<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head>

      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   <title>OpenAM Administration Guide</title><link rel="stylesheet" type="text/css" href="coredoc.css"><link rel="stylesheet" type="text/css" href="css/coredoc.css"><link rel="stylesheet" type="text/css" href="sh/shCore.css"><link rel="stylesheet" type="text/css" href="sh/shCoreEclipse.css"><link rel="stylesheet" type="text/css" href="sh/shThemeEclipse.css"><script src="http://code.jquery.com/jquery-1.11.0.min.js" type="text/javascript"></script><script src="uses-jquery.js" type="text/javascript"></script><script src="sh/shCore.js" type="text/javascript"></script><script src="sh/shBrushAci.js" type="text/javascript"></script><script src="sh/shBrushBash.js" type="text/javascript"></script><script src="sh/shBrushCsv.js" type="text/javascript"></script><script src="sh/shBrushHttp.js" type="text/javascript"></script><script src="sh/shBrushJava.js" type="text/javascript"></script><script src="sh/shBrushJScript.js" type="text/javascript"></script><script src="sh/shBrushLDIF.js" type="text/javascript"></script><script src="sh/shBrushPlain.js" type="text/javascript"></script><script src="sh/shBrushProperties.js" type="text/javascript"></script><script src="sh/shBrushXml.js" type="text/javascript"></script><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><meta name="description" content="Guide to configuring and using OpenAM features. OpenAM provides open source Authentication, Authorization, Entitlement and Federation software."><script type="text/javascript">SyntaxHighlighter.all();</script>
<link rel="shortcut icon" href="http://forgerock.org/favicon.ico">
</head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div lang="en" class="book"><div class="titlepage"><div><div><h1 class="title"><a name="admin-guide"></a>OpenAM Administration Guide</h1></div><div><h2 class="subtitle">Version 12.0.0</h2></div><div><div class="authorgroup"><div class="author"><h3 class="author"><span class="firstname">Mark </span> <span class="surname">Craig</span></h3></div><div class="author"><h3 class="author"><span class="firstname">David </span> <span class="surname">Goldsmith</span></h3></div><div class="author"><h3 class="author"><span class="firstname">Gene </span> <span class="surname">Hirayama</span></h3></div><div class="author"><h3 class="author"><span class="firstname">Mike </span> <span class="surname">Jang</span></h3></div><div class="author"><h3 class="author"><span class="firstname">Chris </span> <span class="surname">Lee</span></h3></div><div class="author"><h3 class="author"><span class="firstname">Vanessa </span> <span class="surname">Richie</span></h3><div lang="en" class="affiliation"><span class="orgname">ForgeRock AS<br></span><div class="address"><p><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="street">33&nbsp;New&nbsp;Montgomery&nbsp;St.</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="otheraddr">Suite&nbsp;1500</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="city">San&nbsp;Francisco</span>,&nbsp;<span class="state">CA</span>&nbsp;<span class="postcode">94105</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="country">USA</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="phone">+1&nbsp;415-599-1100&nbsp;(US)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<code class="uri">www.forgerock.com</code><br>
&nbsp;&nbsp;&nbsp;</p></div></div></div></div></div><div><p class="releaseinfo">Software release date: December 17, 2014</p></div><div><p class="copyright">Copyright &copy; 2011-2014 ForgeRock, Inc.</p></div><div><a href="legalnotice.html">Legal Notice</a></div><div><p class="pubdate">Publication date: December 17, 2014</p></div><div><div class="abstract"><div class="abstract-title">Abstract</div><p>Guide to configuring and using OpenAM features. OpenAM provides open
   source Authentication, Authorization, Entitlement and Federation
   software.</p></div></div></div><hr></div><div class="toc"><div class="toc-title">Table of Contents</div><dl class="toc"><dt><span class="preface"><a href="#preface">Preface</a></span></dt><dt><span class="chapter"><a href="#chap-admin-tools">1. Administration Interfaces &amp; Tools</a></span></dt><dt><span class="chapter"><a href="#chap-auth-services">2. Defining Authentication Services</a></span></dt><dt><span class="chapter"><a href="#chap-authz-policy">3. Defining Authorization Policies</a></span></dt><dt><span class="chapter"><a href="#chap-realms">4. Configuring Realms</a></span></dt><dt><span class="chapter"><a href="#chap-agents">5. Configuring Policy Agent Profiles</a></span></dt><dt><span class="chapter"><a href="#chap-audit-logging">6. Configuring Audit Logging</a></span></dt><dt><span class="chapter"><a href="#chap-mobile">7. Working with Mobile Devices &amp; Applications</a></span></dt><dt><span class="chapter"><a href="#chap-pwd-reset">8. Configuring User Self-Service Features</a></span></dt><dt><span class="chapter"><a href="#chap-sso">9. Configuring Single Sign-On within One Domain</a></span></dt><dt><span class="chapter"><a href="#chap-cdsso">10. Configuring Cross-Domain Single Sign On</a></span></dt><dt><span class="chapter"><a href="#chap-federation">11. Managing SAML 2.0 Federation</a></span></dt><dt><span class="chapter"><a href="#chap-oauth2">12. Managing OAuth 2.0 Authorization</a></span></dt><dt><span class="chapter"><a href="#chap-openid-connect">13. Managing OpenID Connect 1.0 Authorization</a></span></dt><dt><span class="chapter"><a href="#chap-saml-1">14. Managing SAML 1.x Single Sign-On</a></span></dt><dt><span class="chapter"><a href="#chap-rest-sts">15. The RESTful Security Token Service</a></span></dt><dt><span class="chapter"><a href="#chap-dashboard">16. Configuring the Dashboard Service</a></span></dt><dt><span class="chapter"><a href="#chap-rest">17. Configuring REST APIs</a></span></dt><dt><span class="chapter"><a href="#chap-backup-restore">18. Backing Up and Restoring OpenAM Configurations</a></span></dt><dt><span class="chapter"><a href="#chap-certs-keystores">19. Managing Certificates</a></span></dt><dt><span class="chapter"><a href="#chap-monitoring">20. Monitoring OpenAM Services</a></span></dt><dt><span class="chapter"><a href="#chap-tuning">21. Tuning OpenAM</a></span></dt><dt><span class="chapter"><a href="#chap-change-hosts">22. Changing Host Names</a></span></dt><dt><span class="chapter"><a href="#chap-securing">23. Securing OpenAM</a></span></dt><dt><span class="chapter"><a href="#chap-troubleshooting">24. Troubleshooting</a></span></dt><dt><span class="glossary"><a href="#openam-glossary">OpenAM Glossary</a></span></dt><dt><span class="appendix"><a href="#appendix-interface-stability">A. Release Levels &amp; Interface Stability</a></span></dt><dt><span class="index"><a href="#d16037e35993">Index</a></span></dt></dl></div><div lang="en" class="preface"><div class="titlepage"><div><div><h1 class="title"><a name="preface"></a>Preface</h1></div></div></div><p>This guide shows you how to configure, maintain, and troubleshoot
  OpenAM for single sign on and authorization, password reset, account
  lockout, cross-domain single sign on, and federation.</p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d16037e175"></a>1.&nbsp;Who Should Use this Guide</h2></div></div></div><p>This guide is written for access management designers and
   administrators who build, deploy, and maintain OpenAM services for
   their organizations. This guide covers the tasks you might repeat
   throughout the life cycle of an OpenAM release used in your
   organization.</p><p>This guide starts by introducing the OpenAM administrative
   interfaces and tools, and by showing how to manage OpenAM services.
   This guide continues by showing how to configure the principle
   features of OpenAM. It then demonstrates how to backup, restore,
   monitor, tune, and troubleshoot, OpenAM services.</p><p>You do not need to be an OpenAM wizard to learn something from
   this guide, though a background in access management and maintaining
   web application software can help. You do need some background in
   managing services on your operating systems and in your application
   servers. You can nevertheless get started with this guide, and then
   learn more as you go along.</p></div><div lang="en" class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="formatting-conventions"></a>2.&nbsp;Formatting Conventions</h2></div></div></div><p>
  Most examples in the documentation are created on GNU/Linux or Mac OS X.

  Where it is helpful to make a distinction between operating environments,
  examples for UNIX, GNU/Linux, Mac OS X, and so forth are labeled (UNIX).
  Mac OS X specific examples can be labeled (Mac OS X).
  Examples for Microsoft Windows can be labeled (Windows).

  To avoid repetition, however, file system directory names are
  often given only in UNIX format as in <code class="filename">/path/to/server</code>,
  even if the text applies to <code class="filename">C:\path\to\server</code> as well.
 </p><p>
  Absolute path names usually begin with the placeholder
  <code class="filename">/path/to/</code>.

  This path might translate to <code class="filename">/opt/</code>,
  <code class="filename">C:\Program Files\</code>, or somewhere else on your system.
 </p><p>
  Command line, terminal sessions are formatted as follows.
 </p><div class="screen"><pre>$ <strong>echo $JAVA_HOME</strong>
<em>/path/to/jdk</em></pre></div><p>
  Command output is sometimes formatted for narrower, more readable output
  even though formatting parameters are not shown in the command.
  In the following example, the query string parameter
  <code class="literal">_prettyPrint=true</code> is omitted.
 </p><div class="screen"><pre>
$ <strong>curl https://bjensen:hifalutin@opendj.example.com:8443/users/newuser</strong>
<em>{
  "_rev" : "000000005b337348",
  "schemas" : [ "urn:scim:schemas:core:1.0" ],
  "contactInformation" : {
    "telephoneNumber" : "+1 408 555 1212",
    "emailAddress" : "newuser@example.com"
  },
  "_id" : "newuser",
  "name" : {
    "familyName" : "New",
    "givenName" : "User"
  },
  "userName" : "newuser@example.com",
  "displayName" : "New User",
  "meta" : {
    "created" : "2014-06-03T09:58:27Z"
  },
  "manager" : [ {
    "_id" : "kvaughan",
    "displayName" : "Kirsten Vaughan"
  } ]
}</em>
 </pre></div><p>
  Program listings are formatted as follows.
 </p><pre class="brush: java;">class Test {
    public static void main(String [] args)  {
        System.out.println("This is a program listing.");
    }
}</pre></div><div lang="en" class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="accessing-doc-online"></a>3.&nbsp;Accessing Documentation Online</h2></div></div></div><p>
  ForgeRock core documentation, such as what you are now reading, aims to be
  technically accurate and complete with respect to the software documented.
 </p><div class="itemizedlist"><p>
   Core documentation therefore follows a three-phase review process
   designed to eliminate errors.
  </p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
    Product managers and software architects review project documentation design
    with respect to the users' software lifecycle needs.
   </p></li><li class="listitem"><p>
    Subject matter experts review proposed documentation changes for
    technical accuracy and completeness
    with respect to the corresponding software.
   </p></li><li class="listitem"><p>
    Quality experts validate implemented documentation changes for
    technical validity with respect to the software,
    technical completeness with respect to the scope of the document,
    and usability for the expected audience.
   </p></li></ul></div><p>
  The review process helps to ensure that documentation published for
  a ForgeRock release is technically accurate and complete.
 </p><p>
  Fully reviewed, published core documentation is available at
  <a class="link" href="http://docs.forgerock.org/" target="_blank">http://docs.forgerock.org/</a>.

  Use this documentation when working with a ForgeRock Enterprise release.
 </p><p>
  In-progress documentation can be found at each project site under the
  <a class="link" href="http://forgerock.org" target="_blank">Developer Community</a> projects page.

  Use this documentation when trying a nightly build.
 </p><p>
  The ForgeRock <a class="link" href="https://wikis.forgerock.org/" target="_blank">Community Wikis</a> and provide additional, user-created information.

  We encourage you to
  <a class="link" href="https://sso.forgerock.com/openam/UI/Login" target="_blank">join the community</a>, so that you can update the Wikis, too.
 </p></div><div lang="en" class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="joining-the-community"></a>4.&nbsp;Joining the ForgeRock Community</h2></div></div></div><p>
  After you
  <a class="link" href="https://backstage.forgerock.com/#/account/register" target="_blank">sign up</a> to join the ForgeRock community,
  you can edit the
  <a class="link" href="https://wikis.forgerock.org/" target="_blank">Community Wikis</a>,
  and also log bugs and feature requests in the
  <a class="link" href="https://bugster.forgerock.org/" target="_blank">issue tracker</a>.
 </p><p>
  If you have a question regarding a project but cannot find an answer
  in the project documentation or Wiki, browse to the
  <a class="link" href="http://forgerock.org" target="_blank">Developer Community</a> page for the project,
  where you can find details on joining the project mailing lists,
  and find links to mailing list archives.

  You can also suggest updates to documentation through the
  <a class="link" href="https://lists.forgerock.org/mailman/listinfo/docs" target="_blank">ForgeRock docs mailing list</a>.
 </p><p>
  The Community Wikis describe how to check out and build source code.

  Should you want to contribute a patch, test, or feature,
  or want to author part of the core documentation,
  first have a look on the ForgeRock site at
  <a class="link" href="http://forgerock.org/get_involved.html" target="_blank">how to get involved</a>.
 </p></div></div><div lang="en" class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="chap-admin-tools"></a>Chapter&nbsp;1.&nbsp;Administration Interfaces &amp; Tools</h1></div></div></div><div class="toc"><div class="toc-title">Table of Contents</div><dl class="toc"><dt><span class="section"><a href="#openam-console-overview">1.1. OpenAM Web-Based Console</a></span></dt><dt><span class="section"><a href="#openam-cli-overview">1.2. OpenAM Command-Line Tools</a></span></dt><dt><span class="section"><a href="#openam-ssoadm-jsp-overview">1.3. OpenAM ssoadm.jsp</a></span></dt></dl></div><a class="indexterm" name="d16037e302"></a><p>This chapter provides a brief introduction to the web-based OpenAM
 console. It also lists and describes each command line interface (CLI)
 administration tool.</p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="openam-console-overview"></a>1.1.&nbsp;OpenAM Web-Based Console</h2></div></div></div><a class="indexterm" name="d16037e310"></a><p>After you install OpenAM, login to the web-based console as OpenAM
  Administrator, <code class="literal">amadmin</code> with the password you set during
  installation. Navigate to a URL such as
  <code class="literal">http://openam.example.com:8080/openam</code>. In this case,
  communications proceed over the HTTP protocol to a FQDN
  (<code class="literal">openam.example.com</code>), over a standard Java EE web container
  port number (8080), to a specific deployment URI (<code class="literal">/openam</code>).</p><div class="mediaobject" align="center"><a name="figure-console-as-amadmin"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/console-as-amadmin.png" align="middle" height="360" alt="How the console looks to amadmin"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-console-as-amadmin.html" target="longdesc">D</a>]</span></div></div><p>When you login as the OpenAM Administrator, <code class="literal">amadmin</code>,
  you have access to the complete OpenAM console. In addition, OpenAM has set a
  cookie in your browser that lasts until the session expires, you logout, or
  you close your browser.<a href="#ftn.d16037e342" class="footnote" name="d16037e342"><sup class="footnote">[1]</sup></a></p><p>When you login to the OpenAM console as a non-administrative end user,
  you do not have access to the administrative console. Your access is limited
  to a configuration page with your account information.</p><div class="mediaobject" align="center"><a name="figure-console-non-admin-user"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/console-non-admin-user.png" align="middle" height="360" alt="How the console looks to an end user"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-console-non-admin-user.html" target="longdesc">D</a>]</span></div></div><p>If you configure OpenAM to grant administrative capabilities to
  another user, then that user also sees the console after login. For
  instance, the OpenAM Administrator granted Kirsten Vaughan privileges to
  administer the OpenAM Top Level Realm. (This can be done through the console
  under Access Control &gt; / (Top Level Realm) &gt; Privileges. Kirsten
  has authorization to read and write policy properties and configured
  policy agent properties.) When Kirsten logs in, she sees only part of the
  console capabilities.<a href="#ftn.d16037e357" class="footnote" name="d16037e357"><sup class="footnote">[2]</sup></a></p><div class="mediaobject" align="center"><a name="figure-console-as-kvaughan"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/console-as-kvaughan.png" align="middle" height="360" alt="How the console looks to an administrator"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-console-as-kvaughan.html" target="longdesc">D</a>]</span></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="openam-cli-overview"></a>1.2.&nbsp;OpenAM Command-Line Tools</h2></div></div></div><a class="indexterm" name="d16037e371"></a><p>The script tools in the following list have <code class="literal">.bat</code>
  versions for use on Microsoft Windows.</p><a class="indexterm" name="d16037e381"></a><div class="variablelist"><p>You can install the following OpenAM command-line tools.</p><dl class="variablelist"><dt><span class="term"><span class="command"><strong>agentadmin</strong></span></span></dt><dd><p>This tool lets you manage OpenAM policy agent installations.</p><p>Unpack this tool as part of policy agent installation.</p></dd><dt><span class="term"><span class="command"><strong>ampassword</strong></span></span></dt><dd><p>This tool lets you change OpenAM Administrator passwords, and
     display encrypted password values.</p><p>Install this from the <code class="filename">SSOAdminTools-12.0.0.zip</code>.</p></dd><dt><span class="term"><span class="command"><strong>amverifyarchive</strong></span></span></dt><dd><p>This tool checks log archives for tampering.</p><p>Install this from <code class="filename">SSOAdminTools-12.0.0.zip</code>.</p></dd><dt><span class="term"><span class="command"><strong>openam-distribution-configurator-12.0.0.jar</strong></span></span></dt><dd><p>This executable .jar file lets you perform a silent installation of an OpenAM
     server with a configuration file. For example, the <span class="command"><strong>java -jar configurator.jar -f
     config.file</strong></span> command couples the <code class="filename">configurator.jar</code> archive
     with the <em class="replaceable"><code>config.file</code></em>. The <code class="filename">sampleconfiguration</code>
     file provided with the tool is set up with the format for the <code class="filename">config.file</code>,
     and it must be adapted for your environment.</p><p>Install this from <code class="filename">SSOConfiguratorTools-12.0.0.zip</code>.</p></dd><dt><span class="term"><span class="command"><strong>ssoadm</strong></span></span></dt><dd><p>This tool provides a rich command-line interface for the configuration
     of OpenAM core services.</p><p>In a test environment you can activate
     <code class="filename">ssoadm.jsp</code> to access the same functionality in your
     browser. Once active, you can use many features of the <span class="command"><strong>ssoadm</strong></span>
     command, by navigating to the <code class="filename">ssoadm.jsp</code> URI, in a URL such as
     <code class="literal">http://openam.example.com:8080/openam/ssoadm.jsp</code>.</p><p>Install this from <code class="filename">SSOAdminTools-12.0.0.zip</code>.</p><p>To translate settings applied in OpenAM console to service attributes
     for use with <span class="command"><strong>ssoadm</strong></span>, login to the OpenAM console
     as <code class="literal">amadmin</code> and access the services page, in a URL such as
     <code class="literal">http://openam.example.com:8080/openam/services.jsp</code>.</p></dd></dl></div><p>The commands access the OpenAM configuration over HTTP (or HTTPS).
  When using the administration commands in a site configuration, the
  commands access the configuration through the front end load balancer.</p><div class="itemizedlist"><p>Sometimes a command cannot access the load balancer, because:</p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Network routing restrictions prevent the tool from accessing
    the load balancer.</p></li><li class="listitem"><p>For testing purposes, the load balancer uses a self-signed
    certificate for HTTPS, and the tool does not have a way of trusting the
    self-signed certificate.</p></li><li class="listitem"><p>The load balancer is temporarily unavailable.</p></li></ul></div><p>In such cases you can work around the problem by adding an option for each
   node, such as the following to the <span class="command"><strong>java</strong></span> command in the
   tool's script.</p><p>Node 1:</p><pre class="brush: plain;">
   -D"com.iplanet.am.naming.map.site.to.server=https://lb.example.com:443/openam=
   http://server1.example.com:8080/openam"
  </pre><p>Node 2:</p><pre class="brush: plain;">
   -D"com.iplanet.am.naming.map.site.to.server=https://lb.example.com:443/openam=
   http://server2.example.com:8080/openam"
  </pre><p>In the above example the load balancer is on the <code class="literal">lb</code>
   host, <code class="literal">https://lb.example.com:443/openam</code> is the site name,
   and the OpenAM servers in the site are on <code class="literal">server1</code> and
   <code class="literal">server2</code>.</p><p>The <span class="command"><strong>ssoadm</strong></span> command will only use the latest value in the
   map, so if you have a mapping like: </p><pre class="brush: plain;">
   -D"com.iplanet.am.naming.map.site.to.server=https://lb.example.com:443/openam=
   http://server1.example.com:8080/openam, https://lb.example.com:443/openam=
   http://server2.example.com:8080/openam"
  </pre><p>The <span class="command"><strong>ssoadm</strong></span> command will always talk to:</p><pre class="brush: plain;">
   http://server2.example.com:8080/openam
  </pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="openam-ssoadm-jsp-overview"></a>1.3.&nbsp;OpenAM ssoadm.jsp</h2></div></div></div><a class="indexterm" name="d16037e543"></a><p>You can use the <span class="command"><strong>ssoadm.jsp</strong></span> page to access a large
  subset of the configuration capabilities of the <span class="command"><strong>ssoadm</strong></span>
  command. Yet, <span class="command"><strong>ssoadm.jsp</strong></span> is disabled by default to prevent
  potential misuse.</p><div class="procedure"><a name="enable-ssoadm-jsp"></a><div class="procedure-title">Procedure&nbsp;1.1.&nbsp;To Enable ssoadm.jsp</div><a class="indexterm" name="d16037e562"></a><ol class="procedure" type="1"><li class="step"><p>Login as OpenAM administrator, <code class="literal">amadmin</code>.</p></li><li class="step"><p>Click Configuration &gt; Servers and Sites &gt;
    Servers &gt; <em class="replaceable"><code>URL of your server</code></em>.</p></li><li class="step"><p>Click Advanced to display the Advanced Properties table,
    and then click Add. In the text boxes that appear, include the following
    information, and then click Save.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Property Name</span></dt><dd><p>ssoadm.disabled</p></dd><dt><span class="term">Property Value</span></dt><dd><p>false</p></dd></dl></div></li><li class="step"><p>To see if the change worked, navigate to the URL of OpenAM with the
    <code class="literal">/ssoadm.jsp</code> URI. For the aforementioned URL, you would
    navigate to <code class="literal">http://openam.example.com:8080/openam/ssoadm.jsp</code>.</p></li></ol></div></div><div class="footnotes"><br><hr class="footnote-hr"><div id="ftn.d16037e342" class="footnote"><p><a href="#d16037e342" class="para"><sup class="para">[1] </sup></a>Persistent cookies can remain valid when you
  close your browser. This section reflects OpenAM default behavior before
  you configure additional functionality.</p></div><div id="ftn.d16037e357" class="footnote"><p><a href="#d16037e357" class="para"><sup class="para">[2] </sup></a>For more on delegated administration,
  see the chapter covering realms.</p></div></div></div><div lang="en" class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="chap-auth-services"></a>Chapter&nbsp;2.&nbsp;Defining Authentication Services</h1></div></div></div><div class="toc"><div class="toc-title">Table of Contents</div><dl class="toc"><dt><span class="section"><a href="#what-is-authn">2.1. About Authentication in OpenAM</a></span></dt><dt><span class="section"><a href="#configure-social-authn">2.2. Configuring Social Authentication</a></span></dt><dt><span class="section"><a href="#configure-authn-modules">2.3. Configuring Authentication Modules</a></span></dt><dt><span class="section"><a href="#configure-authn-chains">2.4. Configuring Authentication Chains</a></span></dt><dt><span class="section"><a href="#authn-post-auth-plugins">2.5. Post Authentication Plugins</a></span></dt><dt><span class="section"><a href="#authn-from-browser">2.6. Authenticating To OpenAM</a></span></dt><dt><span class="section"><a href="#session-upgrade">2.7. Authentication Levels &amp; Session Upgrade</a></span></dt><dt><span class="section"><a href="#configure-account-lockout">2.8. Configuring Account Lockout</a></span></dt><dt><span class="section"><a href="#configure-session-quotas">2.9. Configuring Session Quotas</a></span></dt><dt><span class="section"><a href="#configure-valid-goto-url-resources">2.10. Configuring Valid goto URL Resources</a></span></dt></dl></div><p>An <em class="firstterm">authentication</em> service confirms the identity
 of a user or a client application.</p><p>This chapter describes how to configure authentication in OpenAM.</p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="what-is-authn"></a>2.1.&nbsp;About Authentication in OpenAM</h2></div></div></div><a class="indexterm" name="d16037e616"></a><p>Access management is about controlling access to resources. OpenAM
  plays a role similar to border control at an international airport. Instead
  of having each and every airline company deal with access to each
  destination, all airlines redirects passengers to border control. Border
  control then determines who each passenger is according to passport
  credentials. Border control also checks whether the identified passenger
  is authorized to fly to the destination corresponding to the ticket, perhaps
  based on visa credentials. Then, at the departure gate, an agent enforces
  the authorization from border control, allowing the passenger to board the
  plane as long as the passenger has not gotten lost, or tried to board the
  wrong plane, or swapped tickets with someone else. Thus, border control
  handles access management at the airport.</p><p>OpenAM is most frequently used to protect web-accessible resources.
  Users browse to a protected web application page. An agent installed on the
  server with the web application redirects the user to OpenAM for access management.
  OpenAM determines who the user is, and whether the user has the right to
  access the protected page. OpenAM then redirects the user back to the
  protected page, with authorization credentials that can be verified by the agent.
  The agent allows OpenAM authorized users access the page.</p><p>Notice that OpenAM basically needs to determine two things for
  access management: the identity of the user, and whether the user has access rights
  to the protected page. <em class="firstterm">Authentication</em> is how OpenAM identifies
  the user. This chapter covers how to set up the
  authentication process. <em class="firstterm">Authorization</em> is how OpenAM determines
  whether a user has access to a protected resource. Authorization is covered later.</p><p>For authentication, OpenAM uses credentials from the user or
  client application. It then uses defined mechanisms to
  validate credentials and complete the authentication. The authentication
  methods can vary. For example, passengers travelling on international flights authenticate
  with passports and visas. In contrast, passengers travelling on domestic flights might
  authenticate with an identity card or a driver's license. Customers withdrawing
  cash from an ATM authenticate with a card and a PIN. </p><a class="indexterm" name="d16037e635"></a><a class="indexterm" name="d16037e640"></a><p>OpenAM allows you to configure authentication processes and then customize
  how they are applied. OpenAM uses <em class="firstterm">authentication
  modules</em> to handle different ways of authenticating. Basically,
  each authentication module handles one way of obtaining and verifying
  credentials. You can chain different authentication modules together.
  In OpenAM, this is called <em class="firstterm">authentication chaining</em>.
  Each authentication module can be configured to specify the continuation and
  failure semantics with one of the following four flags:
  required, optional, requisite, or sufficient.<a href="#ftn.d16037e653" class="footnote" name="d16037e653"><sup class="footnote">[3]</sup></a></p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>When a <em class="firstterm">required</em> module fails, the rest of
    the chain is processed, but the authentication fails.</p><p>A required module might be used for login with email and password,
    but then fall through to another module to handle new users who have not
    yet signed up.</p></li><li class="listitem"><p>When an <em class="firstterm">optional</em> module fails,
    authentication continues.</p><p>An optional module might be used to permit a higher level of access
    if the user can present a X.509 certificate for example.</p></li><li class="listitem"><p>When a <em class="firstterm">requisite</em> module fails, authentication
    fails and authentication processing stops.</p><p>A requisite module might be used with exclusive SSO.</p></li><li class="listitem"><p>When a <em class="firstterm">sufficient</em> succeeds, authentication
    is successful and later modules in the chain are skipped.</p><p>You could set Windows Desktop SSO as sufficient, so authenticated
    Windows users are let through, whereas web users have to traverse another
    authentication module such as one requiring an email address and a
    password.</p></li></ul></div><a class="indexterm" name="d16037e689"></a><p>With OpenAM, you can further set <em class="firstterm">authentication
  levels</em> per module, with higher levels being used typically
  to allow access to more restricted resources. The OpenAM SPIs also let you
  develop your own authentication modules, and post-authentication plugins.
  Client applications can specify the authentication level, module, user, and
  authentication service to use among those you have configured. As described
  later in this guide, you can use <em class="firstterm">realms</em> to organize
  which authentication process applies for different applications or different
  domains, perhaps managed by different people.</p><p>When a user successfully authenticates, OpenAM creates a session, which
  allows OpenAM to manage that user's access to resources. In some deployments
  you need to limit how many active sessions a user can have at a given time.
  For example, you might want to prevent a user from using more than two devices
  at once. See <a class="xref" href="#configure-session-quotas" title="2.9.&nbsp;Configuring Session Quotas">Section&nbsp;2.9, &#8220;Configuring Session Quotas&#8221;</a> for
  instructions.</p><p>OpenAM leaves the authentication process flexible so that you can adapt
  how it works to your situation. Although at first the number of choices
  can seem daunting, now that you understand the basic process, you begin to
  see how choosing authentication modules and arranging them in authentication
  chains lets you use OpenAM to protect access to a wide range of applications
  used in your organization.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="configure-social-authn"></a>2.2.&nbsp;Configuring Social Authentication</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="#social-authn-wizard-pre-populated">2.2.1. Configuring Pre-Populated Social Authentication Providers</a></span></dt><dt><span class="section"><a href="#social-authn-wizard-custom">2.2.2. Configuring Custom Social Authentication Providers</a></span></dt><dt><span class="section"><a href="#social-authn-implementations-service">2.2.3. Configuring the Social Authentication Implementations service</a></span></dt></dl></div><a class="indexterm" name="d16037e711"></a><a class="indexterm" name="d16037e718"></a><p>OpenAM allows delegation of authentication to any third party
   OpenID Connect 1.0 server that implements the <a class="link" href="http://openid.net/specs/openid-connect-discovery-1_0.html" target="_blank"><em class="citetitle">OpenID Connect Discovery 1.0 specification</em></a>.</p><p>The OpenAM console provides wizards for configuring authentication
   with selected third parties: Facebook, Google, or Microsoft. An additional
   wizard provides the ability to configure other third party authentication
   providers.</p><p>The wizards create an Authentication Module
   and an Authentication Chain containing the correct configuration
   needed to authenticate with the third party. The wizard also adds
   configuration data to the realm's <span class="emphasis"><em>Social Authentication Implementations</em></span>
   Service (and provisions the service if it is not already present) that
   enables the display of logos of configured third party authentication
   providers on the OpenAM login screen, as shown below.</p><div class="figure"><a name="figure-login-with-social-logos"></a><div class="figure-title">Figure&nbsp;2.1.&nbsp;Login Screen With Social Authentication Logos</div><div class="figure-contents"><div class="mediaobject" align="center"><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/login-with-social-authentication.png" align="middle" height="360" alt="Login screen with social authentication logos."></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="ld-d16037e739.html" target="longdesc">D</a>]</span></div></div></div></div><br class="figure-break"><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="social-authn-wizard-pre-populated"></a>2.2.1.&nbsp;Configuring Pre-Populated Social Authentication Providers</h3></div></div></div><a class="indexterm" name="d16037e753"></a><p>OpenAM provides wizards to quickly enable authentication with
    Facebook, Google and Microsoft. Most settings are pre-populated,
    only a <span class="emphasis"><em>Client ID</em></span> and <span class="emphasis"><em>Client
     Secret</em></span> are required.</p><p>To obtain a <span class="emphasis"><em>Client ID</em></span> and <span class="emphasis"><em>Client
    Secret</em></span> you should register an application with the
    third party provider, at the following links:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Facebook</span></dt><dd><p>
      <a class="link" href="https://developers.facebook.com/quickstarts/?platform=web" target="_blank">
       <em class="citetitle">Facebook App Quickstart</em></a></p></dd><dt><span class="term">Google</span></dt><dd><p><a class="link" href="https://console.developers.google.com/project" target="_blank"><em class="citetitle">Google Developers Console</em></a></p><div class="note"><h3 class="title">Note</h3><p>You must enable the Google+ API in order to
       authenticate with Google. To enable the Google+ API,
       login to the Google Developers Console, select your project,
       navigate to APIs &amp; auth &gt; APIs, and then set the status of the
       <code class="literal">Google+ API</code> to <code class="literal">ON</code>.</p></div></dd><dt><span class="term">Microsoft</span></dt><dd><p>
      <a class="link" href="https://account.live.com/developers/applications/index" target="_blank"><em class="citetitle">Microsoft account Developer Center</em></a></p></dd></dl></div><div class="procedure"><a name="howto-social-authn-wizard-pre-populated"></a><div class="procedure-title">Procedure&nbsp;2.1.&nbsp;To Configure Pre-Populated Social Authentication Providers</div><a class="indexterm" name="d16037e814"></a><p>Once you have registered an application and obtained credentials from
     the social authentication provider, follow the steps below to configure
     authentication with the provider.</p><ol class="procedure" type="1"><li class="step"><p>On the Common Tasks tab page of the OpenAM console, click the link
      for the social authentication provider you want to configure, either
      <span class="emphasis"><em>Configure Facebook Authentication</em></span>,
      <span class="emphasis"><em>Configure Google Authentication</em></span>, or
      <span class="emphasis"><em>Configure Microsoft Authentication</em></span>.
     </p></li><li class="step"><p>On the configure third party authentication page:</p><ol type="a" class="substeps"><li class="step"><p>Select the realm in which to enable social authentication.</p></li><li class="step"><p>Enter the <span class="emphasis"><em>Client ID</em></span> obtained from
       the third party authentication provider.</p></li><li class="step"><p>Enter the <span class="emphasis"><em>Client Secret</em></span> obtained from
       the third party authentication provider, and repeat it in the
       <code class="literal">Confirm Client Secret</code> field.</p></li><li class="step"><p>Leave the default <code class="literal">Redirect URL</code>,
       unless you are using an external server as a proxy.</p></li><li class="step"><p>Click <code class="literal">Create</code>.</p></li></ol><div class="figure"><a name="figure-google-authn-wizard"></a><div class="figure-title">Figure&nbsp;2.2.&nbsp;The Configure Google Authentication Wizard</div><div class="figure-contents"><div class="mediaobject" align="center"><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/google-authn-wizard.png" align="middle" height="360" alt="The Configure Google Authentication wizard."></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="ld-d16037e872.html" target="longdesc">D</a>]</span></div></div></div></div><br class="figure-break"><p>On completion, the wizard displays a message confirming
      the successful creation of a new Authentication Module and an
      Authentication Chain for the provider, and either the creation of a new
      Social Authentication Implementations service named
      <code class="literal">socialAuthNService</code>, or an update if it already existed.</p></li></ol></div><p>You can configure the Authentication Module, Authentication Chain,
    and Social Authentication Implementations service that you created by using the
    wizards in the same way as manually created versions. For more information, see
    <a class="xref" href="#configure-authn-modules" title="2.3.&nbsp;Configuring Authentication Modules">Section&nbsp;2.3, &#8220;Configuring Authentication Modules&#8221;</a>,
    <a class="xref" href="#configure-authn-chains" title="2.4.&nbsp;Configuring Authentication Chains">Section&nbsp;2.4, &#8220;Configuring Authentication Chains&#8221;</a>, and
    <a class="xref" href="#social-authn-implementations-service" title="2.2.3.&nbsp;Configuring the Social Authentication Implementations service">Section&nbsp;2.2.3, &#8220;Configuring the Social Authentication Implementations service&#8221;</a>.
   </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="social-authn-wizard-custom"></a>2.2.2.&nbsp;Configuring Custom Social Authentication Providers</h3></div></div></div><a class="indexterm" name="d16037e896"></a><p>OpenAM provides a wizard to quickly enable authentication with
    any third party provider that supports the <a class="link" href="http://openid.net/specs/openid-connect-discovery-1_0.html" target="_blank">
     <em class="citetitle">OpenID Connect Discovery 1.0 specification</em></a>.</p><p>You must first register an application with the third party
    provider to obtain a <span class="emphasis"><em>Client ID</em></span>, <span class="emphasis"><em>Client
     Secret</em></span>, and the <span class="emphasis"><em>OpenID Discovery URL</em></span>.</p><div class="procedure"><a name="howto-social-authn-wizard-custom"></a><div class="procedure-title">Procedure&nbsp;2.2.&nbsp;To Configure Custom Social Authentication Providers</div><p>Once you have registered an application and obtained your
     credentials from the social authentication provider,
     follow the steps below to configure authentication with the provider.</p><ol class="procedure" type="1"><li class="step"><p>On the Common Tasks tab page of the OpenAM console, click the
      <code class="literal">Configure Other Authentication</code> link.
     </p></li><li class="step"><p>On the configure social authentication page:</p><ol type="a" class="substeps"><li class="step"><p>Select the realm in which to enable social authentication.</p></li><li class="step"><p>Enter the <span class="emphasis"><em>OpenID Discovery URL</em></span> obtained
       from the third party authentication provider.</p></li><li class="step"><p>Enter a name for the provider in the <code class="literal">Provider
      Name</code> field. OpenAM uses this as a label on the
       login page to identify the provider.</p></li><li class="step"><p>Enter the URL of an image to be used on the login page in the
       <code class="literal">Image URL</code> field. OpenAM places the image on the
       login page, to enable authentication with the provider.</p></li><li class="step"><p>Enter the <span class="emphasis"><em>Client ID</em></span> obtained from
       the third party authentication provider.</p></li><li class="step"><p>Enter the <span class="emphasis"><em>Client Secret</em></span> obtained from
       the third party authentication provider, and repeat it in the
       <code class="literal">Confirm Client Secret</code> field.</p></li><li class="step"><p>Leave the default <code class="literal">Redirect URL</code>,
       unless you are using an external server as a proxy.</p></li><li class="step"><p>Click <code class="literal">Create</code>.</p></li></ol><div class="figure"><a name="figure-social-authn-wizard"></a><div class="figure-title">Figure&nbsp;2.3.&nbsp;The Configure Social Authentication Wizard</div><div class="figure-contents"><div class="mediaobject" align="center"><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/social-authn-wizard.png" align="middle" height="360" alt="The Configure Social Authentication wizard."></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="ld-d16037e987.html" target="longdesc">D</a>]</span></div></div></div></div><br class="figure-break"><p>On completion, the wizard displays a message confirming
      the successful creation of a new Authentication Module and an
      Authentication Chain for the provider, and either the creation of a new
      Social Authentication Implementations service named
      <code class="literal">socialAuthNService</code>, or an update if it already existed.</p></li></ol></div><p>You can configure the Authentication Module, Authentication Chain,
    and Social Authentication Implementations service that you created by using the
    wizard in the same way as manually created versions. For more information, see
    <a class="xref" href="#configure-authn-modules" title="2.3.&nbsp;Configuring Authentication Modules">Section&nbsp;2.3, &#8220;Configuring Authentication Modules&#8221;</a>,
    <a class="xref" href="#configure-authn-chains" title="2.4.&nbsp;Configuring Authentication Chains">Section&nbsp;2.4, &#8220;Configuring Authentication Chains&#8221;</a>, and
    <a class="xref" href="#social-authn-implementations-service" title="2.2.3.&nbsp;Configuring the Social Authentication Implementations service">Section&nbsp;2.2.3, &#8220;Configuring the Social Authentication Implementations service&#8221;</a>.
   </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="social-authn-implementations-service"></a>2.2.3.&nbsp;Configuring the Social Authentication Implementations service</h3></div></div></div><a class="indexterm" name="d16037e1011"></a><p>You can add logos to the login page to allow users to authenticate
    using configured social authentication providers.</p><p>Wizards are provided to configure common social authentication
    providers, which also configure the Social Authentication Implementations
    service to add logos to the login page. You can manually add other
    Authentication Chains that contain an OAuth 2.0 / OpenID Connect
    authentication module.</p><p>To add a social authentication provider to the login screen,
    you must first configure an OAuth 2.0 / OpenID Connect Authentication Module
    , and an Authentication Chain that contains it. You can create the by using a
    wizard, see <a class="xref" href="#social-authn-wizard-pre-populated" title="2.2.1.&nbsp;Configuring Pre-Populated Social Authentication Providers">Section&nbsp;2.2.1, &#8220;Configuring Pre-Populated Social Authentication Providers&#8221;</a> and
    <a class="xref" href="#social-authn-wizard-custom" title="2.2.2.&nbsp;Configuring Custom Social Authentication Providers">Section&nbsp;2.2.2, &#8220;Configuring Custom Social Authentication Providers&#8221;</a>
   or created manually, see <a class="xref" href="#configure-authn-modules" title="2.3.&nbsp;Configuring Authentication Modules">Section&nbsp;2.3, &#8220;Configuring Authentication Modules&#8221;</a> and
    <a class="xref" href="#configure-authn-chains" title="2.4.&nbsp;Configuring Authentication Chains">Section&nbsp;2.4, &#8220;Configuring Authentication Chains&#8221;</a>.</p><div class="procedure"><a name="howto-social-authn-implementations"></a><div class="procedure-title">Procedure&nbsp;2.3.&nbsp;To Configure Social Authentication Implementations</div><p>Once you have created an Authentication Chain containing an OAuth
     2.0 / OpenID Connect Authentication Module, follow the steps below to add a logo for the
     authentication provider to the login screen.</p><ol class="procedure" type="1"><li class="step"><p>On the Access Control tab page of the OpenAM console, click the
      realm containing the authentication module and authentication chain to
      be added to the login screen.
     </p></li><li class="step"><p>On the Services tab page for the realm:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>If the
        <code class="literal">Social Authentication Implementations</code> service
        exists, click on it.</p></li></ul></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>If the
        <code class="literal">Social Authentication Implementations</code> service
        does not exist, click New, select
        Social Authentication Implementations, and then click
        Next.</p></li></ul></div></li><li class="step"><p>On the Social Authentication Implementations page:</p><ol type="a" class="substeps"><li class="step"><p>In the <span class="emphasis"><em>Display Names</em></span> section, enter a
       Map Key, enter the text to display as ALT text on the logo in
       the Corresponding Map Value field, and then click Add.</p><div class="note"><h3 class="title">Note</h3><p>OpenAM uses the value in the Map Key fields throughout the
       configuration to tie the various implementation settings
       to each other. The value is case-sensitive.</p></div></li><li class="step"><p>In the <span class="emphasis"><em>Authentication Chains</em></span> section,
       re-enter the Map Key used in the previous step, select the Authentication Chain
       from the Corresponding Map Value list, and then click Add.</p></li><li class="step"><p>In the <span class="emphasis"><em>Icons</em></span> section,
       re-enter the  Map Key used in the previous steps, enter the path to a
       logo image to be used on the login screen in the Corresponding Map Value
       list, and then click Add.</p></li><li class="step"><p>In the <span class="emphasis"><em>Enabled Implementations</em></span> section,
       re-enter the  Map Key used in the previous steps, and then click Add.</p><div class="tip"><h3 class="title">Tip</h3><p>Removing a Map Key from the Enabled Implementations
        list removes the associated logo from the login screen. There
        is no need to delete the Display Name, Authentication Chain or
        Icon configuration to remove the logo from the login screen.</p></div></li><li class="step"><p>Click Add or Save.</p></li></ol><div class="figure"><a name="figure-social-authn-implementations"></a><div class="figure-title">Figure&nbsp;2.4.&nbsp;Configuring the Social Authentication Implementations
       service</div><div class="figure-contents"><div class="mediaobject" align="center"><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/social-authn-implementations.png" align="middle" height="360" alt="Configuring the Social Authentication Implementations service."></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="ld-d16037e1097.html" target="longdesc">D</a>]</span></div></div></div></div><br class="figure-break"></li></ol></div><p>An icon now appears on the OpenAM login screen,
    allowing users to authenticate with the third party
    authentication provider.</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="configure-authn-modules"></a>2.3.&nbsp;Configuring Authentication Modules</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="#ad-module-conf-hints">2.3.1. Hints for the Active Directory Authentication Module</a></span></dt><dt><span class="section"><a href="#adaptive-auth-module-conf-hints">2.3.2. Hints for the Adaptive Risk Authentication Module</a></span></dt><dt><span class="section"><a href="#anon-module-conf-hints">2.3.3. Hints for the Anonymous Authentication Module</a></span></dt><dt><span class="section"><a href="#cert-module-conf-hints">2.3.4. Hints for the Certificate Authentication Module</a></span></dt><dt><span class="section"><a href="#core-module-conf-hints">2.3.5. Hints for the Core Authentication Module</a></span></dt><dt><span class="section"><a href="#datastore-module-conf-hints">2.3.6. Hints for the Data Store Authentication Module</a></span></dt><dt><span class="section"><a href="#device-id-match-hints">2.3.7. Hints for the Device ID (Match) Authentication Module</a></span></dt><dt><span class="section"><a href="#device-id-save-hints">2.3.8. Hints for the Device ID (Save) Module</a></span></dt><dt><span class="section"><a href="#federation-module-conf-hints">2.3.9. Hints for the Federation Authentication Module</a></span></dt><dt><span class="section"><a href="#hotp-module-conf-hints">2.3.10. Hints for the HOTP Authentication Module</a></span></dt><dt><span class="section"><a href="#http-module-conf-hints">2.3.11. Hints for the HTTP Basic Authentication Module</a></span></dt><dt><span class="section"><a href="#jdbc-module-conf-hints">2.3.12. Hints for the JDBC Authentication Module</a></span></dt><dt><span class="section"><a href="#ldap-module-conf-hints">2.3.13. Hints for the LDAP Authentication Module</a></span></dt><dt><span class="section"><a href="#msisdn-module-conf-hints">2.3.14. Hints for the MSISDN Authentication Module</a></span></dt><dt><span class="section"><a href="#OATH-module-conf-hints">2.3.15. Hints for the OATH Module</a></span></dt><dt><span class="section"><a href="#oauth2-module-conf-hints">2.3.16. Hints for the OAuth 2.0/OpenID Connect Authentication Module</a></span></dt><dt><span class="section"><a href="#oidc-module-conf-hints">2.3.17. Hints for the OpenID Connect id_token bearer Module</a></span></dt><dt><span class="section"><a href="#persistent-cookie">2.3.18. Hints for the Persistent Cookie Module</a></span></dt><dt><span class="section"><a href="#radius-module-conf-hints">2.3.19. Hints for the RADIUS Authentication Module</a></span></dt><dt><span class="section"><a href="#sae-module-conf-hints">2.3.20. Hints for the SAE Authentication Module</a></span></dt><dt><span class="section"><a href="#scripted-module-conf-hints">2.3.21. Hints for Scripted Authentication Modules</a></span></dt><dt><span class="section"><a href="#securid-module-conf-hints">2.3.22. Hints For the SecurID Authentication Module</a></span></dt><dt><span class="section"><a href="#desktop-module-conf-hints">2.3.23. Hints for the Windows Desktop SSO Authentication Module</a></span></dt><dt><span class="section"><a href="#winnt-module-conf-hints">2.3.24. Hints for the Windows NT Authentication Module</a></span></dt><dt><span class="section"><a href="#wss-module-conf-hints">2.3.25. Hints for the WSSAuth Authentication Module</a></span></dt></dl></div><a class="indexterm" name="d16037e1110"></a><p>The OpenAM console provides two places where the OpenAM administrator
  can configure authentication modules.</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Under Configuration &gt; Authentication, you configure available
    modules for use throughout OpenAM. What you set up here is inherited
    for use elsewhere.</p></li><li class="listitem"><p>Under Access Control &gt; <em class="replaceable"><code>Realm Name</code></em> &gt;
    Authentication, you configure modules for your realm. What you set up
    at this level inherits from the global configuration, but you can override
    what is inherited. You can also add your own modules if necessary.</p></li></ol></div><p>The configuration of individual modules depend on its function.
  The configuration of an Active Directory over LDAP user authentication module
  requires connection information and details about where to search for users.
  In contrast, the configuration of the HOTP module for OTP authentication
  requires data about the password length and the mail server or SMS gateway for
  to send the password during authentication.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="ad-module-conf-hints"></a>2.3.1.&nbsp;Hints for the Active Directory Authentication Module</h3></div></div></div><a class="indexterm" name="idx-auth-hints-ad"></a><a class="indexterm" name="d16037e1139"></a><p>OpenAM connects to Active Directory over Lightweight Directory Access
   Protocol (LDAP). OpenAM provides separate Active Directory and LDAP
   modules to support the use of both Active Directory and
   another directory service in an authentication chain.</p><p><span class="command"><strong>ssoadm</strong></span> service name:
   <code class="literal">sunAMAuthADService</code></p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Primary Active Directory Server, </span><span class="term">Secondary Active Directory Server</span></dt><dd><p>The default port for LDAP is 389. If you are connecting to
      Active Directory over SSL, the default port for LDAP/SSL is 636.</p><p>To allow users to change passwords through OpenAM, Active Directory
      requires that you connect over SSL.</p><p>If you want to use SSL or TLS for security, then scroll down to
      enable SSL/TLS Access to Active Directory Server. Make sure that OpenAM
      can trust the Active Directory certificate when using this option.</p><p>OpenAM first attempts to contact primary servers. If no primary
      server is available, then OpenAM attempts to contact secondaries.</p><p>When authenticating users from a directory server that is remote
      from OpenAM, set both the primary and secondary server values.</p><p><span class="command"><strong>ssoadm</strong></span> attributes: primary is
      <code class="literal">iplanet-am-auth-ldap-server</code>; secondary is
      <code class="literal">iplanet-am-auth-ldap-server2</code></p></dd><dt><span class="term">DN to Start User Search</span></dt><dd><p>LDAP data is organized hierarchically, a bit like a file system
      on Windows or UNIX. More specific DNs likely result in better performance.
      When configuring the module for a particular part of the organization,
      you can perhaps start searches from a specific organizational unit such as
      <code class="literal">OU=sales,DC=example,DC=com</code>.</p><p>If multiple entries exist with identical search attribute values,
      make this value specific enough to return only one entry.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-ldap-base-dn</code></p></dd><dt><span class="term">Bind User DN, Bind User Password</span></dt><dd><p>If OpenAM stores attributes in Active Directory, for example to
      manage account lockout, or if Active Directory requires that OpenAM
      authenticate in order to read users' attributes, then OpenAM needs the
      DN and password to authenticate to Active Directory.</p><p>The default is <code class="literal">amldapuser</code>. If the administrator
      authentication chain (default: <code class="literal">ldapService</code>) has been
      configured to include only the Active Directory module, then make sure
      that the password is correct before you logout. If it is incorrect, you
      will be locked out. If you do get locked out, you can login with the
      super user DN, which by default is
      <code class="literal">uid=amAdmin,ou=People,<em class="replaceable"><code>OpenAM-deploy-base</code></em></code>,
      where <em class="replaceable"><code>OpenAM-deploy-base</code></em> was set during
      OpenAM configuration.</p><p><span class="command"><strong>ssoadm</strong></span> attributes:
      <code class="literal">iplanet-am-auth-ldap-bind-dn</code> and
      <code class="literal">iplanet-am-auth-ldap-bind-passwd</code></p></dd><dt><span class="term">Attributes Used to Retrieve User Profile, </span><span class="term">Attributes Used to Search for a User to be Authenticated, </span><span class="term">User Search Filter, </span><span class="term">Search Scope</span></dt><dd><p>LDAP searches for user entries return entries with attribute
      values matching the filter you provide. For example if you search under
      <code class="literal">CN=Users,DC=example,DC=com</code> with a filter
      <code class="literal">"(MAIL=bjensen@example.com)"</code>, then the directory
      returns the entry that has <code class="literal">MAIL=bjensen@example.com</code>.
      In this example the attribute used to search for a user is
      <code class="literal">mail</code>. Multiple attribute values mean the user can
      authenticate with any one of the values. For example, if you have
      both <code class="literal">uid</code> and <code class="literal">mail</code>, then Barbara
      Jensen can authenticate with either <code class="literal">bjensen</code> or
      <code class="literal">bjensen@example.com</code>.</p><p>The User Search Filter text box provides a more complex filter. For example, 
      if you search on <code class="literal">mail</code> and add User Search Filter
      <code class="literal">(objectClass=inetOrgPerson)</code>, then OpenAM uses the resulting 
      search filter <code class="literal">(&amp;(mail=<em class="replaceable"><code>address</code></em>)
      (objectClass=inetOrgPerson))</code>, where <em class="replaceable"><code>address</code></em> 
      is the mail address provided by the user.</p><p>This controls how and the level of the directory that will be searched.
      You can set the search to run at a high level or against a specific area.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>OBJECT will search only for the entry specified as the DN to Start User
         Search.</p></li><li class="listitem"><p>ONELEVEL will search only the entries that are directly children of that
         object.</p></li><li class="listitem"><p>SUBTREE will search the entry specified and every entry under it.</p></li></ul></div><p><span class="command"><strong>ssoadm</strong></span> attributes:
      <code class="literal">iplanet-am-auth-ldap-user-naming-attribute</code>,
      <code class="literal">iplanet-am-auth-ldap-user-search-attributes</code>,
      <code class="literal">iplanet-am-auth-ldap-search-filter</code>, and
      <code class="literal">iplanet-am-auth-ldap-search-scope</code></p></dd><dt><span class="term">SSL/TLS Access to Active Directory Server</span></dt><dd><p>If you enable SSL/TLS, OpenAM must be able to trust Active Directory
      certificates, either because the Active Directory certificates were
      signed by a CA whose certificate is already included in the trust store
      used by the container where OpenAM runs, or because you imported the
      certificates into the trust store.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-ldap-ssl-enabled</code></p></dd><dt><span class="term">Return User DN to DataStore</span></dt><dd><p>When enabled, and OpenAM uses Active Directory as the user store,
      the module returns the DN rather than the User ID, so the bind for
      authentication can be completed without a search to retrieve
      the DN.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-ldap-return-user-dn</code></p></dd><dt><span class="term">User Creation Attributes</span></dt><dd><p>This list lets you map (external) attribute names from Active
      Directory to (internal) attribute names used by OpenAM.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-ldap-user-creation-attr-list</code></p></dd><dt><span class="term">LDAP Connection Heartbeat Interval</span></dt><dd><p>Specifies how often OpenAM should send a heartbeat request to the
      directory server to ensure that the connection does not remain idle. Some
      network administrators configure firewalls and load balancers to drop
      connections that are idle for too long. You can turn this off by setting
      the value to 0 or to a negative number. To set the units for the interval
      use LDAP Connection Heartbeat Time Unit.</p><p>Default: 1</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openam-auth-ldap-heartbeat-interval</code></p></dd><dt><span class="term">LDAP Connection Heartbeat Time Unit</span></dt><dd><p>Specifies the time unit corresponding to LDAP Connection Heartbeat
      Interval.</p><p>Default: minute</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openam-auth-ldap-heartbeat-interval</code></p></dd><dt><span class="term">Authentication Level</span></dt><dd><p>Sets the authentication level used to indicate the level of security
      associated with the module. The value can range from 0 to any positive integer.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sunAMAuthADAuthLevel</code></p></dd></dl></div><a class="indexterm" name="d16037e1380"></a></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="adaptive-auth-module-conf-hints"></a>2.3.2.&nbsp;Hints for the Adaptive Risk Authentication Module</h3></div></div></div><a class="indexterm" name="idx-auth-hints-adaptive-risk"></a><a class="indexterm" name="d16037e1393"></a><p>The Adaptive Risk module is designed to assess risk during
   authentication so that OpenAM can determine whether to require the
   user to complete further authentication steps. After configuring the
   Adaptive Risk module, insert it in your authentication chain with criteria
   set to sufficient as shown in the following example.</p><div class="mediaobject" align="center"><a name="figure-adaptive-auth-module"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/adaptive-auth-module.png" align="middle" height="360" alt="Including the Adaptive Risk module in an authentication chain"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-adaptive-auth-module.html" target="longdesc">D</a>]</span></div></div><p>In the example authentication chain shown, OpenAM has users
   authenticate first using the LDAP module providing a user ID and password
   combination. Upon success, OpenAM calls the Adaptive Risk module. The
   Adaptive Risk module assesses the risk based on your configured parameters.
   If the Adaptive Risk module calculates a total score below the threshold you
   set, the module returns success, and OpenAM finishes authentication
   processing without requiring further credentials. Otherwise the Adaptive
   Risk module evaluates the score to be above the risk threshold, and returns
   failure. OpenAM then calls the HOTP module, requiring the user to
   authenticate with a one-time password delivered to her by email or by SMS
   to her mobile phone.</p><p>When you configure the Adaptive Risk module to save cookies and
   profile attributes after successful authentication, OpenAM performs the
   save as post-authentication processing, only after the entire authentication
   chain returns success. You must set up OpenAM to save the data as part of
   post-authentication processing by editing the authentication chain to add
   <code class="literal">org.forgerock.openam.authentication.modules.adaptive.Adaptive</code>
   to the list of post authentication plugins.</p><p>
    When the Adaptive Risk module relies on the client IP address,
    and OpenAM lies behind a load balancer or proxy layer,
    configure the load balancer or proxy to send the address
    by using the <code class="literal">X-Forwarded-For</code> header,
    and configure OpenAM to consume and forward the header as necessary.
    For details, see the <em class="citetitle">Installation Guide</em> section,
    <a href="../install-guide/index.html#handle-request-headers" class="link"><em class="citetitle">Handling HTTP Request Headers</em></a>.
   </p><p><span class="command"><strong>ssoadm</strong></span> service name:
   <code class="literal">sunAMAuthAdaptiveService</code></p><div class="variablelist"><div class="variablelist-title">General</div><dl class="variablelist"><dt><span class="term">Authentication Level</span></dt><dd><p>Sets the authentication level used to indicate the level of security
      associated with the module. The value can range from 0 to any positive integer.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
       <code class="literal">openam-auth-adaptive-auth-level</code></p></dd><dt><span class="term">Risk Threshold</span></dt><dd><p>Risk threshold score. If the sum of the Scores is greater than the
      threshold, the Adaptive Risk module returns failure. Default: 1</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openam-auth-adaptive-auth-threshold</code></p></dd></dl></div><div class="variablelist"><div class="variablelist-title">Failed Authentications</div><dl class="variablelist"><dt><span class="term">Failed Authentication Check</span></dt><dd><p>When enabled, check the user profile for authentication failures
      since the last successful login. This check therefore requires
      OpenAM to have access to the user profile, and Account Lockout to be
      enabled (otherwise OpenAM does not record authentication
      failures).</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openam-auth-adaptive-failure-check</code></p></dd><dt><span class="term">Score</span></dt><dd><p>Value to add to the total score if the user fails the Failed
      Authentication Check. Default: 1</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openam-auth-adaptive-failure-score</code></p></dd><dt><span class="term">Invert Result</span></dt><dd><p>When selected, add the Score to the total score if the user
      passes the Failed Authentication Check.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openam-auth-adaptive-failure-invert</code></p></dd></dl></div><div class="variablelist"><div class="variablelist-title">IP Address Range</div><dl class="variablelist"><dt><span class="term">IP Range Check</span></dt><dd><p>When enabled, check whether the client IP address is within one
      of the specified IP Ranges.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openam-auth-adaptive-ip-range-check</code></p></dd><dt><span class="term">IP Range</span></dt><dd><p>For IPv4, specifies a list of IP ranges either in CIDR-style notation
      (<code class="literal"><em class="replaceable"><code>x.x.x.x</code></em>/<em class="replaceable"><code>YY</code></em></code>)
      or as a range from one address to another
      (<code class="literal"><em class="replaceable"><code>x.x.x.x</code></em>-<em class="replaceable"><code>y.y.y.y</code></em></code>,
      meaning from <em class="replaceable"><code>x.x.x.x</code></em> to
      <em class="replaceable"><code>y.y.y.y</code></em>).</p><p>For IPv6, specifies a list of IP ranges either in CIDR-style notation
      (<code class="literal"><em class="replaceable"><code>X:X:X:X:X:X:X:X</code></em>/<em class="replaceable"><code>YY</code></em></code>)
      or as a range from one address to another
      (<code class="literal"><em class="replaceable"><code>X:X:X:X:X:X:X:X</code></em>-<em class="replaceable"><code>Y:Y:Y:Y:Y:Y:Y:Y</code></em></code>,
      meaning from <em class="replaceable"><code>X:X:X:X:X:X:X:X</code></em> to
      <em class="replaceable"><code>Y:Y:Y:Y:Y:Y:Y:Y</code></em>).</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openam-auth-adaptive-ip-range-range</code></p></dd><dt><span class="term">Score</span></dt><dd><p>Value to add to the total score if the user fails the IP Range
      Check. Default: 1</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openam-auth-adaptive-ip-range-score</code></p></dd><dt><span class="term">Invert Result</span></dt><dd><p>When selected, add the Score to the total score if the user
      passes the IP Range Check.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openam-auth-adaptive-ip-range-invert</code></p></dd></dl></div><div class="variablelist"><div class="variablelist-title">IP Address History</div><dl class="variablelist"><dt><span class="term">IP History Check</span></dt><dd><p>When enabled, check whether the client IP address matches one of
      the known values stored on the profile attribute you specify. This check
      therefore requires that OpenAM have access to the user profile.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openam-auth-adaptive-ip-history-check</code></p></dd><dt><span class="term">History Size</span></dt><dd><p>Specifies how many IP address values to retain on the profile
      attribute you specify. Default: 5</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openam-auth-ip-adaptive-history-count</code></p></dd><dt><span class="term">Profile Attribute Name</span></dt><dd><p>Name of the user profile attribute on which to store known IP
      addresses. Default: <code class="literal">iphistory</code></p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openam-auth-adaptive-ip-history-attribute</code></p></dd><dt><span class="term">Save Successful IP Address</span></dt><dd><p>When enabled, save new client IP addresses to the known IP address
      list following successful authentication.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openam-auth-adaptive-ip-history-save</code></p></dd><dt><span class="term">Score</span></dt><dd><p>Value to add to the total score if the user fails the IP History
      Check. Default: 1</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openam-auth-adaptive-ip-history-score</code></p></dd><dt><span class="term">Invert Result</span></dt><dd><p>When selected, add the Score to the total score if the user
      passes the IP History Check.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openam-auth-adaptive-ip-history-invert</code></p></dd></dl></div><div class="variablelist"><div class="variablelist-title">Known Cookie</div><dl class="variablelist"><dt><span class="term">Cookie Value Check</span></dt><dd><p>When enabled, check whether the client browser request has the
      specified cookie and optional cookie value.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openam-auth-adaptive-known-cookie-check</code></p></dd><dt><span class="term">Cookie Name</span></dt><dd><p>Specifies the name of the cookie for which OpenAM checks when
      you enable the Cookie Value Check.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openam-auth-adaptive-known-cookie-name</code></p></dd><dt><span class="term">Cookie Value</span></dt><dd><p>Specifies the value of the cookie for which OpenAM checks. If
      no value is specified, OpenAM does not check the cookie value.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openam-auth-adaptive-known-cookie-value</code></p></dd><dt><span class="term">Save Cookie Value on Successful Login</span></dt><dd><p>When enabled, save the cookie as specified in the client's browser
      following successful authentication. If no Cookie Value is specified,
      the value is set to 1.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openam-auth-adaptive-known-cookie-save</code></p></dd><dt><span class="term">Score</span></dt><dd><p>Value to add to the total score if user passes the Cookie Value
      Check. Default: 1</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openam-auth-adaptive-known-cookie-score</code></p></dd><dt><span class="term">Invert Result</span></dt><dd><p>When selected, add the Score to the total score if the user
      passes the Cookie Value Check.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openam-auth-adaptive-known-cookie-invert</code></p></dd></dl></div><div class="variablelist"><div class="variablelist-title">Device Cookie</div><dl class="variablelist"><dt><span class="term">Device Registration Cookie Check</span></dt><dd><p>When enabled, check whether the client browser request has the
      specified cookie with the correct device registration identifier as
      the value.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openam-auth-adaptive-device-cookie-check</code></p></dd><dt><span class="term">Cookie Name</span></dt><dd><p>Specifies the name of the cookie for the Device Registration Cookie
      Check. Default: Device</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openam-auth-adaptive-device-cookie-name</code></p></dd><dt><span class="term">Save Device Registration on Successful Login</span></dt><dd><p>When enabled, save the specified cookie with a hashed device
      identifier value in the client's browser following successful
      authentication.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openam-auth-adaptive-device-cookie-save</code></p></dd><dt><span class="term">Score</span></dt><dd><p>Value to add to the total score if the user fails the Device
      Registration Cookie Check. Default: 1</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openam-auth-adaptive-device-cookie-score</code></p></dd><dt><span class="term">Invert Result</span></dt><dd><p>When selected, add the Score to the total score if the user
      passes the Device Registration Cookie Check.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openam-auth-adaptive-device-cookie-invert</code></p></dd></dl></div><div class="variablelist"><div class="variablelist-title">Time Since Last Login</div><dl class="variablelist"><dt><span class="term">Time Since Last Login Check</span></dt><dd><p>When enabled, check whether the client browser request has the
      specified cookie that holds the encrypted last login time, and check
      that the last login time is more recent than a maximum number of days you
      specify.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openam-auth-adaptive-time-since-last-login-check</code></p></dd><dt><span class="term">Cookie Name</span></dt><dd><p>Specifies the name of the cookie holding the encrypted last login
      time value.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openam-auth-adaptive-time-since-last-login-cookie-name</code></p></dd><dt><span class="term">Max Time since Last Login</span></dt><dd><p>Specifies a threshold age of the last login time in days. If the
      client's last login time is more recent than the number of days specified,
      then the client successfully passes the check.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openam-auth-adaptive-time-since-last-login-value</code></p></dd><dt><span class="term">Save time of Successful Login</span></dt><dd><p>When enabled, save the specified cookie with the current time
      encrypted as the last login value in the client's browser following
      successful authentication.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openam-auth-adaptive-time-since-last-login-save</code></p></dd><dt><span class="term">Score</span></dt><dd><p>Value to add to the total score if the user fails the Time Since
      Last Login Check. Default: 1</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openam-auth-adaptive-time-since-last-login-score</code></p></dd><dt><span class="term">Invert Result</span></dt><dd><p>When selected, add the Score to the total score if the user
      passes the Time Since Last Login Check.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openam-auth-adaptive-time-since-last-login-invert</code></p></dd></dl></div><div class="variablelist"><div class="variablelist-title">Profile Attribute</div><dl class="variablelist"><dt><span class="term">Profile Risk Attribute check</span></dt><dd><p>When enabled, check whether the user profile contains the specified
      attribute and value.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openam-auth-adaptive-risk-attribute-check</code></p></dd><dt><span class="term">Attribute Name</span></dt><dd><p>Specifies the attribute to check on the user profile for the
      specified value.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openam-auth-adaptive-risk-attribute-name</code></p></dd><dt><span class="term">Attribute Value</span></dt><dd><p>Specifies the value to match on the profile attribute. If the
      attribute is multi-valued, a single match is sufficient to pass the
      check.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openam-auth-adaptive-risk-attribute-value</code></p></dd><dt><span class="term">Score</span></dt><dd><p>Value to add to the total score if the user fails the Profile Risk
      Attribute Check. Default: 1</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openam-auth-adaptive-risk-attribute-score</code></p></dd><dt><span class="term">Invert Result</span></dt><dd><p>When selected, add the Score to the total score if the user
      passes the Profile Risk Attribute Check.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openam-auth-adaptive-risk-attribute-invert</code></p></dd></dl></div><div class="variablelist"><div class="variablelist-title">Geo Location</div><dl class="variablelist"><dt><span class="term">Geolocation Country Code Check</span></dt><dd><p>When enabled, check whether the client IP address location matches
      a country specified in the Valid Country Codes list. The </p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">forgerock-am-auth-adaptive-geo-location-check</code></p></dd><dt><span class="term">Geolocation Database location</span></dt><dd><p>Path to GeoIP data file used to convert IP addresses to
      country locations. The geolocation database is not packaged with OpenAM. 
      You can downloaded the GeoIP Country database from  <a class="link" href="http://www.maxmind.com/en/country" target="_top">MaxMind</a>. Use the binary 
      .dat file format, rather than .csv. You can use the GeoLite Country database
      for testing.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openam-auth-adaptive-geo-location-database</code></p></dd><dt><span class="term">Valid Country Codes</span></dt><dd><p>Specifies the list of country codes to match. Use
      <code class="literal">|</code> to separate multiple values.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openam-auth-adaptive-geo-location-values</code>.</p></dd><dt><span class="term">Score</span></dt><dd><p>Value to add to the total score if the user fails the Geolocation
      Country Code Check. Default: 1</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openam-auth-adaptive-geo-location-score</code></p></dd><dt><span class="term">Invert Result</span></dt><dd><p>When selected, add the Score to the total score if the user
      passes the Geolocation Country Code Check.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openam-auth-adaptive-geo-location-invert</code></p></dd></dl></div><div class="variablelist"><div class="variablelist-title">Request Header</div><dl class="variablelist"><dt><span class="term">Request Header Check</span></dt><dd><p>When enabled, check whether the client browser request has the
      specified header with the correct value.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openam-auth-adaptive-req-header-check</code></p></dd><dt><span class="term">Request Header Name</span></dt><dd><p>Specifies the name of the request header for the Request Header
      Check.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openam-auth-adaptive-req-header-name</code></p></dd><dt><span class="term">Request Header Value</span></dt><dd><p>Specifies the value of the request header for the Request Header
      Check.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openam-auth-adaptive-req-header-value</code></p></dd><dt><span class="term">Score</span></dt><dd><p>Value to add to the total score if the user fails the Request
      Header Check. Default: 1</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openam-auth-adaptive-req-header-score</code></p></dd><dt><span class="term">Invert Result</span></dt><dd><p>When selected, add the Score to the total score if the user
      passes the Request Header Check.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openam-auth-adaptive-req-header-invert</code></p></dd></dl></div><a class="indexterm" name="d16037e2076"></a></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="anon-module-conf-hints"></a>2.3.3.&nbsp;Hints for the Anonymous Authentication Module</h3></div></div></div><a class="indexterm" name="idx-auth-hints-anonymous"></a><a class="indexterm" name="d16037e2089"></a><p>This module lets you configure and track anonymous users, who can log in
     to your application or web site without login credentials.
     Typically, you would provide such users with very limited access,
     for example, an anonymous user may have access to public downloads on your site.
     When the user attempts to access resources that require more protection,
     the module can force further authentication for those resources.</p><p>You can configure the Anonymous Authentication Module
      by specifying the <span class="command"><strong>ssoadm</strong></span> service name and Anonymous
      Authentication realm attributes: Valid Anonymous Users, Default User Name,
      Case Sensitive User IDs, and Authentication Level.
     </p><p><span class="command"><strong>ssoadm</strong></span> service name:
          <code class="literal">iPlanetAMAuthAnonymousService</code></p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Valid Anonymous Users</span></dt><dd><p>Specifies the list of valid anonymous user IDs that can log in without
       submitting a password.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
        <code class="literal">iplanet-am-auth-anonymous-users-list</code></p><p>When user accesses the default module instance login URL, then the
        module prompts the user to enter a valid anonymous user name.</p><p>The default module instance login URL is defined as follows:</p><pre class="literallayout">protocol://hostname:port/deploy_URI/UI/Login?module=Anonymous&amp;org=org_name</pre><p>Next, OpenAM checks that the user ID is a valid anonymous user name.
        If the valid anonymous user ID exists in the list, the user is granted access to
        the application and the session is assigned to the user.
        The valid user can bypass the Login page at the following URL:</p><pre class="literallayout">protocol://hostname:port/deploy_URI/UI/Login?module=Anonymous&amp;org=org_name&amp;
IDToken1=&lt;valid anonymous username&gt;</pre><p>If the valid anonymous user ID does not exist in the list,
       the user will be authenticated as the Default Anonymous User Name (see below).</p></dd><dt><span class="term">Default Anonymous User Name</span></dt><dd><p>Specifies the user ID assigned by the module if the Valid
      Anonymous Users list is empty. The default value is <code class="literal">anonymous</code>.
      Note that the anonymous user must be defined in the realm.</p><pre class="literallayout">protocol://hostname:port/deploy_URI/UI/Login?module=Anonymous&amp;org=orgName
&amp;IDToken1=&lt;Default Anonymous User Name&gt;</pre><p>For example, the user can bypass the Login page by accessing the URL
        as the default anonymous user using the value of <code class="literal">anonymous</code>:</p><pre class="literallayout">http://openam.example.com:8080/openam/UI/Login?module=Anonymous&amp;org=example.com
&amp;IDToken1=anonymous</pre><p><span class="command"><strong>ssoadm</strong></span> attribute:
       <code class="literal">iplanet-am-auth-anonymous-default-user-name</code></p></dd><dt><span class="term">Case Sensitive User IDs</span></dt><dd><p>Determines whether case matters for anonymous user IDs.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
       <code class="literal">iplanet-am-auth-anonymous-case-sensitive</code></p></dd><dt><span class="term">Authentication Level</span></dt><dd><p>Sets the authentication level used to indicate the level of security
      associated with the module. The value can range from 0 (default) to any
      positive integer and is set for each authentication method.
      The higher number corresponds to a higher level of authentication.
      If you configured your authentication levels from a 0 to 5 scale, then an
      authentication level of 5 will require the highest level of authentication.</p><p>After a user has authenticated, OpenAM stores the authentication level in
      the session token.
      When the user attempts to access a protected resource, the token is
      presented to the application.
      The application uses the token's value to determine if the user has the
      correct authentication level required to access the resource.
      If the user does not have the required authentication level,
      the application can prompt the user to authenticate with a higher
      authentication level. </p><p><span class="command"><strong>ssoadm</strong></span> attribute:
       <code class="literal">iplanet-am-auth-anonymous-auth-level</code></p></dd></dl></div><div class="note"><h3 class="title">Note</h3><p>You can configure the Anonymous Authentication Module using the
          OpenAM Console by clicking <code class="literal">Configuration</code> &gt;
          <code class="literal">Authentication</code> &gt; <code class="literal">Anonymous</code>.</p></div><a class="indexterm" name="d16037e2192"></a></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="cert-module-conf-hints"></a>2.3.4.&nbsp;Hints for the Certificate Authentication Module</h3></div></div></div><a class="indexterm" name="idx-auth-cert"></a><a class="indexterm" name="d16037e2205"></a><p>X.509 digital certificates can enable secure authentication without
   the need for user names and passwords or other credentials. Certificate
   authentication can be handy to manage authentication by applications.
   If all certificates are signed by a recognized Certificate Authority (CA),
   then you might get away without additional configuration. If you need to
   look up public keys of OpenAM clients, this module can also look up public
   keys in an LDAP directory server.</p><p>When you store certificates and certificate revocation lists (CRL)
   in an LDAP directory service, you must configure both how to access the
   directory service and also how to look up the certificates and CRLs,
   based on the fields in the certificates that OpenAM clients present to
   authenticate.</p><p>Access to the LDAP server and how to search for users is similar
   to LDAP module configuration as in <a class="xref" href="#ldap-module-conf-hints" title="2.3.13.&nbsp;Hints for the LDAP Authentication Module">Section&nbsp;2.3.13, &#8220;Hints for the LDAP Authentication Module&#8221;</a>.
   The primary difference is that, unlike for LDAP configuration, OpenAM
   retrieves the user identifier from a field in the certificate that the
   client application presents, then uses that identifier to search for the
   LDAP directory entry that holds the certificate, which should match the
   certificate presented. For example, if the Subject field of a typical
   certificate has a DN <code class="literal">C=FR, O=Example Corp, CN=Barbara
   Jensen</code>, and Barbara Jensen's entry in the directory has
   <code class="literal">cn=Barbara Jensen</code>, then you can use <code class="literal">CN=Barbara
   Jensen</code> from the Subject DN to search for the entry with
   <code class="literal">cn=Barbara Jensen</code> in the directory.</p><p><span class="command"><strong>ssoadm</strong></span> service name:
   <code class="literal">iPlanetAMAuthCertService</code></p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Match Certificate in LDAP</span></dt><dd><p>When enabled, OpenAM searches for a match for the user's
      certificate in the LDAP directory. If a match is found and not revoked
      according to a CRL or OCSP validation, then authentication succeeds.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-cert-check-cert-in-ldap</code></p></dd><dt><span class="term">Subject DN Attribute Used to Search LDAP for Certificates</span></dt><dd><p>Indicates which attribute and value in the certificate Subject DN
      is used to find the LDAP entry holding the certificate.</p><p>Default: CN</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-cert-attr-check-ldap</code></p></dd><dt><span class="term">Match Certificate to CRL</span></dt><dd><p>When enabled, OpenAM checks whether the certificate has been
      revoked according to a CRL in the LDAP directory.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-cert-check-crl</code></p></dd><dt><span class="term">Issuer DN Attribute Used to Search LDAP for CRLs</span></dt><dd><p>Indicates which attribute and value in the certificate Issuer DN
      is used to find the CRL in the LDAP directory.</p><p>Default: CN</p><p>If only one attribute is specified, the LDAP search filter used to
      find the CRL based on the Subject DN of the CA certificate is
      <code class="literal">(<em class="replaceable"><code>attr-name</code></em>=<em class="replaceable"><code>attr-value-in-subject-DN</code></em>)</code>.</p><p>For example, if the subject DN of the issuer certificate is
      <code class="literal">C=US, CN=Some CA, serialNumber=123456</code>, and the
      attribute specified is <code class="literal">CN</code>, then the LDAP search filter
      used to find the CRL is <code class="literal">(CN=Some CA)</code>.</p><p>In order to distinguish among different CRLs for the same CA issuer,
      specify multiple attributes separated by commas (<code class="literal">,</code>) in
      the same order they occur in the subject DN. When multiple attribute names
      are provided in a comma-separated list, the LDAP search filter used is
      <code class="literal">(cn=<em class="replaceable"><code>attr1</code></em>=<em class="replaceable"><code>attr1-value-in-subject-DN</code></em>,<em class="replaceable"><code>attr2</code></em>=<em class="replaceable"><code>attr2-value-in-subject-DN</code></em>,...,<em class="replaceable"><code>attrN</code></em>=<em class="replaceable"><code>attrN-value-in-subject-DN</code></em>)</code>.</p><p>For example, if the subject DN of the issuer certificate is
      <code class="literal">C=US, CN=Some CA, serialNumber=123456</code>, and the
      attributes specified are <code class="literal">CN,serialNumber</code>, then
      the LDAP search filter used to find the CRL is
      <code class="literal">(cn=CN=Some CA,serialNumber=123456)</code>.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-cert-attr-check-crl</code></p></dd><dt><span class="term">HTTP Parameters for CRL Update</span></dt><dd><p>Your certificate authority should provide the URL to use here,
      from which OpenAM can get CRL updates.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-cert-param-get-crl</code></p></dd><dt><span class="term">Match CA Certificate to CRL</span></dt><dd><p>When enabled, OpenAM checks the CRL against the CA certificate to
      ensure it has not been compromised.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">sunAMValidateCACert</code></p></dd><dt><span class="term">Cache CRLs in Memory</span></dt><dd><p>When enabled, CRLs will be cached.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
                   <code class="literal">openam-am-auth-cert-attr-cache-crl</code></p></dd><dt><span class="term">Update CA CRLs from CRLDistributionPoint</span></dt><dd><p>When enabled, OpenAM updates CRLs from the LDAP directory store.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
                   <code class="literal">openam-am-auth-cert-update-crl</code></p></dd><dt><span class="term">OCSP Validation</span></dt><dd><p>Enable this to use Online Certificate Status Protocol (OCSP)
      instead of CRLs to check certificates' revocation status.</p><p>If you enable this, you also must configure OSCP for OpenAM
      under Configuration &gt; Server and Sites &gt; Default Server Settings,
      or Configuration &gt; Server and Sites &gt; <em class="replaceable"><code>Server
      Name</code></em> &gt; Security.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-cert-check-ocsp</code></p></dd><dt><span class="term">LDAP Server Where Certificates are Stored</span></dt><dd><p>Identifies the LDAP server with certificates. Remember to specify URLs
      with appropriate port numbers (389 for unencrypted LDAP, 636 for LDAP over SSL).
      When configuring a secure connection, scroll down to enable Use SSL/TLS for LDAP
      Access.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-cert-ldap-provider-url</code></p></dd><dt><span class="term">LDAP Search Start or Base DN</span></dt><dd><p>Valid base DN for the LDAP search, such as
      <code class="literal">dc=example,dc=com</code>.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-cert-start-search-loc</code></p></dd><dt><span class="term">LDAP Server Authentication User, LDAP Server Authentication Password</span></dt><dd><p>If OpenAM stores attributes in the LDAP directory, for example to
      manage account lockout, or if the LDAP directory requires that OpenAM
      authenticate in order to read users' attributes, then OpenAM needs the
      DN and password to authenticate to the LDAP directory.</p><p><span class="command"><strong>ssoadm</strong></span> attributes:
      <code class="literal">iplanet-am-auth-cert-principal-user</code>, and
      <code class="literal"> iplanet-am-auth-cert-principal-passwd</code></p></dd><dt><span class="term">Use SSL/TLS for LDAP Access</span></dt><dd><p>If you use SSL/TLS for LDAP access, OpenAM must be able to trust the
      LDAP server certificate.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-cert-use-ssl</code></p></dd><dt><span class="term">Certificate Field Used to Access User Profile</span></dt><dd><p>If the user profile is in a different entry from the user
      certificate, then this can be different from subject DN attribute
      used to find the entry with the certificate. When you select other,
      provide an attribute name in the Other Certificate Field Used to Access
      User Profile text box.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-cert-user-profile-mapper</code></p></dd><dt><span class="term">Other Certificate Field Used to Access User Profile</span></dt><dd><p>This field is only used if the Certificate Field Used to Access
      User Profile attribute is set to other. This field allows a custom
      certificate field to be used as the basis of the user search.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-cert-user-profile-mapper-other</code></p></dd><dt><span class="term">SubjectAltNameExt Value Type to Access User Profile</span></dt><dd><p>Use this if you want to look up the user profile from an RFC 822
      style name, or a User Principal Name as used in Active Directory.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal"> iplanet-am-auth-cert-user-profile-mapper-ext</code></p></dd><dt><span class="term">Trusted Remote Hosts</span></dt><dd><p>Hosts trusted to send certificates to OpenAM, such as load balancers
      doing SSL termination, or OpenAM distributed authentication UI
      instances.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-cert-gw-cert-auth-enabled</code></p></dd><dt><span class="term">HTTP Header Name for Client Certificate</span></dt><dd><p>If you configure trusted hosts, specify the HTTP header name for
      the client certificate inserted by the trusted host.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">sunAMHttpParamName</code></p></dd><dt><span class="term">Authentication Level</span></dt><dd><p>Sets the authentication level used to indicate the level of security
      associated with the module. The value can range from 0 to any positive integer.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">iplanet-am-auth-cert-auth-level</code></p></dd></dl></div><a class="indexterm" name="d16037e2537"></a></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="core-module-conf-hints"></a>2.3.5.&nbsp;Hints for the Core Authentication Module</h3></div></div></div><a class="indexterm" name="d16037e2545"></a><p>The Core authentication module is a meta-module.</p><p>The Core module lets you set up the list of modules available,
   and specify what types of client applications can authenticate with which
   modules. It also lets you configure connection pools for access to
   directory servers, and whether to retain objects used during authentication
   for use during logout. Furthermore, the Core module lets you set defaults
   used when configuring authentication in a particular realm.</p><div class="itemizedlist"><p>The Core Authentication module is divided into seven sections:</p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="#auth-core-global" title="2.3.5.1.&nbsp;Core - Global Attributes">Section&nbsp;2.3.5.1, &#8220;Core - Global Attributes&#8221;</a></p></li><li class="listitem"><p><a class="xref" href="#auth-core-realm-attributes" title="2.3.5.2.&nbsp;Core - Realm Attributes">Section&nbsp;2.3.5.2, &#8220;Core - Realm Attributes&#8221;</a></p></li><li class="listitem"><p><a class="xref" href="#auth-core-persistent-cookie" title="2.3.5.3.&nbsp;Core - Persistent Cookie (Legacy)">Section&nbsp;2.3.5.3, &#8220;Core - Persistent Cookie (Legacy)&#8221;</a></p></li><li class="listitem"><p><a class="xref" href="#auth-core-account-lockout" title="2.3.5.4.&nbsp;Core - Account Lockout">Section&nbsp;2.3.5.4, &#8220;Core - Account Lockout&#8221;</a></p></li><li class="listitem"><p><a class="xref" href="#auth-core-general" title="2.3.5.5.&nbsp;Core - General">Section&nbsp;2.3.5.5, &#8220;Core - General&#8221;</a></p></li><li class="listitem"><p><a class="xref" href="#auth-core-security" title="2.3.5.6.&nbsp;Core - Security">Section&nbsp;2.3.5.6, &#8220;Core - Security&#8221;</a></p></li><li class="listitem"><p><a class="xref" href="#auth-core-post-auth" title="2.3.5.7.&nbsp;Core - Post Authentication Processing">Section&nbsp;2.3.5.7, &#8220;Core - Post Authentication Processing&#8221;</a></p></li></ul></div><p><span class="command"><strong>ssoadm</strong></span> service name:
   <code class="literal">iPlanetAMAuthService</code></p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="auth-core-global"></a>2.3.5.1.&nbsp;Core - Global Attributes</h4></div></div></div><a class="indexterm" name="d16037e2587"></a><a class="indexterm" name="d16037e2594"></a><p>The Global Attributes includes the list of available modules, LDAP connection
            settings, authentication process options, and an option to disable the XUI
            and make the classic UI the default end user interface.
            The Global Attributes are defined in the
            <a href="../reference/index.html#authentication-configuration" class="link">
                <em class="citetitle">Authentication Configuration</em></a> section of the
            <em class="citetitle">Reference</em>.</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="auth-core-realm-attributes"></a>2.3.5.2.&nbsp;Core - Realm Attributes</h4></div></div></div><a class="indexterm" name="d16037e2612"></a><a class="indexterm" name="d16037e2619"></a><p>This section of the Core Authentication module is on the Realm Attributes section
    page before options for Persistent Cookies.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">User Profile</span></dt><dd><p>Whether a user profile needs to exist in the user data store,
      or should be created on successful authentication.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Dynamic</span></dt><dd><p>Specifies that on successful authentication the Authentication
         Service creates a user profile if one does not already exist.
         OpenAM then issues the SSOToken. OpenAM creates the user profile 
         in the user data store configured for the realm.</p></dd><dt><span class="term">Dynamic with User Alias</span></dt><dd><p>Specifies that on successful authentication the Authentication
         Service creates a user profile that contains the User Alias List
         attribute which defines one or more aliases that for mapping a
         user's multiple profiles.</p></dd><dt><span class="term">Ignored</span></dt><dd><p>Specifies that a user profile is not required for the
         Authentication Service to issue an SSOToken after a successful
         authentication.</p></dd><dt><span class="term">Required</span></dt><dd><p>Specifies that on successful authentication the user must have
         a user profile in the user data store configured for the realm in
         order for the Authentication Service to issue an SSOToken.</p></dd></dl></div><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-dynamic-profile-creation</code></p></dd><dt><span class="term">User Profile Dynamic Creation Default Roles</span></dt><dd><p>Specifies the Distinguished Name (DN) of a role to be assigned to
      a new user whose profile is created when either of the Dynamic options
      is selected under the User Profile attribute. There are no default
      values. The role specified must be within the realm for which the
      authentication process is configured.</p><p>This role can be either an OpenAM or Sun DSEE role, but it cannot
      be a filtered role. If you wish to automatically assign specific services
      to the user, you have to configure the Required Services attribute in
      the User Profile.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-default-role</code></p></dd><dt><span class="term">Alias Search Attribute Name</span></dt><dd><p>After a user is successfully authenticated, the user's profile is
       retrieved. OpenAM first searches for the user based on the data store settings.
       If that fails to find the user, OpenAM will use the attributes listed here to
       lookup the user profile. This setting accepts any data store specific attribute
       name.
      </p><p><span class="command"><strong>ssoadm</strong></span> attribute:
       <code class="literal">iplanet-am-auth-alias-attr-name</code>
      </p><div class="note"><h3 class="title">Note</h3><p>
        If the <code class="literal">Alias Search Attribute Name</code> property is empty,
        OpenAM uses the <code class="literal">iplanet-am-auth-user-naming-attr</code> property
        from the <code class="literal">iPlanetAmAuthService</code>.
        The <code class="literal">iplanet-am-auth-user-naming-attr</code> property is only
        configurable through the <span class="command"><strong>ssoadm</strong></span> command-line tool and
        not through the OpenAM console.
       </p><div class="screen"><pre>
$ ssoadm get-realm-svc-attrs \
  --adminid amadmin \
  --password-file PATH_TO_PWDFILE \
  --realm REALM \
  --servicename iPlanetAMAuthService

$ ssoadm set-realm-svc-attrs \
  --adminid amadmin \
  --password-file PATH_TO_PWDFILE \
  --realm REALM \
  --servicename iPlanetAMAuthService \
  --attributevalues iplanet-am-auth-user-naming-attr=SEARCH_ATTRIBUTE
       </pre></div></div></dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="auth-core-persistent-cookie"></a>2.3.5.3.&nbsp;Core - Persistent Cookie (Legacy)</h4></div></div></div><a class="indexterm" name="d16037e2714"></a><a class="indexterm" name="d16037e2721"></a><p>This section of the Core Authentication module covers the Persistent Cookie options.</p><div class="note"><h3 class="title">Note</h3><p>Two methods are available in OpenAM to configure persistent cookies. The options described
     here and in <a class="xref" href="#authn-from-browser" title="2.6.&nbsp;Authenticating To OpenAM">Section&nbsp;2.6, &#8220;Authenticating To OpenAM&#8221;</a> specify one method. There is also a new module,
     described in <a class="xref" href="#persistent-cookie" title="2.3.18.&nbsp;Hints for the Persistent Cookie Module">Section&nbsp;2.3.18, &#8220;Hints for the Persistent Cookie Module&#8221;</a>. If you want to set up persistent cookies, you are
     encouraged to use the new module. The options described here have no effect on that module.</p></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Persistent Cookie Mode</span></dt><dd><p>Determines whether users can return to their authenticated session
      after restarting the browser. When enabled, the persistent cookie can be
      used to reauthenticate until the persistent cookie expires (as specified
      by the value of the Persistent Cookie Maximum Time attribute), or until
      the user explicitly logs out. By default, the Authentication Service uses
      only memory cookies (expires when the browser is closed).</p><p>The client must explicitly request a persistent cookie by adding
      <code class="literal">iPSPCookie=yes</code> as a parameter to the login URL. OpenAM
      sets a <code class="literal">DProPCookie</code> as described in
      <a class="xref" href="#authn-from-browser" title="2.6.&nbsp;Authenticating To OpenAM">Section&nbsp;2.6, &#8220;Authenticating To OpenAM&#8221;</a>.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-persistent-cookie-mode</code></p></dd><dt><span class="term">Persistent Cookie Maximum Time</span></dt><dd><p>Specifies the interval after which a persistent cookie expires.
      The interval begins when the user's session is successfully authenticated.
      The maximum value is 2147483647 (in seconds, so a bit more than 68 years).
      The field accepts any integer value less than the maximum.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-persistent-cookie-time</code></p></dd><dt><span class="term">Persistent Cookie Authentication Level</span></dt><dd><p>Sets the authentication level used to indicate the level of security
          associated with the module. The value can range from 0 to any positive integer.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
          <code class="literal">openam-auth-pcookie-auth-level</code></p></dd></dl></div><div class="note"><h3 class="title">Note</h3><p>
       The distributed authentication service (DAS) and cross-domain single sign-on
       (CDSSO) do not support the <code class="literal">iPSPCookie/DProPCookie</code>
       query string parameter to set a <code class="literal">DProPCookie</code> in the
       user-agent as a mechanism for cookie persistence. Neither DAS nor CDSSO retains
       <code class="literal">iPSPCookie=yes</code>.
      </p></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="auth-core-account-lockout"></a>2.3.5.4.&nbsp;Core - Account Lockout</h4></div></div></div><a class="indexterm" name="d16037e2797"></a><a class="indexterm" name="d16037e2804"></a><p>This section of the Core Authentication module
      includes details on how account lockouts can be configured.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Login Failure Lockout Mode</span></dt><dd><p>Selecting this attribute enables a physical lockout. Physical
      lockout will inactivate an LDAP attribute (defined in the Lockout
      Attribute Name property) in the user's profile. This attribute works in
      conjunction with several other lockout and notification attributes.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-login-failure-lockout-mode</code></p></dd><dt><span class="term">Login Failure Lockout Count</span></dt><dd><p>Defines the number of attempts that a user has to authenticate,
      within the time interval defined in Login Failure Lockout Interval,
      before being locked out.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-login-failure-count</code></p></dd><dt><span class="term">Login Failure Lockout Interval</span></dt><dd><p>Defines the time in minutes during which failed login attempts are
      counted. If one failed login attempt is followed by a second failed
      attempt, within this defined lockout interval time, the lockout count
      starts, and the user is locked out if the number of attempts reaches
      the number defined in Login Failure Lockout Count. If an attempt within
      the defined lockout interval time proves successful before the number of
      attempts reaches the number defined in Login Failure Lockout Count, the
      lockout count is reset.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-login-failure-duration</code></p></dd><dt><span class="term">Email Address to Send Lockout Notification</span></dt><dd><p>Specify one (or more) email address(es) to which notification is
      sent if a user lockout occurs.</p><p>Separate multiple addresses with spaces, and append
      <code class="literal">|<em class="replaceable"><code>locale</code></em>|<em class="replaceable"><code>charset</code></em></code>
      to addresses for recipients in non-English locales.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-lockout-email-address</code></p></dd><dt><span class="term">Warn User After N Failures</span></dt><dd><p>The number of authentication failures after which OpenAM displays
      a warning message that the user will be locked out.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal"> iplanet-am-auth-lockout-warn-user</code></p></dd><dt><span class="term">Login Failure Lockout Duration</span></dt><dd><p>Defines how many minutes a user must wait after a lockout before
      attempting to authenticate again. Entering a value greater than 0 enables
      memory lockout and disables physical lockout. Memory lockout means
      the user's account is locked in memory for the number of minutes
      specified. The account is unlocked after the time period has passed.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-lockout-duration</code></p></dd><dt><span class="term">Lockout Duration Multiplier</span></dt><dd><p>Defines a value with which to multiply the value of the Login
      Failure Lockout Duration attribute for each successive lockout. For
      example, if Login Failure Lockout Duration is set to 3 minutes, and the
      Lockout Duration Multiplier is set to 2, the user is locked out of the
      account for 6 minutes. Once the 6 minutes has elapsed, if the user again
      provides the wrong credentials, the lockout duration is then 12 minutes.
      With the Lockout Duration Multiplier, the lockout duration is
      incrementally increased based on the number of times the user has been
      locked out.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">sunLockoutDurationMultiplier</code></p></dd><dt><span class="term">Lockout Attribute Name</span></dt><dd><p>Defines the LDAP attribute used for physical lockout. The default
      value is <code class="literal">inetuserstatus</code>, although the field in the
      OpenAM console is empty. The Lockout Attribute Value field must also
      contain an appropriate value.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-lockout-attribute-name</code></p></dd><dt><span class="term">Lockout Attribute Value</span></dt><dd><p>Specifies the action to take on the attribute defined in Lockout
      Attribute Name. The default value is <code class="literal">inactive</code>,
      although the field in the OpenAM console is empty. The Lockout Attribute
      Name field must also contain an appropriate value.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-lockout-attribute-value</code></p></dd><dt><span class="term">Invalid Attempts Data Attribute Name</span></dt><dd><p>Specifies the LDAP attribute used to hold the number of failed
      authentication attempts towards Login Failure Lockout Count.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">sunAMAuthInvalidAttemptsDataAttrName</code></p></dd><dt><span class="term">Store Invalid Attempts in Data Store</span></dt><dd><p>Enables the storage of information regarding failed authentication
      attempts as the value of the Invalid Attempts Data Attribute Name in
      the user data store. In order to store data in this attribute, the
      OpenAM schema has to be loaded. Information stored includes number of
      invalid attempts, time of last failed attempt, lockout time and lockout
      duration. Storing this information in the identity repository allows it
      to be shared among multiple instances of OpenAM.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">sunStoreInvalidAttemptsInDS</code></p></dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="auth-core-general"></a>2.3.5.5.&nbsp;Core - General</h4></div></div></div><a class="indexterm" name="d16037e2963"></a><a class="indexterm" name="d16037e2970"></a><p>This section of the Core Authentication module includes general options.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Default Authentication Locale</span></dt><dd><p>Specifies the default language subtype to be used by the
      Authentication Service. The default value is
      <code class="literal">en_US</code>.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-locale</code></p></dd><dt><span class="term">Identity Types</span></dt><dd><p>Lists the type or types of identities used during a profile lookup. You can
      choose more than one to search on multiple types if you would like OpenAM to 
      conduct a second lookup if the first lookup fails. Default: Agent and User</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Agent</span></dt><dd><p>Searches for identities under your agents.</p></dd><dt><span class="term">agentgroup</span></dt><dd><p>Searches for identities according to your established agent group.</p></dd><dt><span class="term">agentonly</span></dt><dd><p>Searches for identities only under your agents.</p></dd><dt><span class="term">Group</span></dt><dd><p>Searches for identities according to your established groups.</p></dd><dt><span class="term">User</span></dt><dd><p>Searches for identities according to your users.</p></dd></dl></div><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">sunAMIdentityType</code></p></dd><dt><span class="term">Pluggable User Status Event Classes</span></dt><dd><p>Specifies one or more Java classes used to provide a callback
      mechanism for user status changes during the authentication process.
      The Java class must implement the
      <code class="literal">com.sun.identity.authentication.spi.AMAuthCallBack</code>
      OpenAM interface. OpenAM supports account lockout and password changes.
      OpenAM supports password changes through the LDAP authentication module,
      and so the feature is only available for the LDAP module.</p><p>A .jar containing the user status event class belongs in
      the <code class="filename">WEB-INF/lib</code> directory of the deployed OpenAM
      instance. If you do not build a .jar, add the class files under
      <code class="filename">WEB-INF/classes</code>. </p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">sunAMUserStatusCallbackPlugins</code></p></dd><dt><span class="term">Default Authentication Level</span></dt><dd><p>Specifies the default authentication level for authentication modules.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-default-auth-level</code></p></dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="auth-core-security"></a>2.3.5.6.&nbsp;Core - Security</h4></div></div></div><a class="indexterm" name="d16037e3075"></a><a class="indexterm" name="d16037e3082"></a><p>This section of the Core Authentication module
              includes basic security options.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Module Based Authentication</span></dt><dd><p>Enables users to authenticate using module-based authentication.
      Otherwise, all attempts at authentication using the
      <code class="literal">module=<em class="replaceable"><code>module-name</code></em></code> login
      parameter result in failure. It is recommended that this be turned off in 
      a production environment.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">sunEnableModuleBasedAuth</code></p></dd><dt><span class="term">Zero Page Login</span></dt><dd><a class="indexterm" name="d16037e3111"></a><p>
       If enabled, allow users to authenticate using only GET request parameters
       without showing a login screen.
       Enable this with caution as browsers can cache
       and servers can log credentials when they are part of the URL.
      </p><p>
       OpenAM always allows HTTP POST requests for zero page login.
      </p><p>
       Default: false (disabled)
      </p><p>
       <span class="command"><strong>ssoadm</strong></span> attribute:
       <code class="literal">openam.auth.zero.page.login.enabled</code>
      </p></dd><dt><span class="term">Zero Page Login Referer Whitelist</span></dt><dd><p>
       List of HTTP Referer URLs for which OpenAM allows zero page login.
       These URLs are supplied in the HTTP request header,
       <code class="literal">Referer</code>, which is designed to
       allow the client to specify the web page
       that provided the link to the requested resource.
      </p><p>
       If you enable zero page login,
       include the URLs here for the pages from which to allow zero page login,
       or leave this list blank to allow zero page login from any Referer.
      </p><p>
       This setting applies for both HTTP GET and also HTTP POST requests
       for zero page login.
      </p><p>
       <span class="command"><strong>ssoadm</strong></span> attribute:
       <code class="literal">openam.auth.zero.page.login.referer.whitelist</code>
      </p></dd><dt><span class="term">Zero Page Login Allowed without Referer?</span></dt><dd><p>
       If enabled and zero page login is enabled,
       allow zero page login for requests
       without an HTTP <code class="literal">Referer</code> request header.
      </p><p>
       Default: true (enabled)
      </p><p>
       <span class="command"><strong>ssoadm</strong></span> attribute:
       <code class="literal">openam.auth.zero.page.login.allow.null.referer</code>
      </p></dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="auth-core-post-auth"></a>2.3.5.7.&nbsp;Core - Post Authentication Processing</h4></div></div></div><a class="indexterm" name="d16037e3171"></a><a class="indexterm" name="d16037e3178"></a><p>This section of the Core Authentication module
              specifies options for post authentication processing.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Default Success Login URL</span></dt><dd><p>Accepts a list of values that specifies where users are directed
      after successful authentication. The format of this attribute is
      <code class="literal"><em class="replaceable"><code>client-type</code></em>|<em class="replaceable"><code>URL</code></em></code>
      although the only value you can specify at this time is a URL
      which assumes the type HTML. The default value is
      <code class="literal">/openam/console</code>. Values that do not specify HTTP have
      that appended to the deployment URI.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-login-success-url</code></p></dd><dt><span class="term">Default Failure Login URL</span></dt><dd><p>Accepts a list of values that specifies where users are directed
      after authentication has failed. The format of this attribute is
      <code class="literal"><em class="replaceable"><code>client-type</code></em>|<em class="replaceable"><code>URL</code></em></code>
      although the only value you can specify at this time is a URL
      which assumes the type HTML. Values that do not specify HTTP have
      that appended to the deployment URI.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-login-failure-url</code></p></dd><dt><span class="term">Authentication Post Processing Classes</span></dt><dd><p>Specifies one or more Java classes used to customize post
      authentication processes for successful or unsuccessful logins.
      The Java class must implement the
      <code class="literal">com.sun.identity.authentication.spi.AMPostAuthProcessInterface</code>
      OpenAM interface.</p><p>A .jar containing the post processing class belongs in
      the <code class="filename">WEB-INF/lib</code> directory of the deployed OpenAM
      instance. If you do not build a .jar, add the class files under
      <code class="filename">WEB-INF/classes</code>. For deployment, add the .jar or
      classes into a custom OpenAM .war file.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-post-login-process-class</code></p></dd><dt><span class="term">Generate UserID Mode</span></dt><dd><p>When enabled, the Membership module generates a list of alternate
      user identifiers if the one entered by a user during the
      self-registration process is not valid or already exists. The user
      identifiers are generated by the class specified in the Pluggable User
      Name Generator Class property.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-username-generator-enabled</code></p></dd><dt><span class="term">Pluggable User Name Generator Class</span></dt><dd><p>Specifies the name of the class used to generate alternate user
      identifiers when Generate UserID Mode is enabled. The default value is
      <code class="literal">com.sun.identity.authentication.spi.DefaultUserIDGenerator</code>.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-username-generator-class</code></p></dd><dt><span class="term">User Attribute Mapping to Session Attribute</span></dt><dd><p>Enables the authenticating user's identity attributes (stored in
      the identity repository) to be set as session properties in the user's
      SSOToken. The value takes the format
      <code class="literal"><em class="replaceable"><code>User-Profile-Attribute</code></em>|<em class="replaceable"><code>Session-Attribute-Name</code></em></code>.
      If <em class="replaceable"><code>Session-Attribute-Name</code></em> is not specified,
      the value of <em class="replaceable"><code>User-Profile-Attribute</code></em> is used.
      All session attributes contain the <code class="literal">am.protected</code> prefix
      to ensure that they cannot be edited by the Client SDK.</p><p>For example, if you define the user profile attribute as mail and
      the user's email address (available in the user session) as
      <code class="literal">user.mail</code>, the entry for this attribute would be
      <code class="literal">mail|user.mail</code>. After a successful authentication,
      the <code class="literal">SSOToken.getProperty(String)</code> method is used to
      retrieve the user profile attribute set in the session. The user's email
      address is retrieved from the user's session using the
      <code class="literal">SSOToken.getProperty("am.protected.user.mail")</code> method
      call.</p><p>Properties that are set in the user session using User Attribute
      Mapping to Session Attributes can not be modified (for example,
      <code class="literal">SSOToken.setProperty(String, String)</code>). This results in
      an <code class="literal">SSOException</code>. Multi-value attributes, such as
      <code class="literal">memberOf</code>, are listed as a single session variable
      with a <code class="literal">|</code> separator.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">sunAMUserAttributesSessionMapping</code></p></dd></dl></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="datastore-module-conf-hints"></a>2.3.6.&nbsp;Hints for the Data Store Authentication Module</h3></div></div></div><a class="indexterm" name="d16037e3336"></a><a class="indexterm" name="d16037e3341"></a><p>The Data Store authentication module allows a login using the Identity
   Repository of the realm to authenticate users. Using the Data Store module
   removes the requirement to write an authentication plug-in module, load,
   and then configure the authentication module if you need to authenticate
   against the same data store repository. Additionally, you do not need to
   write a custom authentication module where flat-file authentication is
   needed for the corresponding repository in that realm.</p><p>Yet, the Data Store module is generic. It does not implement data
   store-specific capabilities such as the password policy and password reset
   features provided by LDAP modules. Therefore the Data Store module returns
   failure when such capabilities are invoked.</p><a class="indexterm" name="d16037e3348"></a><p><span class="command"><strong>ssoadm</strong></span> service name:
   <code class="literal">sunAMAuthDataStoreService</code></p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Authentication Level</span></dt><dd><p>Sets the authentication level used to indicate the level of security
      associated with the module. The value can range from 0 to any positive integer.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">sunAMAuthDataStoreAuthLevel</code></p></dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="device-id-match-hints"></a>2.3.7.&nbsp;Hints for the Device ID (Match) Authentication Module</h3></div></div></div><a class="indexterm" name="idx-auth-hints-deviceid-match"></a><a class="indexterm" name="d16037e3380"></a><p>The Device ID (Match) module provides device fingerprinting functionality
    for risk-based authentication. The Device ID (Match) works together with other
    modules, for example, the DataStore, HMAC One-Time Password (HOTP), and
    Device ID (Save) modules in an authentication chain.
   </p><p>
    The Device ID (Match) module collects the unique characteristics of a remote user's computing device
    and compares them to characteristics on a saved device profile.
    The module computes any variances between the collected characteristics
    to those stored on the saved device profile and assigns penalty points for
    each difference.
   </p><p>
    For example, when a user who typically logs on to the Internet
    on a FireFox browser, logs on using Chrome, the Device ID (Match) module notes the
    difference and assigns penalty points to this change in behavior. If
    the module detects additional differences in behavior, such as browser fonts,
    geolocation, etc., then additional points are assessed and calculated. If the
    total maximum number of penalty points exceeds a pre-configured threshold value,
    the Device ID (Match) module fails and control is determined by how you
    configured your authentication chain. For example, if you include the
    HMAC One-Time Password (HOTP) module in your authentication chain
    and if the Device ID (Match) module fails after the maximum number of penalty
    points have been exceeded, then the authentication chain issues a HOTP request to the user,
    requiring the user to identify himself using two-factor authentication.
   </p><p>
    Typically, you configure and gather the following device print items:
   </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>User agents, associated with the configuration of a web browser</p></li><li class="listitem"><p>Installed fonts</p></li><li class="listitem"><p>The plugins installed for the web browser</p></li><li class="listitem"><p>The resolution and color depth associated with a display</p></li><li class="listitem"><p>The timezone or even the geolocation of a device</p></li></ul></div><p>The Device ID (Match) module comes out of the box with default
    client-side and server-side JavaScript code, supplying
    the logic necessary to fingerprint the user agent and computer.
    Scripting allows you to customize the code, providing more control over the
    device fingerprint elements that you would like to collect.
    OpenAM supports both the JavaScript (default) and Groovy languages.
    The client-side code must be in JavaScript. The server-side script can be
    written in JavaScript or Groovy.
   </p><div class="important"><h3 class="title">Important</h3><p>
     By default, the maximum penalty points is set to 0, which you can adjust in
     the server-side script.
    </p></div><p>
    To access the Device ID (Match) module page on the
    console, click Configuration &gt; Device Id (Match).
   </p><div class="figure"><a name="figure-device-id-match"></a><div class="figure-title">Figure&nbsp;2.5.&nbsp;Device ID (Match) Module</div><div class="figure-contents"><div class="mediaobject" align="center"><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/device-id-match.png" align="middle" height="360" alt="Device ID (Match)"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="ld-d16037e3417.html" target="longdesc">D</a>]</span></div></div></div></div><br class="figure-break"><div class="caution"><h3 class="title">Caution</h3><p>The Device ID (Match) module's default JavaScript
    client-side and server-side scripts are fully functional.
    If you change the client-side script, you must also
    make a corresponding change to the server-side script.
    For a safer option if you want to change the behavior of the module,
    you can copy the scripts to a custom scripted module, and edit the code to
    make your own customized version.
   </p></div><p>The Device ID (Match) does not stand on its own within an authentication
    chain and requires additional modules. For example, you can have any
    module that identifies the user (for example, DataStore, Active Directory or others),
    Device ID (Match), any module that provides two-factor authentication,
    (for example, HOTP or SecurID), and Device ID (Save) within your authentication
    chain.</p><p>
    As an example, you can configure the following modules with the
    specified criteria:
   </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p><span class="bold"><strong>DataStore - Requisite</strong></span>.
      The Device ID (Match) module requires user authentication information to
      validate the username. You can also use other modules that identify
      the username, such as Active Directory, RADIUS, or Windows NT.
     </p></li><li class="listitem"><p><span class="bold"><strong>Device ID (Match) - Sufficient</strong></span>.
      The Device ID (Match) runs the client-side script, which invokes the
      device fingerprint collectors, captures the data, and converts it into a
      JSON string. It then auto-submits the data in a JSP page to the server-side
      scripting engine.</p><p>
      The server-side script calculates the penalty points based
      on differences between the client device and stored device profile, and
      determines if the client device successfully "matches" the stored profile.
      If a match is successful, OpenAM determines that the client's device has the
      required attributes for a successful authentication.</p><p>
      If the device does not have a match, then the module fails and falls through
      to the HMAC One-Time Password (HOTP) module for further processing.
     </p></li><li class="listitem"><p><span class="bold"><strong>HMAC One-Time Password (HOTP) - Requisite</strong></span>.
      If the user's device does not match a stored profile,
      OpenAM presents the user with a HMAC One-Time Password (HOTP) screen either
      by SMS or email, prompting the user to enter a password.
     </p><p>
      You can also use any other module that provides two-factor authentication.
     </p><p>
      After the HOTP has successfully validated the user, the Device ID (Save)
      module gathers additional data from the user.
      For specific information about the HOTP module, see
      <a class="xref" href="#hotp-module-conf-hints" title="2.3.10.&nbsp;Hints for the HOTP Authentication Module">Section&nbsp;2.3.10, &#8220;Hints for the HOTP Authentication Module&#8221;</a>.
     </p></li><li class="listitem"><p><span class="bold"><strong>Device ID (Save) - Required</strong></span>.
      The Device ID (Save) module provides configuration options to enable
      an auto-save feature on the device profile as well as set a maximum number
      of stored device profiles on the user entry or record.
      Once the maximum number of stored device profiles is reached, OpenAM
      deletes the old data from the user record as new ones are added.
      User records could thus contain both old and new device profiles.
     </p><p>
      If the auto-save feature is not enabled, OpenAM presents the user with a
      screen to save the new device profile.
     </p><p>
      The module also takes the device print and creates a JSON object that includes the ID,
      name, last selected date, selection counter, and device print.
      For specific information about the Device ID (Save) module, see
      <a class="xref" href="#device-id-save-hints" title="2.3.8.&nbsp;Hints for the Device ID (Save) Module">Section&nbsp;2.3.8, &#8220;Hints for the Device ID (Save) Module&#8221;</a>.
     </p><div class="note"><h3 class="title">Note</h3><p>If a user has multiple device profiles, the profile that is the closest
       match to the current client details is used for the comparison result.
      </p></div></li></ol></div><p>You can create modules instances for a particular realm by clicking Access Control
    &gt; <em class="replaceable"><code>Realm Name</code></em> &gt; Authentication, and then
    click New under Module Instances to add Device Id (Match) and Device Id (Save).
   </p><p>Under Authentication Chaining, click New to create a new chain, and then enter
    a name for the chain. On the <em class="replaceable"><code>Chain Name</code></em> - Properties
    page, click Add to set up the modules for your authentication chain.
   </p><div class="figure"><a name="figure-device-id-auth-chain"></a><div class="figure-title">Figure&nbsp;2.6.&nbsp;Authentication Chain with Device ID (Match) and Device ID (Save)</div><div class="figure-contents"><div class="mediaobject" align="center"><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/device-id-auth-chain.png" align="middle" height="360" alt="Device ID (Match) and Device ID (Save)"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="ld-d16037e3485.html" target="longdesc">D</a>]</span></div></div></div></div><br class="figure-break"><p>The Device ID (Match) module has the following properties:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Client-side Script Enabled</span></dt><dd><p>Enable Device ID (Match) to send JavaScript in an authentication page
      to the device to collect data about the device by a self-submitting form.
      </p><p><span class="command"><strong>ssoadm</strong></span> attribute:
       <code class="literal">iplanet-am-auth-scripted-client-script-enabled</code></p></dd><dt><span class="term">Client-side Script</span></dt><dd><p>You can see default client-side JavaScript code that you can modify
       if necessary. Note that if you change the client-side script, you must make
       a corresponding change in the server-side script to account for the
       specific addition or removal of an element.
      </p><p><span class="command"><strong>ssoadm</strong></span> attribute:
       <code class="literal">iplanet-am-auth-scripted-client-script</code></p></dd><dt><span class="term">Server-side Script Language</span></dt><dd><p>Default: JavaScript. Select Groovy if your script is written in that
       language.
      </p><p><span class="command"><strong>ssoadm</strong></span> attribute:
       <code class="literal">iplanet-am-auth-scripted-script-type</code></p></dd><dt><span class="term">Server-side Script</span></dt><dd><p>You can see default server-side JavaScript code that you can modify
       if necessary. Note that a change in the client-side script requires a
       corresponding change in the server-side script to account for the specific
       addition or removal of an element.
      </p><p><span class="command"><strong>ssoadm</strong></span> attribute:
       <code class="literal">iplanet-am-auth-scripted-server-script</code></p></dd><dt><span class="term">Authentication Level</span></dt><dd><p>Sets the authentication level used to indicate the level of security
       associated with the module. The value can range from 0 to any positive integer.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
       <code class="literal">iplanet-am-auth-scripted-auth-level</code></p></dd></dl></div><p>
    When the user logs on to the console, OpenAM determines if the user's device
    differs from that of the stored profile.
    If the differences exceed the maximum number of penalty points,
    OpenAM sends an "Enter OTP" page, requiring the
    user to enter a one-time password, which is sent to the user via email or SMS.
    The user also has the option to request a one-time password.
   </p><p>Next, OpenAM presents the user with a "Add to Trusted Devices?" page,
    asking if the user wants to add the device to the list of trusted device profiles.
    If the user clicks "Yes", OpenAM prompts the user to enter a descriptive name
    for the trusted device.
   </p><p>Next, OpenAM presents the user with the User Profile page, where the
    user can click the Dashboard link in the upper left corner to access the My
    Applications and Trusted Devices page. Once on the Dashboard, the user can
    view the list of trusted devices or remove the device by clicking the
    Delete Device link.
   </p><div class="figure"><a name="figure-trusted-device-mgmt"></a><div class="figure-title">Figure&nbsp;2.7.&nbsp;Trusted Device Management on the User Profile Page</div><div class="figure-contents"><div class="mediaobject" align="center"><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/trusted-device-mgmt.png" align="middle" height="360" alt="Trusted Device Management"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="ld-d16037e3565.html" target="longdesc">D</a>]</span></div></div></div></div><br class="figure-break"><a class="indexterm" name="d16037e3573"></a></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="device-id-save-hints"></a>2.3.8.&nbsp;Hints for the Device ID (Save) Module</h3></div></div></div><a class="indexterm" name="d16037e3581"></a><a class="indexterm" name="d16037e3586"></a><p>The Device ID (Save) module auto-saves the device
    profile rather than presenting a Save screen to the user each time a device
    profile requires update. The module also provides a configuration setting for
    the maximum number of stored profiles on the user record.
   </p><div class="note"><h3 class="title">Note</h3><p>If a user has multiple device profiles, the profile that is the closest
     match to the current client details is used for the comparison result.
    </p></div><p>
    Within its configured authentication chain, the Device ID (Save) module also
    takes the device print and creates a JSON object that consists of the ID,
    name, last selected date, selection counter, and device print itself.
   </p><p>The Device ID (Save) module has the following properties:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Automatically store new profiles</span></dt><dd><p>Select the checkbox to automatically store new profiles.
       After successful HMAC one-time password (HOTP) confirmation,
       OpenAM stores the new profile automatically.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
       <code class="literal">iplanet-am-auth-device-id-save-auto-store-profile</code></p></dd><dt><span class="term">Maximum stored profile quantity</span></dt><dd><p>Sets the maximum number of stored profiles on the user's record.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
       <code class="literal">iplanet-am-auth-device-id-save-max-profiles-allowed</code></p></dd><dt><span class="term">Authentication Level</span></dt><dd><p>Sets the authentication level used to indicate the level of security
       associated with the module. The value can range from 0 to any positive integer.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
       <code class="literal">iplanet-am-auth-device-id-save-auth-level</code></p></dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="federation-module-conf-hints"></a>2.3.9.&nbsp;Hints for the Federation Authentication Module</h3></div></div></div><a class="indexterm" name="d16037e3638"></a><a class="indexterm" name="d16037e3643"></a><p>The Federation authentication module is used by a service provider
   to create a user session after validating single sign-on protocol messages.
   This authentication module is used by the SAML, SAMLv2, ID-FF, and
   WS-Federation protocols.</p><p><span class="command"><strong>ssoadm</strong></span> service name:
   <code class="literal">sunAMAuthFederationService</code></p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Authentication Level</span></dt><dd><p>Sets the authentication level used to indicate the level of security
      associated with the module. The value can range from 0 to any positive integer.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">sunAMAuthFederationAuthLevel</code></p></dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="hotp-module-conf-hints"></a>2.3.10.&nbsp;Hints for the HOTP Authentication Module</h3></div></div></div><a class="indexterm" name="idx-auth-hints-hotp"></a><a class="indexterm" name="d16037e3675"></a><p>The HMAC One-Time Password authentication module works together in an
    authentication chain with any module that stores the <code class="literal">username</code>
    attribute.
    The module uses the <code class="literal">username</code> from the <code class="literal">sharedState</code>
    set by the previous module in the chain and retrieves the user's email address
    or telephone number to send a one-time password to the user. The user then
    enters the password on a Login page and completes the authentication process if
    successful.
   </p><p>
    For example, to set up HOTP in an authentication chain, you can configure
    the Data Store module (or any module that stores the user's
    <code class="literal">username</code>) as the <code class="literal">requisite</code> first module,
    and the HOTP module as the second <code class="literal">requisite</code> module.
    When authentication succeeds against the Data Store module, the HOTP module
    retrieves the Email Address and Telephone Number attributes from the data store
    based on the <code class="literal">username</code> value.
    For the HOTP module to use either attribute, the Email Address must contain
    a valid email address, or the Telephone Number must contain a valid
    SMS telephone number.
   </p><p>
    You can set the HOTP module to automatically generate a password when
    users begin logging into the system. You can also setup mobile phone,
    mobile carrier, and email attributes for tighter controls over where
    the messages are generated and what provider the messages go through to
    reach the user.
   </p><p><span class="command"><strong>ssoadm</strong></span> service name:
   <code class="literal">sunAMAuthHOTPService</code></p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Authentication Level</span></dt><dd><p>Sets the authentication level used to indicate the level of security
      associated with the module. The value can range from 0 to any positive integer.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">sunAMAuthHOTPAuthLevel</code></p></dd><dt><span class="term">SMS Gateway Implementation Class</span></dt><dd><p>Change this if you must customize the SMS gateway implementation.
      The default class sends an SMS or email, depending on the
      configuration.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">sunAMAuthHOTPSMSGatewayImplClassName</code></p></dd><dt><span class="term">Mail Server Host Name</span></dt><dd><p>Host name of the mail server supporting Simple Message Transfer
      Protocol for electronic mail.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">sunAMAuthHOTPSMTPHostName</code></p></dd><dt><span class="term">Mail Server Host Port</span></dt><dd><p>The default outgoing mail server port is 25, 465 (when connecting over SSL).</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">sunAMAuthHOTPSMTPHostPort</code></p></dd><dt><span class="term">Mail Server Authentication Username</span></dt><dd><p>User name for OpenAM to connect to the mail server.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">sunAMAuthHOTPSMTPUserName</code></p></dd><dt><span class="term">Mail Server Authentication Password</span></dt><dd><p>Password for OpenAM to connect to the mail server.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">sunAMAuthHOTPSMTPUserPassword</code></p></dd><dt><span class="term">Mail Server Secure Connection</span></dt><dd><p>If OpenAM connects to the mail server securely, OpenAM must be able
      to trust the server certificate.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">sunAMAuthHOTPSMTPSSLEnabled</code></p></dd><dt><span class="term">Email From Address</span></dt><dd><p>The <code class="literal">From:</code> address when sending a one-time
      password by mail.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">sunAMAuthHOTPSMTPFromAddress</code></p></dd><dt><span class="term">One Time Password Validity Length (in minutes)</span></dt><dd><p>One-time passwords are valid for 5 minutes after they are generated
      by default.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">sunAMAuthHOTPPasswordValidityDuration</code></p></dd><dt><span class="term">One Time Password Length (in digits)</span></dt><dd><p>Set the length of the one-time password to 6 or 8 digits.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">sunAMAuthHOTPPasswordLength</code></p></dd><dt><span class="term">One Time Password Delivery</span></dt><dd><p>Send the one-time password by SMS, by mail, or both.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">sunAMAuthHOTPasswordDelivery</code></p></dd><dt><span class="term">Mobile Phone Number Attribute Names</span></dt><dd><p>Provides the attribute name used for the text message. The 
      default value is <code class="literal">telephoneNumber</code>.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openamTelephoneAttribute</code></p></dd><dt><span class="term">Mobile Carrier Attribute Name</span></dt><dd><p>Provides the name of the carrier that will send the text
      message.</p><p>Every carrier has their own attribute name ending, for example Verizon
      uses @vtext.com or vtext.com. Contact your mobile carrier to find out what their 
      attribute name is. If you will be sending international texts, ask your carrier 
      if a country code is a required.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openamSMSCarrierAttribute</code></p></dd><dt><span class="term">Email Attribute Name</span></dt><dd><p>Provides the attribute name used to email the OTP. The
      default value is <code class="literal">mail</code> (email).</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openamEmailAttribute</code></p></dd><dt><span class="term">Auto Send OTP Code</span></dt><dd><p>Setup the HOTP module to automatically generate an email
      or text message when users begin the login process. </p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">sunAMAuthHOTPAutoClicking</code></p></dd></dl></div><a class="indexterm" name="d16037e3903"></a></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="http-module-conf-hints"></a>2.3.11.&nbsp;Hints for the HTTP Basic Authentication Module</h3></div></div></div><a class="indexterm" name="d16037e3911"></a><p>HTTP basic authentication takes a user name and password from HTTP
   authentication and tries authentication against the backend module in OpenAM,
   depending on what you configure as the Backend Module Name.</p><p><span class="command"><strong>ssoadm</strong></span> service name:
   <code class="literal">iPlanetAMAuthHTTPBasicService</code></p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Backend Module Name</span></dt><dd><p>Specifies the module that checks the user credentials. The credentials are
      then supplied to either a Data Store or other identity repository module for authentication.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-http-basic-module-configured</code></p></dd><dt><span class="term">Authentication Level</span></dt><dd><p>Sets the authentication level used to indicate the level of security
      associated with the module. The value can range from 0 to any positive integer.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-httpbasic-auth-level</code></p></dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="jdbc-module-conf-hints"></a>2.3.12.&nbsp;Hints for the JDBC Authentication Module</h3></div></div></div><a class="indexterm" name="d16037e3952"></a><a class="indexterm" name="d16037e3957"></a><p>The Java Database Connectivity (JDBC) module lets OpenAM connect to
   a database such as MySQL or Oracle DB to authenticate users.</p><p><span class="command"><strong>ssoadm</strong></span> service name:
   <code class="literal">sunAMAuthJDBCService</code></p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Connection Type</span></dt><dd><p>Choose Connection pool is retrieved via JNDI to connect using the
      Java Naming and Directory Interface connection pool supported by the web
      container in which OpenAM runs. Choose Non-persistent JDBC connection to
      connect directly through the JDBC driver.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">sunAMAuthJDBCConnectionType</code></p></dd><dt><span class="term">Connection Pool JNDI Name</span></dt><dd><p>When using Connection pool is retrieved via JNDI, this specifies
      the pool. How you configure connection pooling depends on the web
      container where you run OpenAM. Refer to the documentation for your
      web container for instructions on setting up connection pooling.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">sunAMAuthJDBCJndiName</code></p></dd><dt><span class="term">JDBC Driver</span></dt><dd><p>When using Non-persistent JDBC connection, this specifies the JDBC
      driver provided by the database.</p><p>The .jar containing the JDBC driver belongs in the
      <code class="filename">WEB-INF/lib</code> directory of the deployed OpenAM
      instance, and so you should add it to a custom OpenAM .war file that you
      deploy.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">sunAMAuthJDBCDriver</code></p></dd><dt><span class="term">JDBC URL</span></dt><dd><p>When using Non-persistent JDBC connection, this specifies the URL
      to connect to the database.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">sunAMAuthJDBCUrl</code></p></dd><dt><span class="term">Database Username</span></dt><dd><p>Specify the user name to open the database connection.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">sunAMAuthJDBCDbuser</code></p></dd><dt><span class="term">Database Password</span></dt><dd><p>Specify the password for the user opening the database connection.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">sunAMAuthJDBCDbpassword</code></p></dd><dt><span class="term">Password Column Name</span></dt><dd><p>Specify the database column name where passwords are stored.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">sunAMAuthJDBCPasswordColumn</code></p></dd><dt><span class="term">Prepared Statement</span></dt><dd><p>Specify the SQL query to return the password corresponding to the
      user to authenticate.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">sunAMAuthJDBCStatement</code></p></dd><dt><span class="term">Class to Transform Password Syntax</span></dt><dd><p>Specify the class that transforms the password retrieved to the
      same format as provided by the user.</p><p>The default class expects the password in clear text. Custom
      classes must implement the
      <code class="literal">JDBCPasswordSyntaxTransform</code> interface.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">sunAMAuthJDBCPasswordSyntaxTransformPlugin</code></p></dd><dt><span class="term">Authentication Level</span></dt><dd><p>Sets the authentication level used to indicate the level of security
      associated with the module. The value can range from 0 to any positive integer.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sunAMAuthJDBCAuthLevel</code></p></dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="ldap-module-conf-hints"></a>2.3.13.&nbsp;Hints for the LDAP Authentication Module</h3></div></div></div><a class="indexterm" name="idx-auth-hints-ldap"></a><a class="indexterm" name="d16037e4107"></a><p>OpenAM connects to directory servers using Lightweight Directory
   Access Protocol (LDAP). To build an easy-to-manage, high performance, pure
   Java, open source directory service, try
   <a class="link" href="http://opendj.org" target="_top">OpenDJ</a> directory services.</p><p><span class="command"><strong>ssoadm</strong></span> service name:
   <code class="literal">iPlanetAMAuthLDAPService</code></p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Primary LDAP Server, </span><span class="term">Secondary LDAP Server</span></dt><dd><p>Directory servers generally use built-in data replication for high
      availability. Thus a directory service likely consists of a pool of
      replicas to which OpenAM can connect to retrieve and update directory
      data. You set up primary and secondary servers in case a replica is down
      due to maintenance or to a problem with a particular server.</p><p>Set one primary and optionally one secondary directory server for
      each OpenAM server. For the current OpenAM server, specify each directory
      server as a
      <code class="literal"><em class="replaceable"><code>host</code></em>:<em class="replaceable"><code>port</code></em></code>
      combination. For other OpenAM servers in the deployment, you can specify
      each directory server as
<code class="literal"><em class="replaceable"><code>server-name</code></em>|<em class="replaceable"><code>host</code></em>:<em class="replaceable"><code>port</code></em></code>,
      where <em class="replaceable"><code>server-name</code></em> is the FQDN portion of the
      OpenAM server from the list under Configuration &gt; Servers and
      Sites, and <em class="replaceable"><code>host</code></em>:<em class="replaceable"><code>port</code></em>
      identifies the directory server.</p><p>For example, if the <em class="replaceable"><code>server-name</code></em>
      that is listed is <code class="literal">http://openam.example.com:8080/openam</code>
      and the directory server is accessible at <code class="literal">opendj.example.com:1389</code>,
      you would enter <code class="literal">openam.example.com|opendj.example.com:1389</code>.</p><p>When authenticating users from a directory service that is remote
      from OpenAM, set both the primary and secondary server values.</p><p>If you want to use SSL or TLS for security, then scroll down to
      enable SSL/TLS Access to LDAP Server. Make sure that OpenAM
      can trust the servers' certificates when using this option.</p><p><span class="command"><strong>ssoadm</strong></span> attributes:
      primary is <code class="literal">iplanet-am-auth-ldap-server</code>,
      secondary is <code class="literal">iplanet-am-auth-ldap-server2</code>, and
      <code class="literal">iplanet-am-auth-ldap-ssl-enabled</code></p></dd><dt><span class="term">DN to Start User Search</span></dt><dd><p>LDAP data is organized hierarchically, a bit like a file system
      on Windows or UNIX. More specific DNs likely result in better search
      performance. When configuring the module for a particular part of the
      organization, you can perhaps start searches from a specific
      organizational unit such as
      <code class="literal">ou=sales,dc=example,dc=com</code>.</p><p>If multiple entries exist with identical search attribute values,
      make this value specific enough to return only one entry.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal"> iplanet-am-auth-ldap-base-dn</code></p></dd><dt><span class="term">Bind User DN, Bind User Password</span></dt><dd><p>If OpenAM stores attributes in the directory, for example to
      manage account lockout, or if the directory requires that OpenAM
      authenticate in order to read users' attributes, then OpenAM needs the
      DN and password to authenticate to the directory.</p><p>The default is <code class="literal">cn=Directory Manager</code>. Make sure
      that password is correct before you logout. If it is incorrect, you will
      be locked out. If this should occur, you can login with the super user DN,
      which by default is
      <code class="literal">uid=amAdmin,ou=People,<em class="replaceable"><code>OpenAM-deploy-base</code></em></code>,
      where <em class="replaceable"><code>OpenAM-deploy-base</code></em> you set during
      OpenAM configuration.</p><p><span class="command"><strong>ssoadm</strong></span> attributes:
      <code class="literal">iplanet-am-auth-ldap-bind-dn</code>,
      <code class="literal">iplanet-am-auth-ldap-bind-passwd</code></p></dd><dt><span class="term">Attributes Used to Retrieve User Profile, </span><span class="term">Attributes Used to Search for a User to be Authenticated, </span><span class="term">User Search Filter, </span><span class="term">Search Scope</span></dt><dd><p>LDAP searches for user entries return entries with attribute
      values matching the filter you provide. For example if you search under
      <code class="literal">ou=people,dc=example,dc=com</code> with a filter
      <code class="literal">"(mail=bjensen@example.com)"</code>, then the directory
      returns the entry that has <code class="literal">mail=bjensen@example.com</code>.
      In this example the attribute used to search for a user is
      <code class="literal">mail</code>. Multiple attribute values mean the user can
      authenticate with any one of the values. For example, if you have
      both <code class="literal">uid</code> and <code class="literal">mail</code>, then Barbara
      Jensen can authenticate with either <code class="literal">bjensen</code> or
      <code class="literal">bjensen@example.com</code>.</p><p>Should you require a more complex filter for performance, you
      add that to the User Search Filter text box. For example, if you search
      on <code class="literal">mail</code> and add User Search Filter
      <code class="literal">(objectClass=inetOrgPerson)</code>, then OpenAM uses the
      resulting search filter
      <code class="literal">(&amp;(mail=<em class="replaceable"><code>address</code></em>)(objectClass=inetOrgPerson))</code>,
      where <em class="replaceable"><code>address</code></em> is the mail address provided
      by the user.</p><p>Scope OBJECT means search only the entry specified as the DN to
      Start User Search, whereas ONELEVEL means search only the entries
      that are directly children of that object. SUBTREE means search the
      entry specified and every entry under it.</p><p><span class="command"><strong>ssoadm</strong></span> attributes:
      <code class="literal">iplanet-am-auth-ldap-user-naming-attribute</code>,
      <code class="literal">iplanet-am-auth-ldap-user-search-attributes</code>,
      <code class="literal">iplanet-am-auth-ldap-search-filter</code>, and
      <code class="literal">iplanet-am-auth-ldap-search-scope</code></p></dd><dt><span class="term">SSL/TLS Access to LDAP Server</span></dt><dd><p>If you enable SSL/TLS, OpenAM must be able to trust LDAP certificates, either because the certificates were
      signed by a CA whose certificate is already included in the trust store
      used by the container where OpenAM runs, or because you imported the
      certificates into the trust store.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-ldap-ssl-enabled</code></p></dd><dt><span class="term">Return User DN to Authenticate</span></dt><dd><p>When enabled, and OpenAM uses the directory service as the user
      store, the module returns the DN rather than the rather than the User ID,
      so the bind for authentication can be completed without a search to
      retrieve the DN.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-ldap-return-user-dn</code></p></dd><dt><span class="term">User Creation Attributes</span></dt><dd><p>
       This list lets you map (external) attribute names
       from the LDAP directory server
       to (internal) attribute names used by OpenAM.
      </p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-ldap-user-creation-attr-list</code></p></dd><dt><span class="term">Minimum Password Length</span></dt><dd><p>Specify the minimum acceptable password length.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-ldap-min-password-length</code></p></dd><dt><span class="term">LDAP Behera Password Policy Support</span></dt><dd><p>When enabled, support interoperability with servers that implement
      the Internet-Draft, <a class="link" href="http://tools.ietf.org/html/draft-behera-ldap-password-policy-09" target="_top">Password Policy for LDAP Directories</a>.</p><p>Support for this Internet-Draft is limited to the LDAP
      authentication module. Other components of OpenAM, such as the password
      change functionality in the <code class="literal">/idm/EndUser</code> page, do
      not support the Internet-Draft. In general, outside of the LDAP
      authentication module, OpenAM binds to the directory server as an
      administrator, such as Directory Manager. When OpenAM binds to the
      directory server as an administrator rather than as an end user, many
      features of the Internet-Draft password policies do not apply.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-ldap-behera-password-policy-enabled</code></p></dd><dt><span class="term">Trust All Server Certificates</span></dt><dd><p>When enabled, blindly trust server certificates, including
      self-signed test certificates.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-ldap-ssl-trust-all</code></p></dd><dt><span class="term">LDAP Connection Heartbeat Interval</span></dt><dd><p>Specifies how often OpenAM should send a heartbeat request to the
      directory server to ensure that the connection does not remain idle. Some
      network administrators configure firewalls and load balancers to drop
      connections that are idle for too long. You can turn this off by setting
      the value to 0 or to a negative number. To set the units for the interval
      use LDAP Connection Heartbeat Time Unit.</p><p>Default: 1</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openam-auth-ldap-heartbeat-interval</code></p></dd><dt><span class="term">LDAP Connection Heartbeat Time Unit</span></dt><dd><p>Specifies the time unit corresponding to LDAP Connection Heartbeat
      Interval.</p><p>Default: minute</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openam-auth-ldap-heartbeat-interval</code></p></dd><dt><span class="term">Authentication Level</span></dt><dd><p>Sets the authentication level used to indicate the level of security
      associated with the module. The value can range from 0 to any positive integer.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">iplanet-am-auth-ldap-auth-level</code></p></dd></dl></div><a class="indexterm" name="d16037e4424"></a></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="msisdn-module-conf-hints"></a>2.3.14.&nbsp;Hints for the MSISDN Authentication Module</h3></div></div></div><a class="indexterm" name="idx-auth-hints-msisdn"></a><a class="indexterm" name="d16037e4438"></a><p>The Mobile Station Integrated Services Digital Network (MSISDN)
   authentication module enables non-interactive authentication using a mobile
   subscriber ISDN associated with a terminal such as a mobile phone.
   The module checks the subscriber ISDN against the value found on a user's
   entry in an LDAP directory service.</p><p><span class="command"><strong>ssoadm</strong></span> service name:
   <code class="literal">sunAMAuthMSISDNService</code></p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Trusted Gateway IP Address</span></dt><dd><p>Specifies a list of IP addresses of trusted clients that can access
      MSISDN modules. Either restrict the clients allowed to access the MSISDN
      module by adding each IPv4 or IPv6 address here, or leave the list empty to allow
      all clients to access the module. If you specify the value
      <code class="literal">none</code>, no clients are allowed access.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">sunAMAuthMSISDNTrustedGatewayList</code></p></dd><dt><span class="term">MSISDN Number Search Parameter Name</span></dt><dd><p>Specifies a list of parameter names that identify which parameters
      to search in the request header or cookie header for the MSISDN number.
      For example, if you define x-Cookie-Param, AM_NUMBER, and COOKIE-ID,
      the MSISDN authentication service checks those parameters for the
      MSISDN number.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">sunAMAuthMSISDNParameterNameList</code></p></dd><dt><span class="term">LDAP Server and Port</span></dt><dd><p>If you want to use SSL or TLS for security, then scroll down to
      enable SSL/TLS Access to LDAP. Make sure that OpenAM can trust the
      servers' certificates when using this option.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">sunAMAuthMSISDNLdapProviderUrl</code></p></dd><dt><span class="term">LDAP Start Search DN</span></dt><dd><p>Specify the DN of the entry where the search for the user's MSISDN
      number should start.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">sunAMAuthMSISDNBaseDn</code></p></dd><dt><span class="term">Attribute To Use To Search LDAP</span></dt><dd><p>Specify the name of the attribute in the user's profile that
      contains the MSISDN number to search for the user. The default is
      <code class="literal">sunIdentityMSISDNNumber</code>.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">sunAMAuthMSISDNUserSearchAttribute</code></p></dd><dt><span class="term">LDAP Server Authentication User</span></dt><dd><p>If OpenAM must authenticate to the directory server in order to
      search, then specify the bind DN. The default is
      <code class="literal">cn=amldapuser,ou=DSAME Users,dc=example,dc=com</code>.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">sunAMAuthMSISDNPrincipalUser</code></p></dd><dt><span class="term">LDAP Server Authentication Password</span></dt><dd><p>Specify the password corresponding to the bind DN.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">sunAMAuthMSISDNPrincipalPasswd</code></p></dd><dt><span class="term">SSL/TLS for LDAP Access</span></dt><dd><p>If you choose to enable SSL or TLS, then make sure that
      OpenAM can trust the servers' certificates.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">sunAMAuthMSISDNUseSsl</code></p></dd><dt><span class="term">MSISDN Header Search Attribute</span></dt><dd><p>Specify the headers to use for searching the request for the
      MSISDN number.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Cookie Header tells OpenAM to search the cookie.</p></li><li class="listitem"><p>Request Header tells OpenAM to search the request header.</p></li><li class="listitem"><p>Request Parameter tells OpenAM to search the request parameters.</p></li></ul></div><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">sunAMAuthMSISDNHeaderSearch</code></p></dd><dt><span class="term">LDAP Attribute Used to Retrieve User Profile</span></dt><dd><p>Specify the LDAP attribute that is used during a search to return
      the user profile for MSISDN authentication service. The default is
      <code class="literal">uid</code>.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">sunAMAuthMSISDNUserNamingAttribute</code></p></dd><dt><span class="term">Return User DN to DataStore</span></dt><dd><p>Enable this option only when the OpenAM directory is the same as
      the directory configured for MSISDN searches. When enabled, this option
      allows the authentication module to return the DN instead of the User ID.
      OpenAM thus does not need to perform an additional search with the user
      ID to find the user's entry.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">sunAMAuthMSISDNReturnUserDN</code></p></dd><dt><span class="term">Authentication Level</span></dt><dd><p>Sets the authentication level used to indicate the level of security
      associated with the module. The value can range from 0 to any positive integer.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sunAMAuthMSISDNAuthLevel</code></p></dd></dl></div><a class="indexterm" name="d16037e4616"></a></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="OATH-module-conf-hints"></a>2.3.15.&nbsp;Hints for the OATH Module</h3></div></div></div><a class="indexterm" name="idx-auth-hints-oath"></a><a class="indexterm" name="d16037e4629"></a><p>The Open Authentication (OATH) module provides a more secure method for users to 
      access their accounts with the help of a device, such as their mobile phone or 
      Yubikey. Users can log into OpenAM and update their information more securely from
      a one-time password (OTP) displayed on their device. The OATH module includes the
      <a class="link" href="http://www.openauthentication.org/about/" target="_blank">OATH standard protocols</a> (<a class="link" href="http://tools.ietf.org/html/rfc4226" target="_blank">RFC 4226</a> and 
      <a class="link" href="http://tools.ietf.org/html/rfc6238" target="_blank">
      RFC 6238</a>). The OATH module has several enhancements to the
      HMAC One-Time Password (HOTP) Authentication Module, but does not replace the original
      module for those already using HOTP prior to the 10.1.0 release. The OATH module includes 
      HOTP authentication and Time-Based One-Time Password (TOTP) authentication. Both types
      of authentication require an OATH compliant device that can provide the OTP.</p><p> HOTP authentication generates the OTP every time the user requests a new OTP
      on their device. The device tracks the number of times the user requests a new OTP, called
      the counter. The OTP displays for a period of time you designate in the setup, so the 
      user may be further in the counter on their device than on their account. OpenAM will resynchronize
      the counter when the user finally logs in. To accommodate this, you set the number of 
      passwords a user can generate before their device cannot be resynchronized. For example, if 
      you set the number of HOTP Window Size to 50 and someone presses the button 30 on the
      user's device to generate a new OTP, the counter in OpenAM will review the OTPs until
      it reaches the OTP entered by the user. If someone presses the button 51 times,
      you will need to reset the counter to match the number on the device's counter before the
      user can login to OpenAM. HOTP authentication does not check earlier passwords, so if the 
      user attempts to reset the counter on their device, they will not be able to login until
      you reset the counter in OpenAM to match their device.</p><p>TOTP authentication constantly generates a new OTP based on a time interval you specify.
      The device tracks the last two passwords generated and the current password. The Last Login Time
      monitors the time when a user logs in to make sure that user is not logged in several times
      within the present time period. Once a user log into OpenAM, they must wait for the time it 
      takes TOTP to generate the next two passwords and display them. This prevents others from 
      being able to access the users account using the OTP they entered. The user's account can be
      accessed again after the generation of the third new OTP is generated and displayed on their
      device. For this reason, the TOTP Time-Step Interval should not be so long as to
      lock users out, with a recommended time of 30 seconds.</p><p>An authentication chain can be created to generate an OTP from 
      either HOTP or TOTP.</p><p><span class="command"><strong>ssoadm</strong></span> service name:
   <code class="literal">iPlanetAMAuthOATHService</code></p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Authentication Level</span></dt><dd><p>Sets the authentication level used to indicate the level of security
      associated with the module. The value can range from 0 to any positive integer.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-oath-auth-level</code></p></dd><dt><span class="term">One Time Password Length (in digits)</span></dt><dd><p>Set the length of the OTP between 6 and 9 digits long. The default value is 6 digits.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-oath-password-length</code></p></dd><dt><span class="term">Minimum Secret Key Length</span></dt><dd><p>The minimal number of characters required to set the Secret Key.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-oath-min-secret-key-length</code></p></dd><dt><span class="term">Secret Key Attribute Name</span></dt><dd><p>The name of the attribute where the key will be stored in the user profile.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-oath-secret-key-attribute</code></p></dd><dt><span class="term">OATH Algorithm to Use</span></dt><dd><p>Select whether to use HOTP or TOTP. You can create an authentication chain to
      allow for a greater variety of devices. The default value is HOTP.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-oath-algorithm</code></p></dd><dt><span class="term">HOTP Window Size</span></dt><dd><p>The number of requests that the system and the device can be off to resynchronize 
      the password. If a user passes this number of requests before logging 
      into the system, the password will not work. The default value is 100.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-oath-hotp-window-size</code></p></dd><dt><span class="term">Counter Attribute Name</span></dt><dd><p>The name of the HOTP attribute where the counter will be stored in the user profile.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-oath-hotp-counter-attribute</code></p></dd><dt><span class="term">Add Checksum Digit</span></dt><dd><p>Adds a checksum digit at the end of the HOTP password to verify it was entered correctly. 
      The default value is No.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-oath-add-checksum</code></p></dd><dt><span class="term">Truncation Offset</span></dt><dd><p>Advanced feature that is device specific. Any value below 0 or above 15 will turn off 
      the functionality. The default value is -1. If not required by the device, leave at the default 
      setting.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-oath-truncation-offset</code></p></dd><dt><span class="term">TOTP Time Step Interval</span></dt><dd><p>Defines how long the password will appear on the user's device (in seconds).
      We recommend keeping this number low, for example 30 seconds, because once a user
      logs out, they will not be able to login again until two full time cycles have passed.
      The default value is 30 seconds.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-oath-size-of-time-step</code></p></dd><dt><span class="term">TOTP Time Steps</span></dt><dd><p>The number of requests that the system and the device can be off to resynchronize 
      the password. If a user passes this number of requests before logging into the system,
      the password will not work. The default value is 2.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-oath-steps-in-window</code></p></dd><dt><span class="term">Last Login Time Attribute</span></dt><dd><p>The name of the attribute where both HOTP and TOTP authentication will store information
      on when a person last logged in.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-oath-last-login-time-attribute-name</code></p></dd></dl></div><p>If you plan to use Yubikey for your OATH module, you will need to take some
    time to set it up. Go to the <a class="link" href="http://www.yubico.com/products/services-software/personalization-tools/use/" target="_blank">
    YubiKey website</a> to configure your YubiKey device. If you do not have a
    YubiKey device, you can purchase them from this page as well.</p><p>Select the appropriate instructions, keeping in mind that the cross-platform
    personalization tool is recommended unless you have specific need for one of the
    other types. You have the greatest selection of platforms for this choice. Each 
    device will need to be setup before use.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="oauth2-module-conf-hints"></a>2.3.16.&nbsp;Hints for the OAuth 2.0/OpenID Connect Authentication Module</h3></div></div></div><a class="indexterm" name="idx-auth-hints-oauth2-oidc"></a><a class="indexterm" name="d16037e4815"></a><p>The OAuth 2.0 / OpenID Connect authentication module lets OpenAM
    authenticate clients of OAuth resource servers. References in this section
    are to RFC 6749, <a class="link" href="http://tools.ietf.org/html/rfc6749" target="_blank">The OAuth
   2.0 Authorization Framework</a>.</p><div class="tip"><h3 class="title">Tip</h3><p>OpenAM provides a wizard for configuring common OAuth 2.0 /
    OpenID Connect authentication providers such as Facebook, Google and
    Microsoft. For more information, see
    <a class="xref" href="#social-authn-wizard-pre-populated" title="2.2.1.&nbsp;Configuring Pre-Populated Social Authentication Providers">Section&nbsp;2.2.1, &#8220;Configuring Pre-Populated Social Authentication Providers&#8221;</a>.</p></div><p>
    If the module is configured to create an account if none exists,
    then you must provide valid SMTP settings.
    As part of account creation, the OAuth 2.0 / OpenID Connect client authentication module
    sends the resource owner an email with an account activation code.
    To send email, OpenAM uses the SMTP settings from the configuration
    for the OAuth 2.0 / OpenID Connect authentication module.
   </p><a class="indexterm" name="d16037e4830"></a><a class="indexterm" name="d16037e4835"></a><div class="note"><h3 class="title">Note</h3><p>The default settings are for Facebook.</p></div><p><span class="command"><strong>ssoadm</strong></span> service name:
   <code class="literal">sunAMAuthOAuthService</code></p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Client ID</span></dt><dd><p>OAuth <code class="literal">client_id</code> as described in
      <a class="link" href="http://tools.ietf.org/html/rfc6749#section-2.2" target="_blank">section 2.2 of RFC 6749</a>.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-oauth-client-id</code></p></dd><dt><span class="term">Client Secret</span></dt><dd><p>OAuth <code class="literal">client_secret</code> as described in
      <a class="link" href="http://tools.ietf.org/html/rfc6749#section-2.3" target="_blank">section 2.3 of RFC 6749</a>.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-oauth-client-secret</code></p></dd><dt><span class="term">Authentication Endpoint URL</span></dt><dd><p>URL to the end point handling OAuth authentication as described in
      <a class="link" href="http://tools.ietf.org/html/rfc6749#section-3.1" target="_blank">section 3.1 of RFC 6749</a>. The default value is
      <code class="literal">https://www.facebook.com/dialog/oauth</code>.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-oauth-auth-service</code></p></dd><dt><span class="term">Access Token Endpoint URL</span></dt><dd><p>URL to the end point handling access tokens as described in
      <a class="link" href="http://tools.ietf.org/html/rfc6749#section-3.2" target="_blank">section 3.2 of RFC 6749</a>. The default value is
      <code class="literal">https://graph.facebook.com/oauth/access_token</code>.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-oauth-token-service</code></p></dd><dt><span class="term">User Profile Service URL</span></dt><dd><p>User profile URL that returns profile information in JSON
      format. The default value is
      <code class="literal">https://graph.facebook.com/me</code>.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-oauth-user-profile-service</code></p></dd><dt><span class="term">Scope</span></dt><dd><p>
       According to
       <a class="link" href="http://tools.ietf.org/html/rfc6749" target="_blank"><em class="citetitle">The OAuth 2.0 Authorization Framework</em></a>,
       a space-separated list of user profile attributes
       that the client application requires.
       The list depends on the permissions
       that the resource owner, such as the end user,
       grants to the client application.
      </p><p>
       Some authorization servers use non-standard separators for scopes.
       Facebook, for example, takes a comma-separated list.
      </p><p>
       Default: <code class="literal">email,read_stream</code> (Facebook example)
      </p><p>
       <span class="command"><strong>ssoadm</strong></span> attribute:
       <code class="literal">iplanet-am-auth-oauth-scope</code>
      </p></dd><dt><span class="term">Proxy URL</span></dt><dd><p>URL to the <code class="filename">/oauth2c/OAuthProxy.jsp</code> file,
      part of OpenAM.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-oauth-sso-proxy-url</code></p></dd><dt><span class="term">Account Mapper</span></dt><dd><p>Class implementing account mapping. The default value is
      <code class="literal">org.forgerock.openam.authentication.modules.common.mapping.AttributeMapper</code>.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">org-forgerock-auth-oauth-account-mapper</code></p></dd><dt><span class="term">Account Mapper Configuration</span></dt><dd><p>Map of OAuth Provider user account attributes used to find the
      local profile of the authenticated user, with values in the form
      <code class="literal"><em class="replaceable"><code>provider-attr</code></em>=<em class="replaceable"><code>local-attr</code></em></code>.
      Default values <code class="literal">email=mail</code> and <code class="literal"> id=facebook-id</code>.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">org-forgerock-auth-oauth-account-mapper-configuration</code></p></dd><dt><span class="term">Account Provider</span></dt><dd><p>An account provider.
       Default:
      <code class="literal">org.forgerock.openam.authentication.modules.common.mapping.AccountProvider</code></p><p><span class="command"><strong>ssoadm</strong></span> attribute:
       <code class="literal">org-forgerock-auth-oauth-account-provider</code></p></dd><dt><span class="term">Attribute Mapper</span></dt><dd><p>List of fully qualified class names for implementations that map
       attributes from the OAuth 2.0 authorization server or OpenID Connect
       provider to OpenAM profile attributes.
       Default:
      <code class="literal">org.forgerock.openam.authentication.modules.common.mapping.JsonAttributeMapper</code></p><p>Provided implementations are:</p><table border="0" summary="Simple list" class="simplelist"><tr><td><code class="literal">org.forgerock.openam.authentication.modules.common.mapping.JsonAttributeMapper</code></td></tr><tr><td><code class="literal">org.forgerock.openam.authentication.modules.oidc.JwtAttributeMapper</code>
        (can only be used when using the <code class="literal">openid</code> scope)</td></tr></table><div class="tip"><h3 class="title">Tip</h3><p>You can provide string constructor parameters by appending
       pipe (<code class="literal">|</code>) separated values.</p><p>For example, the
       <code class="literal">org.forgerock.openam.authentication.modules.oidc.JwtAttributeMapper</code>
       class can take two constructor parameters: a comma-separated list of
       attributes and a prefix to apply to their values. Specify these as
       follows:</p><p><code class="literal">org.forgerock.openam.authentication.modules.oidc.JwtAttributeMapper|uid,employeeNumber|myPrefix-</code>
      </p></div><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">org-forgerock-auth-oauth-attribute-mapper</code></p></dd><dt><span class="term">Attribute Mapper Configuration</span></dt><dd><p>Map of OAuth Provider user account attributes to local user profile
      attributes, with values in the form
      <code class="literal"><em class="replaceable"><code>provider-attr</code></em>=<em class="replaceable"><code>local-attr</code></em></code>.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">org-forgerock-auth-oauth-attribute-mapper-configuration</code></p></dd><dt><span class="term">Save attributes in the session</span></dt><dd><p>When enabled, add the mapped attributes to the session saved. The
      default mode is <code class="literal">Enabled</code>.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">org-forgerock-auth-oauth-save-attributes-to-session-flag</code></p></dd><dt><span class="term">Email attribute in OAuth2 Response</span></dt><dd><p>Specifies the attribute identifying email address in the response
      from the profile service in the OAuth provider. This setting is used to
      send an email address with an activation code for accounts created
      dynamically.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">org-forgerock-auth-oauth-mail-attribute</code></p></dd><dt><span class="term">Create account if it does not exist</span></dt><dd><p>When enabled, if the user profile does not exist, optionally
      retrieve a password and activation code from the user, and then create
      the profile. The default mode is <code class="literal">Enabled</code>.</p><p>When the OAuth 2.0 / OpenID Connect client is configured to create new accounts,
      the SMTP settings must also be valid. As part of account creation,
      the OAuth 2.0 / OpenID Connect client authentication module sends the resource owner
      an email with an account activation code. To send the mail, OpenAM
      uses the SMTP settings you provide here in the OAuth 2.0 / OpenID Connect client
      configuration.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">org-forgerock-auth-oauth-createaccount-flag</code></p></dd><dt><span class="term">Prompt for password setting and activation code</span></dt><dd><p>When enabled, the user sets a password, receives an activation code
      by email. The user must correctly set both in order for the account to
      be created.  The default mode is <code class="literal">Enabled</code>.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">org-forgerock-auth-oauth-prompt-password-flag</code></p></dd><dt><span class="term">Map to anonymous user</span></dt><dd><p>When enabled, map the OAuth authenticated user to the anonymous
      user you specify. No account is created, even if Create account if it
      does not exist is enabled.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">org-forgerock-auth-oauth-map-to-anonymous-flag</code></p></dd><dt><span class="term">Anonymous User</span></dt><dd><p>Specifies an anonymous user that exists in the current realm. The
      default is <code class="literal">anonymous</code>.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">org-forgerock-auth-oauth-anonymous-user</code></p></dd><dt><span class="term">OAuth 2.0 Provider logout service</span></dt><dd><p>Specifies the optional URL of the OAuth Provider.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">org-forgerock-auth-oauth-logout-service-url</code></p></dd><dt><span class="term">Logout options</span></dt><dd><p>Specifies whether not to log the user out without prompting from
      the OAuth Provider on logout, to log the user out without prompting, or
      to prompt the user regarding whether to logout from the OAuth
      provider.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">org-forgerock-auth-oauth-logout-behaviour</code></p></dd><dt><span class="term">Mail Server Gateway implementation class</span></dt><dd><p>Class to interact with the mail server. Default:
      <code class="literal">org.forgerock. openam.authentication.modules.oauth2.DefaultEmailGatewayImpl</code></p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">org-forgerock-auth-oauth-email-gwy-impl</code></p></dd><dt><span class="term">SMTP host</span></dt><dd><p>Host name of the mail server. The default is
      <code class="literal">localhost</code>.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">org-forgerock-auth-oauth-smtp-hostname</code></p></dd><dt><span class="term">SMTP port</span></dt><dd><p>SMTP port number for the mail server. The default value is
      <code class="literal">25</code>.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">org-forgerock-auth-oauth-smtp-port</code></p></dd><dt><span class="term">SMTP User Name</span></dt><dd><p>If the mail server requires authentication to send mail, specifies
      the user name.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">org-forgerock-auth-oauth-smtp-username</code></p></dd><dt><span class="term">SMTP User Password</span></dt><dd><p>If the mail server requires authentication to send mail, specifies
      the password.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">org-forgerock-auth-oauth-smtp-password</code></p></dd><dt><span class="term">SMTP SSL Enabled</span></dt><dd><p>When enabled, connect to the mail server over SSL. OpenAM must be
      able to trust the SMTP server certificate.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">org-forgerock-auth-oauth-smtp-ssl_enabled</code></p></dd><dt><span class="term">SMTP From address</span></dt><dd><p>Specifies the message sender address, such as
      <code class="literal">no-reply@example.com</code>. The default value is
      <code class="literal">info@forgerock.com</code>.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">org-forgerock-auth-oauth-smtp-email-from</code></p></dd><dt><span class="term">Authentication Level</span></dt><dd><p>Sets the authentication level used to indicate the level of security
      associated with the module. The value can range from 0 to any positive integer.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-oauth-auth-level</code></p></dd></dl></div><div class="note"><h3 class="title">Note</h3><p>
     Old uses of <code class="literal">DefaultAccountMapper</code> are automatically
     upgraded to the equivalent default implementations.
    </p></div><p>The following tables show endpoint URLs for OpenAM when <a href="../admin-guide/index.html#chap-oauth2" class="link">configured as an
    OAuth 2.0 provider</a>.
    The default endpoints are for Facebook as the OAuth 2.0 provider.</p><p>In addition to the endpoint URLs you can set other fields, like scope
    and attribute mapping, depending on the provider you use.</p><div class="table"><a name="oauth2-openam"></a><div class="table-title">Table&nbsp;2.1.&nbsp;Endpoint URLs for OpenAM</div><div class="table-contents"><table summary="Endpoint URLs for OpenAM" width="100%" border="0"><colgroup><col width="50%"><col width="50%"></colgroup><thead><tr><th>OpenAM Field</th><th>Details</th></tr></thead><tbody><tr><td>Authorization Endpoint URL</td><td>
         <p><code class="literal">/oauth2/authorize</code> under the deployment
          URL.<a href="#ftn.oauth2-realms-footnote" class="footnote" name="oauth2-realms-footnote"><sup class="footnote">[a]</sup></a>
         </p>
         <p>Example: <code class="literal">https://openam.example.com:8443/openam/oauth2/authorize</code>.</p>
       </td></tr><tr><td>Access Token Endpoint URL</td><td>
         <p><code class="literal">/oauth2/access_token</code> under the deployment
          URL.<a href="#ftn.oauth2-realms-footnote" class="footnoteref"><sup class="footnoteref">[a]</sup></a></p>
         <p>Example: <code class="literal">https://openam.example.com:8443/openam/oauth2/access_token</code>.</p></td></tr><tr><td>User Profile Service URL</td><td>
         <p><code class="literal">/oauth2/tokeninfo</code> under the deployment URL.</p>
         <p>Example: <code class="literal">https://openam.example.com:8443/openam/oauth2/tokeninfo</code>.</p></td></tr></tbody><tbody class="footnotes"><tr><td colspan="2"><div id="ftn.oauth2-realms-footnote" class="footnote"><p><a href="#oauth2-realms-footnote" class="para"><sup class="para">[a] </sup></a>This OpenAM endpoint can take additional parameters. In
           particular you must specify the realm if the OpenAM OAuth 2.0
           provider is configured for a subrealm rather than / (Top-Level
           Realm).</p><p>For example, if the OAuth 2.0 provider is configured for the
           realm <code class="literal">/customers</code>, then the authentication endpoint
           URL is as follows:
           <code class="literal">https://openam.example.com:8443/openam/oauth2/authorize?realm=/customers</code></p><p>The <code class="literal">/oauth2/authorize</code> endpoint can also take
           <code class="literal">module</code> and <code class="literal">service</code> parameters.
           Use either as described in <a href="../admin-guide/index.html#authn-from-browser" class="link"><em class="citetitle">Authenticating To OpenAM</em></a>, where
           <code class="literal">module</code> specifies the authentication module
           instance to use or <code class="literal">service</code> specifies the
           authentication chain to use when authenticating the resource
           owner.</p></div></td></tr></tbody></table></div></div><br class="table-break"><a class="indexterm" name="d16037e5413"></a></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="oidc-module-conf-hints"></a>2.3.17.&nbsp;Hints for the OpenID Connect id_token bearer Module</h3></div></div></div><a class="indexterm" name="d16037e5421"></a><a class="indexterm" name="d16037e5426"></a><p>
    The OpenID Connect id_token bearer module lets OpenAM rely on
    an <a class="link" href="http://openid.net/connect/" target="_blank">OpenID Connect 1.0</a> provider's ID Token to authenticate an end
    user.</p><div class="note"><h3 class="title">Note</h3><p>This module validates an OpenID Connect ID token and matches
    it with a user profile. You should not use this module if you want OpenAM
    to act as a client in the full OpenID Connect authentication flow.</p><p>To provision OpenAM as an OpenID Connect client, you should instead configure
    an OAuth 2.0 / OpenID Connect module. OpenAM provides a wizard to configure
     an OAuth 2.0 / OpenID Connect module that will
    authenticate against an OpenID Connect 1.0 provider. For more information, see
    <a class="xref" href="#social-authn-wizard-custom" title="2.2.2.&nbsp;Configuring Custom Social Authentication Providers">Section&nbsp;2.2.2, &#8220;Configuring Custom Social Authentication Providers&#8221;</a>.</p></div><p>The OpenID Connect id_token bearer module expects an OpenID Connect
    ID Token in an HTTP request header.
    It validates the ID Token, and if successful,
    looks up the OpenAM user profile corresponding to the end user
    for whom the ID Token was issued.
    Assuming the ID Token is valid and the profile is found,
    the module authenticates the OpenAM user.
   </p><p>
    You configure the OpenID Connect id_token bearer module
    to specify how OpenAM gets the information needed to validate the ID Token,
    which request header contains the ID Token,
    the issuer identifier for the provider who issued the ID Token,
    and how to map the ID Token claims to an OpenAM user profile.
   </p><div class="note"><h3 class="title">Note</h3><p>The default settings are for Google's provider.</p></div><a class="indexterm" name="d16037e5448"></a><a class="indexterm" name="d16037e5453"></a><p>
    <span class="command"><strong>ssoadm</strong></span> service name:
    <code class="literal">amAuthOpenIdConnect</code>
   </p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Configuration type</span></dt><dd><p>
       In order to validate the ID Token from the OpenID Connect provider,
       the module needs either a URL to get the public keys for the provider,
       or the symmetric key for an ID Token signed with a HMAC-based algorithm.
      </p><div class="variablelist"><p>
        By default, the configuration type is
        <code class="literal">.well-known/openid-configuration_url</code>.
        This means the module should retrieve the keys based on
        information in the OpenID Connect Provider Configuration Document.
       </p><p>
        You can instead configure the authentication module
        to validate the ID Token signature
        with the client secret key you provide,
        or to validate the ID token with the keys retrieved
        from the URL to the OpenID Connect provider's JSON Web Key Set.
       </p><dl class="variablelist"><dt><span class="term"><code class="literal">.well-known/openid-configuration_url</code> (Default)</span></dt><dd><p>
          Retrieve the provider keys based on the information provided
          in the OpenID Connect Provider Configuration Document.
         </p><p>
          Specify the URL to the document as the discovery URL.
         </p></dd><dt><span class="term"><code class="literal">client_secret</code></span></dt><dd><p>
          Use the client secret that you specify as the key to validate
          the ID Token signature according to the HMAC,
          using the client secret to the decrypt the hash
          and then checking that the hash matches the hash of the ID Token JWT.
         </p></dd><dt><span class="term"><code class="literal">jwk_url</code></span></dt><dd><p>
          Retrieve the provider's JSON Web Key Set at the URL that you specify.
         </p></dd></dl></div><p>
       <span class="command"><strong>ssoadm</strong></span> attribute:
       <code class="literal">openam-auth-openidconnect-crypto-context-type</code>
      </p></dd><dt><span class="term">Discovery url, jwk url, or client_secret</span></dt><dd><p>
       Edit this field depending on the Configuration type you specified.
      </p><p>
       Default: <code class="literal">https://accounts.google.com/.well-known/openid-configuration</code>
      </p><p>
       <span class="command"><strong>ssoadm</strong></span> attribute:
       <code class="literal">openam-auth-openidconnect-crypto-context-value</code>
      </p></dd><dt><span class="term">Name of header referencing the ID Token</span></dt><dd><p>
       The module looks for the ID Token in this HTTP request header.
      </p><p>
       Default: <code class="literal">oidc_id_token</code>
      </p><p>
       <span class="command"><strong>ssoadm</strong></span> attribute:
       <code class="literal">openam-auth-openidconnect-header-name</code>
      </p></dd><dt><span class="term">Name of OpenID Connect ID Token Issuer</span></dt><dd><p>
       This corresponds to the expected issue identifier value
       in the <code class="literal">iss</code> of the ID Token.
      </p><p>
       Default: <code class="literal">accounts.google.com</code>
      </p><p>
       <span class="command"><strong>ssoadm</strong></span> attribute:
       <code class="literal">openam-auth-openidconnect-issuer-name</code>
      </p></dd><dt><span class="term">Mapping of local LDAP attributes to jwt attributes</span></dt><dd><p>
       This setting maps local user profile attributes
       to OpenID Connect ID Token claims,
       allowing the module to retrieve the user profile based on the ID Token.
      </p><p>
       In OpenID Connect, an ID Token is represented as a JSON Web Token (JWT).
       The
       <a class="link" href="http://openid.net/specs/openid-connect-core-1_0.html#IDToken" target="_blank">ID Token</a> section of the OpenID Connect Core 1.0 specification
       defines a number of claims included in the ID Token for all flows.
       Additional claims depend on the scopes requested of the OpenID Connect
       provider.
      </p><p>
       For each item in the map, the key is the ID Token field name and the
       value is the local user profile attribute name.
      </p><p>
       Default: <code class="literal">mail=email</code>, <code class="literal">uid=sub</code>
      </p><p>
       <span class="command"><strong>ssoadm</strong></span> attribute:
       <code class="literal">openam-auth-openidconnect-local-to-jwt-attribute-mappings</code>
      </p></dd><dt><span class="term">Principal Mapper class</span></dt><dd><p>
       The principal mapper matches the OpenID Connect end user
       with an OpenAM account.
       The default principal mapper uses
       the mapping of local attributes to ID Token attributes
       to find a user profile.
      </p><p>
       Default: <code class="literal">org.forgerock.openam.authentication.common.mapping.AttributeMapper</code>
      </p><p>
       <span class="command"><strong>ssoadm</strong></span> attribute:
       <code class="literal">openam-auth-openidconnect-principal-mapper-class</code>
      </p></dd><dt><span class="term">Principal Account Provider class</span></dt><dd><p>
       The principal account provider provides the means to search for and
       create OpenID Connect users given a set of attributes.
      </p><p>
       Default: <code class="literal">org.forgerock.openam.authentication.common.mapping.AccountProvider</code>
      </p><p>
       <span class="command"><strong>ssoadm</strong></span> attribute:
       <code class="literal">openam-auth-openidconnect-account-provider-class</code>
      </p></dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="persistent-cookie"></a>2.3.18.&nbsp;Hints for the Persistent Cookie Module</h3></div></div></div><a class="indexterm" name="d16037e5641"></a><p>The Persistent Cookie module supports the configuration of cookie lifetimes,
    based on requests and a maximum time. It is the preferred method for creating
    a persistent cookie. If you choose this method, be aware that it does not
    interact with the persistent cookie options associated with the Core
    Authentication module.
    Note that, by default, the persistent cookie is called <code class="literal">session-jwt</code>.
   </p><div class="important"><h3 class="title">Important</h3><p>
     If Secure Cookie is enabled (Configuration &gt; Servers and Sites &gt;
     Servers &gt; <em class="replaceable"><code>URL of your server</code></em> &gt; Security
     &gt; Cookies), the Persistent Cookie Module only works over HTTPS.
    </p></div><p><span class="command"><strong>ssoadm</strong></span> service name:
    <code class="literal">iPlanetAMAuthPersistentCookieService</code></p><p>Before you begin, make sure a public key alias is defined in OpenAM.
    The Persistent Cookie module encrypts a JSON Web Token (JWT) using a public key
    from the OpenAM keystore. The keystore must be configured under
    Authentication &gt; All Core Settings &gt; Security. If the keystore changes
    and the default <code class="literal">test</code> key is no longer present, the public
    key alias must be updated to reflect the change, otherwise the module will
    fail. Similarly, in multi-instance deployments, the keypair must be available
    on all OpenAM instances.</p><p>To configure the Persistent Cookie module globally in the console,
    navigate to Configuration &gt; Authentication &gt; Persistent Cookie.
    In the window that appears you should see the following attributes:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Idle Timeout</span></dt><dd><p>Specify the maximum idle time between requests, in hours. If
                  that time is exceeded, the cookie is no longer valid.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
                  <code class="literal">openam-auth-persistent-cookie-idle-time</code></p></dd><dt><span class="term">Max Life</span></dt><dd><p>Specify the maximum life of the cookie in hours.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
                  <code class="literal">openam-auth-persistent-cookie-max-life</code></p></dd><dt><span class="term">Enforce Client IP</span></dt><dd><p>
                   When enabled, enforces that the persistent cookie
                   can only be used from the same client IP
                   to which the cookie was issued.
                  </p><p>
                   <span class="command"><strong>ssoadm</strong></span> attribute:
                   <code class="literal">openam-auth-persistent-cookie-enforce-ip</code>
                  </p></dd><dt><span class="term">Use secure cookie</span></dt><dd><p>
             When enabled, adds the "Secure" attribute to the persistent cookie.
            </p><p>
             <span class="command"><strong>ssoadm</strong></span> attribute:
             <code class="literal">openam-auth-persistent-cookie-secure-cookie</code>
            </p></dd><dt><span class="term">Use HTTP only cookie</span></dt><dd><p>
             When enabled, adds the "HttpOnly" attribute to the persistent
             cookie.
            </p><p>
             <span class="command"><strong>ssoadm</strong></span> attribute:
             <code class="literal">openam-auth-persistent-cookie-http-only-cookie</code>
            </p></dd></dl></div><p>
       When the Persistent Cookie module enforces the client IP address,
       and OpenAM lies behind a load balancer or proxy layer,
       configure the load balancer or proxy to send the address
       by using the <code class="literal">X-Forwarded-For</code> header,
       and configure OpenAM to consume and forward the header as necessary.
       For details, see the <em class="citetitle">Installation Guide</em> section,
       <a href="../install-guide/index.html#handle-request-headers" class="link"><em class="citetitle">Handling HTTP Request Headers</em></a>.
      </p><p>The Persistent Cookie module belongs with a second module in an authentication chain. To see how
      this works, navigate to Access Control &gt; <em class="replaceable"><code>Realm Name</code></em> &gt; Authentication &gt; New.
      Enter a name for the chain and add modules as shown in the figure. The following example shows how a
      Persistent Cookie module is sufficient; if that cookie does not yet exist, authentication in this case
      relies on a data store module such as LDAP.</p><div class="mediaobject" align="center"><a name="figure-persistent-cookie-mod"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/persistent-cookie-mod.png" align="middle" height="360" alt="Including the Persistent Cookie module in an authentication chain"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-persistent-cookie-mod.html" target="longdesc">D</a>]</span></div></div><p>
       Scroll down in the properties page for the chain.
       Set the Post Authentication Processing Class to
       <code class="literal">org.forgerock.openam.authentication.modules.persistentcookie.PersistentCookieAuthModule</code>
       as shown in the following figure:</p><div class="mediaobject" align="center"><a name="figure-persistent-cookie-class"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/persistent-cookie-class.png" align="middle" height="360" alt="Including the Persistent Cookie attribute in the post processing class"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-persistent-cookie-class.html" target="longdesc">D</a>]</span></div></div><p>You should now be able to authenticate automatically, as long as the cookie exists
      for the associated domain.</p><div class="note"><h3 class="title">Note</h3><p>Unlike the legacy Core Authentication module, the Persistent Cookie module does not
      support the iPSPCookie option described in <a class="xref" href="#authn-from-browser" title="2.6.&nbsp;Authenticating To OpenAM">Section&nbsp;2.6, &#8220;Authenticating To OpenAM&#8221;</a></p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="radius-module-conf-hints"></a>2.3.19.&nbsp;Hints for the RADIUS Authentication Module</h3></div></div></div><a class="indexterm" name="d16037e5782"></a><a class="indexterm" name="d16037e5787"></a><p>The Remote Authentication Dial-In User Service (RADIUS) module lets
   OpenAM authenticate users against RADIUS servers.</p><p><span class="command"><strong>ssoadm</strong></span> service name:
   <code class="literal">iPlanetAMAuthRadiusService</code></p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Primary Radius Servers, Secondary Radius Servers</span></dt><dd><p>Specify the IP address or fully qualified domain name of the
      primary RADIUS server. The default is <code class="literal">127.0.0.1</code>
      (localhost loopback).</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">primary is iplanet-am-auth-radius-server1</code>;
      secondary is <code class="literal">iplanet-am-auth-radius-server2</code></p></dd><dt><span class="term">Shared Secret</span></dt><dd><p>Specify the shared secret for RADIUS authentication. The shared
      secret should be as secure as a well-chosen password.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-radius-secret</code></p></dd><dt><span class="term">Port Number</span></dt><dd><p>Specify the RADIUS server port. Default is 1645.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-radius-server-port</code></p></dd><dt><span class="term">Timeout</span></dt><dd><p>Specify how many seconds to wait for the RADIUS server to respond.
      The default value is 3 seconds.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-radius-timeout</code></p></dd><dt><span class="term">Health check interval</span></dt><dd><p>Used for failover. Specify how often OpenAM performs a health check
      on a previously unavailable RADIUS server by sending an invalid
      authentication request. Default: 5 minutes</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">openam-auth-radius-healthcheck-interval</code></p></dd><dt><span class="term">Authentication Level</span></dt><dd><p>Sets the authentication level used to indicate the level of security
      associated with the module. The value can range from 0 to any positive integer.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">iplanet-am-auth-radius-auth-level</code></p></dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="sae-module-conf-hints"></a>2.3.20.&nbsp;Hints for the SAE Authentication Module</h3></div></div></div><a class="indexterm" name="d16037e5880"></a><a class="indexterm" name="d16037e5885"></a><p>The Secure Attribute Exchange (SAE) module lets OpenAM authenticate
   a user who has already authenticated with an entity that can vouch for
   the user to OpenAM, so that OpenAM creates a session for the user.
   This module is useful in virtual federation, where an existing entity
   instructs the local OpenAM instance to use federation protocols to transfer
   authentication and attribute information to a partner application.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
   <code class="literal">sunAMAuthSAEService</code></p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Authentication Level</span></dt><dd><p>Sets the authentication level used to indicate the level of security
      associated with the module. The value can range from 0 to any positive integer.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sunAMAuthSAEAuthLevel</code></p></dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="scripted-module-conf-hints"></a>2.3.21.&nbsp;Hints for Scripted Authentication Modules</h3></div></div></div><a class="indexterm" name="d16037e5912"></a><a class="indexterm" name="d16037e5917"></a><p>
    This section covers what to configure for scripted authentication modules.
   </p><p>
    A scripted authentication module runs scripts to authenticate a user.
    The configuration for the module can hold two scripts,
    one to include in the web page run on the client user-agent,
    another to run in OpenAM on the server side.
   </p><p>
    The client-side script is intended to retrieve data from the user-agent.
    This must be in a language the user-agent, such as JavaScript,
    even if the server-side script is written in Groovy.
   </p><p>
    The server-side script is intended to handle authentication.
   </p><p>
    Scripts are stored not as files, but instead as OpenAM configuration data.
    This makes it easy to update a script on one OpenAM server,
    and then to allow replication to copy it to other servers.
    You can manage the scripts through OpenAM console,
    where you can write them in the text boxes provided
    or upload them from files.
   </p><p>
    You can also upload scripts using the <span class="command"><strong>ssoadm</strong></span> command.
    To perform the command-line equivalent of the Upload button in the console,
    use the <span class="command"><strong>ssoadm</strong></span> attributes,
    <code class="literal">iplanet-am-auth-scripted-client-script-file</code>
    or <code class="literal">iplanet-am-auth-scripted-server-script-file</code>.
    The following example shows how to create a scripted authentication module,
    sets up a basic configuration with scripts as strings in the configuration,
    and then uploads a server-side script file.
   </p><pre class="brush: shell;">
#
# Create a scripted authentication module.
#
ssoadm \
 create-auth-instance \
 --adminid amadmin \
 --password-file /tmp/pwd.txt \
 --authtype Scripted \
 --realm / \
 --name ScriptedModule

#
# Add basic configuration, including minimal client and server-side scripts.
#
ssoadm \
 update-auth-instance \
 --adminid amadmin \
 --password-file /tmp/pwd.txt \
 --authtype Scripted \
 --realm / \
 --name ScriptedModule \
 --attributevalues \
    iplanet-am-auth-scripted-auth-level=0 \
    iplanet-am-auth-scripted-client-script-enabled=false \
    iplanet-am-auth-scripted-script-type='JavaScript' \
    iplanet-am-auth-scripted-client-script='alert("Hello");' \
    iplanet-am-auth-scripted-server-script='authState=SUCCESS;'

#
# Upload a server-side script from a script file, /tmp/server-side.js.
#
ssoadm \
 update-auth-instance \
 --adminid amadmin \
 --password-file /tmp/pwd.txt \
 --authtype Scripted \
 --realm / \
 --name ScriptedModule \
 --attributevalues \
    iplanet-am-auth-scripted-server-script-file=/tmp/server-side.js
   </pre><p>
    If you have multiple separate sets of client-side and server-side scripts,
    then configure multiple modules, one for each set of scripts.
   </p><p>
    For details on writing authentication module scripts, see the
    <em class="citetitle">Developer Guide</em> chapter,
    <a href="../dev-guide/index.html#chap-scripted-auth-module" class="link"><em class="citetitle">Scripting Authentication</em></a>.
   </p><p>
    <span class="command"><strong>ssoadm</strong></span> service name:
    <code class="literal">iPlanetAMAuthScriptedService</code>
   </p><div class="variablelist"><p>
     Use the following settings at the realm level
     when configuring an individual scripted authentication module,
     in OpenAM Console under Access Control &gt;
     <em class="replaceable"><code>Realm Name</code></em> &gt; Authentication &gt; Module Instances.
    </p><dl class="variablelist"><dt><span class="term">Server-Side Script Language</span></dt><dd><p>
       The language of the server-side script.
      </p><p>
       <span class="command"><strong>ssoadm</strong></span> attribute:
       <code class="literal">iplanet-am-auth-scripted-script-type</code>
      </p></dd><dt><span class="term">Client Side Script Enabled</span></dt><dd><p>
       When selected, include the client-side script in the login page
       to be executed on the user-agent prior to the server-side script.
      </p><p>
       <span class="command"><strong>ssoadm</strong></span> attribute:
       <code class="literal">iplanet-am-auth-scripted-client-script-enabled</code>
      </p></dd><dt><span class="term">Client Side Script</span></dt><dd><p>
       The script to include in the login page.
       This script is run on the user-agent prior to the server-side script.
      </p><p>
       This script must be written in a language the user-agent can interpret,
       such as JavaScript,
       even if the server-side script is written in Groovy.
      </p><p>
       <span class="command"><strong>ssoadm</strong></span> attribute:
       <code class="literal">iplanet-am-auth-scripted-client-script</code>
      </p><p>
       When uploading the script from a file, use the
       <span class="command"><strong>ssoadm</strong></span> attribute:
       <code class="literal">iplanet-am-auth-scripted-client-script-file</code>
      </p></dd><dt><span class="term">Server Side Script</span></dt><dd><p>
       The script to run in OpenAM after the client-side script has completed.
      </p><p>
       <span class="command"><strong>ssoadm</strong></span> attribute:
       <code class="literal">iplanet-am-auth-scripted-server-script</code>
      </p><p>
       When uploading the script from a file, use the
       <span class="command"><strong>ssoadm</strong></span> attribute:
       <code class="literal">iplanet-am-auth-scripted-server-script-file</code>
      </p></dd><dt><span class="term">Authentication Level</span></dt><dd><p>
       Sets the authentication level used to indicate the level of security
       associated with the scripted authentication module.
      </p><p>
       The value can range from 0 to any positive integer.
      </p><p>
       <span class="command"><strong>ssoadm</strong></span> attribute:
       <code class="literal">iplanet-am-auth-scripted-auth-level</code>
      </p></dd></dl></div><div class="variablelist"><p>
     Use the following global configuration settings
     for all scripted authentication modules,
     in OpenAM Console under Configuration &gt; Authentication &gt; Scripted Module.
    </p><dl class="variablelist"><dt><span class="term">Server Side Script Timeout</span></dt><dd><p>
       Sets the maximum execution time to run a single server-side script,
       in seconds.
      </p><p>
       Default: 0 (meaning no timeout)
      </p><p>
       If your server-side scripts send external HTTP requests,
       consider setting an appropriate value for this timeout.
      </p><p>
       <span class="command"><strong>ssoadm</strong></span> attribute:
       <code class="literal">iplanet-am-auth-scripted-server-timeout</code>
      </p></dd><dt><span class="term">Core thread pool size</span></dt><dd><p>
       Core size for the pool of threads dedicated to running server-side scripts.
      </p><p>
       Default: 10
      </p><p>
       This setting is not hot-swappable.
       Instead, you must restart OpenAM or the container in which it runs
       for the changes to take effect.
      </p><p>
       <span class="command"><strong>ssoadm</strong></span> attribute:
       <code class="literal">iplanet-am-auth-scripted-core-threads</code>
      </p></dd><dt><span class="term">Maximum thread pool size</span></dt><dd><p>
       Maximum size for the pool of threads dedicated to running server-side scripts.
      </p><p>
       Default: 50
      </p><p>
       This setting is not hot-swappable.
       Instead, you must restart OpenAM or the container in which it runs
       for the changes to take effect.
      </p><p>
       <span class="command"><strong>ssoadm</strong></span> attribute:
       <code class="literal">iplanet-am-auth-scripted-core-threads</code>
      </p></dd></dl></div></div><div lang="en" class="section"><div class="titlepage"><div><div><h3 class="title"><a name="securid-module-conf-hints"></a>2.3.22.&nbsp;Hints For the SecurID Authentication Module</h3></div></div></div><p>
  The SecurID module lets OpenAM authenticate users
  with RSA Authentication Manager software and RSA SecurID authenticators.
 </p><div class="orderedlist"><p>
   In order to use the SecurID authentication module,
   you must first build an OpenAM war file
   that includes the supporting library,
   <code class="filename">authapi-2005-08-12.jar</code>.
  </p><ol class="orderedlist" type="1"><li class="listitem"><p>
    Unpack the OpenAM .war file.
   </p><div class="screen"><pre>
$ <strong>mkdir /tmp/openam</strong>
$ <strong>cd /tmp/openam/</strong>
$ <strong>jar -xf ~/Downloads/openam/OpenAM-12.0.0.war</strong>
   </pre></div></li><li class="listitem"><p>
    Copy <code class="filename">authapi-2005-08-12.jar</code>
    into the <code class="filename">WEB-INF/lib</code> directory.
   </p><div class="screen"><pre>
$ <strong>cp /path/to/authapi-2005-08-12.jar WEB-INF/lib/</strong>
   </pre></div></li><li class="listitem"><p>
    Pack up the OpenAM .war file to deploy.
   </p><div class="screen"><pre>
$ <strong>jar -cf ../openam.war *</strong>
   </pre></div></li><li class="listitem"><p>Deploy the new .war file.</p><p>
    In this example the .war file to deploy is
    <code class="filename">/tmp/openam.war</code>.
   </p></li></ol></div><a class="indexterm" name="d16037e6174"></a><p>
  <span class="command"><strong>ssoadm</strong></span> service name:
  <code class="literal">iPlanetAMAuthSecurIDService</code>
 </p><div class="variablelist"><dl class="variablelist"><dt><span class="term">ACE/Server Configuration Path</span></dt><dd><p>
     Specify the directory where
     the SecurID ACE/Server <code class="filename">sdconf.rec</code> file is located,
     which by default is expected under the OpenAM configuration directory,
     such as <code class="filename">$HOME/openam/openam/auth/ace/data</code>.
     The directory must exist before OpenAM can use SecurID authentication.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">iplanet-am-auth-securid-server-config-path</code>
    </p></dd><dt><span class="term">Authentication Level</span></dt><dd><p>
     Sets the authentication level used
     to indicate the level of security associated with the module.
     The value can range from 0 to any positive integer.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">iplanet-am-auth-securid-auth-level</code>
    </p></dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="desktop-module-conf-hints"></a>2.3.23.&nbsp;Hints for the Windows Desktop SSO Authentication Module</h3></div></div></div><a class="indexterm" name="d16037e6225"></a><a class="indexterm" name="d16037e6230"></a><a class="indexterm" name="d16037e6233"></a><p>
    The Windows Desktop SSO module uses Kerberos authentication. The user
    presents a Kerberos token to OpenAM through the Simple and Protected
    GSS-API Negotiation Mechanism (SPNEGO) protocol. The Windows Desktop SSO
    authentication module enables desktop single sign on such that a user who
    has already authenticated with a Kerberos Key Distribution Center can
    authenticate to OpenAM without having to provide the login information
    again. Users might need to set up Integrated Windows Authentication in
    Internet Explorer to benefit from single sign on when logged on to
    a Windows desktop.
   </p><p><span class="command"><strong>ssoadm</strong></span> service name:
   <code class="literal">iPlanetAMAuthWindowsDesktopSSOService</code></p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Service Principal</span></dt><dd><p>Specify the Kerberos principal for authentication in the following
      format.</p><pre class="literallayout">HTTP/<em class="replaceable"><code>host</code></em>.<em class="replaceable"><code>domain</code></em>@<em class="replaceable"><code>dc-domain-name</code></em></pre><p>Here, <em class="replaceable"><code>host</code></em> and
      <em class="replaceable"><code>domain</code></em> correspond to the host and domain names
      of the OpenAM instance, and <em class="replaceable"><code>dc-domain-name</code></em>
      is the domain name of the Windows Kerberos domain controller server.
      The <em class="replaceable"><code>dc-domain-name</code></em> can differ from the domain
      name for OpenAM.</p><p>You set up the account on the Windows domain controller, creating
      a computer account for OpenAM and associating the new account with a
      service provider name.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-windowsdesktopsso-principal-name</code></p></dd><dt><span class="term">Keytab File Name</span></dt><dd><p>Specify the full path of the keytab file for the Service Principal.
      You generate the keytab file using the Windows <span class="command"><strong>ktpass</strong></span>
      utility.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-windowsdesktopsso-keytab-file</code></p></dd><dt><span class="term">Kerberos Realm</span></dt><dd><p>Specify the Kerberos Key Distribution Center realm. For the
      Windows Kerberos service this is the domain controller server domain
      name.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-windowsdesktopsso-kerberos-realm</code></p></dd><dt><span class="term">Kerberos Server Name</span></dt><dd><p>Specify the fully qualified domain name of the Kerberos Key
      Distribution Center server, such as that of the domain controller
      server.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-windowsdesktopsso-kdc</code></p></dd><dt><span class="term">Return Principal with Domain Name</span></dt><dd><p>When enabled, OpenAM automatically returns the Kerberos principal
      with the domain controller's domain name during authentication.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-windowsdesktopsso-returnRealm</code></p></dd><dt><span class="term">Authentication Level</span></dt><dd><p>Sets the authentication level used to indicate the level of security
      associated with the module. The value can range from 0 to any positive integer.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-windowsdesktopsso-auth-level</code></p></dd><dt><span class="term">Search for the user in the realm</span></dt><dd><p>
      Validates the user against the configured data stores. If the user from the
      Kerberos token is not found, authentication will fail. If an authentication
      chain is set, the user is able to authenticate through another module.
      This search uses the <code class="literal">Alias Search Attribute Name</code> from
      the core realm attributes. See
      <a href="../admin-guide/index.html#auth-core-realm-attributes" class="link">
       <em class="citetitle">Core - Realm Attributes</em></a> for more information.
     </p><p><span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">iplanet-am-auth-windowsdesktopsso-lookupUserInRealm</code></p></dd></dl></div><div class="note"><h3 class="title">Note</h3><p>
     For Windows 7 and later, you will need to turn off the "Enable
     Integrated Windows Authentication" option in Internet Explorer. In addition, you
     will need to add and activate the DisableNTMLPreAuth key to the Windows Registry.
     For detailed instructions, see the Microsoft KB article on when
     <a class="link" href="http://support.microsoft.com/kb/251404" target="_blank"><em class="citetitle">You cannot post data
      to a non-NTLM-authenticated Web site</em></a>.
    </p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="winnt-module-conf-hints"></a>2.3.24.&nbsp;Hints for the Windows NT Authentication Module</h3></div></div></div><a class="indexterm" name="d16037e6376"></a><a class="indexterm" name="d16037e6381"></a><p>The Windows NT module lets OpenAM authenticate against a Microsoft
   Windows NT server.</p><p>This module requires that you install a Samba client in a 
   <code class="filename">bin</code> directory under the OpenAM configuration directory
   such as <code class="filename">$HOME/openam/openam/bin</code>.</p><p><span class="command"><strong>ssoadm</strong></span> service name:
   <code class="literal">iPlanetAMAuthNTService</code></p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Authentication Domain</span></dt><dd><p>Specify the Windows domain name to which users belong.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-nt-domain</code></p></dd><dt><span class="term">Authentication Host</span></dt><dd><p>Specify the NetBIOS name of the Windows NT host to which to
      authenticate users.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-nt-host</code></p></dd><dt><span class="term">Samba Configuration File Name</span></dt><dd><p>Specify the full path to the Samba configuration file.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-samba-config-file-name</code></p></dd><dt><span class="term">Authentication Level</span></dt><dd><p>Sets the authentication level used to indicate the level of security
      associated with the module. The value can range from 0 to any positive integer.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">iplanet-am-auth-nt-auth-level</code></p></dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="wss-module-conf-hints"></a>2.3.25.&nbsp;Hints for the WSSAuth Authentication Module</h3></div></div></div><a class="indexterm" name="d16037e6452"></a><a class="indexterm" name="d16037e6457"></a><p>The Web Service Security (WSSAuth) module lets OpenAM validate a
   user name, password combination received as an authentication token in
   a request from a Web Service Client to a Web Service Provider.</p><div lang="en" class="note"><h3 class="title">Note</h3><p>
  The current implementation of the WSSAuth Authentication module, along with
  the Web Service Provider, Web Service Client and STS Client Policy agents,
  were developed for versions 1.0 and 1.3 of the WS-Trust standard. ForgeRock
  now includes configuration options for the RESTful Security Token Service
  (STS), compatible with version 1.4 of the WS-Trust standard, which uses
  client certificate and Kerberos JASPI authentication modules.
 </p><p>
  For more information on the new implementation of STS, see
  <a href="../admin-guide/index.html#chap-rest-sts" class="link"><em class="citetitle">The RESTful Security
   Token Service</em></a>.
 </p></div><p><span class="command"><strong>ssoadm</strong></span> service name:
   <code class="literal">sunAMAuthWSSAuthModuleService</code></p><div class="variablelist"><dl class="variablelist"><dt><span class="term">User search attribute</span></dt><dd><p>Specify a user attribute to search for a user. Default is
      <code class="literal">uid</code>.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">sunWebservicesUserSearchAttribute</code></p></dd><dt><span class="term">User realm</span></dt><dd><p>Specify the realm to which users belong. For the OpenAM STS, this
       is <code class="literal">/</code>.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">sunWebServicesUserRealm</code></p></dd><dt><span class="term">User password attribute</span></dt><dd><p>Specify the password attribute or that of the password equivalent.
      The default is <code class="literal">userPassword</code>.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">sunWebservicesUserPasswordAttribute</code></p></dd><dt><span class="term">Authentication Level</span></dt><dd><p>Sets the authentication level used to indicate the level of security
      associated with the module. The value can range from 0 to any positive integer.</p><p><span class="command"><strong>ssoadm</strong></span> attribute:
      <code class="literal">sunWebservicesAuthenticationLevel</code></p></dd></dl></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="configure-authn-chains"></a>2.4.&nbsp;Configuring Authentication Chains</h2></div></div></div><a class="indexterm" name="d16037e6540"></a><p>Once you have configured authentication modules, and added the modules
  to the list of module instances, you can configure authentication chains.
  Authentication chains let you handle situations where alternative modules
  are needed, or where a single set of credentials is not sufficient.</p><div class="tip"><h3 class="title">Tip</h3><p>OpenAM provides a wizard for configuring authentication providers,
   including Facebook, Google and Microsoft. The wizard creates a
   relevant Authentication Chain as part of the process. For more
   information, see <a class="xref" href="#configure-social-authn" title="2.2.&nbsp;Configuring Social Authentication">Section&nbsp;2.2, &#8220;Configuring Social Authentication&#8221;</a>.
  </p></div><div class="procedure"><a name="create-authn-chain"></a><div class="procedure-title">Procedure&nbsp;2.4.&nbsp;To Create an Authentication Chain</div><ol class="procedure" type="1"><li class="step"><p>On the Access Control tab page of the OpenAM console, click the
    realm for which to create the authentication chain.</p></li><li class="step"><p>On the Authentication tab page for the realm, scroll to the bottom
    of the page, and click the New button in the Authentication Chaining
    table.</p></li><li class="step"><p>Give the new authentication chain a name, and add instances of the
    modules to use in the chain.</p></li><li class="step"><p>Assign appropriate criteria (optional, required, requisite, sufficient)
    as described above in <a class="xref" href="#what-is-authn" title="2.1.&nbsp;About Authentication in OpenAM">Section&nbsp;2.1, &#8220;About Authentication in OpenAM&#8221;</a>. You can also
    configure where OpenAM redirects the user upon successful and failed
    authentication, and plug in your post-authentication processing classes
    as necessary.</p></li><li class="step"><p>If you need modules in the chain to share user credentials, then set
    options for the module.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="option">iplanet-am-auth-shared-state-enabled</code></span></dt><dd><p>Set <code class="literal">iplanet-am-auth-shared-state-enabled=true</code>
       to allow subsequent modules in the authentication chain to use
       the credentials, such as user name and password, captured by this
       module. (Default: <code class="literal">true</code>)</p></dd><dt><span class="term"><code class="option">iplanet-am-auth-store-shared-state-enabled</code></span></dt><dd><p>Set <code class="literal">iplanet-am-auth-store-shared-state-enabled=true</code>
       to store the captured credentials. Shared state is cleared when the
       user successfully authenticates, quits the chain, or logs out.
       (Default: <code class="literal">false</code>)</p></dd><dt><span class="term"><code class="option">iplanet-am-auth-shared-state-behavior-pattern</code></span></dt><dd><p>Set <code class="literal">iplanet-am-auth-shared-state-behavior-pattern=tryFirstPass</code>
       (the default) to try authenticating with the captured password. If
       authentication fails, then OpenAM prompts the user for the credentials
       again.</p><p>Set <code class="literal">iplanet-am-auth-shared-state-behavior-pattern=useFirstPass</code>
       to authenticate with the captured password. If authentication fails,
       then the module fails.</p></dd></dl></div><p>For example, consider a chain with two modules sharing credentials
    according to the default settings. The first module in the chain has the
    option <code class="literal">iplanet-am-auth-shared-state-enabled=true</code>, and
    criteria <code class="literal">REQUIRED</code>. The second module in the chain has
    options <code class="literal">iplanet-am-auth-shared-state-enabled=true</code>,
    <code class="literal">iplanet-am-auth-shared-state-behavior-pattern=tryFirstPass</code>,
    and criteria <code class="literal">REQUIRED</code>. A successful authentication
    sequence happens as follows. The user enters her credentials for the first
    module, successfully authenticating. The first module shares the
    credentials with the second module, successfully authenticating the user
    without prompting again for her credentials, unless the credentials for
    the first module do not successfully authenticate here to the second
    module. Just be sure to separate the options with a space and not a comma.</p></li><li class="step"><p>Save your work.</p></li></ol></div><div class="procedure"><a name="set-default-authn-chain"></a><div class="procedure-title">Procedure&nbsp;2.5.&nbsp;To Select the Default Chain</div><p>Before you select the default chain for users, and especially for
   administrators, test the authentication chain first. For example,
   <code class="literal">http://openam.example.com:8080/openam/UI/Login?service=NewChain</code>.
   If you cannot log in, then go back and fix the authentication chain's
   configuration before making it the default.</p><ol class="procedure" type="1"><li class="step"><p>On the Access Control tab page of the OpenAM console, click the
    realm for which to set the default authentication chain.</p></li><li class="step"><p>If necessary, on the Authentication tab page for the realm, adjust
    the drop-down lists for Organization Authentication Configuration and
    Administrator Authentication Configuration to the appropriate
    authentication chains.</p><p>The Organization Authentication Configuration serves when users
    access <code class="literal">/openam/UI/Login</code>.</p><p>The Administrator Authentication Configuration serves when users
    access <code class="literal">/openam/console</code>.</p><p>You can set these independently to separate administrative login
    from user login. For example, you can change the default user chain, but
    leave the default administrator chain as is to avoid locking yourself
    out as administrator. By default, <code class="literal">amadmin</code> can login at
    <code class="literal">/openam/UI/Login</code>. You can change that for your
    deployment.</p></li><li class="step"><p>Save your work.</p></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="authn-post-auth-plugins"></a>2.5.&nbsp;Post Authentication Plugins</h2></div></div></div><a class="indexterm" name="d16037e6673"></a><p>Post authentication plugins include custom processing at the end of the
  authentication process, immediately before the subject is authenticated.
  Common uses of post authentication plugins include setting cookies and
  session variables. Post authentication plugins are often used in conjunction
  with policy agents. The post authentication plugin sets custom session
  properties, and then the policy agent injects the custom properties into the
  request header to the protected application.</p><p>In the OpenAM console, you add post authentication plugins to an
  authentication chain. Navigate to Access Control &gt; <em class="replaceable"><code>Realm
  Name</code></em> &gt; Authentication &gt; Authentication Chaining &gt;
  <em class="replaceable"><code>Auth Chain Name</code></em>. Scroll down to the Post Authentication
  Processing Class list.</p><div class="variablelist"><div class="variablelist-title">Standard Post Authentication Plugins</div><p>OpenAM provides some post authentication plugins as part of the
   standard product delivery.</p><dl class="variablelist"><dt><span class="term">Class name: <code class="literal">org.forgerock.openam.authentication.modules.adaptive.Adaptive</code></span></dt><dd><p>The adaptive authentication plugin serves to save cookies and profile
     attributes after successful authentication.</p><p>Add it to your authentication chains that use the adaptive
     authentication module configured to save cookies and profile
     attributes.</p></dd><dt><span class="term">Class name: <code class="literal">org.forgerock.openam.authentication.modules.oauth2.OAuth2PostAuthnPlugin</code></span></dt><dd><p>The OAuth 2.0 post authentication plugin builds a global logout URL
     used by <code class="filename">/oauth2c/OAuthLogout.jsp</code> after successful
     OAuth 2.0 client authentication. This logs the resource owner out
     with the OAuth 2.0 provider when logging out of OpenAM.</p><p>Before using this plugin, configure the OAuth 2.0 authentication
     module with the correct OAuth 2.0 Provider logout service URL, and set
     the Logout options to Log out or Prompt. This plugin cannot succeed unless
     those parameters are correctly set.</p><p>Sometimes OAuth 2.0 providers change their endpoints, including
     their logout URLs. When using a provider like Facebook, Google, or MSN
     make sure you are aware when they change their endpoint locations so that
     you can change your client configuration accordingly.</p></dd><dt><span class="term">Class name: <code class="literal">org.forgerock.openam.authentication.plugins.AccountExpirePlugin</code></span></dt><dd><p>The account expiration post authentication plugin sets an account
     expiration date after successful authentication. OpenAM uses this to
     prevent expired accounts from being used to authenticate.</p><p>The default of 30 days can be changed using the advanced OpenAM
     server property,
     <code class="literal">org.forgerock.openam.authentication.accountExpire.days</code>.</p></dd></dl></div><p>If necessary, you can also write your own custom post authentication
  plugin as described in the <em class="citetitle">Developer's Guide</em> chapter
  on <a href="../dev-guide/index.html#chap-post-auth" class="link"><em class="citetitle">Creating a Post
  Authentication Plugin</em></a>.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="authn-from-browser"></a>2.6.&nbsp;Authenticating To OpenAM</h2></div></div></div><a class="indexterm" name="d16037e6743"></a><p>This section explains how to connect to OpenAM for user authentication
  by adding parameters to the login URL when testing your configuration.</p><p>The base URL to authenticate to OpenAM points to
  <code class="literal">/UI/Login</code> under the deployment URL, such as
  <code class="literal">http://openam.example.com:8080/openam/UI/Login</code>.
  <a href="#ftn.d16037e6758" class="footnote" name="d16037e6758"><sup class="footnote">[4]</sup></a> You can, however, specify parameters in the query string
  of the URL to request a specific authentication configuration. For example,
  <code class="literal">http://openam.example.com:8080/openam/UI/Login?module=LDAP</code>
  requests that OpenAM use the LDAP authentication module.</p><div class="variablelist"><p>OpenAM accepts the following parameters in the query string. With
   the exception of <code class="literal">IDToken</code> parameters, use no more than
   one occurrence of each.</p><div class="note"><h3 class="title">Note</h3><p>The way you enter parameters depends on whether you are using the
   XUI or the classic UI. For example, if you want to request that OpenAM end the
   user's current session and start a new session in the classic UI, you might enter
   a URL similar to: <code class="literal">http://openam.example.com:8080/openam/UI/Login?locale=fr</code>.
   Alternatively, for the JavaScript-based XUI, the corresponding URL would be subtly different:
   <code class="literal">http://openam.example.com:8080/openam/XUI/#login/&amp;arg=newsession</code>.
   </p></div><dl class="variablelist"><dt><span class="term">arg=newsession</span></dt><dd><p>Request that OpenAM end the user's current session and start a
     new session.</p></dd><dt><span class="term">authlevel</span></dt><dd><p>Request that OpenAM authenticate the user using a module with at
     least the specified authentication level that you have configured.</p><p>As this parameter determines authentication module selection, do
     not use it with <code class="literal">module</code>, <code class="literal">service</code>,
     or <code class="literal">user</code>.</p></dd><dt><span class="term">ForceAuth</span></dt><dd><p>If <code class="literal">ForceAuth=true</code>, request that OpenAM force the
     user to authenticate even if she already has a valid session. On
     successful authentication, OpenAM updates the session token.</p></dd><dt><span class="term">goto</span></dt><dd><p>On successful authentication, or successful logout, request that
     OpenAM redirect the user to the specified location. Values must be
     URL encoded.</p></dd><dt><span class="term">gotoOnFail</span></dt><dd><p>On authentication failure, request that OpenAM redirect the user to
     the specified location. Values must be URL encoded.</p></dd><dt><span class="term">IDToken1, IDToken2, ..., IDTokenN</span></dt><dd><p>Pass the specified credentials as <code class="literal">IDToken</code>
     parameters in the URL. The <code class="literal">IDToken</code> credentials map
     to the fields in the login page for the authentication module, such as
     <code class="literal">IDToken1</code> as user ID and <code class="literal">IDToken2</code>
     as password for basic user name, password authentication. The order
     depends on the callbacks in login page for the module;
     <code class="literal">IDTokenN</code> represents the N<sup>th</sup>
     callback of the login page.</p></dd><dt><span class="term">iPSPCookie=yes</span></dt><dd><p>Applicable only if you configure persistent cookies based on
     <a class="xref" href="#auth-core-persistent-cookie" title="2.3.5.3.&nbsp;Core - Persistent Cookie (Legacy)">Section&nbsp;2.3.5.3, &#8220;Core - Persistent Cookie (Legacy)&#8221;</a></p><p>Request that OpenAM return a persistent cookie that remains in the
     browser after the browser is closed, allowing the user to login again
     without being prompted for credentials. This only works if you have
     configured persistent cookie mode for the realm where the user logs
     in.</p><p>OpenAM sets an <code class="literal">DProPCookie</code> that persists until
     expiry. The following screen shot shows an example.</p><div class="mediaobject" align="center"><a name="figure-persistent-dpropcookie"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/persistent-dpropcookie.png" align="middle" height="360" alt="DProPCookie shown in the browser"></td></tr></table></div><p>An alternative persistent cookie mechanism extends the lifetime of
     the normal <code class="literal">iPlanetDirectoryPro</code> using the advanced
     server settings, <code class="literal">openam.session.persist_am_cookie</code>
     or <code class="literal">openam.session.allow_persist_am_cookie</code>, and
     <code class="literal">com.iplanet.am.cookie.timeToLive</code>.</p><p>To set the mechanism globally for the server, browse in the OpenAM
     console to Configuration &gt; Servers and Sites &gt; <em class="replaceable"><code>Server
     Name</code></em> &gt; Advanced, and then set
     <code class="literal">openam.session.persist_am_cookie</code> to
     <code class="literal">true</code> and
     <code class="literal">com.iplanet.am.cookie.timeToLive</code> to the cookie lifetime
     in seconds.</p><p>To allow users to use this mechanism on a per-session basis,
     browse in the OpenAM console to Configuration &gt; Servers and
     Sites &gt; <em class="replaceable"><code>Server Name</code></em> &gt; Advanced, and then
     set <code class="literal">openam.session.allow_persist_am_cookie</code> to
     <code class="literal">true</code> and
     <code class="literal">com.iplanet.am.cookie.timeToLive</code> to the cookie lifetime
     in seconds. (If the OpenAM .war deployed does not include the console, set
     these properties in the .properties configuration file.) Also configure
     the session properties either globally under Configuration &gt; Global
     &gt; Session &gt; Dynamic Attributes, or per realm under Access Control
     &gt; <em class="replaceable"><code>Realm Name</code></em> &gt; Services &gt; Session.
     Then, to request the cookie, use
     <code class="literal">openam.session.persist_am_cookie=Yes</code> as one of the
     query string parameters in the login URL.</p><div class="note"><h3 class="title">Note</h3><p>
       Neither the XUI, Persistent Cookie module, distributed authentication
       service (DAS), nor cross-domain single sign-on (CDSSO) support the deprecated
       <code class="literal">iPSPCookie</code>. Similarly, DAS and CDSSO do not support
       <code class="literal">DProPCookie</code>.
      </p></div></dd><dt><span class="term">locale</span></dt><dd><p>Request that OpenAM display the user interface in the specified,
     supported locale. Locale can also be set in the user's profile, in
     the HTTP header from her browser, configured in OpenAM, and so on.</p></dd><dt><span class="term">module</span></dt><dd><p>Request that OpenAM use the authentication module instance as
     configured for the realm where the user is authenticating.</p><p>As this parameter determines authentication module selection, do
     not use it with <code class="literal">authlevel</code>, <code class="literal">service</code>,
     or <code class="literal">user</code>.</p></dd><dt><span class="term">realm</span></dt><dd><p>Request that OpenAM authenticate the user to the specified realm.</p></dd><dt><span class="term">service</span></dt><dd><p>Request that OpenAM authenticate the user with the specified
     authentication chain.</p><p>As this parameter determines authentication module selection, do
     not use it with <code class="literal">authlevel</code>, <code class="literal">module</code>,
     or <code class="literal">user</code>.</p></dd><dt><span class="term">user</span></dt><dd><p>Request that the user, specified by her OpenAM universal ID,
     authenticate according to the chain specified in her profile.</p><p>As this parameter determines authentication module selection, do
     not use it with <code class="literal">authlevel</code>, <code class="literal">module</code>,
     or <code class="literal">service</code>.</p></dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="session-upgrade"></a>2.7.&nbsp;Authentication Levels &amp; Session Upgrade</h2></div></div></div><a class="indexterm" name="d16037e6994"></a><p>
   As shown in <a class="xref" href="#configure-authn-modules" title="2.3.&nbsp;Configuring Authentication Modules">Section&nbsp;2.3, &#8220;Configuring Authentication Modules&#8221;</a>,
   authentication modules are configured with an authentication level.
   This configuration sets the level of security associated with the module,
   Stronger forms of authentication are assigned higher authentication levels.
   (Or lower authentication level numbers if the deployment defines
   stronger authentication with lower authentication level numbers.)
   Upon successful authentication, a user's session includes information
   about the authentication level achieved.
  </p><p>
   Authorization policies can require a particular authentication level
   for access to sensitive resources
   (or at most or at least a specified authentication level).
   When a user who is already authenticated in the realm
   tries to access a sensitive resource with a valid session
   but that does not have the requisite authentication level,
   OpenAM denies access to the resource.
   However, OpenAM also returns <em class="firstterm">advices</em>
   with the authorization decision.
   The advices indicate the need for the required authentication level.
   The policy agent or policy enforcement point can then
   send the user back to OpenAM for <em class="firstterm">session upgrade</em>.
  </p><p>
   During session upgrade the user authenticates
   with a stronger authentication module.
   The stronger module is typically part of the same authentication chain
   that handled the original authentication,
   though not required for access to less sensitive resources.
   Upon successful stronger authentication,
   the user session is upgraded to the new authentication level
   and modified to include any settings related to the stronger authentication.
  </p><p>
   If unsuccessful, session upgrade leaves the user session
   as it was before the attempt at stronger authentication.
   If session upgrade failed because the login page times out,
   OpenAM redirects the user's browser to the success URL
   from the last successful authentication.
  </p><p>
   OpenAM policy agents generally handle session upgrade
   without additional configuration,
   as policy agents are built to handle OpenAM's advices.
   If you build your own policy enforcement point (PEP), however,
   take advices and session upgrade into consideration.
   For RESTful PEPs, see the <em class="citetitle">Developer's Guide</em> sections,
   <a href="../dev-guide/index.html#rest-api-authz-policy-decisions" class="link"><em class="citetitle">Requesting Policy Decisions</em></a>
   and
   <a href="../dev-guide/index.html#rest-api-auth-json" class="link"><em class="citetitle">Authentication &amp; Logout</em></a>,
   for indications on how to handle advices and session upgrade.
  </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="configure-account-lockout"></a>2.8.&nbsp;Configuring Account Lockout</h2></div></div></div><a class="indexterm" name="d16037e7031"></a><div class="itemizedlist"><p>OpenAM supports two different approaches to <em class="firstterm">account
   lockout</em>, where OpenAM locks an account after repeated
   authentication failures. Lockout works with modules for which users
   can enter a password incorrectly.</p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Memory lockout locks the user account, keeping track of the locked
    state only in memory, and then unlocking the account after a specified
    delay. Memory lockout is also released when OpenAM restarts.</p></li><li class="listitem"><p>Persistent (physical) lockout sets the user account status to
    <code class="literal">inactive</code> in the user profile. For persistent lockout,
    OpenAM tracks failed authentication attempts by writing to the user
    repository.</p><p>Persistent account lockout works independently of account lockout
    mechanisms in the underlying directory server that serves as the user
    data store.</p></li></ul></div><div class="itemizedlist"><p>You configure account lockout by editing settings for the <a href="../admin-guide/index.html#core-module-conf-hints" class="link">core authentication
   module</a>. Access the settings in OpenAM console under Access Control
   &gt; <em class="replaceable"><code>Realm Name</code></em> &gt; Authentication &gt; All
   Core Settings..., and then scroll down to the Account Lockout section.
   The inline help explains the settings in detail.</p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Enable lockout by checking Login Failure Lockout Mode, setting
    the number of attempts, and setting the lockout interval and
    duration.</p><p>You can also opt to warn users after several consecutive failures,
    or to multiply the lockout duration on each successive lockout.</p></li><li class="listitem"><p>You can set up email notification upon lockout to an administrator
    if OpenAM is configured to send mail. (Configuration &gt; Servers and Sites &gt;
    Default Server Settings &gt; General &gt; Mail Server.)</p></li><li class="listitem"><p>For persistent lockout, OpenAM sets the value of the user's
    <code class="literal">inetuserstatus</code> profile attribute to
    <code class="literal">inactive</code>. You can also specify another attribute to
    update on lockout. You can further set a non-default attribute on which
    to store the number of failed authentication attempts. When you do store
    the number of failed attempts in the data store, other OpenAM servers
    accessing the user data store can also see the number.</p></li></ul></div><p>If you need to unlock a user's account, find the user under Access
  Control &gt; <em class="replaceable"><code>Realm Name</code></em> &gt; Subjects &gt; User,
  set the user's User Status to Active, and click Save.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="configure-session-quotas"></a>2.9.&nbsp;Configuring Session Quotas</h2></div></div></div><a class="indexterm" name="d16037e7087"></a><a class="indexterm" name="d16037e7092"></a><p>OpenAM lets you limit the number of active sessions for a user by
  setting session quotas. You also configure session quota exhaustion actions
  so that when a user goes beyond the session quota, OpenAM takes the
  appropriate action.</p><div class="important"><h3 class="title">Important</h3><p>To enforce session quotas across multiple servers in a site, configure
   session failover as described in the <em class="citetitle">Installation Guide</em>
   chapter, <a href="../install-guide/index.html#chap-session-failover" class="link"><em class="citetitle">Setting Up OpenAM
   Session Failover</em></a>.</p></div><div class="procedure"><a name="session-quotas-and-exhaustion-actions"></a><div class="procedure-title">Procedure&nbsp;2.6.&nbsp;To Configure Session Quotas &amp; Exhaustion Actions</div><p>The session quota applies to all sessions opened for the same
  user (as represented by the user's universal identifier).</p><ol class="procedure" type="1"><li class="step"><p>Log in to OpenAM Console as administrator, and then browse to
   Configuration &gt; Global &gt; Session.</p></li><li class="step"><p>Set Enable Quota Constraints to <code class="literal">ON</code>.</p></li><li class="step"><p>Set Resulting behavior if session quota exhausted.</p><div class="variablelist"><p>The following settings are available by default.</p><dl class="variablelist"><dt><span class="term"><code class="literal">DENY_ACCESS</code></span></dt><dd><p>Deny access, preventing the user from creating an additional
      session.</p></dd><dt><span class="term"><code class="literal">DESTROY_NEXT_EXPIRING</code></span></dt><dd><p>Remove the next session to expire, and create a new session for
      the user. The next session to expire is the session with the minimum
      time left until expiration.</p><p>This is the default setting.</p></dd><dt><span class="term"><code class="literal">DESTROY_OLDEST_SESSION</code></span></dt><dd><p>Remove the oldest session, and create a new session for the
      user.</p></dd><dt><span class="term"><code class="literal">DESTROY_OLD_SESSIONS</code></span></dt><dd><p>Remove all existing sessions, and create a new session for the
      user.</p></dd></dl></div><p>If none of these session quota exhaustion actions fit your deployment,
   you can implement a custom session quota exhaustion action. See the
   <em class="citetitle">Developer's Guide</em> chapter on <a href="../dev-guide/index.html#chap-custom-quota-exhaustion-action" class="link"><em class="citetitle">Customizing
   Session Quota Exhaustion Actions</em></a> for an example.</p></li><li class="step"><p>Set Active User Sessions to the session quota.</p><p>The default is 5 sessions.</p></li><li class="step"><p>Save your work.</p></li><li class="step"><p>If you have multiple servers but session failover is not configured,
   configure multi-server mode as described below.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>If you have only a single OpenAM server, skip this step. OpenAM
     enforces the session quota you set for the server.</p></li><li class="listitem"><p>If you have multiple servers with session failover configured, then
     also skip this step. In this case OpenAM uses the session store to enforce
     session quotas globally across your deployment. In other words when the
     Set Active User Sessions is 5, a user can have a maximum of 5 active
     sessions.</p></li><li class="listitem"><p>If you have multiple OpenAM servers but session failover is not
     configured, configure multi-server mode for session quotas. Browse to
     Configuration &gt; Servers and Sites &gt; Default Server Settings or
     Configuration &gt; Servers and Sites &gt; <em class="replaceable"><code>Server
     Name</code></em>, and then use the Advanced tab page to set the
     following advanced server property.</p><div class="literallayout"><p>openam.session.useLocalSessionsInMultiServerMode&nbsp;=&nbsp;true</p></div><p>When you set this property to <code class="literal">true</code> for your OpenAM
     servers, users can potentially reach the session quota for each individual
     server before all session quotas are exhausted. In other words if you have
     4 OpenAM servers and Set Active User Sessions is 5, then the user can have
     a maximum of 20 (5 * 4) sessions.</p></li></ul></div></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="configure-valid-goto-url-resources"></a>2.10.&nbsp;Configuring Valid goto URL Resources</h2></div></div></div><a class="indexterm" name="d16037e7201"></a><p>
   By default, OpenAM redirects the user to the URL specified in the
   <code class="literal">goto</code> and <code class="literal">gotoOnFail</code> query string parameters
   supplied to the authentication interface in the login URL.
   You can increase security against possible phishing attacks through open redirect
   by specifying a list of valid URL resources using the Valid
   <code class="literal">goto</code> URL Resource service.
  </p><p>
   OpenAM only redirects a user if the <code class="literal">goto</code> and
   <code class="literal">gotoOnFail</code> URL matches any of the resources specified in
   this setting.
   If no setting is present, it is assumed that the <code class="literal">goto</code> or
   <code class="literal">gotoOnFail</code> URL is valid.
  </p><p>
   The URL whitelisting and pattern matching follow the wildcard rules as specified in
   <span class="olink">
    <em class="citetitle">To Configure a Policy for a Web Site</em></span>.
   There is one main difference: when creating Applications, the URL pattern
   matching for <code class="literal">ApplicationTypes</code> is different from the way
   Applications are matched when creating policies.
  </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
     <span class="bold"><strong>Creating an Application</strong></span>.
     When creating an application, the default pattern is the asterisk ("*") wildcard.
     There is one exception: the default application,
     <code class="literal">iPlanetAMWebAgentService</code>,
     uses a different pattern matching rule: <code class="literal">*://*:*/*</code> and
     <code class="literal">*://*:*/*?*</code> as opposed to just <code class="literal">*</code>. This
     rule is specified due to the application resource expecting a URI.
    </p></li><li class="listitem"><p>
     <span class="bold"><strong>Creating a Policy</strong></span>.
     When creating a policy, any rule with a trailing asterisk ("*") matches anything,
     including a question mark ("?").
    </p></li></ul></div><p>
   Here are some general examples of URL pattern matching:
  </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
     If no port is specified, <code class="literal">http://www.example.com</code> canonicalizes
     to <code class="literal">http://www.example.com:80</code> and
     <code class="literal">https://www.example.com</code> canonicalizes
     to <code class="literal">http://www.example.com:443</code>.
    </p></li><li class="listitem"><p>
     A wildcard before "://" only matches up to "://"
    </p><p>
     For example, <code class="literal">http*://*.com/*</code> matches
     <code class="literal">http://www.example.com/hello/world</code> and
     <code class="literal">https://www.example.com/hello</code>.
    </p></li><li class="listitem"><p>
     A wildcard between "://" and ":" matches up to ":"
    </p><p>
     For example, <code class="literal">http://*:85</code> matches <code class="literal">http://www.example.com:85</code>.
    </p></li><li class="listitem"><p>
     A wildcard between ":" and "/" only matches up to the first "/"
    </p><p>
     For example, <code class="literal">http://www.*:*/</code> matches
     <code class="literal">http://www.example.com:80</code>.
     In another example, <code class="literal">http://www.example.com:*</code> matches
     <code class="literal">http://ww.example.com:[any port]</code>
     and <code class="literal">http://www.example.com:[any port]/</code> but nothing more.
    </p></li><li class="listitem"><p>
     A wildcard after "/" matches anything depending on whether it is single-level
     or a wildcard appropriately.
    </p><p>
     For example, <code class="literal">https://www.example.com/*</code> matches
     <code class="literal">https://www.example.com:443/foo/bar/baz/me</code>
    </p></li><li class="listitem"><p>
     If you do not use any wildcards, OpenAM exactly matches the string, so
     <code class="literal">http://www.example.com</code> only matches
     <code class="literal">http://www.example.com</code> but NOT <code class="literal">http://www.example.com/</code>
     (trailing slash).
    </p><p>
     If you put the wildcard after the path, OpenAM expects a path (even if it is blank),
     so <code class="literal">http://www.example.com/*</code> matches
     <code class="literal">http://www.example.com/</code>
     and <code class="literal">http://www.example.com/foo/bar/baz.html</code> but NOT
     <code class="literal">http://www.example.com</code>.
    </p></li><li class="listitem"><p>
     <code class="literal">http://www.example.com:*/</code> matches
     <code class="literal">http://www.example.com/</code>, which also canonicalizes to
     <code class="literal">http://www.example.com:80/</code>.
    </p></li><li class="listitem"><p>
     <code class="literal">https://www.example.com:*/</code> matches
     <code class="literal">https://www.example.com/</code>, which also canonicalizes to
     <code class="literal">https://www.example.com:443/</code>.
    </p></li></ul></div></div><div class="footnotes"><br><hr class="footnote-hr"><div id="ftn.d16037e653" class="footnote"><p><a href="#d16037e653" class="para"><sup class="para">[3] </sup></a>The four flags, required, optional, requisite, and sufficient, come from
  the standards created for the Java Authentication and Authorization Service
  (JAAS).</p></div><div id="ftn.d16037e6758" class="footnote"><p><a href="#d16037e6758" class="para"><sup class="para">[4] </sup></a>The base URL to logout is similar, for example
  <code class="literal">http://openam.example.com:8080/openam/UI/Logout</code>.</p></div></div></div><div lang="en" class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="chap-authz-policy"></a>Chapter&nbsp;3.&nbsp;Defining Authorization Policies</h1></div></div></div><div class="toc"><div class="toc-title">Table of Contents</div><dl class="toc"><dt><span class="section"><a href="#what-is-authz">3.1. About Authorization in OpenAM</a></span></dt><dt><span class="section"><a href="#policy-resolution">3.2. How OpenAM Reaches Policy Decisions</a></span></dt><dt><span class="section"><a href="#configure-authz-apps">3.3. Configuring Applications, Policies, and Referrals</a></span></dt><dt><span class="section"><a href="#delegate-policy">3.4. Delegating Policy Management</a></span></dt></dl></div><p>
  <em class="firstterm">Authorization</em> is determining
  whether to grant or to deny a user access to a resource.
  <em class="firstterm">Policies</em> define how to determine
  whether to grant or deny access.
  This chapter describes how to configure authorization policies in OpenAM.
 </p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="what-is-authz"></a>3.1.&nbsp;About Authorization in OpenAM</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="#what-is-authz-policies">3.1.1. OpenAM Policies and Applications</a></span></dt><dt><span class="section"><a href="#what-is-authz-decision">3.1.2. OpenAM Policy Decisions</a></span></dt><dt><span class="section"><a href="#what-is-authz-example">3.1.3. Example Authorization</a></span></dt></dl></div><a class="indexterm" name="d16037e7405"></a><p>
   Applications rely on OpenAM for access management,
   which breaks down into authentication,
   or determining who is trying to access a resource,
   and authorization,
   or determining whether to grant or deny access.
   This is because whether access is granted generally depends on
   what the policies about access are,
   who is trying to gain access,
   and perhaps some other conditions,
   such as whether the access itself needs to happen over a secure channel
   or what time of day it is.
  </p><p>
   To return to the international airport example
   from the discussion on authentication
   the policy might be that passengers with valid passports and visas
   presenting valid plane tickets
   are allowed through to the gate where the plane is waiting to take off,
   but only under the condition that the plane is going to leave soon.
   (You cannot expect to get to the gate today
   with a scheduled departure for three months from now.)
  </p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="what-is-authz-policies"></a>3.1.1.&nbsp;OpenAM Policies and Applications</h3></div></div></div><a class="indexterm" name="d16037e7415"></a><div class="variablelist"><p>
     To allow OpenAM to determine whether to grant access,
     you define authorization <em class="firstterm">policies</em>.
     A policy defines the following.
    </p><dl class="variablelist"><dt><span class="term"><em class="firstterm">resources</em></span></dt><dd><p>
       The resource definitions constrain which resources,
       such as web pages or access to the boarding area,
       the policy applies to.
      </p></dd><dt><span class="term"><em class="firstterm">actions</em></span></dt><dd><p>
       The actions are verbs that describe
       what the policy allows users to do to the resources,
       such as read a web page, submit a web form, or access the boarding area.
      </p></dd><dt><span class="term"><em class="firstterm">subject conditions</em></span></dt><dd><p>
       The subject conditions constrain who the policy applies to,
       such as all authenticated users, only administrators,
       or only passengers with valid tickets for planes leaving soon.
      </p></dd><dt><span class="term"><em class="firstterm">environment conditions</em></span></dt><dd><p>
       The environment conditions set
       the circumstances under which the policy applies,
       such as only during work hours,
       only when accessing from a specific IP address,
       or only when the flight is scheduled to leave within the next four hours.
      </p></dd><dt><span class="term"><em class="firstterm">response attributes</em></span></dt><dd><p>
       The response attributes define information
       that OpenAM attaches to a response following a policy decision,
       such as a name, email address, or frequent flyer status.
      </p></dd></dl></div><p>
    When queried about whether to let a user through to a protected resource,
    OpenAM decides to authorize access or not based on applicable policies
    as described below in <a class="xref" href="#what-is-authz-decision" title="3.1.2.&nbsp;OpenAM Policy Decisions">Section&nbsp;3.1.2, &#8220;OpenAM Policy Decisions&#8221;</a>.
    OpenAM communicates its decision to the application
    using OpenAM for access management.
    In the common case, this is a policy agent
    installed on the server where the application runs.
    The agent then enforces the authorization decision from OpenAM.
   </p><div class="mediaobject" align="center"><a name="figure-realm-app-policy-overview"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/realm-app-policy-overview.png" align="middle" height="360" alt="Shows the relationship between Realms, Applications and Policies, and how a policy agent requests authorization decisions from OpenAM."></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-realm-app-policy-overview.html" target="longdesc">D</a>]</span></div></div><p>
    To act as a template for the policies,
    OpenAM uses <em class="firstterm">applications</em>.
    An application can constrain the resources that its policies apply to.
    For example, an application for Example.com's HR service
    might constrain all policies to apply to resources under
    <code class="literal">http*://example.com/hr*</code> and
    <code class="literal">http*://example.com/hr*?*</code>.
    The list of applications is the first thing that you see
    when editing policies through OpenAM console.
    You create or select an application,
    and then configure the policies for that application.
   </p><p>
    Applications have associated types.
    The default application type that represents web resources
    is <code class="literal">iPlanetAMWebAgentService</code>,
    which defines resources as URL patterns and actions as HTTP methods.
    OpenAM policy agents use a default application type based on this type,
    which is called <code class="literal">iPlanetAMWebAgentService</code>.
    This is the application type for policies
    that you edit through OpenAM console.
    OpenAM supports other application types as well
    that you can manage over the policy REST APIs.
   </p><p>
    For applications that are not of type <code class="literal">iPlanetAmWebAgentService</code>,
    such as CREST applications, you must manage these applications over REST.
    OpenAM policy agents work with applications of type
    <code class="literal">iPlanetAmWebAgentService</code>, so your policy evaluation points (PEPs)
    should use the REST endpoints for policy decision requests.
   </p><div class="tip"><h3 class="title">Tip</h3><p>
     When you configure a policy agent,
     if the application for its policies is not named
     <code class="literal">iPlanetAMWebAgentService</code>,
     then you must edit the policy agent configuration,
     setting the application name to match your application.
    </p><p>
     The application you specify must exist in the evaluation realm
     that you specify for the policy agent.
    </p></div><p>
    When policies for an application are administered in multiple realms,
    you set up a <em class="firstterm">referral</em> between applications.
    When finding all policies that apply for a given request,
    OpenAM follows the referrals
    to locate the application's policies in other realms.
    This is useful, for example,
    when the same policy agents protect multiple applications.
    The OpenAM policy editor does allow you to manage referrals as well,
    though the referral editor is not enabled by default.
   </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="what-is-authz-decision"></a>3.1.2.&nbsp;OpenAM Policy Decisions</h3></div></div></div><p>
    OpenAM relies on policies to reach authorization decisions,
    such as whether to grant or to deny access to a resource.
    OpenAM acts as the <em class="firstterm">policy decision point</em> (PDP),
    whereas OpenAM policy agents act as
    <em class="firstterm">policy enforcement points</em> (PEP).
    In other words, a policy agent or other PEP takes responsibility only
    for enforcing a policy decision rendered by OpenAM.
    When you configured applications and their policies in OpenAM,
    you used OpenAM as a
    <em class="firstterm">policy administration point</em> (PAP).

   </p><p>
    Concretely speaking, when a PEP requests a policy decision from OpenAM
    it specifies the target resource(s),
    the application (default: <code class="literal">iPlanetAMWebAgentService</code>),
    and information about the subject and the environment.
    OpenAM as the PDP retrieves policies within the specified application
    that apply to the target resource(s).
    OpenAM then evaluates those policies to make a decision
    based on the conditions matching those of the subject and environment.
    When multiple policies apply for a particular resource,
    the default logic for combining decisions is that
    the first evaluation resulting in a decision to deny access
    takes precedence over all other evaluations.
    OpenAM only allows access if all applicable policies evaluate
    to a decision to allow access.
   </p><p>
    OpenAM communicates the policy decision to the PEP.
    The concrete decision,
    applying policy for a subject under the specified conditions,
    is called an <em class="firstterm">entitlement</em>.
   </p><p>
    The entitlement indicates the resource(s) it applies to,
    the actions permitted and denied for each resource,
    and optionally response attributes and <em class="firstterm">advice</em>.
   </p><p>
    When OpenAM denies a request due to a failed condition,
    OpenAM can send advice to the PEP,
    and the PEP can then take remedial action.
    For instance, suppose a user comes to a web site
    having authenticated with an email address and password,
    which is configured as authentication level 0.
    Had the user authenticated using a one-time password,
    the user would have had authentication level 1 in their session.
    Yet, because they have authentication level 0,
    they currently cannot access the desired page,
    as the policy governing access requires authentication level 1.
    OpenAM sends advice, prompting the PEP
    to have the user re-authenticate using a one-time password module,
    gaining authentication level 1,
    and thus having OpenAM grant access to the protected page.
   </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="what-is-authz-example"></a>3.1.3.&nbsp;Example Authorization</h3></div></div></div><p>
    Consider the case where OpenAM protects a user profile web page.
    An OpenAM policy agent installed in the web server
    intercepts client requests to enforce policy.
    The policy says that only authenticated users
    can access the page to view and to update their profiles.
   </p><p>
    When a user browses to the profile page,
    the OpenAM policy agent intercepts the request.
    The policy agent notices that the request is to access a protected resource,
    but the request is coming from a user who has not yet logged in
    and consequently has no authorization to visit the page.
    The policy agent therefore redirects the user's browser
    to OpenAM to authenticate.
   </p><p>
    OpenAM receives the redirected user,
    serving a login page that collects the user's email and password.
    With the email and password credentials,
    OpenAM authenticates the user, and creates a session for the user.
    OpenAM then redirects the user to the policy agent,
    which gets the policy decision from OpenAM for the page to access,
    and grants access to the page.
   </p><p>
    OpenAM and the policy agent use cookies set in the user's browser
    to share an opaque reference to the session with OpenAM.
    While the user has a valid session with OpenAM,
    the user can go away to another page in the browser,
    come back to the profile page,
    and gain access without having to enter their email and password again.
   </p><p>
    Notice how OpenAM and the policy agent handle the access in the example.
    The web site developer can offer a profile page,
    but the web site developer never has to manage login,
    or handle who can access a page.
    As OpenAM administrator, you can change
    authentication and authorization independently of updates to the web site.
    You might need to agree with web site developers
    on how OpenAM identifies users
    so web developers can identify users by their own names when they log in.
    By using OpenAM and policy agents for authentication and authorization,
    your organization no longer needs to update web applications
    when you want to add external access to your Intranet for roaming users,
    open some of your sites to partners,
    only let managers access certain pages of your HR web site,
    or allow users already logged in to their desktops to visit protected sites
    without having to type their credentials again.
   </p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="policy-resolution"></a>3.2.&nbsp;How OpenAM Reaches Policy Decisions</h2></div></div></div><p>OpenAM has to match policies to resources to take policy decisions.
  For a policy to match, the resource has to match one of the resource patterns
   defined in the policy. The user making the request has to match a subject.
   Furthermore, at least one condition for each condition type has to be
   satisfied.</p><p>If more than one policy matches, OpenAM has to reconcile differences.
  When multiple policies match, the order in which OpenAM uses them to make a
  policy decision is not deterministic. However, a deny decision overrides an
  allow decision, and so by default once OpenAM reaches a deny decision it
  stops checking further policies. (If you want OpenAM to continue checking
  despite the deny, see Configuration &gt; Global &gt; Policy Configuration
  &gt; Continue Evaluation on Deny Decision.)</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="configure-authz-apps"></a>3.3.&nbsp;Configuring Applications, Policies, and Referrals</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="#configure-apps-with-console">3.3.1. Configuring Applications by Using the OpenAM Console</a></span></dt><dt><span class="section"><a href="#configure-policies-with-console">3.3.2. Configuring Policies by Using the OpenAM Console</a></span></dt><dt><span class="section"><a href="#configure-referrals-with-console">3.3.3. Configuring Referrals by Using the OpenAM Console</a></span></dt><dt><span class="section"><a href="#policy-patterns-wildcards">3.3.4. Specifying Resource Patterns with Wildcards</a></span></dt><dt><span class="section"><a href="#script-policy">3.3.5. Importing and Exporting Policies</a></span></dt></dl></div><p>You can configure applications, policies and referrals by using the
   policy editor in the OpenAM console, by using the REST interface,
   or by using the <span class="command"><strong>ssoadm</strong></span> command.</p><p>This section explains how to use the OpenAM console to configure
   applications, policies and referrals to protect a web site or web
   application.</p><p>To configure applications and policies to protect
   other types of resource, you must use the REST API or
   the <span class="command"><strong>ssoadm</strong></span> command. For more information on the REST API,
   see the <em class="citetitle">Developer's Guide</em> chapters
   <a href="../dev-guide/index.html#rest-api-authz-applications" class="link">
    <em class="citetitle">Defining Applications</em></a> and
   <a href="../dev-guide/index.html#rest-api-authz-policies" class="link">
    <em class="citetitle">Managing Policies</em></a>. For more
   information on the <span class="command"><strong>ssoadm</strong></span> command,
   see the <em class="citetitle">OpenAM Reference Guide</em> chapter
   <a href="../reference/index.html#ssoadm-1" class="link">
    <em class="citetitle">ssoadm</em></a>.</p><div lang="en" class="section"><div class="titlepage"><div><div><h3 class="title"><a name="configure-apps-with-console"></a>3.3.1.&nbsp;Configuring Applications by Using the OpenAM Console</h3></div></div></div><a class="indexterm" name="d16037e7608"></a><p>This section describes the process of creating applications, which are
     used as templates for policies protecting a web site or web application,
     using the OpenAM console.</p><div class="procedure"><a name="create-app-xui"></a><div class="procedure-title">Procedure&nbsp;3.1.&nbsp;To Configure an Application by Using the Policy Editor</div><ol class="procedure" type="1"><li class="step"><p>In the OpenAM console, select Access Control &gt; <em class="replaceable"><code>Realm
            Name</code></em> &gt; Policies.</p><ol type="a" class="substeps"><li class="step"><p>To create a new application, click Add New
                Application.</p></li><li class="step"><p>To modify an existing application, in the row
               containing the application, click the Edit
               Application icon.</p></li><li class="step"><p>To discard any changes and return to the previous page,
              click Cancel.</p></li></ol></li><li class="step"><p>Provide a name for the application, and optionally a
             description, and then click Next.
            </p><p>
             Do not use special characters within policy, application or referral names
             (for example, "my+referral") using the Policy Editor or REST endpoints as
             OpenAM returns a 400 Bad Request error.
             The special characters are: double quotes ("), plus sign (+), comma (,),
             less than (&lt;), equals (=), greater than (&gt;), backslash (\), and
             null (\u0000).
            </p></li><li class="step"><p>Define resource patterns that policies within this
      application use as the basis for their rules, by following the steps
      below:</p><ol type="a" class="substeps"><li class="step"><p>In the Available patterns section, click
             the row containing an asterisk (<code class="literal">*</code>) to move the
             pattern to the Create your resources section.</p><div class="mediaobject" align="center"><a name="figure-resource-patterns-step1"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="./images/resource-pattern-templates-step1.png" align="middle" height="360" alt="Move available starter patterns to the right of the screen to configure the resource patterns that policies in this application use."></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-resource-patterns-step1.html" target="longdesc">D</a>]</span></div></div></li><li class="step"><p>Optionally, in the Create your resources section, replace the
             asterisk with a pattern that the policies in the application use as
             a template for specifying resources.</p><div class="mediaobject" align="center"><a name="figure-resource-patterns-step2"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/resource-pattern-templates-step2.png" align="middle" height="360" alt="Create resource patterns, with optional wildcards, that policies in this application use."></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-resource-patterns-step2.html" target="longdesc">D</a>]</span></div></div><p>For information on specifying patterns that the
          policies use for matching resources, see
          <a href="../admin-guide/index.html#policy-patterns-wildcards" class="link">
           <em class="citetitle">Specifying Resource Patterns with Wildcards</em></a>.</p></li><li class="step"><p>Click the Add icon to move the pattern into
         the Resources section.</p><div class="mediaobject" align="center"><a name="figure-resource-patterns-step3"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/resource-pattern-templates-step3.png" align="middle" height="360" alt="Add the completed resource template to the Resources section by clicking the Add icon."></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-resource-patterns-step3.html" target="longdesc">D</a>]</span></div></div></li></ol><div class="tip"><h3 class="title">Tip</h3><p>To remove a resource pattern,
       click the Delete icon.</p></div><p>Repeat these steps to add all the resource patterns your
            policies may require, and then click Next.</p></li><li class="step"><p>Review your configuration.</p><div class="tip"><h3 class="title">Tip</h3><p>If the configuration is not visible, click the maximized
             link to switch to maximized view.</p></div><p>To make changes to the configuration, either click the step in
            the list, or click the item to amend in the Review
           Configuration and Finish section to jump to the relevant
          step, and make your changes.</p><p>When the configuration is complete,
             click Finish.</p></li></ol></div><div class="itemizedlist"><p>
    To make use of the new application and any policies it contains,
    you must perform one of the following procedures:
   </p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Configure a policy agent to use the application for
     policy decisions.
    </p><p>
     For details see the procedure
     <a href="../admin-guide/index.html#agent-realm-application-for-policy-decisions" class="link"><em class="citetitle">To Specify the Realm and Application for Policy Decisions</em></a>.
    </p></li><li class="listitem"><p>
     Create a referral to the realm the application is in.
    </p><p>
     For details see the procedure
     <a href="../admin-guide/index.html#create-referral-xui" class="link"><em class="citetitle">To Enable Referrals in the Policy Editor</em></a>.
    </p></li></ul></div></div><div lang="en" class="section"><div class="titlepage"><div><div><h3 class="title"><a name="configure-policies-with-console"></a>3.3.2.&nbsp;Configuring Policies by Using the OpenAM Console</h3></div></div></div><p>This section describes the process of configuring policies to
     protect a web site or web application by using the OpenAM console.</p><div class="procedure"><a name="create-policy-xui"></a><div class="procedure-title">Procedure&nbsp;3.2.&nbsp;To Configure a Policy by Using the OpenAM Console</div><a class="indexterm" name="d16037e7731"></a><a class="indexterm" name="d16037e7736"></a><ol class="procedure" type="1"><li class="step"><p>In the OpenAM console, select Access Control &gt; <em class="replaceable"><code>Realm
    Name</code></em> &gt; Policies, and then click the name of the
    application to configure a policy in.</p><ol type="a" class="substeps"><li class="step"><p>To create a new policy, click Add New Policy.</p></li><li class="step"><p>To modify an existing policy, click the name of the
    policy.</p></li><li class="step"><p>To discard any changes and return to the previous page,
    click Cancel.</p></li></ol></li><li class="step"><p>Provide a name for the policy, and optionally a
    description, and then click Next.
   </p><p>
    Do not use special characters within policy, application or referral names
    (for example, "my+referral") using the Policy Editor or REST endpoints as
    OpenAM returns a 400 Bad Request error.
    The special characters are: double quotes ("), plus sign (+), comma (,),
    less than (&lt;), equals (=), greater than (&gt;), backslash (\), and
    null (\u0000).
   </p></li><li class="step"><p>To define resources that the policy applies to,
    follow the steps below:</p><ol type="a" class="substeps"><li class="step"><p>In the Available patterns section, click the
      row containing the pattern to use as the template for a resource pattern
      to move it to the Create your resources section.</p><div class="mediaobject" align="center"><a name="figure-resource-patterns-policies-step1"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/resource-pattern-step1.png" align="middle" height="360" alt="Modify the resource patterns to specify the resources the policy applies to."></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-resource-patterns-policies-step1.html" target="longdesc">D</a>]</span></div></div></li><li class="step"><p>Optionally, in the Create your resources
      section, replace the asterisks with values to define the resources
      that the policy applies to.</p><div class="mediaobject" align="center"><a name="figure-resource-patterns-policies-step2"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/resource-pattern-step2.png" align="middle" height="360" alt="Edit the resource pattern if required."></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-resource-patterns-policies-step2.html" target="longdesc">D</a>]</span></div></div><p>For information on specifying patterns for matching resources, see
      <a href="../admin-guide/index.html#policy-patterns-wildcards" class="link">
    <em class="citetitle">Specifying Resource Patterns with Wildcards</em></a>.</p></li><li class="step"><p>Click the Add icon to move the resource into
      the Resources section.</p><div class="mediaobject" align="center"><a name="figure-resource-patterns-policies-step3"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/resource-pattern-step3.png" align="middle" height="360" alt="Add the completed resource to the Resources section by clicking the Add icon."></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-resource-patterns-policies-step3.html" target="longdesc">D</a>]</span></div></div></li></ol><div class="tip"><h3 class="title">Tip</h3><p>To remove a resource pattern,
    click the Delete icon.</p></div><p>Repeat these steps to add all the resources your
    policy applies to,  and then click Next.</p></li><li class="step"><p>
    Select the HTTP 1.1 methods that the policy applies to, and whether to
    <code class="literal">Allow</code> or <code class="literal">Deny</code> those methods on the
    resources specified earlier, and then click Next.</p><p>For more information on HTTP 1.1 methods, see <a class="link" href="https://tools.ietf.org/html/rfc2616#section-9" target="_blank"><em class="citetitle">Method Definitions</em></a> and <a class="link" href="https://tools.ietf.org/html/rfc5789" target="_blank"><em class="citetitle">PATCH Method for HTTP</em></a>.</p></li><li class="step"><p>Define conditions in the OpenAM console
      by combining logical operators with blocks of configured
      parameters to create a rule set that the policy uses to filter
      requests for resources. You can nest logical operators at multiple
      levels to create complex rule sets.</p><p>To define the subjects that the policy applies to,
      complete the following steps:</p><ol type="a" class="substeps"><li class="step"><p>To add a subject condition, click the Subject
        Condition button, choose the type from
        the drop-down menu, specify any required
        Subject Values, and then drag the block into a
        drop-point in a logical block above.</p><div class="tip"><h3 class="title">Tip</h3><p>Valid drop-points in which to drop a block are displayed with
        a striped horizontal bar.</p><div class="mediaobject" align="center"><a name="policy-editor-valid-drop-points"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/policy-editor-valid-drop-points.png" align="middle" height="360" alt="Valid drop-points to drop a block are shown with a striped horizontal band."></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="policy-editor-valid-drop-points.html" target="longdesc">D</a>]</span></div></div></div><p>The available Subject Condition Types are:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Authenticated Users</span></dt><dd><p>Any user that has successfully authenticated with OpenAM.</p></dd><dt><span class="term">Users &amp; Groups</span></dt><dd><p>A user or group as defined in the Subjects tab of the
           realm the policy is created in.</p><p>Select one or more users or groups from the
           Subject Values drop-down menu, which displays
           the subjects available within the realm.</p><p>To remove an entry, click the value,
           and then press <span class="keycap"><strong>Delete</strong></span> (Windows/GNU/Linux)
           or <span class="keycap"><strong>Backspace</strong></span> (Mac OS X).</p></dd><dt><span class="term">Jwt Claim</span></dt><dd><p>Validate a claim within a JSON Web Token (JWT).</p><p>Type the name of the claim to validate in
           Claim Name, for example <code class="literal">sub</code>,
           and the required value in Claim Value,
           for example <code class="literal">UserA</code>.</p><div class="note"><h3 class="title">Note</h3><p>This condition type only supports string
           equality comparisons, and is case-sensitive.</p></div></dd><dt><span class="term">Never Match</span></dt><dd><p>
           Never match any subject, with the result not that access is denied,
           but instead that the policy itself does not match
           and therefore cannot be evaluated in order to allow access.
          </p><p>
           If you do not set a subject condition, "Never Match" is the default.
           In other words,
           you must set a subject condition for the policy to apply.
          </p><p>
           To match regardless of the subject, configure a subject condition
           that is <code class="literal">NOT</code> "Never Match".
          </p></dd></dl></div></li><li class="step"><p>To add a logical operator, click the Logical
       button, choose between <code class="literal">AND</code>, <code class="literal">NOT</code>,
       and <code class="literal">OR</code> from the drop-down menu,
       and then drag the block into a valid drop point in the rule set
       above.</p></li><li class="step"><p>Continue combining logical operators and subject
       conditions, and then click Next.</p></li></ol></li><li class="step"><p>To configure environment conditions in the policy,
   complete the following steps:</p><ol type="a" class="substeps"><li class="step"><p>To add an environment condition, click the Environment Condition
        button, choose the type from the drop-down menu,
        specify any required parameters, and then drag the block into a
        drop-point in a logical block above.</p><div class="tip"><h3 class="title">Tip</h3><p>Valid drop-points in which to drop a block are displayed with
        a striped horizontal bar.</p><div class="mediaobject" align="center"><a name="policy-editor-valid-drop-points-environment"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/policy-editor-valid-drop-points.png" align="middle" height="360" alt="Valid drop-points to drop a block are shown with a striped horizontal band."></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="policy-editor-valid-drop-points-environment.html" target="longdesc">D</a>]</span></div></div></div><p>The available environment condition types are:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Active Session Time</span></dt><dd><p>Make the policy depend on how long the user's session has been
           active, as specified in Max Session Time. To
           terminate the session if it has been active for longer than the
           specified time, set Terminate Sessions to
           <code class="literal">True</code>. The user will need to re-authenticate.</p></dd><dt><span class="term">Authentication by Module Chain</span></dt><dd><p>Make the policy depend on the service that was used to
           authenticate the user.</p></dd><dt><span class="term">Authentication by Module Instance</span></dt><dd><p>Make the policy depend on the authentication
           module used to authenticate, specified in Authentication
            Scheme. Specify a timeout for
           application authentication in Application Idle
            Timeout Scheme and the name of the application in
           Application Name.</p></dd><dt><span class="term">Authentication Level (greater than or equal to)</span></dt><dd><p>Make the policy depend on the minimum acceptable authentication
           level specified in Authentication Level.</p></dd><dt><span class="term">Authentication to a Realm</span></dt><dd><p>Make the policy depend on the realm to which the user
           authenticated.</p></dd><dt><span class="term">Current Session Properties</span></dt><dd><p>Make the policy depend on properties set in the user's session.</p><p>Type the value to search for in Properties,
           and set Ignore Value Case to <code class="literal">True</code>
           to make the search case-insensitive.</p></dd><dt><span class="term">Identity Membership</span></dt><dd><p>Make the policy apply if the UUID of the invocator is a member
           of at least one of the AMIdentity objects specified in AM
            Identity Name.</p><p>Often used to filter requests on the identity of a
           Web Service Client (WSC).</p></dd><dt><span class="term">IPv4 Address/DNS Name</span></dt><dd><p>Make the policy depend on the IP version 4 address that
           the request originated from.</p><div class="note"><h3 class="title">Note</h3><p>The IP address is taken from the
           <code class="literal">requestIp</code> value of policy decision requests. If
           this is not provided, the IP address stored in the SSO token is
           used instead.</p></div><p>
          Specify a range of addresses to test against by
           entering four sets of up to three digits, separated by full stops
           (<span class="keycap"><strong>.</strong></span>) in both Start IP and
           End IP.</p><div class="note"><h3 class="title">Note</h3><p>If only one of these values is provided, it is used as a
           single IP address to match.</p></div><p>Optionally, specify a DNS name in DNS Name to filter requests to
           that domain.</p></dd><dt><span class="term">IPv6 Address/DNS Name</span></dt><dd><p>Make the policy depend on the IP version 6 address that
           the request originated from.</p><div class="note"><h3 class="title">Note</h3><p>The IP address is taken from the
           <code class="literal">requestIp</code> value of policy decision requests. If
           this is not provided, the IP address stored in the SSO token is
           used instead.</p></div><p>Specify a range of addresses to test against by entering eight
           sets of four hexadecimal characters, separated by a colon
           (<span class="keycap"><strong>:</strong></span>) in both Start IP and
           End IP.</p><div class="note"><h3 class="title">Note</h3><p>If only one of these values is provided, it is used as a
           single IP address to match.</p></div><p>Optionally, specify a DNS name in
          DNS Name to filter requests to those coming
           from the specified domain.</p><div class="tip"><h3 class="title">Tip</h3><p>Use an asterisk (<span class="keycap"><strong>*</strong></span>) in the DNS
           name to match multiple subdomains. For example
           <code class="literal">*.example.com</code> applies to requests coming from
           <code class="literal">www.example.com</code>, <code class="literal">secure.example.com</code>,
           or any other subdomain of <code class="literal">example.com</code>.</p></div></dd><dt><span class="term">LDAP Filter Condition</span></dt><dd><p>Make the policy depend on whether
           the user's entry can be found using the LDAP search filter you specify
           in the directory configured for the policy service, which by default
           is the identity repository. See Configuration &gt; Global &gt; Policy
           Configuration &gt; Realm Attributes &gt; Primary LDAP Server.</p><p>Alternatively you can set this for the realm under Access Control
           &gt; <em class="replaceable"><code>Realm Name</code></em> &gt; Services &gt; Policy
           Configuration.</p></dd><dt><span class="term">OAuth2 Scope</span></dt><dd><p>
           Make the policy depend on whether an authorization request
           includes all of the specified OAuth 2.0 scopes.
          </p><p>
           Scope names must follow OAuth 2.0 scope syntax described in RFC 6749,
           <a class="link" href="https://tools.ietf.org/html/rfc6749#section-3.3" target="_blank"><em class="citetitle">Access Token Scope</em></a>.
           As described in that section,
           separate multiple scope strings with spaces,
           such as <code class="literal">openid profile</code>.
          </p><p>
           The scope strings match regardless of order in which they occur,
           so <code class="literal">openid profile</code>
           is equivalent to <code class="literal">profile openid</code>.
          </p><p>
           The condition is also met when additional scope strings are provided
           beyond those required to match the specified list.
           For example,
           if the condition specifies <code class="literal">openid profile</code>,
           then <code class="literal">openid profile email</code> also matches.
          </p></dd><dt><span class="term">Resource/Environment/IP Address</span></dt><dd><p>Make the policy apply to a complex condition such as whether the
           user is making a request from the localhost and has also authenticated
           with the LDAP authentication module.</p><p>Entries must take the form of an
           <code class="literal">IF...ELSE</code> statement. The <code class="literal">IF</code> statement can specify either
           <code class="literal">IP</code> to match the user's IP address, or
           <code class="literal">dnsName</code> to match their DNS name.</p><p>If the <code class="literal">IF</code> statement is true,
           the <code class="literal">THEN</code> statement must also be true for the
           condition to be fulfilled. If not, relevant advice is returned in the
           policy evaluation request.</p><p>The available parameters for the
           <code class="literal">THEN</code> statement are as follows:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">module</code></span></dt><dd><p>The module that was used to authenticate the user, for
               example <code class="literal">DataStore</code>.</p></dd><dt><span class="term"><code class="literal">service</code></span></dt><dd><p>The service that was used to authenticate the user.</p></dd><dt><span class="term"><code class="literal">authlevel</code></span></dt><dd><p>The minimum required authentication level.</p></dd><dt><span class="term"><code class="literal">role</code></span></dt><dd><p>The role of the authenticated user.</p></dd><dt><span class="term"><code class="literal">user</code></span></dt><dd><p>The name of the authenticated user.</p></dd><dt><span class="term"><code class="literal">redirectURL</code></span></dt><dd><p>The URL the user was redirected from.</p></dd><dt><span class="term"><code class="literal">realm</code></span></dt><dd><p>The realm that was used to authenticate the user.</p></dd></dl></div><p>The IP address can be IPv4, IPv6, or a hybrid of the two.</p><p>Example:
           <code class="literal">IF IP=[127.0.0.1] THEN role=admins</code>.</p></dd><dt><span class="term">Time (day, date, time, and timezone)</span></dt><dd><p>Make the policy depend on when the policy is evaluated.</p><p>The values for day, date and time must be set in pairs,
           a start and an end. Incomplete pairings are highlighted
           in red.</p><div class="mediaobject" align="center"><a name="policy-editor-mismatched-time-pairs"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/policy-editor-mismatched-time-pairs.png" align="middle" height="360" alt="Missing values are highlighted in red."></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="policy-editor-mismatched-time-pairs.html" target="longdesc">D</a>]</span></div></div></dd></dl></div></li><li class="step"><p>To add a logical operator, click the Logical
    button, choose between <code class="literal">AND</code>, <code class="literal">NOT</code>,
    and <code class="literal">OR</code> from the drop-down menu,
    and then drag the block into a valid drop point in the rule set
    above.</p></li><li class="step"><p>Continue combining logical operators and environment
     conditions, and when finished, click Next.</p></li></ol></li><li class="step"><p>Add policy response attributes, retrieved from the user entry in the
    identity repository, into the headers of the request at policy decision time.
    The policy agent for the protected resources/applications or the protected resources/applications themselves
    retrieve the policy response attributes to customize or personalize the application.
    Policy response attributes come in two formats: subject
    attributes and static attributes.
   </p><ol type="a" class="substeps"><li class="step"><p>To add subject attributes, click an empty space in the Subject
      attributes field, and select the subject attribute to add to the
      response.</p><p>To remove an entry, click the value,
      and then press <span class="keycap"><strong>Delete</strong></span> (Windows/GNU/Linux) or
      <span class="keycap"><strong>Backspace</strong></span> (Mac OS X)</p></li><li class="step"><p>To add a static attribute, type in a Key and a Value in the fields,
      and then click the Add icon.
     </p><p>To remove an entry, click the Delete icon in
      the row containing the Key: Value pair.</p></li><li class="step"><p>Continue adding subject and static attributes,
      and when finished, click Next.</p></li></ol></li><li class="step"><p>Review your configuration.</p><div class="tip"><h3 class="title">Tip</h3><p>If the configuration is not visible, click the maximized
    link to switch to maximized view.</p></div><p>To make changes to the configuration, either click the relevant step,
    or click the item to jump to the relevant step and make amendments to
    the configuration.</p><p>When the configuration is completed, click Finish.</p></li></ol></div></div><div lang="en" class="section"><div class="titlepage"><div><div><h3 class="title"><a name="configure-referrals-with-console"></a>3.3.3.&nbsp;Configuring Referrals by Using the OpenAM Console</h3></div></div></div><p>This section describes the process of creating referrals within an
     application by using the OpenAM Console.</p><p>By default, referrals are not displayed in the policy editor
  within the OpenAM console.</p><div class="procedure"><a name="enable-referrals-xui"></a><div class="procedure-title">Procedure&nbsp;3.3.&nbsp;To Enable Referrals in the Policy Editor</div><a class="indexterm" name="d16037e8265"></a><ul class="procedure"><li class="step"><p>In the OpenAM console, select Configuration &gt; Global &gt; Policy
   Configuration, set Activate Referrals to
   <code class="literal">Enabled</code>, and then click Save.</p></li></ul></div><p>Referrals enable applications and policies to exist in
  different realms, and redirect incoming authorization requests to those
  realms.</p><div class="procedure"><a name="create-referral-xui"></a><div class="procedure-title">Procedure&nbsp;3.4.&nbsp;To Configure Referrals by Using the Policy Editor</div><a class="indexterm" name="d16037e8281"></a><ol class="procedure" type="1"><li class="step"><p>In the OpenAM console, select Access Control &gt; <em class="replaceable"><code>Realm
    Name</code></em> &gt; Policies, and then click the name of the
    application to create a referral in.</p><ol type="a" class="substeps"><li class="step"><p>To create a new referral, click Add New Referral.</p></li><li class="step"><p>To modify an existing referral, click the name of the
     referral.</p></li><li class="step"><p>To discard any changes and return to the previous page,
     click Cancel.</p></li></ol></li><li class="step"><p>Provide a name for the referral, and then click Next.</p><p>
    Do not use special characters within policy, application or referral names
    (for example, "my+referral") using the Policy Editor or REST endpoints as
    OpenAM returns a 400 Bad Request error.
    The special characters are: double quotes ("), plus sign (+), comma (,),
    less than (&lt;), equals (=), greater than (&gt;), backslash (\), and
    null (\u0000).
   </p></li><li class="step"><p>To define resources that the referral applies to,
    follow the steps below:</p><ol type="a" class="substeps"><li class="step"><p>In the Available patterns section, click the
      row containing the pattern to use as the template for a resource pattern
      to move it to the Create your resources section.</p><div class="mediaobject" align="center"><a name="figure-resource-patterns-referrals-step1"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/resource-pattern-step1.png" align="middle" height="360" alt="Modify the resource patterns to specify the resources the policy applies to."></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-resource-patterns-referrals-step1.html" target="longdesc">D</a>]</span></div></div></li><li class="step"><p>Optionally, in the Create your resources section, replace the
      asterisks with values to define the resources that the referral applies
      to.</p><div class="mediaobject" align="center"><a name="figure-resource-referrals-step2"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/resource-pattern-step2.png" align="middle" height="360" alt="Edit the resource pattern if required."></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-resource-referrals-step2.html" target="longdesc">D</a>]</span></div></div><p>For information on specifying patterns for matching resources, see
      <a href="../admin-guide/index.html#policy-patterns-wildcards" class="link">
       <em class="citetitle">Specifying Resource Patterns with Wildcards</em>
      </a>.</p></li><li class="step"><p>Click the Add icon to move the resource into the Resources
      section.</p><div class="mediaobject" align="center"><a name="figure-resource-referrals-step3"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/resource-pattern-step3.png" align="middle" height="360" alt="Add the completed resource to the Resources section by clicking the Add icon."></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-resource-referrals-step3.html" target="longdesc">D</a>]</span></div></div></li></ol><div class="tip"><h3 class="title">Tip</h3><p>To remove a resource, click the Delete icon.</p></div><p>Repeat these steps to add all the resources your
    referral applies to,  and then click Next.</p></li><li class="step"><p>
    In the Available realms drop-down, select a realm to which the
    referral redirects requests, and then click the Add icon. You can add
    multiple target realms.</p><div class="note"><h3 class="title">Note</h3><p>A referral can only redirect requests to a child,
    or sibling of the realm it is created in. The Available
     realms drop-down only displays valid realms.</p></div><p>To remove an entry, click the Delete icon in the
    row containing the realm to remove.</p></li><li class="step"><p>Review your configuration.</p><div class="tip"><h3 class="title">Tip</h3><p>If the configuration is not visible, click the maximized
    link to switch to maximized view.</p></div><p>To make changes to the configuration, either click the relevant step,
    or click the item to jump to the relevant step and make amendments to
    the configuration.</p><p>When the configuration is completed, click Finish.</p></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="policy-patterns-wildcards"></a>3.3.4.&nbsp;Specifying Resource Patterns with Wildcards</h3></div></div></div><div lang="en" class="itemizedlist"><p>
  Resource patterns can specify an individual URL or resource name to protect.
  Alternatively, a resource pattern can match URLs or resource names by using
  wildcards.
 </p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
   The wildcards you can use are <code class="literal">*</code> and <code class="literal">-*-</code>.
  </p><p>
   These wildcards can be used throughout resource patterns
   to match URLs or resource names.
   For a resource pattern used to match URLs, wildcards can be employed to match
   the scheme, host, port, path, and query string of the resource.
  </p></li><li class="listitem"><p>
   The wildcard <code class="literal">*</code> matches multiple levels in a path.
  </p><p>
   For example, <code class="literal">http://www.example.com/*</code> matches
   <code class="literal">http://www.example.com/</code>,
   <code class="literal">http://www.example.com/index.html</code>, and also
   <code class="literal">http://www.example.com/company/images/logo.png</code>.
  </p></li><li class="listitem"><p>
   The wildcard <code class="literal">-*-</code> matches a single level in a path.
  </p><p>
   For example, <code class="literal">http://www.example.com/-*-</code> matches
   <code class="literal">http://www.example.com/index.html</code> but does not match
   <code class="literal">http://www.example.com/company/images/logo.png</code>.
  </p></li><li class="listitem"><p>
   Wildcards do not match <code class="literal">?</code>.
   You must explicitly add patterns to match URLs with query strings.
  </p><p>
   When used at the end of a pattern after a <code class="literal">?</code> character,
   <code class="literal">*</code> matches one or more characters,
   not zero or more characters.
  </p><p>
   For example, <code class="literal">http://www.example.com/*?*</code> matches
   <code class="literal">http://www.example.com/users?_action=create</code>, but not
   <code class="literal">http://www.example.com/users?</code>.
  </p><p>
   For example, to match everything under
   <code class="literal">http://www.example.com/</code> specify three patterns,
   one for <code class="literal">http://www.example.com/*</code>,
   one for <code class="literal">http://www.example.com/*?</code>, and
   one for <code class="literal">http://www.example.com/*?*</code>.
  </p><p>
   When defining patterns to match URLs with query strings, OpenAM sorts the
   query string field-value pairs alphabetically by field name
   when normalizing URLs before checking whether a policy matches.
   Therefore the query string
   <code class="literal">?subject=SPBnfm+t5PlP+ISyQhVlplE22A8=&amp;action=get</code>
   is equivalent to the query string
   <code class="literal">?action=get&amp;subject=SPBnfm+t5PlP+ISyQhVlplE22A8=</code>.
  </p></li><li class="listitem"><p>
   Duplicate slashes (<code class="literal">/</code>)
   are not considered part of the resource name to match.
   A trailing slash is considered by OpenAM as part of the resource name.
  </p><p>
   For example,
   <code class="literal">http://www.example.com//path/</code>,
   and <code class="literal">http://www.example.com/path//</code>
   are treated in the same way.
  </p><p>
   <code class="literal">http://www.example.com/path</code>,
   and <code class="literal">http://www.example.com/path/</code>
   are considered two distinct resources.
  </p></li><li class="listitem"><p>
   Wildcards can be used to match protocols, host names, and port numbers.
  </p><p>
   For example, <code class="literal">*://*:*/*</code> matches
   <code class="literal">http://www.example.com:80/index.html</code>,
   <code class="literal">https://www.example.com:443/index.html</code>, and
   <code class="literal">http://www.example.net:8080/index.html</code>.
  </p><p>
   When a port number is not explicitly specified,
   then the default port number is implied.
   Therefore <code class="literal">http://www.example.com/*</code>
   is the same as <code class="literal">http://www.example.com:80/*</code>,
   and <code class="literal">https://www.example.com/*</code>
   is the same as <code class="literal">https://www.example.com:443/*</code>.
  </p></li><li class="listitem"><p>
   Wildcards cannot be escaped.
  </p></li><li class="listitem"><p>
   Do not mix <code class="literal">*</code> and <code class="literal">-*-</code> in the same
   pattern.
  </p></li><li class="listitem"><p>
   By default, comparisons are not case sensitive.
   The delimiter, wildcards and case sensitivity are configurable.
   To see examples of other configurations, browse in the OpenAM Console to
   Configuration &gt; Global &gt; Policy Configuration &gt; Resource Comparator.
  </p></li></ul></div></div><div lang="en" class="section"><div class="titlepage"><div><div><h3 class="title"><a name="script-policy"></a>3.3.5.&nbsp;Importing and Exporting Policies</h3></div></div></div><a class="indexterm" name="d16037e8550"></a><p>You can import and export policies to and from files.</p><p>You can use these files to backup policies, transfer policies between
  OpenAM instances, or store policy configuration in a version
  control system such as Git or Subversion.</p><p>The default, preferred format for importing and
  exporting OpenAM policies is <a class="link" href="http://docs.oasis-open.org/xacml/3.0/xacml-3.0-core-spec-os-en.html" target="_blank">
<em class="citetitle">eXtensible Access Control Markup Language (XACML) Version 3.0</em></a>.</p><div class="note"><h3 class="title">Note</h3><p>OpenAM can only import XACML 3.0 files that were either created by
 an OpenAM instance, or that have had minor manual modifications,
 due to the reuse of some XACML 3.0 parameters for non-standard
 information.</p></div><p>You can import and export policies by using the policy editor in
 the OpenAM console, using the REST API, or with the <span class="command"><strong>ssoadm</strong></span>
 command.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
    <a class="xref" href="#export-policy-to-xacml-xui" title="Procedure&nbsp;3.5.&nbsp;To Export Policies in XACML Format (OpenAM Console)">Procedure&nbsp;3.5, &#8220;To Export Policies in XACML Format (OpenAM Console)&#8221;</a>
   </p></li><li class="listitem"><p><a class="xref" href="#import-policy-in-xacml-xui" title="Procedure&nbsp;3.6.&nbsp;To Import Policies in XACML Format (OpenAM Console)">Procedure&nbsp;3.6, &#8220;To Import Policies in XACML Format (OpenAM Console)&#8221;</a></p></li><li class="listitem"><p><a class="xref" href="#export-policy-to-xacml-ssoadm" title="Procedure&nbsp;3.7.&nbsp;To Export Policies in XACML Format (Command Line)">Procedure&nbsp;3.7, &#8220;To Export Policies in XACML Format (Command Line)&#8221;</a></p></li><li class="listitem"><p><a class="xref" href="#import-policy-in-xacml-ssoadm" title="Procedure&nbsp;3.8.&nbsp;To Import Policies in XACML Format (Command Line)">Procedure&nbsp;3.8, &#8220;To Import Policies in XACML Format (Command Line)&#8221;</a></p></li><li class="listitem"><p><a class="xref" href="#import-policy-in-xml-ssoadm" title="Procedure&nbsp;3.9.&nbsp;To Import Policies in XML Format (Command Line)">Procedure&nbsp;3.9, &#8220;To Import Policies in XML Format (Command Line)&#8221;</a></p></li></ul></div><div class="procedure"><a name="export-policy-to-xacml-xui"></a><div class="procedure-title">Procedure&nbsp;3.5.&nbsp;To Export Policies in XACML Format (OpenAM Console)</div><ul class="procedure"><li class="step"><p>In the OpenAM console, select Access Control &gt; <em class="replaceable"><code>Realm
     Name</code></em> &gt; Policies, and then click Export
    All Policies.</p></li></ul></div><div class="procedure"><a name="import-policy-in-xacml-xui"></a><div class="procedure-title">Procedure&nbsp;3.6.&nbsp;To Import Policies in XACML Format (OpenAM Console)</div><ol class="procedure" type="1"><li class="step"><p>In the OpenAM console, select Access Control &gt; <em class="replaceable"><code>Realm
    Name</code></em> &gt; Policies, and then click Import
    Policies.</p></li><li class="step"><p>Browse to the XACML format file, select it,
    and then click Open.</p></li></ol></div><div class="procedure"><a name="export-policy-to-xacml-ssoadm"></a><div class="procedure-title">Procedure&nbsp;3.7.&nbsp;To Export Policies in XACML Format (Command Line)</div><ul class="procedure"><li class="step"><p>Use the <span class="command"><strong>ssoadm list-xacml</strong></span> command.</p><div class="screen"><pre>
$ <strong>ssoadm \
 list-xacml \
 --realm "/" \
 --adminid amadmin \
 --password-file /tmp/pwd.txt</strong>
<em>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
 &lt;PolicySet
  xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17"
  PolicyCombiningAlgId="urn...rule-combining-algorithm:deny-overrides"
  Version="2014.11.25.17.41.15.597"
  PolicySetId="/:2014.11.25.17.41.15.597"&gt;
  &lt;Target /&gt;
  &lt;Policy
   RuleCombiningAlgId="urn...rule-combining-algorithm:deny-overrides"
   Version="2014.11.25.17.40.08.067"
   PolicyId="myPolicy"&gt;
   &lt;Description /&gt;
   &lt;Target&gt;
    &lt;AnyOf&gt;
     &lt;AllOf&gt;
      &lt;Match
       MatchId="urn...entitlement:json-subject-match"&gt;
       &lt;AttributeValue
        DataType="urn...entitlement.conditions.subject.AuthenticatedUsers"&gt;
        {}
       &lt;/AttributeValue&gt;
       &lt;AttributeDesignator
        MustBePresent="true"
        DataType="urn...entitlement.conditions.subject.AuthenticatedUsers"
        AttributeId="urn...entitlement:json-subject"
        Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" /&gt;
      &lt;/Match&gt;
     &lt;/AllOf&gt;
    &lt;/AnyOf&gt;
    &lt;AnyOf&gt;
     &lt;AllOf&gt;
      &lt;Match
       MatchId="urn...entitlement:resource-match:application:iPlanetAMWebAgentService"&gt;
       &lt;AttributeValue
        DataType="htp://www.w3.org/2001/XMLSchema#string"&gt;
        http://www.example.com:8000/*?*
       &lt;/AttributeValue&gt;
       &lt;AttributeDesignator
        MustBePresent="true"
        DataType="htp://www.w3.org/2001/XMLSchema#string"
        AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id"
        Category="urn...attribute-category:resource" /&gt;
      &lt;/Match&gt;
     &lt;/AllOf&gt;
    &lt;/AnyOf&gt;
    &lt;AnyOf&gt;
     &lt;AllOf&gt;
      &lt;Match
       MatchId="urn...application-match"&gt;
       &lt;AttributeValue
        DataType="htp://www.w3.org/2001/XMLSchema#string"&gt;
        iPlanetAMWebAgentService
       &lt;/AttributeValue&gt;
       &lt;AttributeDesignator
        MustBePresent="false"
        DataType="htp://www.w3.org/2001/XMLSchema#string"
        AttributeId="urn...application-id"
        Category="urn...application-category" /&gt;
      &lt;/Match&gt;
     &lt;/AllOf&gt;
    &lt;/AnyOf&gt;
    &lt;AnyOf&gt;
     &lt;AllOf&gt;
      &lt;Match
       MatchId="urn...entitlement:action-match:application:iPlanetAMWebAgentService"&gt;
       &lt;AttributeValue
        DataType="htp://www.w3.org/2001/XMLSchema#string"&gt;
        POST
       &lt;/AttributeValue&gt;
       &lt;AttributeDesignator
        MustBePresent="true"
        DataType="htp://www.w3.org/2001/XMLSchema#string"
        AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id"
        Category="urn...attribute-category:action" /&gt;
      &lt;/Match&gt;
     &lt;/AllOf&gt;
     &lt;AllOf&gt;
      &lt;Match
       MatchId="urn...entitlement:action-match:application:iPlanetAMWebAgentService"&gt;
       &lt;AttributeValue
        DataType="htp://www.w3.org/2001/XMLSchema#string"&gt;
        GET
       &lt;/AttributeValue&gt;
       &lt;AttributeDesignator
        MustBePresent="true"
        DataType="htp://www.w3.org/2001/XMLSchema#string"
        AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id"
        Category="urn...attribute-category:action" /&gt;
      &lt;/Match&gt;
     &lt;/AllOf&gt;
    &lt;/AnyOf&gt;
   &lt;/Target&gt;
   &lt;VariableDefinition
    VariableId="....entitlement.applicationName"&gt;
    &lt;AttributeValue
     DataType="htp://www.w3.org/2001/XMLSchema#string"&gt;
     iPlanetAMWebAgentService
    &lt;/AttributeValue&gt;
   &lt;/VariableDefinition&gt;
   &lt;VariableDefinition
    VariableId="...privilege.createdBy"&gt;
    &lt;AttributeValue
     DataType="htp://www.w3.org/2001/XMLSchema#string"&gt;
     id=amadmin,ou=user,dc=openam,dc=forgerock,dc=org
    &lt;/AttributeValue&gt;
   &lt;/VariableDefinition&gt;
   &lt;VariableDefinition
    VariableId="...privilege.lastModifiedBy"&gt;
    &lt;AttributeValue
     DataType="htp://www.w3.org/2001/XMLSchema#string"&gt;
     id=amadmin,ou=user,dc=openam,dc=forgerock,dc=org
    &lt;/AttributeValue&gt;
   &lt;/VariableDefinition&gt;
   &lt;VariableDefinition
    VariableId="...privilege.creationDate"&gt;
    &lt;AttributeValue
     DataType="htp://www.w3.org/2001/XMLSchema#dateTime"&gt;
     2014-11-25T17:40:08.067
    &lt;/AttributeValue&gt;
   &lt;/VariableDefinition&gt;
   &lt;VariableDefinition
    VariableId="...privilege.lastModifiedDate"&gt;
    &lt;AttributeValue
     DataType="htp://www.w3.org/2001/XMLSchema#dateTime"&gt;
     2014-11-25T17:40:08.067
    &lt;/AttributeValue&gt;
   &lt;/VariableDefinition&gt;
   &lt;Rule
    Effect="Permit"
    RuleId="null:permit-rule"&gt;
    &lt;Description&gt;Permit Rule&lt;/Description&gt;
    &lt;Target&gt;
     &lt;AnyOf&gt;
      &lt;AllOf&gt;
       &lt;Match
        MatchId="urn...entitlement:action-match:application:iPlanetAMWebAgentService"&gt;
        &lt;AttributeValue
         DataType="htp://www.w3.org/2001/XMLSchema#string"&gt;
         POST
        &lt;/AttributeValue&gt;
        &lt;AttributeDesignator
         MustBePresent="true"
         DataType="htp://www.w3.org/2001/XMLSchema#string"
         AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id"
         Category="urn...attribute-category:action" /&gt;
       &lt;/Match&gt;
      &lt;/AllOf&gt;
      &lt;AllOf&gt;
       &lt;Match
        MatchId="urn...entitlement:action-match:application:iPlanetAMWebAgentService"&gt;
        &lt;AttributeValue
         DataType="htp://www.w3.org/2001/XMLSchema#string"&gt;
         GET
        &lt;/AttributeValue&gt;
        &lt;AttributeDesignator
         MustBePresent="true"
         DataType="htp://www.w3.org/2001/XMLSchema#string"
         AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id"
         Category="urn...attribute-category:action" /&gt;
       &lt;/Match&gt;
      &lt;/AllOf&gt;
     &lt;/AnyOf&gt;
    &lt;/Target&gt;
    &lt;Condition&gt;
     &lt;Apply
      FunctionId="urn...entitlement:json-subject-and-condition-satisfied"&gt;
      &lt;AttributeValue
       DataType="urn...entitlement.conditions.subject.AuthenticatedUsers"
       privilegeComponent="entitlementSubject"&gt;
       {}
      &lt;/AttributeValue&gt;
     &lt;/Apply&gt;
    &lt;/Condition&gt;
   &lt;/Rule&gt;
  &lt;/Policy&gt;
 &lt;/PolicySet&gt;

 Policy definitions were returned under realm, /.
 </em>
</pre></div></li></ul></div><div class="procedure"><a name="import-policy-in-xacml-ssoadm"></a><div class="procedure-title">Procedure&nbsp;3.8.&nbsp;To Import Policies in XACML Format (Command Line)</div><ul class="procedure"><li class="step"><p>Use the <span class="command"><strong>ssoadm create-xacml</strong></span> command.</p><div class="screen"><pre>
$ <strong>ssoadm \
 create-xacml \
 --realm "/" \
 --adminid amadmin \
 --password-file /tmp/pwd.txt \
 --xmlfile policy.xml</strong>

 <em>Policies were created under realm, /.</em>
</pre></div></li></ul></div><div class="procedure"><a name="import-policy-in-xml-ssoadm"></a><div class="procedure-title">Procedure&nbsp;3.9.&nbsp;To Import Policies in XML Format (Command Line)</div><p>You can import policies stored in non-XACML XML format. Once imported,
    the policy can then be exported in the XACML format using either the OpenAM
    console or the <span class="command"><strong>ssoadm list-xacml</strong></span> command.</p><ul class="procedure"><li class="step"><p>To import policies stored in non-XACML XML format, use the
     <span class="command"><strong>ssoadm create-policies</strong></span> command.</p><div class="screen"><pre>
$ <strong>ssoadm \
 create-policies \
 --realm "/" \
 --adminid amadmin \
 --password-file /tmp/pwd.txt \
 --xmlfile policy.xml</strong>

 <em>Policies were created under realm, /.</em>
</pre></div></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="delegate-policy"></a>3.4.&nbsp;Delegating Policy Management</h2></div></div></div><a class="indexterm" name="d16037e8672"></a><p>
   To delegate policy management and other administrative tasks, use privileges.
   You set privileges in OpenAM console on the Privileges page for a realm.
  </p><p>
   For details see the procedure,
   <a href="../admin-guide/index.html#chap-realms" class="link"><em class="citetitle">To Delegate Administration</em></a>.</p></div></div><div lang="en" class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="chap-realms"></a>Chapter&nbsp;4.&nbsp;Configuring Realms</h1></div></div></div><div class="toc"><div class="toc-title">Table of Contents</div><dl class="toc"><dt><span class="section"><a href="#manage-realms">4.1. Managing Realms</a></span></dt><dt><span class="section"><a href="#realms-agents">4.2. Working With Realms and Policy Agents</a></span></dt><dt><span class="section"><a href="#config-data-store">4.3. Configuring Data Stores</a></span></dt></dl></div><a class="indexterm" name="d16037e8689"></a><p>
  This chapter shows how to configure OpenAM <em class="firstterm">realms</em>,
  which are used to group configuration and identities together.
  For example, you might have one realm for OpenAM administrators and agents,
  and another realm for users.
  In this two-realm setup, the OpenAM administrator can login
  to the administrative realm to manage the services,
  but cannot authenticate as OpenAM administrator to the realm
  that protects web sites with HR and financial information.
 </p><p>
  OpenAM associates a realm with at least one identity repository
  and authentication chain.
  OpenAM also associates the realm with
  authorization applications and their policies,
  and with privileges for administrators.
  Each realm can have its own configuration for the services it provides.
 </p><p>
  When you first configure OpenAM,
  OpenAM sets up the default <code class="literal">/ (Top Level Realm)</code>,
  containing OpenAM configuration data,
  and allowing authentication using the identity repository
  that you choose during initial configuration.
  The top level realm might hold the overall configuration
  for Example.com for instance.
 </p><p>
  You create new realms to subdivide authentication and authorization,
  and to delegate management of subrealms.
  For example, your organization might require separate realms for payroll,
  human resources, and IT management domains and their applications.
 </p><p>
  By default a new realm inherits configuration from its parent's configuration.
  The default identity repository is the one you choose
  when you deploy and configure OpenAM.
  The default authentication mechanism corresponds
  to that identity repository as well.
  You can, however, constrain authentication to rely on different data stores,
  and set policy for agents to define authorization in the realm.
 </p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="manage-realms"></a>4.1.&nbsp;Managing Realms</h2></div></div></div><p>
   You create and configure realms through the console,
   starting from the Access Control tab &gt; Realms table.
   You delegate administration for a realm by setting privileges in the realm.
  </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="#create-new-realm" title="Procedure&nbsp;4.1.&nbsp;To Create a New Realm">Procedure&nbsp;4.1, &#8220;To Create a New Realm&#8221;</a></p></li><li class="listitem"><p><a class="xref" href="#delegate-realm-administration" title="Procedure&nbsp;4.2.&nbsp;To Delegate Administration">Procedure&nbsp;4.2, &#8220;To Delegate Administration&#8221;</a></p></li></ul></div><div class="procedure"><a name="create-new-realm"></a><div class="procedure-title">Procedure&nbsp;4.1.&nbsp;To Create a New Realm</div><a class="indexterm" name="d16037e8723"></a><p>
    You can create a new realm through the OpenAM console as described below,
    or by using the <span class="command"><strong>ssoadm create-realm</strong></span> command.
   </p><ol class="procedure" type="1"><li class="step"><p>
     Login to the OpenAM console as OpenAM Administrator, <code class="literal">amadmin</code>.
    </p></li><li class="step"><p>
     On the Access Control tab &gt; Realms table,
     click New to open the New Realm page, where you configure the realm.
    </p><div class="note"><h3 class="title">Note</h3><p>Do not use the names of OpenAM REST endpoints as the name of a realm.
     The OpenAM REST endpoint names that should not be used includes: "users",
     "groups", "realms", "policies" and "applications".</p></div><p>
     If you configure the realm to be inactive,
     then users cannot use it to authenticate
     or be granted access to protected resources.
    </p><p>
     Realm/DNS aliases must follow standard FQDN conventions,
     such as <code class="literal">hr.example.com</code>
     or <code class="literal">pay.example.com</code>.<a href="#ftn.d16037e8755" class="footnote" name="d16037e8755"><sup class="footnote">[5]</sup></a>
    </p></li><li class="step"><p>
     Save your work after defining the configuration for the new realm.
    </p></li></ol></div><div class="procedure"><a name="delegate-realm-administration"></a><div class="procedure-title">Procedure&nbsp;4.2.&nbsp;To Delegate Administration</div><a class="indexterm" name="d16037e8768"></a><p>
    You can delegate administration in a realm.
    OpenAM grants administrative capabilities
    to members of groups having administrative privileges.
   </p><p>
    You can grant privileges through the OpenAM console as described below,
    or by using the <span class="command"><strong>ssoadm add-privileges</strong></span> command.
   </p><ol class="procedure" type="1"><li class="step"><p>
     On the Access Control tab &gt; Realms table,
     click the realm for which you want to delegate administration
     to view the realm configuration.
    </p></li><li class="step"><p>
     On the Privileges tab, click the name of the group
     to whom you intend to grant access.
    </p></li><li class="step"><p>
     Select the administrative privileges to delegate for the realm. See
     <a class="xref" href="#realm-privileges" title="Table&nbsp;4.1.&nbsp;OpenAM Privileges">Table&nbsp;4.1, &#8220;OpenAM Privileges&#8221;</a> for information about OpenAM
     privileges.
    </p><p>
     Unless your delegation model requires a high degree of granularity, assign
     realm administrators the <code class="literal">RealmAdmin</code> privilege, and assign
     policy administrators the <code class="literal">PolicyAdmin</code> privilege.
    </p></li><li class="step"><p>
     Save your work.
    </p></li></ol></div><p>
   The following table describes privileges that you can assign
   in the OpenAM console or by using the
   <span class="command"><strong>ssoadm add-privileges</strong></span>
   command:
  </p><div class="table"><a name="realm-privileges"></a><div class="table-title">Table&nbsp;4.1.&nbsp;OpenAM Privileges</div><div class="table-contents"><table summary="OpenAM Privileges" width="100%" border="0"><colgroup><col width="25%"><col width="37%"><col width="38%"></colgroup><thead><tr><th>Privilege</th><th>
       Privilege Name to Use With the <span class="command"><strong>ssoadm add-privileges</strong></span>
       Command
      </th><th>Notes</th></tr></thead><tbody><tr><td>Read and write access to all realm and policy properties</td><td><code class="literal">RealmAdmin</code></td><td>
       Assign this privilege to administrators
       in order to let them modify or read any part of an OpenAM realm.
       Use this privilege when you do not require
       granularity in your delegation model. All other OpenAM
       privileges are included with this privilege.
      </td></tr><tr><td>Read and write access to all log files</td><td><code class="literal">LogAdmin</code></td><td>Subset of the <code class="literal">RealmAdmin</code> privilege.</td></tr><tr><td>Read access to all log files</td><td><code class="literal">LogRead</code></td><td>Subset of the <code class="literal">RealmAdmin</code> privilege.</td></tr><tr><td>Write access to all log files</td><td><code class="literal">LogWrite</code></td><td>Subset of the <code class="literal">RealmAdmin</code> privilege.</td></tr><tr><td>Read and write access to all configured agents</td><td><code class="literal">AgentAdmin</code></td><td>
       Provides access to centralized agent configuration;
       subset of the <code class="literal">RealmAdmin</code> privilege.
      </td></tr><tr><td>Read and write access to all federation metadata configurations</td><td><code class="literal">FederationAdmin</code></td><td>Subset of the <code class="literal">RealmAdmin</code> privilege.</td></tr><tr><td>REST calls for reading realms</td><td><code class="literal">RealmReadAccess</code></td><td>Subset of the <code class="literal">RealmAdmin</code> privilege.</td></tr><tr><td>Read and write access only for policy properties, including REST calls</td><td><code class="literal">PolicyAdmin</code></td><td>
       Assign this privilege to policy administrators
       in order to let them modify or read any part of the OpenAM
       policy configuration. This privilege lets an
       administrator modify or read all policy components:
       policies, applications, referrals, subject types,
       condition types, subject attributes, and decision combiners.
       All other OpenAM privileges that affect policy components
       are included with this privilege. Subset of the
       <code class="literal">RealmAdmin</code> privilege.
      </td></tr><tr><td>REST calls for policy evaluation</td><td><code class="literal">EntitlementRestAccess</code></td><td>
       Subset of the <code class="literal">RealmAdmin</code> and
       <code class="literal">PolicyAdmin</code> privileges.
      </td></tr><tr><td>REST calls for reading policies</td><td><code class="literal">PrivilegeRestReadAccess</code></td><td>
       Subset of the <code class="literal">RealmAdmin</code> and
       <code class="literal">PolicyAdmin</code> privileges.
      </td></tr><tr><td>REST calls for managing policies</td><td><code class="literal">PrivilegeRestAccess</code></td><td>
       Subset of the <code class="literal">RealmAdmin</code> and
       <code class="literal">PolicyAdmin</code> privileges.
      </td></tr><tr><td>REST calls for reading policy referrals</td><td><code class="literal">ReferralsReadAccess</code></td><td>
       Subset of the <code class="literal">RealmAdmin</code> and
       <code class="literal">PolicyAdmin</code> privileges.
      </td></tr><tr><td>REST calls for modifying policy referrals</td><td><code class="literal">ReferralsModifyAccess</code></td><td>
       Subset of the <code class="literal">RealmAdmin</code> and
       <code class="literal">PolicyAdmin</code> privileges.
      </td></tr><tr><td>REST calls for reading policy applications</td><td><code class="literal">ApplicationReadAccess</code></td><td>
       Subset of the <code class="literal">RealmAdmin</code> and
       <code class="literal">PolicyAdmin</code> privileges.
      </td></tr><tr><td>REST calls for modifying policy applications</td><td><code class="literal">ApplicationModifyAccess</code></td><td>
       Subset of the <code class="literal">RealmAdmin</code> and
       <code class="literal">PolicyAdmin</code> privileges.
      </td></tr><tr><td>REST calls for reading policy application types</td><td><code class="literal">ApplicationTypesReadAccess</code></td><td>
       Subset of the <code class="literal">RealmAdmin</code> and
       <code class="literal">PolicyAdmin</code> privileges.
      </td></tr><tr><td>REST calls for reading environment conditions</td><td><code class="literal">ConditionTypesReadAccess</code></td><td>
       Subset of the <code class="literal">RealmAdmin</code> and
       <code class="literal">PolicyAdmin</code> privileges.
      </td></tr><tr><td>REST calls for reading subject conditions</td><td><code class="literal">SubjectTypesReadAccess</code></td><td>
       Subset of the <code class="literal">RealmAdmin</code> and
       <code class="literal">PolicyAdmin</code> privileges.
      </td></tr><tr><td>REST calls for reading decision combiners</td><td><code class="literal">DecisionCombinersReadAccess</code></td><td>
       Subset of the <code class="literal">RealmAdmin</code> and
       <code class="literal">PolicyAdmin</code> privileges.
      </td></tr><tr><td>REST calls for reading subject attributes</td><td><code class="literal">SubjectAttributesReadAccess</code></td><td>
       Subset of the <code class="literal">RealmAdmin</code> and
       <code class="literal">PolicyAdmin</code> privileges.
      </td></tr></tbody></table></div></div><br class="table-break"></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="realms-agents"></a>4.2.&nbsp;Working With Realms and Policy Agents</h2></div></div></div><p>
   You can configure a policy agent
   to be directed to a realm and application when requesting policy decisions,
   or to log users into a different realm than the policy agent's realm.
  </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="#agent-realm-application-for-policy-decisions" title="Procedure&nbsp;4.3.&nbsp;To Specify the Realm and Application for Policy Decisions">Procedure&nbsp;4.3, &#8220;To Specify the Realm and Application for Policy Decisions&#8221;</a></p></li><li class="listitem"><p><a class="xref" href="#agent-redirect-login-to-realm" title="Procedure&nbsp;4.4.&nbsp;To Configure a Web or J2EE Agent for Login to a Realm">Procedure&nbsp;4.4, &#8220;To Configure a Web or J2EE Agent for Login to a Realm&#8221;</a></p></li></ul></div><div class="procedure"><a name="agent-realm-application-for-policy-decisions"></a><div class="procedure-title">Procedure&nbsp;4.3.&nbsp;To Specify the Realm and Application for Policy Decisions</div><p>
    By default, policy agents request policy decisions
    in the top level realm (/)
    and for the default policy agent application,
    <code class="literal">iPlanetAMWebAgentService</code>.
    When the realm and application differ for your policy agent,
    you can specify the realm and application in the policy agent profile.
    OpenAM then directs requests from the policy agent
    to the specified realm and application,
    so this is backwards compatible with existing policy agents.
   </p><ol class="procedure" type="1"><li class="step"><p>
     In the OpenAM console, browse to
     Access Control &gt; <em class="replaceable"><code>Realm Name</code></em> &gt; Agents &gt;
     <em class="replaceable"><code>Web or Java EE Agent Type</code></em> &gt;
     <em class="replaceable"><code>Agent Name</code></em> &gt; OpenAM Services &gt;
     Policy Client Service.
    </p></li><li class="step"><p>
     Set the Realm and Application.
    </p><div class="itemizedlist"><p>
      For example,
      if the realm is <code class="literal">/hr</code>
      and the application is <code class="literal">myHRApp</code>:</p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
       Realm: <code class="literal">/hr</code>
      </p></li><li class="listitem"><p>
       Application: <code class="literal">myHRApp</code>
      </p></li></ul></div></li><li class="step"><p>
     Save your work.
    </p></li></ol></div><div class="procedure"><a name="agent-redirect-login-to-realm"></a><div class="procedure-title">Procedure&nbsp;4.4.&nbsp;To Configure a Web or J2EE Agent for Login to a Realm</div><p>
    You might choose to configure your agent in one realm,
    yet have your real users authenticate through another realm.
    In this case, you want your policy agents
    to redirect users to authenticate to their realm, rather than the agent realm.
   </p><ol class="procedure" type="1"><li class="step"><p>
     In the OpenAM console, browse to
     Access Control &gt; <em class="replaceable"><code>Realm Name</code></em> &gt; Agents &gt;
     <em class="replaceable"><code>Web or Java EE Agent Type</code></em> &gt;
     <em class="replaceable"><code>Agent Name</code></em> &gt; OpenAM Services.
    </p></li><li class="step"><p>
     Add login and logout URLs, including the realm in the query string.
    </p><div class="itemizedlist"><p>
      For example,
      if your <em class="replaceable"><code>Realm Name</code></em> is <code class="literal">hr</code>,
      and you access OpenAM at
      <code class="literal">http://openam.example.com:8080/openam</code>:</p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
       Login URL:
       <code class="literal">http://openam.example.com:8080/openam/UI/Login?realm=hr</code>
      </p></li><li class="listitem"><p>
       Logout URL:
       <code class="literal">http://openam.example.com:8080/openam/UI/Logout?realm=hr</code>
      </p></li></ul></div></li><li class="step"><p>
     Save your work.
    </p></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="config-data-store"></a>4.3.&nbsp;Configuring Data Stores</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="#sec-data-stores-active-directory">4.3.1. Hints for Configuring Active Directory Data Stores</a></span></dt><dt><span class="section"><a href="#sec-data-stores-adam">4.3.2. Hints for Configuring Active Directory Application Mode (ADAM) Data Stores</a></span></dt><dt><span class="section"><a href="#sec-data-stores-db">4.3.3. Hints for Configuring Database Repository (Early Access) Data Stores</a></span></dt><dt><span class="section"><a href="#sec-data-stores-generic-ldapv3">4.3.4. Hints for Configuring Generic LDAPv3 Data Stores</a></span></dt><dt><span class="section"><a href="#sec-data-stores-opendj">4.3.5. Hints for Configuring OpenDJ Data Stores</a></span></dt><dt><span class="section"><a href="#sec-data-stores-dsee">4.3.6. Hints for Configuring Sun/Oracle DSEE Data Stores</a></span></dt><dt><span class="section"><a href="#sec-data-stores-tivoli">4.3.7. Hints for Configuring Tivoli Directory Server Data Stores</a></span></dt></dl></div><p>
   When you first set up a realm,
   the new realm inherits the data store from the parent realm.
   Yet, if your administrators are in one realm and your users in another,
   your new child realm might retrieve users from a different data store.
  </p><div class="procedure"><a name="realm-data-store"></a><div class="procedure-title">Procedure&nbsp;4.5.&nbsp;To Configure a Data Store</div><ol class="procedure" type="1"><li class="step"><p>
     In OpenAM console, browse to
     Access Control &gt; <em class="replaceable"><code>Realm Name</code></em> &gt; Data Stores.
    </p></li><li class="step"><p>
     Click New in the Data Stores table to create a data store profile,
     and to provide the information needed to connect to the data store.
    </p></li><li class="step"><p>
     In the first screen, name the data store and select the type of data store.
    </p><p>
     Most data stores are directory services, though the Database Repository
     lets you connect to an SQL database through JDBC.
    </p></li><li class="step"><p>
     In the second screen, provide information on
     how to connect to your data store,
     and then click Finish to save your work.
    </p><div class="itemizedlist"><p>
      See the following sections for hints depending on the type of data store.
     </p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
       <a href="../admin-guide/index.html#sec-data-stores-active-directory" class="link"><em class="citetitle">Hints for Configuring Active Directory Data Stores</em></a>
      </p></li><li class="listitem"><p>
       <a href="../admin-guide/index.html#sec-data-stores-adam" class="link"><em class="citetitle">Hints for Configuring Active Directory Application Mode (ADAM) Data Stores</em></a>
      </p></li><li class="listitem"><p>
       <a href="../admin-guide/index.html#sec-data-stores-db" class="link"><em class="citetitle">Hints for Configuring Database Repository (Early Access) Data Stores</em></a>
      </p></li><li class="listitem"><p>
       <a href="../admin-guide/index.html#sec-data-stores-generic-ldapv3" class="link"><em class="citetitle">Hints for Configuring Generic LDAPv3 Data Stores</em></a>
      </p></li><li class="listitem"><p>
       <a href="../admin-guide/index.html#sec-data-stores-opendj" class="link"><em class="citetitle">Hints for Configuring OpenDJ Data Stores</em></a>
      </p></li><li class="listitem"><p>
       <a href="../admin-guide/index.html#sec-data-stores-dsee" class="link"><em class="citetitle">Hints for Configuring Sun/Oracle DSEE Data Stores</em></a>
      </p></li><li class="listitem"><p>
       <a href="../admin-guide/index.html#sec-data-stores-tivoli" class="link"><em class="citetitle">Hints for Configuring Tivoli Directory Server Data Stores</em></a>
      </p></li></ul></div></li><li class="step"><p>
     Click the Subjects tab,
     and make sure the connection to your new data store is working,
     by searching for a known identity.
    </p><p>
     By default the Subjects list only retrieves 100 entries
     from the data store.
     Narrow your search if you do not see the identity you are looking for.
    </p></li><li class="step"><p>
     If you no longer need the connection to the inherited data store
     <span class="emphasis"><em>in this realm</em></span>,
     then you can delete its entry in the Data Stores table.
    </p><p>
     Also, once you change the data store for a realm,
     you might opt to change the
     <a href="../admin-guide/index.html#configure-authn-modules" class="link">authentication module configuration</a>
     as described in the chapter on authentication
     to use your realm data store, rather than the inherited settings.
    </p></li></ol></div><div lang="en" class="section"><div class="titlepage"><div><div><h3 class="title"><a name="sec-data-stores-active-directory"></a>4.3.1.&nbsp;Hints for Configuring Active Directory Data Stores</h3></div></div></div><p>
  Use these hints when configuring Active Directory Data Stores.
 </p><a class="indexterm" name="d16037e9282"></a><p>
  <span class="command"><strong>ssoadm</strong></span> service name:
  <code class="literal">sunIdentityRepositoryService</code>
 </p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Name</span></dt><dd><p>
     Name for the data store configuration
    </p></dd><dt><span class="term">Load schema when finished</span></dt><dd><p>
     Add appropriate LDAP schema to the directory server
     when saving the configuration.
     The LDAP Bind DN user must have access to perform this operation.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">idRepoLoadSchema</code>
    </p><p>
     Default:
     false
    </p></dd><dt><span class="term">LDAP Server</span></dt><dd><p>
     <code class="literal"><em class="replaceable"><code>host</code></em>:<em class="replaceable"><code>port</code></em></code>
     to contact the directory server, with optional
     <code class="literal">|<em class="replaceable"><code>server_ID</code></em>|<em class="replaceable"><code>site_ID</code></em></code>
     for deployments with multiple servers and sites
    </p><div class="orderedlist"><p>
      OpenAM uses the optional settings to determine
      which directory server to contact first.
      OpenAM tries to contact directory servers
      in the following priority order, with highest priority first.
     </p><ol class="orderedlist" type="1"><li class="listitem"><p>
       The first directory server in the list
       whose <em class="replaceable"><code>server_ID</code></em>
       matches the current OpenAM server
      </p></li><li class="listitem"><p>
       The first directory server in the list
       whose <em class="replaceable"><code>site_ID</code></em>
       matches the current OpenAM server
      </p></li><li class="listitem"><p>
       The first directory server in the remaining list
      </p></li></ol></div><p>
     If the directory server is not available,
     OpenAM proceeds to the next directory server in the list.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-ldap-server</code>
    </p><p>
     Default:
     <code class="literal"><em class="replaceable"><code>host</code></em>:<em class="replaceable"><code>port</code></em></code>
     of the initial directory server configured for this OpenAM server
    </p></dd><dt><span class="term">LDAP Bind DN</span></dt><dd><p>
     Bind DN for connecting to the directory server.
     Some OpenAM capabilities require write access to directory entries.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-authid</code>
    </p><p>
     Default:
     <code class="literal">CN=Administrator,CN=Users,<em class="replaceable"><code>base-dn</code></em></code>
    </p></dd><dt><span class="term">LDAP Bind Password</span></dt><dd><p>
     Bind password for connecting to the directory server
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-authpw</code>
    </p></dd><dt><span class="term">LDAP Organization DN</span></dt><dd><p>
     The base DN under which to find user and group profiles
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-organization_name</code>
    </p><p>
     Default:
     <code class="literal"><em class="replaceable"><code>base-dn</code></em></code>
    </p></dd><dt><span class="term">LDAP SSL/TLS Enabled</span></dt><dd><p>
     Whether to use LDAPS or StartTLS to connect to the directory server.
     If you enable SSL/TLS, OpenAM must be able to trust server certificates,
     either because the server certificates were signed by a CA
     whose certificate is already included in the trust store
     used by the container where OpenAM runs,
     or because you imported the certificates into the trust store.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-ssl-enabled</code>
    </p><p>
     Default:
     false
    </p></dd><dt><span class="term">LDAP Connection Pool Maximum Size</span></dt><dd><p>
     Maximum number of connections to the directory server.
     Make sure the directory service can cope
     with the maximum number of client connections across all servers.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-connection_pool_max_size</code>
    </p><p>
     Default:
     10
    </p></dd><dt><span class="term">LDAP Connection Heartbeat Interval</span></dt><dd><p>
     How often to send a heartbeat request to the directory server
     to ensure that the connection does not remain idle.
     Some network administrators configure firewalls and load balancers
     to drop connections that are idle for too long.
     You can turn this off by setting the value to 0 or to a negative number.
     To set the units for the interval use LDAP Connection Heartbeat Time Unit.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">openam-idrepo-ldapv3-heartbeat-interval</code>
    </p><p>
     Default:
     10
    </p></dd><dt><span class="term">LDAP Connection Heartbeat Time Unit</span></dt><dd><p>
     Time unit for the LDAP Connection Heartbeat Interval setting
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">openam-idrepo-ldapv3-heartbeat-timeunit</code>
    </p><p>
     Default:
     <code class="literal">second</code>
    </p></dd><dt><span class="term">Maximum Results Returned from Search</span></dt><dd><p>
     A cap for the number of search results to request.
     For example when using the Subjects tab to view profiles,
     even if you set
     Configuration &gt; Console &gt; Administration &gt; Maximum Results Returned from Search
     to a larger number, OpenAM does not exceed this setting.
     Rather than raise this number,
     consider narrowing your search to match fewer directory entries.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-max-result</code>
    </p><p>
     Default:
     1000
    </p></dd><dt><span class="term">Search Timeout</span></dt><dd><p>
     Maximum time to wait for search results in seconds.
     Does not apply to persistent searches.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-time-limit</code>
    </p><p>
     Default:
     10
    </p></dd><dt><span class="term">LDAPv3 Plug-in Search Scope</span></dt><dd><p>
     LDAP searches can apply to a single entry (SCOPE_BASE),
     entries directly below the search DN (SCOPE_ONE),
     or all entries below the search DN (SEARCH_SUB)
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-search-scope</code>
    </p><p>
     Default:
     <code class="literal">SCOPE_SUB</code>
    </p></dd><dt><span class="term">LDAPv3 Repository Plug-in Class Name</span></dt><dd><p>
     OpenAM identity repository implementation
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sunIdRepoClass</code>
    </p><p>
     Default:
     <code class="literal">org.forgerock.openam.idrepo.ldap.DJLDAPv3Repo</code>
    </p></dd><dt><span class="term">Attribute Name Mapping</span></dt><dd><p>
     Map of OpenAM profile attribute names to directory server attribute names
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sunIdRepoAttributeMapping</code>
    </p><p>
     Default:
     <code class="literal">userPassword=unicodePwd</code>
    </p></dd><dt><span class="term">LDAPv3 Plug-in Supported Types and Operations</span></dt><dd><p>
     Map of OpenAM operations that can be performed in the specified OpenAM contexts
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sunIdRepoSupportedOperations</code>
    </p><p>
     Default:
     <code class="literal">group=read,create,edit,delete</code>,
     <code class="literal">realm=read,create,edit,delete,service</code>,
     <code class="literal">user=read,create,edit,delete</code>
    </p></dd><dt><span class="term">LDAP Users Search Attribute</span></dt><dd><p>
     When searching for a user by name, match values against this attribute
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-users-search-attribute</code>
    </p><p>
     Default:
     <code class="literal">cn</code>
    </p></dd><dt><span class="term">LDAP Users Search Filter</span></dt><dd><p>
     When searching for users, apply this LDAP search filter as well
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-users-search-filter</code>
    </p><p>
     Default:
     <code class="literal">(objectclass=person)</code>
    </p></dd><dt><span class="term">LDAP People Container Naming Attribute</span></dt><dd><p>
     RDN attribute of the LDAP base DN which contains user profiles
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-people-container-name</code>
    </p><p>
     Default:
     <code class="literal">cn</code>
    </p></dd><dt><span class="term">LDAP People Container Value</span></dt><dd><p>
     RDN attribute value of the LDAP base DN which contains user profiles
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-people-container-value</code>
    </p><p>
     Default:
     <code class="literal">users</code>
    </p></dd><dt><span class="term">LDAP User Object Class</span></dt><dd><p>
     User profiles have these LDAP object classes
    </p><p>
     OpenAM handles only those attributes listed in this setting.
     OpenAM discards any such unlisted attributes from requests
     and the request proceeds without the attribute.
    </p><p>
     For example, with default settings
     if you request that OpenAM execute a search that asks for
     the <code class="literal">mailAlternateAddress</code> attribute,
     OpenAM does the search, but does not request
     <code class="literal">mailAlternateAddress</code>.
     In the same way, OpenAM does perform an update operation
     with a request to set the value of an unlisted attribute
     like <code class="literal">mailAlternateAddress</code>,
     but it drops the unlisted attribute from the update request.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-user-objectclass</code>
    </p><p>
     Default:
     <code class="literal">organizationalPerson</code>,
     <code class="literal">person</code>,
     <code class="literal">top</code>,
     <code class="literal">User</code>,
    </p></dd><dt><span class="term">LDAP User Attributes</span></dt><dd><p>
     User profiles have these LDAP attributes
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-user-attributes</code>
    </p><p>
     Default:
     <code class="literal">assignedDashboard</code>,
     <code class="literal">cn</code>,
     <code class="literal">devicePrintProfiles</code>,
     <code class="literal">displayName</code>,
     <code class="literal">distinguishedName</code>,
     <code class="literal">dn</code>,
     <code class="literal">employeeNumber</code>,
     <code class="literal">givenName</code>,
     <code class="literal">iplanet-am-auth-configuration</code>,
     <code class="literal">iplanet-am-session-add-session-listener-on-all-sessions</code>,
     <code class="literal">iplanet-am-session-destroy-sessions</code>,
     <code class="literal">iplanet-am-session-get-valid-sessions</code>,
     <code class="literal">iplanet-am-session-max-caching-time</code>,
     <code class="literal">iplanet-am-session-max-idle-time</code>,
     <code class="literal">iplanet-am-session-max-session-time</code>,
     <code class="literal">iplanet-am-session-quota-limit</code>,
     <code class="literal">iplanet-am-session-service-status</code>,
     <code class="literal">iplanet-am-user-account-life</code>,
     <code class="literal">iplanet-am-user-admin-start-dn</code>,
     <code class="literal">iplanet-am-user-alias-list</code>,
     <code class="literal">iplanet-am-user-auth-config</code>,
     <code class="literal">iplanet-am-user-auth-modules</code>,
     <code class="literal">iplanet-am-user-failure-url</code>,
     <code class="literal">iplanet-am-user-federation-info-key</code>,
     <code class="literal">iplanet-am-user-federation-info</code>,
     <code class="literal">iplanet-am-user-login-status</code>,
     <code class="literal">iplanet-am-user-password-reset-force-reset</code>,
     <code class="literal">iplanet-am-user-password-reset-options</code>,
     <code class="literal">iplanet-am-user-password-reset-question-answer</code>,
     <code class="literal">iplanet-am-user-success-url</code>,
     <code class="literal">mail</code>,
     <code class="literal">name</code>,
     <code class="literal">objectclass</code>,
     <code class="literal">objectGUID</code>,
     <code class="literal">postalAddress</code>,
     <code class="literal">preferredlanguage</code>,
     <code class="literal">preferredLocale</code>,
     <code class="literal">preferredtimezone</code>,
     <code class="literal">sAMAccountName</code>,
     <code class="literal">sn</code>,
     <code class="literal">sun-fm-saml2-nameid-info</code>,
     <code class="literal">sun-fm-saml2-nameid-infokey</code>,
     <code class="literal">sunAMAuthInvalidAttemptsData</code>,
     <code class="literal">sunIdentityMSISDNNumber</code>,
     <code class="literal">sunIdentityServerDiscoEntries</code>,
     <code class="literal">sunIdentityServerPPAddressCard</code>,
     <code class="literal">sunIdentityServerPPCommonNameAltCN</code>,
     <code class="literal">sunIdentityServerPPCommonNameCN</code>,
     <code class="literal">sunIdentityServerPPCommonNameFN</code>,
     <code class="literal">sunIdentityServerPPCommonNameMN</code>,
     <code class="literal">sunIdentityServerPPCommonNamePT</code>,
     <code class="literal">sunIdentityServerPPCommonNameSN</code>,
     <code class="literal">sunIdentityServerPPDemographicsAge</code>,
     <code class="literal">sunIdentityServerPPDemographicsBirthDay</code>,
     <code class="literal">sunIdentityServerPPDemographicsDisplayLanguage</code>,
     <code class="literal">sunIdentityServerPPDemographicsLanguage</code>,
     <code class="literal">sunIdentityServerPPDemographicsTimeZone</code>,
     <code class="literal">sunIdentityServerPPEmergencyContact</code>,
     <code class="literal">sunIdentityServerPPEmploymentIdentityAltO</code>,
     <code class="literal">sunIdentityServerPPEmploymentIdentityJobTitle</code>,
     <code class="literal">sunIdentityServerPPEmploymentIdentityOrg</code>,
     <code class="literal">sunIdentityServerPPEncryPTKey</code>,
     <code class="literal">sunIdentityServerPPFacadegreetmesound</code>,
     <code class="literal">sunIdentityServerPPFacadeGreetSound</code>,
     <code class="literal">sunIdentityServerPPFacadeMugShot</code>,
     <code class="literal">sunIdentityServerPPFacadeNamePronounced</code>,
     <code class="literal">sunIdentityServerPPFacadeWebSite</code>,
     <code class="literal">sunIdentityServerPPInformalName</code>,
     <code class="literal">sunIdentityServerPPLegalIdentityAltIdType</code>,
     <code class="literal">sunIdentityServerPPLegalIdentityAltIdValue</code>,
     <code class="literal">sunIdentityServerPPLegalIdentityDOB</code>,
     <code class="literal">sunIdentityServerPPLegalIdentityGender</code>,
     <code class="literal">sunIdentityServerPPLegalIdentityLegalName</code>,
     <code class="literal">sunIdentityServerPPLegalIdentityMaritalStatus</code>,
     <code class="literal">sunIdentityServerPPLegalIdentityVATIdType</code>,
     <code class="literal">sunIdentityServerPPLegalIdentityVATIdValue</code>,
     <code class="literal">sunIdentityServerPPMsgContact</code>,
     <code class="literal">sunIdentityServerPPSignKey</code>,
     <code class="literal">telephoneNumber</code>,
     <code class="literal">unicodePwd</code>,
     <code class="literal">userAccountControl</code>,
     <code class="literal">userpassword</code>,
     <code class="literal">userPrincipalname</code>
    </p></dd><dt><span class="term">Create User Attribute Mapping</span></dt><dd><p>
     When creating a user profile,
     apply this map of OpenAM profile attribute names
     to directory server attribute names.
    </p><p>
     Attributes not mapped to another attribute
     (for example, <code class="literal">cn</code>)
     and attributes mapped to themselves
     (for example, <code class="literal">cn=cn</code>)
     take the value of the username
     unless the attribute values are provided when creating the profile.
     The object classes for user profile LDAP entries
     generally require Common Name (cn) and Surname (sn) attributes,
     so this prevents an LDAP constraint violation
     when performing the add operation.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-createuser-attr-mapping</code>
    </p><p>
     Default:
     <code class="literal">cn</code>,
     <code class="literal">sn</code>
    </p></dd><dt><span class="term">Attribute Name of User Status</span></dt><dd><p>
     Attribute to check/set user status
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-isactive</code>
    </p><p>
     Default:
     <code class="literal">userAccountControl</code>
    </p></dd><dt><span class="term">User Status Active Value</span></dt><dd><p>
     Active users have the user status attribute set to this value.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-active</code>
    </p><p>
     Default:
     544
    </p></dd><dt><span class="term">User Status Inactive Value</span></dt><dd><p>
     Inactive users have the user status attribute set to this value.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-inactive</code>
    </p><p>
     Default:
     546
    </p></dd><dt><span class="term">Authentication Naming Attribute</span></dt><dd><p>
     RDN attribute for building the bind DN
     when given a username and password
     to authenticate a user against the directory server
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-auth-naming-attr</code>
    </p><p>
     Default:
     <code class="literal">cn</code>
    </p></dd><dt><span class="term">LDAP Groups Search Attribute</span></dt><dd><p>
     When searching for a group by name, match values against this attribute
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-groups-search-attribute</code>
    </p><p>
     Default:
     <code class="literal">cn</code>
    </p></dd><dt><span class="term">LDAP Groups Search Filter</span></dt><dd><p>
     When searching for groups, apply this LDAP search filter as well
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-groups-search-filter</code>
    </p><p>
     Default:
     <code class="literal">(objectclass=group)</code>
    </p></dd><dt><span class="term">LDAP Groups Container Naming Attribute</span></dt><dd><p>
     RDN attribute of the LDAP base DN which contains group profiles
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-group-container-name</code>
    </p><p>
     Default:
     <code class="literal">cn</code>
    </p></dd><dt><span class="term">LDAP Groups Container Value</span></dt><dd><p>
     RDN attribute value of the LDAP base DN which contains group profiles
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-group-container-value</code>
    </p><p>
     Default:
     <code class="literal">users</code>
    </p></dd><dt><span class="term">LDAP Groups Object Class</span></dt><dd><p>
     Group profiles have these LDAP object classes
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-group-objectclass</code>
    </p><p>
     Default:
     <code class="literal">Group</code>,
     <code class="literal">top</code>
    </p></dd><dt><span class="term">LDAP Groups Attributes</span></dt><dd><p>
     Group profiles have these LDAP attributes
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-group-attributes</code>
    </p><p>
     Default:
     <code class="literal">cn</code>,
     <code class="literal">distinguishedName</code>,
     <code class="literal">dn</code>,
     <code class="literal">member</code>,
     <code class="literal">name</code>,
     <code class="literal">objectCategory</code>,
     <code class="literal">objectclass</code>,
     <code class="literal">sAMAccountName</code>,
     <code class="literal">sAMAccountType</code>
    </p></dd><dt><span class="term">Attribute Name for Group Membership</span></dt><dd><p>
     LDAP attribute in the member's LDAP entry
     whose values are the groups to which a member belongs
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-memberof</code>
    </p></dd><dt><span class="term">Attribute Name of Unique Member</span></dt><dd><p>
     Attribute in the group's LDAP entry
     whose values are the members of the group
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-uniquemember</code>
    </p><p>
     Default:
     <code class="literal">member</code>
    </p></dd><dt><span class="term">Persistent Search Base DN</span></dt><dd><p>
     Base DN for LDAP persistent searches
     used to receive notification of changes in directory server data
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-psearchbase</code>
    </p><p>
     Default:
     <code class="literal"><em class="replaceable"><code>base-dn</code></em></code>
    </p></dd><dt><span class="term">Persistent Search Scope</span></dt><dd><p>
     LDAP searches can apply to a single entry (SCOPE_BASE),
     entries directly below the search DN (SCOPE_ONE),
     or all entries below the search DN (SEARCH_SUB)
    </p><p>
     Specify either <code class="literal">SCOPE_BASE</code>
     or <code class="literal">SCOPE_ONE</code>.
     Do not specify <code class="literal">SCOPE_SUB</code>,
     as it can have a severe impact on Active Directory performance.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-psearch-scope</code>
    </p><p>
     Default:
     <code class="literal">SCOPE_SUB</code>
    </p></dd><dt><span class="term">The Delay Time Between Retries</span></dt><dd><p>
     How long to wait after receiving an error result
     that indicates OpenAM should try the LDAP operation again
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">com.iplanet.am.ldap.connection.delay.between.retries</code>
    </p><p>
     Default:
     1000 milliseconds
    </p></dd><dt><span class="term">DN Cache Enabled</span></dt><dd><p>
     Whether to enable the DN cache, which is used to cache DN lookups
     that can happen in bursts during authentication.
     As the cache can become stale when a user is moved or renamed,
     enable DN caching when the directory service allows move/rename operations (Mod DN),
     and when OpenAM uses persistent searches to obtain notification of such updates.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-dncache-enabled</code>
    </p><p>
     Default:
     false
    </p></dd><dt><span class="term">DN Cache Size</span></dt><dd><p>
     Maximum number of DNs cached when caching is enabled
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-dncache-size</code>
    </p><p>
     Default:
     1500 items
    </p></dd></dl></div></div><div lang="en" class="section"><div class="titlepage"><div><div><h3 class="title"><a name="sec-data-stores-adam"></a>4.3.2.&nbsp;Hints for Configuring Active Directory Application Mode (ADAM) Data Stores</h3></div></div></div><p>
  Use these hints when configuring Active Directory Application Mode (ADAM) Data Stores.
 </p><a class="indexterm" name="d16037e10372"></a><p>
  <span class="command"><strong>ssoadm</strong></span> service name:
  <code class="literal">sunIdentityRepositoryService</code>
 </p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Name</span></dt><dd><p>
     Name for the data store configuration
    </p></dd><dt><span class="term">Load schema when finished</span></dt><dd><p>
     Add appropriate LDAP schema to the directory server
     when saving the configuration.
     The LDAP Bind DN user must have access to perform this operation.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">idRepoLoadSchema</code>
    </p><p>
     Default:
     false
    </p></dd><dt><span class="term">LDAP Server</span></dt><dd><p>
     <code class="literal"><em class="replaceable"><code>host</code></em>:<em class="replaceable"><code>port</code></em></code>
     to contact the directory server, with optional
     <code class="literal">|<em class="replaceable"><code>server_ID</code></em>|<em class="replaceable"><code>site_ID</code></em></code>
     for deployments with multiple servers and sites
    </p><div class="orderedlist"><p>
      OpenAM uses the optional settings to determine
      which directory server to contact first.
      OpenAM tries to contact directory servers
      in the following priority order, with highest priority first.
     </p><ol class="orderedlist" type="1"><li class="listitem"><p>
       The first directory server in the list
       whose <em class="replaceable"><code>server_ID</code></em>
       matches the current OpenAM server
      </p></li><li class="listitem"><p>
       The first directory server in the list
       whose <em class="replaceable"><code>site_ID</code></em>
       matches the current OpenAM server
      </p></li><li class="listitem"><p>
       The first directory server in the remaining list
      </p></li></ol></div><p>
     If the directory server is not available,
     OpenAM proceeds to the next directory server in the list.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-ldap-server</code>
    </p><p>
     Default:
     <code class="literal"><em class="replaceable"><code>host</code></em>:<em class="replaceable"><code>port</code></em></code>
     of the initial directory server configured for this OpenAM server
    </p></dd><dt><span class="term">LDAP Bind DN</span></dt><dd><p>
     Bind DN for connecting to the directory server.
     Some OpenAM capabilities require write access to directory entries.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-authid</code>
    </p><p>
     Default:
     <code class="literal">CN=Administrator,CN=Users,<em class="replaceable"><code>base-dn</code></em></code>
    </p></dd><dt><span class="term">LDAP Bind Password</span></dt><dd><p>
     Bind password for connecting to the directory server
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-authpw</code>
    </p></dd><dt><span class="term">LDAP Organization DN</span></dt><dd><p>
     The base DN under which to find user and group profiles
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-organization_name</code>
    </p><p>
     Default:
     <code class="literal"><em class="replaceable"><code>base-dn</code></em></code>
    </p></dd><dt><span class="term">LDAP SSL/TLS Enabled</span></dt><dd><p>
     Whether to use LDAPS or StartTLS to connect to the directory server.
     If you enable SSL/TLS, OpenAM must be able to trust server certificates,
     either because the server certificates were signed by a CA
     whose certificate is already included in the trust store
     used by the container where OpenAM runs,
     or because you imported the certificates into the trust store.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-ssl-enabled</code>
    </p><p>
     Default:
     false
    </p></dd><dt><span class="term">LDAP Connection Pool Maximum Size</span></dt><dd><p>
     Maximum number of connections to the directory server.
     Make sure the directory service can cope
     with the maximum number of client connections across all servers.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-connection_pool_max_size</code>
    </p><p>
     Default:
     10
    </p></dd><dt><span class="term">LDAP Connection Heartbeat Interval</span></dt><dd><p>
     How often to send a heartbeat request to the directory server
     to ensure that the connection does not remain idle.
     Some network administrators configure firewalls
     and load balancers to drop connections that are idle for too long.
     You can turn this off by setting the value to 0 or to a negative number.
     To set the units for the interval use LDAP Connection Heartbeat Time Unit.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">openam-idrepo-ldapv3-heartbeat-interval</code>
    </p><p>
     Default:
     10
    </p></dd><dt><span class="term">LDAP Connection Heartbeat Time Unit</span></dt><dd><p>
     Time unit for the LDAP Connection Heartbeat Interval setting
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">openam-idrepo-ldapv3-heartbeat-timeunit</code>
    </p><p>
     Default:
     <code class="literal">second</code>
    </p></dd><dt><span class="term">Maximum Results Returned from Search</span></dt><dd><p>
     A cap for the number of search results to request.
     For example when using the Subjects tab to view profiles,
     even if you set
     Configuration &gt; Console &gt; Administration &gt; Maximum Results Returned from Search
     to a larger number, OpenAM does not exceed this setting.
     Rather than raise this number,
     consider narrowing your search to match fewer directory entries.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-max-result</code>
    </p><p>
     Default:
     1000
    </p></dd><dt><span class="term">Search Timeout</span></dt><dd><p>
     Maximum time to wait for search results in seconds.
     Does not apply to persistent searches.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-time-limit</code>
    </p><p>
     Default:
     10
    </p></dd><dt><span class="term">LDAPv3 Plug-in Search Scope</span></dt><dd><p>
     LDAP searches can apply to a single entry (SCOPE_BASE),
     entries directly below the search DN (SCOPE_ONE),
     or all entries below the search DN (SEARCH_SUB)
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-search-scope</code>
    </p><p>
     Default:
     <code class="literal">SCOPE_SUB</code>
    </p></dd><dt><span class="term">LDAPv3 Repository Plug-in Class Name</span></dt><dd><p>
     OpenAM identity repository implementation
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sunIdRepoClass</code>
    </p><p>
     Default:
     <code class="literal">org.forgerock.openam.idrepo.ldap.DJLDAPv3Repo</code>
    </p></dd><dt><span class="term">Attribute Name Mapping</span></dt><dd><p>
     Map of OpenAM profile attribute names to directory server attribute names
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sunIdRepoAttributeMapping</code>
    </p><p>
     Default:
     <code class="literal">userPassword=unicodePwd</code>
    </p></dd><dt><span class="term">LDAPv3 Plug-in Supported Types and Operations</span></dt><dd><p>
     Map of OpenAM operations that can be performed in the specified OpenAM contexts
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sunIdRepoSupportedOperations</code>
    </p><p>
     Default:
     <code class="literal">group=read,create,edit,delete</code>,
     <code class="literal">realm=read,create,edit,delete,service</code>,
     <code class="literal">user=read,create,edit,delete</code>
    </p></dd><dt><span class="term">LDAP Users Search Attribute</span></dt><dd><p>
     When searching for a user by name, match values against this attribute
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-users-search-attribute</code>
    </p><p>
     Default:
     <code class="literal">cn</code>
    </p></dd><dt><span class="term">LDAP Users Search Filter</span></dt><dd><p>
     When searching for users, apply this LDAP search filter as well
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-users-search-filter</code>
    </p><p>
     Default:
     <code class="literal">(objectclass=person)</code>
    </p></dd><dt><span class="term">LDAP People Container Naming Attribute</span></dt><dd><p>
     RDN attribute of the LDAP base DN which contains user profiles
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-people-container-name</code>
    </p></dd><dt><span class="term">LDAP People Container Value</span></dt><dd><p>
     RDN attribute value of the LDAP base DN which contains user profiles
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-people-container-value</code>
    </p></dd><dt><span class="term">LDAP User Object Class</span></dt><dd><p>
     User profiles have these LDAP object classes
    </p><p>
     OpenAM handles only those attributes listed in this setting.
     OpenAM discards any unlisted attributes from requests
     and the request proceeds without the attribute.
    </p><p>
     For example, with default settings
     if you request that OpenAM execute a search that asks for
     the <code class="literal">mailAlternateAddress</code> attribute,
     OpenAM does the search, but does not request
     <code class="literal">mailAlternateAddress</code>.
     In the same way, OpenAM does perform an update operation
     with a request to set the value of an unlisted attribute
     like <code class="literal">mailAlternateAddress</code>,
     but it drops the unlisted attribute from the update request.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-user-objectclass</code>
    </p><p>
     Default:
     <code class="literal">devicePrintProfilesContainer</code>,
     <code class="literal">forgerock-am-dashboard-service</code>,
     <code class="literal">iplanet-am-auth-configuration-service</code>,
     <code class="literal">iplanet-am-managed-person</code>,
     <code class="literal">iplanet-am-user-service</code>,
     <code class="literal">iPlanetPreferences</code>,
     <code class="literal">organizationalPerson</code>,
     <code class="literal">person</code>,
     <code class="literal">sunAMAuthAccountLockout</code>,
     <code class="literal">sunFederationManagerDataStore</code>,
     <code class="literal">sunFMSAML2NameIdentifier</code>,
     <code class="literal">sunIdentityServerLibertyPPService</code>,
     <code class="literal">top</code>,
     <code class="literal">User</code>
    </p></dd><dt><span class="term">LDAP User Attributes</span></dt><dd><p>
     User profiles have these LDAP attributes
    </p><p>
     OpenAM handles only those attributes listed in this setting.
     OpenAM discards any unlisted attributes from requests
     and the request proceeds without the attribute.
    </p><p>
     For example, with default settings
     if you request that OpenAM execute a search that asks for
     the <code class="literal">mailAlternateAddress</code> attribute,
     OpenAM does the search, but does not request
     <code class="literal">mailAlternateAddress</code>.
     In the same way, OpenAM does perform an update operation
     with a request to set the value of an unlisted attribute
     like <code class="literal">mailAlternateAddress</code>,
     but it drops the unlisted attribute from the update request.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-user-attributes</code>
    </p><p>
     Default:
     <code class="literal">assignedDashboard</code>,
     <code class="literal">cn</code>,
     <code class="literal">devicePrintProfiles</code>,
     <code class="literal">displayName</code>,
     <code class="literal">distinguishedName</code>,
     <code class="literal">dn</code>,
     <code class="literal">employeeNumber</code>,
     <code class="literal">givenName</code>,
     <code class="literal">iplanet-am-auth-configuration</code>,
     <code class="literal">iplanet-am-session-add-session-listener-on-all-sessions</code>,
     <code class="literal">iplanet-am-session-destroy-sessions</code>,
     <code class="literal">iplanet-am-session-get-valid-sessions</code>,
     <code class="literal">iplanet-am-session-max-caching-time</code>,
     <code class="literal">iplanet-am-session-max-idle-time</code>,
     <code class="literal">iplanet-am-session-max-session-time</code>,
     <code class="literal">iplanet-am-session-quota-limit</code>,
     <code class="literal">iplanet-am-session-service-status</code>,
     <code class="literal">iplanet-am-user-account-life</code>,
     <code class="literal">iplanet-am-user-admin-start-dn</code>,
     <code class="literal">iplanet-am-user-alias-list</code>,
     <code class="literal">iplanet-am-user-auth-config</code>,
     <code class="literal">iplanet-am-user-auth-modules</code>,
     <code class="literal">iplanet-am-user-failure-url</code>,
     <code class="literal">iplanet-am-user-federation-info-key</code>,
     <code class="literal">iplanet-am-user-federation-info</code>,
     <code class="literal">iplanet-am-user-login-status</code>,
     <code class="literal">iplanet-am-user-password-reset-force-reset</code>,
     <code class="literal">iplanet-am-user-password-reset-options</code>,
     <code class="literal">iplanet-am-user-password-reset-question-answer</code>,
     <code class="literal">iplanet-am-user-success-url</code>,
     <code class="literal">mail</code>,
     <code class="literal">name</code>,
     <code class="literal">objectclass</code>,
     <code class="literal">objectGUID</code>,
     <code class="literal">postalAddress</code>,
     <code class="literal">preferredlanguage</code>,
     <code class="literal">preferredLocale</code>,
     <code class="literal">preferredtimezone</code>,
     <code class="literal">sAMAccountName</code>,
     <code class="literal">sn</code>,
     <code class="literal">sun-fm-saml2-nameid-info</code>,
     <code class="literal">sun-fm-saml2-nameid-infokey</code>,
     <code class="literal">sunAMAuthInvalidAttemptsData</code>,
     <code class="literal">sunIdentityMSISDNNumber</code>,
     <code class="literal">sunIdentityServerDiscoEntries</code>,
     <code class="literal">sunIdentityServerPPAddressCard</code>,
     <code class="literal">sunIdentityServerPPCommonNameAltCN</code>,
     <code class="literal">sunIdentityServerPPCommonNameCN</code>,
     <code class="literal">sunIdentityServerPPCommonNameFN</code>,
     <code class="literal">sunIdentityServerPPCommonNameMN</code>,
     <code class="literal">sunIdentityServerPPCommonNamePT</code>,
     <code class="literal">sunIdentityServerPPCommonNameSN</code>,
     <code class="literal">sunIdentityServerPPDemographicsAge</code>,
     <code class="literal">sunIdentityServerPPDemographicsBirthDay</code>,
     <code class="literal">sunIdentityServerPPDemographicsDisplayLanguage</code>,
     <code class="literal">sunIdentityServerPPDemographicsLanguage</code>,
     <code class="literal">sunIdentityServerPPDemographicsTimeZone</code>,
     <code class="literal">sunIdentityServerPPEmergencyContact</code>,
     <code class="literal">sunIdentityServerPPEmploymentIdentityAltO</code>,
     <code class="literal">sunIdentityServerPPEmploymentIdentityJobTitle</code>,
     <code class="literal">sunIdentityServerPPEmploymentIdentityOrg</code>,
     <code class="literal">sunIdentityServerPPEncryPTKey</code>,
     <code class="literal">sunIdentityServerPPFacadegreetmesound</code>,
     <code class="literal">sunIdentityServerPPFacadeGreetSound</code>,
     <code class="literal">sunIdentityServerPPFacadeMugShot</code>,
     <code class="literal">sunIdentityServerPPFacadeNamePronounced</code>,
     <code class="literal">sunIdentityServerPPFacadeWebSite</code>,
     <code class="literal">sunIdentityServerPPInformalName</code>,
     <code class="literal">sunIdentityServerPPLegalIdentityAltIdType</code>,
     <code class="literal">sunIdentityServerPPLegalIdentityAltIdValue</code>,
     <code class="literal">sunIdentityServerPPLegalIdentityDOB</code>,
     <code class="literal">sunIdentityServerPPLegalIdentityGender</code>,
     <code class="literal">sunIdentityServerPPLegalIdentityLegalName</code>,
     <code class="literal">sunIdentityServerPPLegalIdentityMaritalStatus</code>,
     <code class="literal">sunIdentityServerPPLegalIdentityVATIdType</code>,
     <code class="literal">sunIdentityServerPPLegalIdentityVATIdValue</code>,
     <code class="literal">sunIdentityServerPPMsgContact</code>,
     <code class="literal">sunIdentityServerPPSignKey</code>,
     <code class="literal">telephoneNumber</code>,
     <code class="literal">unicodePwd</code>,
     <code class="literal">userAccountControl</code>,
     <code class="literal">userpassword</code>,
     <code class="literal">userPrincipalname</code>
    </p></dd><dt><span class="term">Create User Attribute Mapping</span></dt><dd><p>
     When creating a user profile,
     apply this map of OpenAM profile attribute names
     to directory server attribute names.
    </p><p>
     Attributes not mapped to another attribute
     (for example, <code class="literal">cn</code>)
     and attributes mapped to themselves
     (for example, <code class="literal">cn=cn</code>)
     take the value of the username
     unless the attribute values are provided when creating the profile.
     The object classes for user profile LDAP entries
     generally require Common Name (cn) and Surname (sn) attributes,
     so this prevents an LDAP constraint violation
     when performing the add operation.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-createuser-attr-mapping</code>
    </p><p>
     Default:
     <code class="literal">cn</code>,
     <code class="literal">sn</code>
    </p></dd><dt><span class="term">Attribute Name of User Status</span></dt><dd><p>
     Attribute to check/set user status
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-isactive</code>
    </p><p>
     Default:
     <code class="literal">msDS-UserAccountDisabled</code>
    </p></dd><dt><span class="term">User Status Active Value</span></dt><dd><p>
     Active users have the user status attribute set to this value.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-active</code>
    </p><p>
     Default:
     FALSE
    </p></dd><dt><span class="term">User Status Inactive Value</span></dt><dd><p>
     Inactive users have the user status attribute set to this value.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-inactive</code>
    </p><p>
     Default:
     TRUE
    </p></dd><dt><span class="term">Authentication Naming Attribute</span></dt><dd><p>
     RDN attribute for building the bind DN when given a username and password
     to authenticate a user against the directory server
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-auth-naming-attr</code>
    </p><p>
     Default:
     <code class="literal">cn</code>
    </p></dd><dt><span class="term">LDAP Groups Search Attribute</span></dt><dd><p>
     When searching for a group by name, match values against this attribute
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-groups-search-attribute</code>
    </p><p>
     Default:
     <code class="literal">cn</code>
    </p></dd><dt><span class="term">LDAP Groups Search Filter</span></dt><dd><p>
     When searching for groups, apply this LDAP search filter as well
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-groups-search-filter</code>
    </p><p>
     Default:
     <code class="literal">(objectclass=group)</code>
    </p></dd><dt><span class="term">LDAP Groups Container Naming Attribute</span></dt><dd><p>
     RDN attribute of the LDAP base DN which contains group profiles
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-group-container-name</code>
    </p><p>
     Default:
     <code class="literal">cn</code>
    </p></dd><dt><span class="term">LDAP Groups Container Value</span></dt><dd><p>
     RDN attribute value of the LDAP base DN which contains group profiles
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-group-container-value</code>
    </p></dd><dt><span class="term">LDAP Groups Object Class</span></dt><dd><p>
     Group profiles have these LDAP object classes
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-group-objectclass</code>
    </p><p>
     Default:
     <code class="literal">Group</code>,
     <code class="literal">top</code>
    </p></dd><dt><span class="term">LDAP Groups Attributes</span></dt><dd><p>
     Group profiles have these LDAP attributes
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-group-attributes</code>
    </p><p>
     Default:
     <code class="literal">cn</code>,
     <code class="literal">distinguishedName</code>,
     <code class="literal">dn</code>,
     <code class="literal">member</code>,
     <code class="literal">name</code>,
     <code class="literal">objectCategory</code>,
     <code class="literal">objectclass</code>,
     <code class="literal">sAMAccountName</code>,
     <code class="literal">sAMAccountType</code>
    </p></dd><dt><span class="term">Attribute Name for Group Membership</span></dt><dd><p>
     LDAP attribute in the member's LDAP entry
     whose values are the groups to which a member belongs
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-memberof</code>
    </p></dd><dt><span class="term">Attribute Name of Unique Member</span></dt><dd><p>
     Attribute in the group's LDAP entry
     whose values are the members of the group
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-uniquemember</code>
    </p><p>
     Default:
     <code class="literal">member</code>
    </p></dd><dt><span class="term">Persistent Search Base DN</span></dt><dd><p>
     Base DN for LDAP persistent searches used
     to receive notification of changes in directory server data
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-psearchbase</code>
    </p><p>
     Default:
     <code class="literal"><em class="replaceable"><code>base-dn</code></em></code>
    </p></dd><dt><span class="term">Persistent Search Scope</span></dt><dd><p>
     LDAP searches can apply to a single entry (SCOPE_BASE),
     entries directly below the search DN (SCOPE_ONE),
     or all entries below the search DN (SEARCH_SUB)
    </p><p>
     Specify either <code class="literal">SCOPE_BASE</code>
     or <code class="literal">SCOPE_ONE</code>.
     Do not specify <code class="literal">SCOPE_SUB</code>,
     as it can have a severe impact on Active Directory performance.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-psearch-scope</code>
    </p><p>
     Default:
     <code class="literal">SCOPE_SUB</code>
    </p></dd><dt><span class="term">The Delay Time Between Retries</span></dt><dd><p>
     How long to wait after receiving an error result
     that indicates OpenAM should try the LDAP operation again
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">com.iplanet.am.ldap.connection.delay.between.retries</code>
    </p><p>
     Default:
     1000 milliseconds
    </p></dd><dt><span class="term">DN Cache Enabled</span></dt><dd><p>
     Whether to enable the DN cache, which is used to cache DN lookups
     that can happen in bursts during authentication.
     As the cache can become stale when a user is moved or renamed,
     enable DN caching when the directory service allows move/rename operations (Mod DN),
     and when OpenAM uses persistent searches to obtain notification of such updates.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-dncache-enabled</code>
    </p><p>
     Default:
     false
    </p></dd><dt><span class="term">DN Cache Size</span></dt><dd><p>
     Maximum number of DNs cached when caching is enabled
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-dncache-size</code>
    </p><p>
     Default:
     1500 items
    </p></dd></dl></div></div><div lang="en" class="section"><div class="titlepage"><div><div><h3 class="title"><a name="sec-data-stores-db"></a>4.3.3.&nbsp;Hints for Configuring Database Repository (Early Access) Data Stores</h3></div></div></div><p>
  Use these hints when configuring Database Repository (Early Access) Data Stores.
 </p><div class="important"><h3 class="title">Important</h3><p>
   This feature is in Early Access,
   meaning it is not generally supported for use in production environments.
   If you expect to use a relational database as an identity repository
   other than for development or testing purposes,
   first confirm supportability of your configuration with an expert.
   You can contact ForgeRock at
   <a class="link" href="mailto:info@forgerock.com" target="_top">info@forgerock.com</a>.
  </p></div><a class="indexterm" name="d16037e11496"></a><p>
  <span class="command"><strong>ssoadm</strong></span> service name:
  <code class="literal">sunIdentityRepositoryService</code>
 </p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Name</span></dt><dd><p>
     Name for the data store configuration
    </p></dd><dt><span class="term">Load schema when finished</span></dt><dd><p>
     Add the appropriate schema to the database on saving the configuration.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">idRepoLoadSchema</code>
    </p><p>
     Default:
     false
    </p></dd><dt><span class="term">Database Data Access Object Plugin Class Name</span></dt><dd><p>
     OpenAM data access implementation
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-opensso-database-dao-class-name</code>
    </p><p>
     Default:
     <code class="literal">com.sun.identity.idm.plugins.database.JdbcSimpleUserDao</code>
    </p></dd><dt><span class="term">Connection Type</span></dt><dd><p>
     Whether to connect directly to the database,
     or to connect through JNDI provided by the container where OpenAM runs
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-opensso-database-dao-JDBCConnectionType</code>
    </p><p>
     Default:
     Connection is retrieved via programmatic connection
    </p></dd><dt><span class="term">Database DataSource Name</span></dt><dd><p>
     Data source name from the container configuration when connecting over JNDI
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-opensso-database-DataSourceJndiName</code>
    </p><p>
     Default:
     <code class="literal">java:comp/env/jdbc/openssousersdb</code>
    </p></dd><dt><span class="term">JDBC Driver Class Name</span></dt><dd><p>
     Driver class used when connecting directly
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-opensso-database-JDBCDriver</code>
    </p><p>
     Default:
     <code class="literal">com.mysql.jdbc.Driver</code>
    </p></dd><dt><span class="term">JDBC Driver URL</span></dt><dd><p>
     URL used when connecting directly
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-opensso-database-JDBCUrl</code>
    </p><p>
     Default:
     <code class="literal">jdbc:mysql://127.0.0.1:3306/test</code>
    </p></dd><dt><span class="term">Connect This User to Database</span></dt><dd><p>
     Username used when connecting directly
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-opensso-database-JDBCDbuser</code>
    </p><p>
     Default:
     <code class="literal">root</code>
    </p></dd><dt><span class="term">Password for Connecting to Database</span></dt><dd><p>
     Password used when connecting directly
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-opensso-database-JDBCDbpassword</code>
    </p></dd><dt><span class="term">Maximum Results Returned from Search</span></dt><dd><p>
     A cap for the number of search results to request.
     For example when using the Subjects tab to view profiles,
     even if you set
     Configuration &gt; Console &gt; Administration &gt; Maximum Results Returned from Search
     to a larger number, OpenAM does not exceed this setting.
     Rather than raise this number,
     consider narrowing your search to match fewer profiles.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-opensso-database-config-max-result</code>
    </p><p>
     Default:
     1000
    </p></dd><dt><span class="term">Database Repository Plugin Class Name</span></dt><dd><p>
     OpenAM identity repository implementation
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sunIdRepoClass</code>
    </p><p>
     Default:
     <code class="literal">com.sun.identity.idm.plugins.database.DatabaseRepo</code>
    </p></dd><dt><span class="term">Attribute Name Mapping</span></dt><dd><p>
     Map of OpenAM profile attribute names to database column names
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sunIdRepoAttributeMapping</code>
    </p><p>
     Default:
     <code class="literal">iplanet-am-user-account-life=iplanet_am_user_account_life</code>,
     <code class="literal">iplanet-am-user-alias-list=iplanet_am_user_alias_list</code>,
     <code class="literal">iplanet-am-user-auth-config=iplanet_am_user_auth_config</code>,
     <code class="literal">iplanet-am-user-failure-url=iplanet_am_user_failure_url</code>,
     <code class="literal">iplanet-am-user-password-reset-force-reset=iplanet_am_user_password_reset_force_reset</code>,
     <code class="literal">iplanet-am-user-password-reset-question-answer=iplanet_am_user_password_reset_question_answer</code>,
     <code class="literal">iplanet-am-user-password-resetoptions=iplanet_am_user_password_resetoptions</code>,
     <code class="literal">iplanet-am-user-success-url=iplanet_am_user_success_url</code>
    </p></dd><dt><span class="term">Database Plug-in Supported Types and Operations</span></dt><dd><p>
     Map of OpenAM operations that can be performed in the specified OpenAM contexts
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-opensso-database-sunIdRepoSupportedOperations</code>
    </p><p>
     Default:
     <code class="literal">group=read,create,edit,delete</code>,
     <code class="literal">user=read,create,edit,delete,service</code>
    </p></dd><dt><span class="term">Database User Table Name</span></dt><dd><p>
     Table to store user profiles
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-opensso-database-UserTableName</code>
    </p><p>
     Default:
     <code class="literal">opensso_users</code>
    </p></dd><dt><span class="term">List of User Attributes Names in Database</span></dt><dd><p>
     Columns for user profile attributes
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-opensso-database-UserAttrs</code>
    </p><p>
     Default:
     <code class="literal">ChangePassword</code>,
     <code class="literal">cn</code>,
     <code class="literal">employeenumber</code>,
     <code class="literal">givenname</code>,
     <code class="literal">inetuserstatus</code>,
     <code class="literal">iplanet_am_user_account_life</code>,
     <code class="literal">iplanet_am_user_alias_list</code>,
     <code class="literal">iplanet_am_user_auth_config</code>,
     <code class="literal">iplanet_am_user_failure_url</code>,
     <code class="literal">iplanet_am_user_password_reset_force_reset</code>,
     <code class="literal">iplanet_am_user_password_reset_question_answer</code>,
     <code class="literal">iplanet_am_user_password_resetoptions</code>,
     <code class="literal">iplanet_am_user_success_url</code>,
     <code class="literal">mail</code>,
     <code class="literal">manager</code>,
     <code class="literal">postaladdress</code>,
     <code class="literal">preferredlocale</code>,
     <code class="literal">sn</code>,
     <code class="literal">sunIdentityMSISDNNumber</code>,
     <code class="literal">telephonenumber</code>,
     <code class="literal">uid</code>,
     <code class="literal">userpassword</code>
    </p></dd><dt><span class="term">User Password Attribute Name</span></dt><dd><p>
     Column for user passwords
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-opensso-database-UserPasswordAttr</code>
    </p><p>
     Default:
     <code class="literal">userpassword</code>
    </p></dd><dt><span class="term">User ID Attribute Name</span></dt><dd><p>
     Column for user IDs
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-opensso-database-UserIDAttr</code>
    </p><p>
     Default:
     <code class="literal">uid</code>
    </p></dd><dt><span class="term">Attribute Name of User Status</span></dt><dd><p>
     Column to check/set user status
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-opensso-database-UserStatusAttr</code>
    </p><p>
     Default:
     <code class="literal">inetuserstatus</code>
    </p></dd><dt><span class="term">User Status Active Value</span></dt><dd><p>
     Active users have the user status set to this value.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-opensso-database-activeValue</code>
    </p><p>
     Default:
     <code class="literal">Active</code>
    </p></dd><dt><span class="term">User Status Inactive Value</span></dt><dd><p>
     Inactive users have the user status set to this value.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-opensso-database-inactiveValue</code>
    </p><p>
     Default:
     <code class="literal">Inactive</code>
    </p></dd><dt><span class="term">Users Search Attribute in Database</span></dt><dd><p>
     Key for looking up user profiles by name
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-opensso-database-config-users-search-attribute</code>
    </p><p>
     Default:
     <code class="literal">cn</code>
    </p></dd><dt><span class="term">Database Membership table name</span></dt><dd><p>
     Table to store group profiles
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-opensso-database-MembershipTableName</code>
    </p><p>
     Default:
     <code class="literal">groups</code>
    </p></dd><dt><span class="term">Membership ID Attribute Name</span></dt><dd><p>
     Column for group IDs
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-opensso-database-MembershipIDAttr</code>
    </p><p>
     Default:
     <code class="literal">group_name</code>
    </p></dd><dt><span class="term">Membership Search Attribute in Database</span></dt><dd><p>
     Key for looking up group profiles by name
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-opensso-database-membership-search-attribute</code>
    </p><p>
     Default:
     <code class="literal">cn</code>
    </p></dd></dl></div></div><div lang="en" class="section"><div class="titlepage"><div><div><h3 class="title"><a name="sec-data-stores-generic-ldapv3"></a>4.3.4.&nbsp;Hints for Configuring Generic LDAPv3 Data Stores</h3></div></div></div><p>
  Use these hints when configuring Generic LDAPv3 compliant Data Stores.
 </p><a class="indexterm" name="d16037e12032"></a><p>
  <span class="command"><strong>ssoadm</strong></span> service name:
  <code class="literal">sunIdentityRepositoryService</code>
 </p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Name</span></dt><dd><p>
     Name for the data store configuration
    </p></dd><dt><span class="term">Load schema when finished</span></dt><dd><p>
     Add appropriate LDAP schema to the directory server
     when saving the configuration.
     The LDAP Bind DN user must have access to perform this operation.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">idRepoLoadSchema</code>
    </p><p>
     Default:
     false
    </p></dd><dt><span class="term">LDAP Server</span></dt><dd><p>
     <code class="literal"><em class="replaceable"><code>host</code></em>:<em class="replaceable"><code>port</code></em></code>
     to contact the directory server, with optional
     <code class="literal">|<em class="replaceable"><code>server_ID</code></em>|<em class="replaceable"><code>site_ID</code></em></code>
     for deployments with multiple servers and sites
    </p><div class="orderedlist"><p>
      OpenAM uses the optional settings to determine
      which directory server to contact first.
      OpenAM tries to contact directory servers
      in the following priority order, with highest priority first.
     </p><ol class="orderedlist" type="1"><li class="listitem"><p>
       The first directory server in the list
       whose <em class="replaceable"><code>server_ID</code></em>
       matches the current OpenAM server
      </p></li><li class="listitem"><p>
       The first directory server in the list
       whose <em class="replaceable"><code>site_ID</code></em>
       matches the current OpenAM server
      </p></li><li class="listitem"><p>
       The first directory server in the remaining list
      </p></li></ol></div><p>
     If the directory server is not available,
     OpenAM proceeds to the next directory server in the list.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-ldap-server</code>
    </p><p>
     Default:
     <code class="literal"><em class="replaceable"><code>host</code></em>:<em class="replaceable"><code>port</code></em></code>
     of the initial directory server configured for this OpenAM server
    </p></dd><dt><span class="term">LDAP Bind DN</span></dt><dd><p>
     Bind DN for connecting to the directory server.
     Some OpenAM capabilities require write access to directory entries.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-authid</code>
    </p></dd><dt><span class="term">LDAP Bind Password</span></dt><dd><p>
     Bind password for connecting to the directory server
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-authpw</code>
    </p></dd><dt><span class="term">LDAP Organization DN</span></dt><dd><p>
     The base DN under which to find user and group profiles
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-organization_name</code>
    </p><p>
     Default:
     <code class="literal"><em class="replaceable"><code>base-dn</code></em></code>
    </p></dd><dt><span class="term">LDAP SSL/TLS Enabled</span></dt><dd><p>
     Whether to use LDAPS or StartTLS to connect to the directory server.
     If you enable SSL/TLS, OpenAM must be able to trust server certificates,
     either because the server certificates were signed by a CA
     whose certificate is already included in the trust store
     used by the container where OpenAM runs,
     or because you imported the certificates into the trust store.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-ssl-enabled</code>
    </p><p>
     Default:
     false
    </p></dd><dt><span class="term">LDAP Connection Pool Maximum Size</span></dt><dd><p>
     Maximum number of connections to the directory server.
     Make sure the directory service can cope
     with the maximum number of client connections across all servers.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-connection_pool_max_size</code>
    </p><p>
     Default:
     10
    </p></dd><dt><span class="term">LDAP Connection Heartbeat Interval</span></dt><dd><p>
     How often to send a heartbeat request to the directory server
     to ensure that the connection does not remain idle.
     Some network administrators configure firewalls
     and load balancers to drop connections that are idle for too long.
     You can turn this off by setting the value to 0 or to a negative number.
     To set the units for the interval use LDAP Connection Heartbeat Time Unit.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">openam-idrepo-ldapv3-heartbeat-interval</code>
    </p><p>
     Default:
     10
    </p></dd><dt><span class="term">LDAP Connection Heartbeat Time Unit</span></dt><dd><p>
     Time unit for the LDAP Connection Heartbeat Interval setting
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">openam-idrepo-ldapv3-heartbeat-timeunit</code>
    </p><p>
     Default:
     <code class="literal">second</code>
    </p></dd><dt><span class="term">Maximum Results Returned from Search</span></dt><dd><p>
     A cap for the number of search results to request.
     For example when using the Subjects tab to view profiles,
     even if you set
     Configuration &gt; Console &gt; Administration &gt; Maximum Results Returned from Search
     to a larger number, OpenAM does not exceed this setting.
     Rather than raise this number,
     consider narrowing your search to match fewer directory entries.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-max-result</code>
    </p><p>
     Default:
     1000
    </p></dd><dt><span class="term">Search Timeout</span></dt><dd><p>
     Maximum time to wait for search results in seconds.
     Does not apply to persistent searches.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-time-limit</code>
    </p><p>
     Default:
     10
    </p></dd><dt><span class="term">LDAPv3 Plug-in Search Scope</span></dt><dd><p>
     LDAP searches can apply to a single entry (SCOPE_BASE),
     entries directly below the search DN (SCOPE_ONE),
     or all entries below the search DN (SEARCH_SUB)
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-search-scope</code>
    </p><p>
     Default:
     <code class="literal">SCOPE_SUB</code>
    </p></dd><dt><span class="term">LDAPv3 Repository Plug-in Class Name</span></dt><dd><p>
     OpenAM identity repository implementation
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sunIdRepoClass</code>
    </p><p>
     Default:
     <code class="literal">org.forgerock.openam.idrepo.ldap.DJLDAPv3Repo</code>
    </p></dd><dt><span class="term">Attribute Name Mapping</span></dt><dd><p>
     Map of OpenAM profile attribute names to directory server attribute names
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sunIdRepoAttributeMapping</code>
    </p></dd><dt><span class="term">LDAPv3 Plug-in Supported Types and Operations</span></dt><dd><p>
     Map of OpenAM operations that can be performed in the specified OpenAM contexts
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sunIdRepoSupportedOperations</code>
    </p><p>
     Default:
     <code class="literal">realm=read,create,edit,delete,service</code>,
     <code class="literal">user=read,create,edit,delete</code>,
     <code class="literal">group=read,create,edit,delete</code>
    </p></dd><dt><span class="term">LDAP Users Search Attribute</span></dt><dd><p>
     When searching for a user by name, match values against this attribute
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-users-search-attribute</code>
    </p><p>
     Default:
     <code class="literal">uid</code>
    </p></dd><dt><span class="term">LDAP Users Search Filter</span></dt><dd><p>
     When searching for users, apply this LDAP search filter as well
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-users-search-filter</code>
    </p><p>
     Default:
     <code class="literal">(objectclass=inetorgperson)</code>
    </p></dd><dt><span class="term">LDAP People Container Naming Attribute</span></dt><dd><p>
     RDN attribute of the LDAP base DN which contains user profiles
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-people-container-name</code>
    </p></dd><dt><span class="term">LDAP People Container Value</span></dt><dd><p>
     RDN attribute value of the LDAP base DN which contains user profiles
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-people-container-value</code>
    </p></dd><dt><span class="term">LDAP User Object Class</span></dt><dd><p>
     User profiles have these LDAP object classes
    </p><p>
     OpenAM handles only those attributes listed in this setting.
     OpenAM discards any unlisted attributes from requests
     and the request proceeds without the attribute.
    </p><p>
     For example, with default settings
     if you request that OpenAM execute a search that asks for
     the <code class="literal">mailAlternateAddress</code> attribute,
     OpenAM does the search, but does not request
     <code class="literal">mailAlternateAddress</code>.
     In the same way, OpenAM does perform an update operation
     with a request to set the value of an unlisted attribute
     like <code class="literal">mailAlternateAddress</code>,
     but it drops the unlisted attribute from the update request.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-user-objectclass</code>
    </p><p>
     Default:
     <code class="literal">inetorgperson</code>,
     <code class="literal">inetUser</code>,
     <code class="literal">organizationalPerson</code>,
     <code class="literal">person</code>,
     <code class="literal">top</code>,
    </p></dd><dt><span class="term">LDAP User Attributes</span></dt><dd><p>
     User profiles have these LDAP attributes
    </p><p>
     OpenAM handles only those attributes listed in this setting.
     OpenAM discards any unlisted attributes from requests
     and the request proceeds without the attribute.
    </p><p>
     For example, with default settings
     if you request that OpenAM execute a search that asks for
     the <code class="literal">mailAlternateAddress</code> attribute,
     OpenAM does the search, but does not request
     <code class="literal">mailAlternateAddress</code>.
     In the same way, OpenAM does perform an update operation
     with a request to set the value of an unlisted attribute
     like <code class="literal">mailAlternateAddress</code>,
     but it drops the unlisted attribute from the update request.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-user-attributes</code>
    </p><p>
     Default:
     <code class="literal">uid</code>,
     <code class="literal">caCertificate</code>,
     <code class="literal">authorityRevocationList</code>,
     <code class="literal">inetUserStatus</code>,
     <code class="literal">mail</code>,
     <code class="literal">sn</code>,
     <code class="literal">manager</code>,
     <code class="literal">userPassword</code>,
     <code class="literal">adminRole</code>,
     <code class="literal">objectClass</code>,
     <code class="literal">givenName</code>,
     <code class="literal">memberOf</code>,
     <code class="literal">cn</code>,
     <code class="literal">telephoneNumber</code>,
     <code class="literal">preferredlanguage</code>,
     <code class="literal">userCertificate</code>,
     <code class="literal">postalAddress</code>,
     <code class="literal">dn</code>,
     <code class="literal">employeeNumber</code>,
     <code class="literal">distinguishedName</code>
    </p></dd><dt><span class="term">Create User Attribute Mapping</span></dt><dd><p>
     When creating a user profile,
     apply this map of OpenAM profile attribute names
     to directory server attribute names.
    </p><p>
     Attributes not mapped to another attribute
     (for example, <code class="literal">cn</code>)
     and attributes mapped to themselves
     (for example, <code class="literal">cn=cn</code>)
     take the value of the username
     unless the attribute values are provided when creating the profile.
     The object classes for user profile LDAP entries
     generally require Common Name (cn) and Surname (sn) attributes,
     so this prevents an LDAP constraint violation
     when performing the add operation.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-createuser-attr-mapping</code>
    </p><p>
     Default:
     <code class="literal">cn</code>, <code class="literal">sn</code>
    </p></dd><dt><span class="term">Attribute Name of User Status</span></dt><dd><p>
     Attribute to check/set user status
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-isactive</code>
    </p><p>
     Default:
     <code class="literal">inetuserstatus</code>
    </p></dd><dt><span class="term">User Status Active Value</span></dt><dd><p>
     Active users have the user status attribute set to this value.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-active</code>
    </p><p>
     Default:
     <code class="literal">Active</code>
    </p></dd><dt><span class="term">User Status Inactive Value</span></dt><dd><p>
     Inactive users have the user status attribute set to this value.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-inactive</code>
    </p><p>
     Default:
     <code class="literal">Inactive</code>
    </p></dd><dt><span class="term">Authentication Naming Attribute</span></dt><dd><p>
     RDN attribute for building the bind DN when given a username and password
     to authenticate a user against the directory server
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-auth-naming-attr</code>
    </p><p>
     Default:
     <code class="literal">uid</code>
    </p></dd><dt><span class="term">LDAP Groups Search Attribute</span></dt><dd><p>
     When searching for a group by name, match values against this attribute
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-groups-search-attribute</code>
    </p><p>
     Default:
     <code class="literal">cn</code>
    </p></dd><dt><span class="term">LDAP Groups Search Filter</span></dt><dd><p>
     When searching for groups, apply this LDAP search filter as well
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-groups-search-filter</code>
    </p><p>
     Default:
     <code class="literal">(objectclass=groupOfUniqueNames)</code>
    </p></dd><dt><span class="term">LDAP Groups Container Naming Attribute</span></dt><dd><p>
     RDN attribute of the LDAP base DN which contains group profiles
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-group-container-name</code>
    </p><p>
     Default:
     <code class="literal">ou</code>
    </p></dd><dt><span class="term">LDAP Groups Container Value</span></dt><dd><p>
     RDN attribute value of the LDAP base DN which contains group profiles
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-group-container-value</code>
    </p><p>
     Default:
     <code class="literal">groups</code>
    </p></dd><dt><span class="term">LDAP Groups Object Class</span></dt><dd><p>
     Group profiles have these LDAP object classes
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-group-objectclass</code>
    </p><p>
     Default:
     <code class="literal">groupofuniquenames</code>,
     <code class="literal">top</code>
    </p></dd><dt><span class="term">LDAP Groups Attributes</span></dt><dd><p>
     Group profiles have these LDAP attributes
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-group-attributes</code>
    </p><p>
     Default:
     <code class="literal">ou</code>,
     <code class="literal">cn</code>,
     <code class="literal">description</code>,
     <code class="literal">dn</code>,
     <code class="literal">objectclass</code>,
     <code class="literal">uniqueMember</code>
    </p></dd><dt><span class="term">Attribute Name for Group Membership</span></dt><dd><p>
     LDAP attribute in the member's LDAP entry
     whose values are the groups to which a member belongs
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-memberof</code>
    </p></dd><dt><span class="term">Attribute Name of Unique Member</span></dt><dd><p>
     Attribute in the group's LDAP entry
     whose values are the members of the group
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-uniquemember</code>
    </p><p>
     Default:
     <code class="literal">uniqueMember</code>
    </p></dd><dt><span class="term">Attribute Name of Group Member URL</span></dt><dd><p>
     Attribute in the dynamic group's LDAP entry
     whose value is a URL specifying the members of the group
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-memberurl</code>
    </p><p>
     Default:
     <code class="literal">memberUrl</code>
    </p></dd><dt><span class="term">Default Group Member's User DN</span></dt><dd><p>
     DN of member added to all newly created groups
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-dftgroupmember</code>
    </p></dd><dt><span class="term">Persistent Search Base DN</span></dt><dd><p>
     Base DN for LDAP persistent searches used
     to receive notification of changes in directory server data
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-psearchbase</code>
    </p><p>
     Default:
     <code class="literal"><em class="replaceable"><code>base-dn</code></em></code>
    </p></dd><dt><span class="term">Persistent Search Filter</span></dt><dd><p>
     LDAP filter to apply when performing persistent searches
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-psearch-filter</code>
    </p><p>
     Default:
     <code class="literal">(objectclass=*)</code>
    </p></dd><dt><span class="term">Persistent Search Scope</span></dt><dd><p>
     LDAP searches can apply to a single entry (SCOPE_BASE),
     entries directly below the search DN (SCOPE_ONE),
     or all entries below the search DN (SEARCH_SUB)
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-psearch-scope</code>
    </p><p>
     Default:
     <code class="literal">SCOPE_SUB</code>
    </p></dd><dt><span class="term">The Delay Time Between Retries</span></dt><dd><p>
     How long to wait after receiving an error result
     that indicates OpenAM should try the LDAP operation again
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">com.iplanet.am.ldap.connection.delay.between.retries</code>
    </p><p>
     Default:
     1000 milliseconds
    </p></dd><dt><span class="term">DN Cache Enabled</span></dt><dd><p>
     Whether to enable the DN cache, which is used to cache DN lookups
     that can happen in bursts during authentication.
     As the cache can become stale when a user is moved or renamed,
     enable DN caching when the directory service allows move/rename operations (Mod DN),
     and when OpenAM uses persistent searches to obtain notification of such updates.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-dncache-enabled</code>
    </p><p>
     Default:
     false
    </p></dd><dt><span class="term">DN Cache Size</span></dt><dd><p>
     Maximum number of DNs cached when caching is enabled
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-dncache-size</code>
    </p><p>
     Default:
     1500 items
    </p></dd></dl></div></div><div lang="en" class="section"><div class="titlepage"><div><div><h3 class="title"><a name="sec-data-stores-opendj"></a>4.3.5.&nbsp;Hints for Configuring OpenDJ Data Stores</h3></div></div></div><p>
  Use these hints when configuring OpenDJ Data Stores.
 </p><a class="indexterm" name="d16037e12965"></a><p>
  <span class="command"><strong>ssoadm</strong></span> service name:
  <code class="literal">sunIdentityRepositoryService</code>
 </p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Name</span></dt><dd><p>
     Name for the data store configuration
    </p></dd><dt><span class="term">Load schema when finished</span></dt><dd><p>
     Add appropriate LDAP schema to the directory server
     when saving the configuration.
     The LDAP Bind DN user must have access to perform this operation.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">idRepoLoadSchema</code>
    </p><p>
     Default:
     false
    </p></dd><dt><span class="term">LDAP Server</span></dt><dd><p>
     <code class="literal"><em class="replaceable"><code>host</code></em>:<em class="replaceable"><code>port</code></em></code>
     to contact the directory server, with optional
     <code class="literal">|<em class="replaceable"><code>server_ID</code></em>|<em class="replaceable"><code>site_ID</code></em></code>
     for deployments with multiple servers and sites
    </p><div class="orderedlist"><p>
      OpenAM uses the optional settings to determine
      which directory server to contact first.
      OpenAM tries to contact directory servers
      in the following priority order, with highest priority first.
     </p><ol class="orderedlist" type="1"><li class="listitem"><p>
       The first directory server in the list
       whose <em class="replaceable"><code>server_ID</code></em>
       matches the current OpenAM server
      </p></li><li class="listitem"><p>
       The first directory server in the list
       whose <em class="replaceable"><code>site_ID</code></em>
       matches the current OpenAM server
      </p></li><li class="listitem"><p>
       The first directory server in the remaining list
      </p></li></ol></div><p>
     If the directory server is not available,
     OpenAM proceeds to the next directory server in the list.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-ldap-server</code>
    </p><p>
     Default:
     <code class="literal"><em class="replaceable"><code>host</code></em>:<em class="replaceable"><code>port</code></em></code>
     of the initial directory server configured for this OpenAM server
    </p></dd><dt><span class="term">LDAP Bind DN</span></dt><dd><p>
     Bind DN for connecting to the directory server.
     Some OpenAM capabilities require write access to directory entries.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-authid</code>
    </p></dd><dt><span class="term">LDAP Bind Password</span></dt><dd><p>
     Bind password for connecting to the directory server
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-authpw</code>
    </p></dd><dt><span class="term">LDAP Organization DN</span></dt><dd><p>
     The base DN under which to find user and group profiles
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-organization_name</code>
    </p><p>
     Default:
     <code class="literal"><em class="replaceable"><code>base-dn</code></em></code>
    </p></dd><dt><span class="term">LDAP SSL/TLS Enabled</span></dt><dd><p>
     Whether to use LDAPS or StartTLS to connect to the directory server.
     If you enable SSL/TLS, OpenAM must be able to trust server certificates,
     either because the server certificates were signed by a CA
     whose certificate is already included in the trust store
     used by the container where OpenAM runs,
     or because you imported the certificates into the trust store.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-ssl-enabled</code>
    </p><p>
     Default:
     false
    </p></dd><dt><span class="term">LDAP Connection Pool Maximum Size</span></dt><dd><p>
     Maximum number of connections to the directory server.
     Make sure the directory service can cope
     with the maximum number of client connections across all servers.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-connection_pool_max_size</code>
    </p><p>
     Default:
     10
    </p></dd><dt><span class="term">LDAP Connection Heartbeat Interval</span></dt><dd><p>
     How often to send a heartbeat request to the directory server
     to ensure that the connection does not remain idle.
     Some network administrators configure firewalls
     and load balancers to drop connections that are idle for too long.
     You can turn this off by setting the value to 0 or to a negative number.
     To set the units for the interval use LDAP Connection Heartbeat Time Unit.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">openam-idrepo-ldapv3-heartbeat-interval</code>
    </p><p>
     Default:
     10
    </p></dd><dt><span class="term">LDAP Connection Heartbeat Time Unit</span></dt><dd><p>
     Time unit for the LDAP Connection Heartbeat Interval setting
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">openam-idrepo-ldapv3-heartbeat-timeunit</code>
    </p><p>
     Default:
     <code class="literal">second</code>
    </p></dd><dt><span class="term">Maximum Results Returned from Search</span></dt><dd><p>
     A cap for the number of search results to request.
     For example when using the Subjects tab to view profiles,
     even if you set
     Configuration &gt; Console &gt; Administration &gt; Maximum Results Returned from Search
     to a larger number, OpenAM does not exceed this setting.
     Rather than raise this number,
     consider narrowing your search to match fewer directory entries.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-max-result</code>
    </p><p>
     Default:
     1000
    </p></dd><dt><span class="term">Search Timeout</span></dt><dd><p>
     Maximum time to wait for search results in seconds.
     Does not apply to persistent searches.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-time-limit</code>
    </p><p>
     Default:
     10
    </p></dd><dt><span class="term">LDAPv3 Plug-in Search Scope</span></dt><dd><p>
     LDAP searches can apply to a single entry (SCOPE_BASE),
     entries directly below the search DN (SCOPE_ONE),
     or all entries below the search DN (SEARCH_SUB)
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-search-scope</code>
    </p><p>
     Default:
     <code class="literal">SCOPE_SUB</code>
    </p></dd><dt><span class="term">LDAPv3 Repository Plug-in Class Name</span></dt><dd><p>
     OpenAM identity repository implementation
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sunIdRepoClass</code>
    </p><p>
     Default:
     <code class="literal">org.forgerock.openam.idrepo.ldap.DJLDAPv3Repo</code>
    </p></dd><dt><span class="term">Attribute Name Mapping</span></dt><dd><p>
     Map of OpenAM profile attribute names to directory server attribute names
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sunIdRepoAttributeMapping</code>
    </p></dd><dt><span class="term">LDAPv3 Plug-in Supported Types and Operations</span></dt><dd><p>
     Map of OpenAM operations that can be performed in the specified OpenAM contexts
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sunIdRepoSupportedOperations</code>
    </p><p>
     Default:
     <code class="literal">realm=read,create,edit,delete,service</code>,
     <code class="literal">user=read,create,edit,delete</code>,
     <code class="literal">group=read,create,edit,delete</code>
    </p></dd><dt><span class="term">LDAP Users Search Attribute</span></dt><dd><p>
     When searching for a user by name, match values against this attribute
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-users-search-attribute</code>
    </p><p>
     Default:
     <code class="literal">uid</code>
    </p></dd><dt><span class="term">LDAP Users Search Filter</span></dt><dd><p>
     When searching for users, apply this LDAP search filter as well
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-users-search-filter</code>
    </p><p>
     Default:
     <code class="literal">(objectclass=inetorgperson)</code>
    </p></dd><dt><span class="term">LDAP People Container Naming Attribute</span></dt><dd><p>
     RDN attribute of the LDAP base DN which contains user profiles
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-people-container-name</code>
    </p><p>
     Default:
     <code class="literal">ou</code>
    </p></dd><dt><span class="term">LDAP People Container Value</span></dt><dd><p>
     RDN attribute value of the LDAP base DN which contains user profiles
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-people-container-value</code>
    </p><p>
     Default:
     <code class="literal">people</code>
    </p></dd><dt><span class="term">LDAP User Object Class</span></dt><dd><p>
     User profiles have these LDAP object classes
    </p><p>
     OpenAM handles only those attributes listed in this setting.
     OpenAM discards any unlisted attributes from requests
     and the request proceeds without the attribute.
    </p><p>
     For example, with default settings
     if you request that OpenAM execute a search that asks for
     the <code class="literal">mailAlternateAddress</code> attribute,
     OpenAM does the search, but does not request
     <code class="literal">mailAlternateAddress</code>.
     In the same way, OpenAM does perform an update operation
     with a request to set the value of an unlisted attribute
     like <code class="literal">mailAlternateAddress</code>,
     but it drops the unlisted attribute from the update request.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-user-objectclass</code>
    </p><p>
     Default:
     <code class="literal">devicePrintProfilesContainer</code>,
     <code class="literal">forgerock-am-dashboard-service</code>,
     <code class="literal">inetorgperson</code>,
     <code class="literal">inetuser</code>,
     <code class="literal">iplanet-am-auth-configuration-service</code>,
     <code class="literal">iplanet-am-managed-person</code>,
     <code class="literal">iplanet-am-user-service</code>,
     <code class="literal">iPlanetPreferences</code>,
     <code class="literal">organizationalperson</code>,
     <code class="literal">person</code>,
     <code class="literal">sunAMAuthAccountLockout</code>,
     <code class="literal">sunFederationManagerDataStore</code>,
     <code class="literal">sunFMSAML2NameIdentifier</code>,
     <code class="literal">sunIdentityServerLibertyPPService</code>,
     <code class="literal">top</code>
    </p></dd><dt><span class="term">LDAP User Attributes</span></dt><dd><p>
     User profiles have these LDAP attributes
    </p><p>
     OpenAM handles only those attributes listed in this setting.
     OpenAM discards any unlisted attributes from requests
     and the request proceeds without the attribute.
    </p><p>
     For example, with default settings
     if you request that OpenAM execute a search that asks for
     the <code class="literal">mailAlternateAddress</code> attribute,
     OpenAM does the search, but does not request
     <code class="literal">mailAlternateAddress</code>.
     In the same way, OpenAM does perform an update operation
     with a request to set the value of an unlisted attribute
     like <code class="literal">mailAlternateAddress</code>,
     but it drops the unlisted attribute from the update request.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-user-attributes</code>
    </p><p>
     Default:
     <code class="literal">sunIdentityServerPPDemographicsBirthDay</code>,
     <code class="literal">uid</code>,
     <code class="literal">sunIdentityServerPPLegalIdentityLegalName</code>,
     <code class="literal">manager</code>,
     <code class="literal">assignedDashboard</code>,
     <code class="literal">sunIdentityServerPPCommonNameSN</code>,
     <code class="literal">userPassword</code>,
     <code class="literal">iplanet-am-session-get-valid-sessions</code>,
     <code class="literal">sunIdentityServerPPEmploymentIdentityJobTitle</code>,
     <code class="literal">iplanet-am-user-password-reset-question-answer</code>,
     <code class="literal">sunIdentityServerPPLegalIdentityDOB</code>,
     <code class="literal">sunIdentityServerPPEmergencyContact</code>,
     <code class="literal">sunIdentityServerPPCommonNameCN</code>,
     <code class="literal">iplanet-am-user-success-url</code>,
     <code class="literal">iplanet-am-user-admin-start-dn</code>,
     <code class="literal">iplanet-am-user-federation-info</code>,
     <code class="literal">userCertificate</code>,
     <code class="literal">sunIdentityServerPPFacadeGreetSound</code>,
     <code class="literal">sunAMAuthInvalidAttemptsData</code>,
     <code class="literal">sunIdentityServerPPFacadeNamePronounced</code>,
     <code class="literal">distinguishedName</code>,
     <code class="literal">sunIdentityServerPPDemographicsTimeZone</code>,
     <code class="literal">sunIdentityMSISDNNumber</code>,
     <code class="literal">iplanet-am-session-max-caching-time</code>,
     <code class="literal">sn</code>,
     <code class="literal">iplanet-am-session-quota-limit</code>,
     <code class="literal">iplanet-am-session-max-session-time</code>,
     <code class="literal">adminRole</code>,
     <code class="literal">sunIdentityServerPPEmploymentIdentityAltO</code>,
     <code class="literal">objectClass</code>,
     <code class="literal">sun-fm-saml2-nameid-info</code>,
     <code class="literal">sunIdentityServerPPLegalIdentityMaritalStatus</code>,
     <code class="literal">iplanet-am-user-login-status</code>,
     <code class="literal">sunIdentityServerPPLegalIdentityAltIdType</code>,
     <code class="literal">devicePrintProfiles</code>,
     <code class="literal">iplanet-am-session-max-idle-time</code>,
     <code class="literal">sunIdentityServerPPFacadegreetmesound</code>,
     <code class="literal">cn</code>,
     <code class="literal">iplanet-am-user-password-reset-options</code>,
     <code class="literal">telephoneNumber</code>,
     <code class="literal">preferredlanguage</code>,
     <code class="literal">iplanet-am-user-federation-info-key</code>,
     <code class="literal">sunIdentityServerPPMsgContact</code>,
     <code class="literal">sunIdentityServerPPLegalIdentityGender</code>,
     <code class="literal">iplanet-am-user-alias-list</code>,
     <code class="literal">sunIdentityServerPPCommonNameFN</code>,
     <code class="literal">caCertificate</code>,
     <code class="literal">inetUserStatus</code>,
     <code class="literal">sunIdentityServerPPCommonNameMN</code>,
     <code class="literal">sunIdentityServerPPEncryPTKey</code>,
     <code class="literal">givenName</code>,
     <code class="literal">memberOf</code>,
     <code class="literal">sunIdentityServerPPLegalIdentityVATIdValue</code>,
     <code class="literal">preferredLocale</code>,
     <code class="literal">iplanet-am-session-service-status</code>,
     <code class="literal">sun-fm-saml2-nameid-infokey</code>,
     <code class="literal">sunIdentityServerPPDemographicsAge</code>,
     <code class="literal">sunIdentityServerDiscoEntries</code>,
     <code class="literal">sunIdentityServerPPLegalIdentityVATIdType</code>,
     <code class="literal">iplanet-am-user-auth-config</code>,
     <code class="literal">iplanet-am-user-failure-url</code>,
     <code class="literal">sunIdentityServerPPAddressCard</code>,
     <code class="literal">sunIdentityServerPPCommonNamePT</code>,
     <code class="literal">dn</code>,
     <code class="literal">iplanet-am-session-add-session-listener-on-all-sessions</code>,
     <code class="literal">mail</code>,
     <code class="literal">authorityRevocationList</code>,
     <code class="literal">iplanet-am-user-password-reset-force-reset</code>,
     <code class="literal">inetUserHttpURL</code>,
     <code class="literal">sunIdentityServerPPLegalIdentityAltIdValue</code>,
     <code class="literal">sunIdentityServerPPCommonNameAltCN</code>,
     <code class="literal">preferredtimezone</code>,
     <code class="literal">sunIdentityServerPPInformalName</code>,
     <code class="literal">sunIdentityServerPPSignKey</code>,
     <code class="literal">sunIdentityServerPPEmploymentIdentityOrg</code>,
     <code class="literal">iplanet-am-session-destroy-sessions</code>,
     <code class="literal">sunIdentityServerPPFacadeMugShot</code>,
     <code class="literal">sunIdentityServerPPFacadeWebSite</code>,
     <code class="literal">sunIdentityServerPPDemographicsDisplayLanguage</code>,
     <code class="literal">postalAddress</code>,
     <code class="literal">iplanet-am-auth-configuration</code>,
     <code class="literal">employeeNumber</code>,
     <code class="literal">iplanet-am-user-account-life</code>,
     <code class="literal">iplanet-am-user-auth-modules</code>,
     <code class="literal">sunIdentityServerPPDemographicsLanguage</code>
    </p></dd><dt><span class="term">Create User Attribute Mapping</span></dt><dd><p>
     When creating a user profile,
     apply this map of OpenAM profile attribute names
     to directory server attribute names.
    </p><p>
     Attributes not mapped to another attribute
     (for example, <code class="literal">cn</code>)
     and attributes mapped to themselves
     (for example, <code class="literal">cn=cn</code>)
     take the value of the username
     unless the attribute values are provided when creating the profile.
     The object classes for user profile LDAP entries
     generally require Common Name (cn) and Surname (sn) attributes,
     so this prevents an LDAP constraint violation
     when performing the add operation.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-createuser-attr-mapping</code>
    </p><p>
     Default:
     <code class="literal">cn</code>, <code class="literal">sn</code>
    </p></dd><dt><span class="term">Attribute Name of User Status</span></dt><dd><p>
     Attribute to check/set user status
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-isactive</code>
    </p><p>
     Default:
     <code class="literal">inetuserstatus</code>
    </p></dd><dt><span class="term">User Status Active Value</span></dt><dd><p>
     Active users have the user status attribute set to this value.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-active</code>
    </p><p>
     Default:
     <code class="literal">Active</code>
    </p></dd><dt><span class="term">User Status Inactive Value</span></dt><dd><p>
     Inactive users have the user status attribute set to this value.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-inactive</code>
    </p><p>
     Default:
     <code class="literal">Inactive</code>
    </p></dd><dt><span class="term">Authentication Naming Attribute</span></dt><dd><p>
     RDN attribute for building the bind DN when given a username and password
     to authenticate a user against the directory server
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-auth-naming-attr</code>
    </p><p>
     Default:
     <code class="literal">uid</code>
    </p></dd><dt><span class="term">LDAP Groups Search Attribute</span></dt><dd><p>
     When searching for a group by name, match values against this attribute
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-groups-search-attribute</code>
    </p><p>
     Default:
     <code class="literal">cn</code>
    </p></dd><dt><span class="term">LDAP Groups Search Filter</span></dt><dd><p>
     When searching for groups, apply this LDAP search filter as well
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-groups-search-filter</code>
    </p><p>
     Default:
     <code class="literal">(objectclass=groupOfUniqueNames)</code>
    </p></dd><dt><span class="term">LDAP Groups Container Naming Attribute</span></dt><dd><p>
     RDN attribute of the LDAP base DN which contains group profiles
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-group-container-name</code>
    </p><p>
     Default:
     <code class="literal">ou</code>
    </p></dd><dt><span class="term">LDAP Groups Container Value</span></dt><dd><p>
     RDN attribute value of the LDAP base DN which contains group profiles
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-group-container-value</code>
    </p><p>
     Default:
     <code class="literal">groups</code>
    </p></dd><dt><span class="term">LDAP Groups Object Class</span></dt><dd><p>
     Group profiles have these LDAP object classes
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-group-objectclass</code>
    </p><p>
     Default:
     <code class="literal">groupofuniquenames</code>,
     <code class="literal">top</code>
    </p></dd><dt><span class="term">LDAP Groups Attributes</span></dt><dd><p>
     Group profiles have these LDAP attributes
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-group-attributes</code>
    </p><p>
     Default:
     <code class="literal">cn</code>,
     <code class="literal">dn</code>,
     <code class="literal">objectclass</code>,
     <code class="literal">uniqueMember</code>
    </p></dd><dt><span class="term">Attribute Name for Group Membership</span></dt><dd><p>
     LDAP attribute in the member's LDAP entry
     whose values are the groups to which a member belongs
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-memberof</code>
    </p></dd><dt><span class="term">Attribute Name of Unique Member</span></dt><dd><p>
     Attribute in the group's LDAP entry
     whose values are the members of the group
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-uniquemember</code>
    </p><p>
     Default:
     <code class="literal">uniqueMember</code>
    </p></dd><dt><span class="term">Persistent Search Base DN</span></dt><dd><p>
     Base DN for LDAP persistent searches used
     to receive notification of changes in directory server data
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-psearchbase</code>
    </p><p>
     Default:
     <code class="literal"><em class="replaceable"><code>base-dn</code></em></code>
    </p></dd><dt><span class="term">Persistent Search Filter</span></dt><dd><p>
     LDAP filter to apply when performing persistent searches
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-psearch-filter</code>
    </p><p>
     Default:
     <code class="literal">(objectclass=*)</code>
    </p></dd><dt><span class="term">Persistent Search Scope</span></dt><dd><p>
     LDAP searches can apply to a single entry (SCOPE_BASE),
     entries directly below the search DN (SCOPE_ONE),
     or all entries below the search DN (SEARCH_SUB)
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-psearch-scope</code>
    </p><p>
     Default:
     <code class="literal">SCOPE_SUB</code>
    </p></dd><dt><span class="term">The Delay Time Between Retries</span></dt><dd><p>
     How long to wait after receiving an error result
     that indicates OpenAM should try the LDAP operation again
    </p><p>
     The OpenDJ data store uses this setting only for persistent searches.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">com.iplanet.am.ldap.connection.delay.between.retries</code>
    </p><p>
     Default:
     1000 milliseconds
    </p></dd><dt><span class="term">DN Cache Enabled</span></dt><dd><p>
     Whether to enable the DN cache, which is used to cache DN lookups
     that can happen in bursts during authentication.
     As the cache can become stale when a user is moved or renamed,
     enable DN caching when the directory service allows move/rename operations (Mod DN),
     and when OpenAM uses persistent searches to obtain notification of such updates.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-dncache-enabled</code>
    </p><p>
     Default:
     true
    </p></dd><dt><span class="term">DN Cache Size</span></dt><dd><p>
     Maximum number of DNs cached when caching is enabled
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-dncache-size</code>
    </p><p>
     Default:
     1500 items
    </p></dd></dl></div></div><div lang="en" class="section"><div class="titlepage"><div><div><h3 class="title"><a name="sec-data-stores-dsee"></a>4.3.6.&nbsp;Hints for Configuring Sun/Oracle DSEE Data Stores</h3></div></div></div><p>
  Use these hints when configuring Data Stores
  for Oracle DSEE or Sun DSEE using OpenAM schema.
 </p><a class="indexterm" name="d16037e14096"></a><p>
  <span class="command"><strong>ssoadm</strong></span> service name:
  <code class="literal">sunIdentityRepositoryService</code>
 </p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Name</span></dt><dd><p>
     Name for the data store configuration
    </p></dd><dt><span class="term">Load schema when finished</span></dt><dd><p>
     Add appropriate LDAP schema to the directory server
     when saving the configuration.
     The LDAP Bind DN user must have access to perform this operation.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">idRepoLoadSchema</code>
    </p><p>
     Default:
     false
    </p></dd><dt><span class="term">LDAP Server</span></dt><dd><p>
     <code class="literal"><em class="replaceable"><code>host</code></em>:<em class="replaceable"><code>port</code></em></code>
     to contact the directory server, with optional
     <code class="literal">|<em class="replaceable"><code>server_ID</code></em>|<em class="replaceable"><code>site_ID</code></em></code>
     for deployments with multiple servers and sites
    </p><div class="orderedlist"><p>
      OpenAM uses the optional settings to determine
      which directory server to contact first.
      OpenAM tries to contact directory servers
      in the following priority order, with highest priority first.
     </p><ol class="orderedlist" type="1"><li class="listitem"><p>
       The first directory server in the list
       whose <em class="replaceable"><code>server_ID</code></em>
       matches the current OpenAM server
      </p></li><li class="listitem"><p>
       The first directory server in the list
       whose <em class="replaceable"><code>site_ID</code></em>
       matches the current OpenAM server
      </p></li><li class="listitem"><p>
       The first directory server in the remaining list
      </p></li></ol></div><p>
     If the directory server is not available,
     OpenAM proceeds to the next directory server in the list.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-ldap-server</code>
    </p><p>
     Default:
     <code class="literal"><em class="replaceable"><code>host</code></em>:<em class="replaceable"><code>port</code></em></code>
     of the initial directory server configured for this OpenAM server
    </p></dd><dt><span class="term">LDAP Bind DN</span></dt><dd><p>
     Bind DN for connecting to the directory server.
     Some OpenAM capabilities require write access to directory entries.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-authid</code>
    </p><p>
     Default:
     <code class="literal">cn=dsameuser,ou=DSAME Users,<em class="replaceable"><code>base-dn</code></em></code>
    </p></dd><dt><span class="term">LDAP Bind Password</span></dt><dd><p>
     Bind password for connecting to the directory server
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-authpw</code>
    </p></dd><dt><span class="term">LDAP Organization DN</span></dt><dd><p>
     The base DN under which to find user and group profiles
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-organization_name</code>
    </p><p>
     Default:
     <code class="literal"><em class="replaceable"><code>base-dn</code></em></code>
    </p></dd><dt><span class="term">LDAP SSL/TLS Enabled</span></dt><dd><p>
     Whether to use LDAPS or StartTLS to connect to the directory server.
     If you enable SSL/TLS, OpenAM must be able to trust server certificates,
     either because the server certificates were signed by a CA
     whose certificate is already included in the trust store
     used by the container where OpenAM runs,
     or because you imported the certificates into the trust store.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-ssl-enabled</code>
    </p><p>
     Default:
     false
    </p></dd><dt><span class="term">LDAP Connection Pool Maximum Size</span></dt><dd><p>
     Maximum number of connections to the directory server.
     Make sure the directory service can cope
     with the maximum number of client connections across all servers.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-connection_pool_max_size</code>
    </p><p>
     Default:
     10
    </p></dd><dt><span class="term">LDAP Connection Heartbeat Interval</span></dt><dd><p>
     How often to send a heartbeat request to the directory server
     to ensure that the connection does not remain idle.
     Some network administrators configure firewalls
     and load balancers to drop connections that are idle for too long.
     You can turn this off by setting the value to 0 or to a negative number.
     To set the units for the interval use LDAP Connection Heartbeat Time Unit.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">openam-idrepo-ldapv3-heartbeat-interval</code>
    </p><p>
     Default:
     10
    </p></dd><dt><span class="term">LDAP Connection Heartbeat Time Unit</span></dt><dd><p>
     Time unit for the LDAP Connection Heartbeat Interval setting
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">openam-idrepo-ldapv3-heartbeat-timeunit</code>
    </p><p>
     Default:
     <code class="literal">second</code>
    </p></dd><dt><span class="term">Maximum Results Returned from Search</span></dt><dd><p>
     A cap for the number of search results to request.
     For example when using the Subjects tab to view profiles,
     even if you set
     Configuration &gt; Console &gt; Administration &gt; Maximum Results Returned from Search
     to a larger number, OpenAM does not exceed this setting.
     Rather than raise this number,
     consider narrowing your search to match fewer directory entries.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-max-result</code>
    </p><p>
     Default:
     1000
    </p></dd><dt><span class="term">Search Timeout</span></dt><dd><p>
     Maximum time to wait for search results in seconds.
     Does not apply to persistent searches.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-time-limit</code>
    </p><p>
     Default:
     10
    </p></dd><dt><span class="term">LDAPv3 Plug-in Search Scope</span></dt><dd><p>
     LDAP searches can apply to a single entry (SCOPE_BASE),
     entries directly below the search DN (SCOPE_ONE),
     or all entries below the search DN (SEARCH_SUB)
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-search-scope</code>
    </p><p>
     Default:
     <code class="literal">SCOPE_SUB</code>
    </p></dd><dt><span class="term">LDAPv3 Repository Plug-in Class Name</span></dt><dd><p>
     OpenAM identity repository implementation
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sunIdRepoClass</code>
    </p><p>
     Default:
     <code class="literal">org.forgerock.openam.idrepo.ldap.DJLDAPv3Repo</code>
    </p></dd><dt><span class="term">Attribute Name Mapping</span></dt><dd><p>
     Map of OpenAM profile attribute names to directory server attribute names
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sunIdRepoAttributeMapping</code>
    </p></dd><dt><span class="term">LDAPv3 Plug-in Supported Types and Operations</span></dt><dd><p>
     Map of OpenAM operations that can be performed in the specified OpenAM contexts
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sunIdRepoSupportedOperations</code>
    </p><p>
     Default:
     <code class="literal">filteredrole=read,create,edit,delete</code>,
     <code class="literal">group=read,create,edit,delete</code>,
     <code class="literal">realm=read,create,edit,delete,service</code>,
     <code class="literal">role=read,create,edit,delete</code>,
     <code class="literal">user=read,create,edit,delete,service</code>
    </p></dd><dt><span class="term">LDAP Users Search Attribute</span></dt><dd><p>
     When searching for a user by name, match values against this attribute
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-users-search-attribute</code>
    </p><p>
     Default:
     <code class="literal">uid</code>
    </p></dd><dt><span class="term">LDAP Users Search Filter</span></dt><dd><p>
     When searching for users, apply this LDAP search filter as well
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-users-search-filter</code>
    </p><p>
     Default:
     <code class="literal">(objectclass=inetorgperson)</code>
    </p></dd><dt><span class="term">LDAP People Container Naming Attribute</span></dt><dd><p>
     RDN attribute of the LDAP base DN which contains user profiles
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-people-container-name</code>
    </p><p>
     Default:
     <code class="literal">ou</code>
    </p></dd><dt><span class="term">LDAP People Container Value</span></dt><dd><p>
     RDN attribute value of the LDAP base DN which contains user profiles
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-people-container-value</code>
    </p><p>
     Default:
     <code class="literal">people</code>
    </p></dd><dt><span class="term">LDAP User Object Class</span></dt><dd><p>
     User profiles have these LDAP object classes
    </p><p>
     OpenAM handles only those attributes listed in this setting.
     OpenAM discards any unlisted attributes from requests
     and the request proceeds without the attribute.
    </p><p>
     For example, with default settings
     if you request that OpenAM execute a search that asks for
     the <code class="literal">mailAlternateAddress</code> attribute,
     OpenAM does the search, but does not request
     <code class="literal">mailAlternateAddress</code>.
     In the same way, OpenAM does perform an update operation
     with a request to set the value of an unlisted attribute
     like <code class="literal">mailAlternateAddress</code>,
     but it drops the unlisted attribute from the update request.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-user-objectclass</code>
    </p><p>
     Default:
     <code class="literal">devicePrintProfilesContainer</code>,
     <code class="literal">forgerock-am-dashboard-service</code>,
     <code class="literal">inetadmin</code>,
     <code class="literal">inetorgperson</code>,
     <code class="literal">inetuser</code>,
     <code class="literal">iplanet-am-auth-configuration-service</code>,
     <code class="literal">iplanet-am-managed-person</code>,
     <code class="literal">iplanet-am-user-service</code>,
     <code class="literal">iPlanetPreferences</code>,
     <code class="literal">organizationalperson</code>,
     <code class="literal">person</code>,
     <code class="literal">sunAMAuthAccountLockout</code>,
     <code class="literal">sunFederationManagerDataStore</code>,
     <code class="literal">sunFMSAML2NameIdentifier</code>,
     <code class="literal">sunIdentityServerLibertyPPService</code>,
     <code class="literal">top</code>
    </p></dd><dt><span class="term">LDAP User Attributes</span></dt><dd><p>
     User profiles have these LDAP attributes
    </p><p>
     OpenAM handles only those attributes listed in this setting.
     OpenAM discards any unlisted attributes from requests
     and the request proceeds without the attribute.
    </p><p>
     For example, with default settings
     if you request that OpenAM execute a search that asks for
     the <code class="literal">mailAlternateAddress</code> attribute,
     OpenAM does the search, but does not request
     <code class="literal">mailAlternateAddress</code>.
     In the same way, OpenAM does perform an update operation
     with a request to set the value of an unlisted attribute
     like <code class="literal">mailAlternateAddress</code>,
     but it drops the unlisted attribute from the update request.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-user-attributes</code>
    </p><p>
     Default:
     <code class="literal">sunIdentityServerPPDemographicsBirthDay</code>,
     <code class="literal">uid</code>,
     <code class="literal">sunIdentityServerPPLegalIdentityLegalName</code>,
     <code class="literal">manager</code>,
     <code class="literal">assignedDashboard</code>,
     <code class="literal">sunIdentityServerPPCommonNameSN</code>,
     <code class="literal">userPassword</code>,
     <code class="literal">iplanet-am-session-get-valid-sessions</code>,
     <code class="literal">sunIdentityServerPPEmploymentIdentityJobTitle</code>,
     <code class="literal">iplanet-am-user-password-reset-question-answer</code>,
     <code class="literal">sunIdentityServerPPLegalIdentityDOB</code>,
     <code class="literal">sunIdentityServerPPEmergencyContact</code>,
     <code class="literal">sunIdentityServerPPCommonNameCN</code>,
     <code class="literal">iplanet-am-user-success-url</code>,
     <code class="literal">iplanet-am-user-admin-start-dn</code>,
     <code class="literal">iplanet-am-user-federation-info</code>,
     <code class="literal">userCertificate</code>,
     <code class="literal">sunIdentityServerPPFacadeGreetSound</code>,
     <code class="literal">sunAMAuthInvalidAttemptsData</code>,
     <code class="literal">sunIdentityServerPPFacadeNamePronounced</code>,
     <code class="literal">distinguishedName</code>,
     <code class="literal">sunIdentityServerPPDemographicsTimeZone</code>,
     <code class="literal">sunIdentityMSISDNNumber</code>,
     <code class="literal">iplanet-am-session-max-caching-time</code>,
     <code class="literal">sn</code>,
     <code class="literal">iplanet-am-session-quota-limit</code>,
     <code class="literal">iplanet-am-session-max-session-time</code>,
     <code class="literal">adminRole</code>,
     <code class="literal">sunIdentityServerPPEmploymentIdentityAltO</code>,
     <code class="literal">objectClass</code>,
     <code class="literal">sun-fm-saml2-nameid-info</code>,
     <code class="literal">sunIdentityServerPPLegalIdentityMaritalStatus</code>,
     <code class="literal">iplanet-am-user-login-status</code>,
     <code class="literal">sunIdentityServerPPLegalIdentityAltIdType</code>,
     <code class="literal">devicePrintProfiles</code>,
     <code class="literal">iplanet-am-session-max-idle-time</code>,
     <code class="literal">sunIdentityServerPPFacadegreetmesound</code>,
     <code class="literal">cn</code>,
     <code class="literal">iplanet-am-user-password-reset-options</code>,
     <code class="literal">telephoneNumber</code>,
     <code class="literal">preferredlanguage</code>,
     <code class="literal">iplanet-am-user-federation-info-key</code>,
     <code class="literal">sunIdentityServerPPMsgContact</code>,
     <code class="literal">sunIdentityServerPPLegalIdentityGender</code>,
     <code class="literal">iplanet-am-user-alias-list</code>,
     <code class="literal">sunIdentityServerPPCommonNameFN</code>,
     <code class="literal">caCertificate</code>,
     <code class="literal">inetUserStatus</code>,
     <code class="literal">sunIdentityServerPPCommonNameMN</code>,
     <code class="literal">sunIdentityServerPPEncryPTKey</code>,
     <code class="literal">givenName</code>,
     <code class="literal">memberOf</code>,
     <code class="literal">iplanet-am-static-group-dn</code>,
     <code class="literal">sunIdentityServerPPLegalIdentityVATIdValue</code>,
     <code class="literal">preferredLocale</code>,
     <code class="literal">iplanet-am-session-service-status</code>,
     <code class="literal">sun-fm-saml2-nameid-infokey</code>,
     <code class="literal">sunIdentityServerPPDemographicsAge</code>,
     <code class="literal">sunIdentityServerDiscoEntries</code>,
     <code class="literal">sunIdentityServerPPLegalIdentityVATIdType</code>,
     <code class="literal">iplanet-am-user-auth-config</code>,
     <code class="literal">iplanet-am-user-failure-url</code>,
     <code class="literal">sunIdentityServerPPAddressCard</code>,
     <code class="literal">sunIdentityServerPPCommonNamePT</code>,
     <code class="literal">dn</code>,
     <code class="literal">iplanet-am-session-add-session-listener-on-all-sessions</code>,
     <code class="literal">mail</code>,
     <code class="literal">authorityRevocationList</code>,
     <code class="literal">iplanet-am-user-password-reset-force-reset</code>,
     <code class="literal">inetUserHttpURL</code>,
     <code class="literal">sunIdentityServerPPLegalIdentityAltIdValue</code>,
     <code class="literal">sunIdentityServerPPCommonNameAltCN</code>,
     <code class="literal">preferredtimezone</code>,
     <code class="literal">sunIdentityServerPPInformalName</code>,
     <code class="literal">sunIdentityServerPPSignKey</code>,
     <code class="literal">sunIdentityServerPPEmploymentIdentityOrg</code>,
     <code class="literal">iplanet-am-session-destroy-sessions</code>,
     <code class="literal">sunIdentityServerPPFacadeMugShot</code>,
     <code class="literal">sunIdentityServerPPFacadeWebSite</code>,
     <code class="literal">sunIdentityServerPPDemographicsDisplayLanguage</code>,
     <code class="literal">postalAddress</code>,
     <code class="literal">iplanet-am-auth-configuration</code>,
     <code class="literal">employeeNumber</code>,
     <code class="literal">iplanet-am-user-auth-modules</code>,
     <code class="literal">iplanet-am-user-account-life</code>,
     <code class="literal">sunIdentityServerPPDemographicsLanguage</code>
    </p></dd><dt><span class="term">Create User Attribute Mapping</span></dt><dd><p>
     When creating a user profile,
     apply this map of OpenAM profile attribute names
     to directory server attribute names.
    </p><p>
     Attributes not mapped to another attribute
     (for example, <code class="literal">cn</code>)
     and attributes mapped to themselves
     (for example, <code class="literal">cn=cn</code>)
     take the value of the username
     unless the attribute values are provided when creating the profile.
     The object classes for user profile LDAP entries
     generally require Common Name (cn) and Surname (sn) attributes,
     so this prevents an LDAP constraint violation
     when performing the add operation.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-createuser-attr-mapping</code>
    </p><p>
     Default:
     <code class="literal">cn</code>,
     <code class="literal">sn</code>
    </p></dd><dt><span class="term">Attribute Name of User Status</span></dt><dd><p>
     Attribute to check/set user status
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-isactive</code>
    </p><p>
     Default:
     <code class="literal">inetuserstatus</code>
    </p></dd><dt><span class="term">User Status Active Value</span></dt><dd><p>
     Active users have the user status attribute set to this value.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-active</code>
    </p><p>
     Default:
     <code class="literal">Active</code>
    </p></dd><dt><span class="term">User Status Inactive Value</span></dt><dd><p>
     Inactive users have the user status attribute set to this value.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-inactive</code>
    </p><p>
     Default:
     <code class="literal">Inactive</code>
    </p></dd><dt><span class="term">Authentication Naming Attribute</span></dt><dd><p>
     RDN attribute for building the bind DN when given a username and password
     to authenticate a user against the directory server
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-auth-naming-attr</code>
    </p><p>
     Default:
     <code class="literal">uid</code>
    </p></dd><dt><span class="term">LDAP Groups Search Attribute</span></dt><dd><p>
     When searching for a group by name, match values against this attribute
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-groups-search-attribute</code>
    </p><p>
     Default:
     <code class="literal">cn</code>
    </p></dd><dt><span class="term">LDAP Groups Search Filter</span></dt><dd><p>
     When searching for groups, apply this LDAP search filter as well
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-groups-search-filter</code>
    </p><p>
     Default:
     <code class="literal">(objectclass=groupOfUniqueNames)</code>
    </p></dd><dt><span class="term">LDAP Groups Container Naming Attribute</span></dt><dd><p>
     RDN attribute of the LDAP base DN which contains group profiles
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-group-container-name</code>
    </p><p>
     Default:
     <code class="literal">ou</code>
    </p></dd><dt><span class="term">LDAP Groups Container Value</span></dt><dd><p>
     RDN attribute value of the LDAP base DN which contains group profiles
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-group-container-value</code>
    </p><p>
     Default:
     <code class="literal">groups</code>
    </p></dd><dt><span class="term">LDAP Groups Object Class</span></dt><dd><p>
     Group profiles have these LDAP object classes
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-group-objectclass</code>
    </p><p>
     Default:
     <code class="literal">groupofuniquenames</code>,
     <code class="literal">iplanet-am-managed-group</code>,
     <code class="literal">iplanet-am-managed-static-group</code>,
     <code class="literal">groupofurls</code>,
     <code class="literal">top</code>
    </p></dd><dt><span class="term">LDAP Groups Attributes</span></dt><dd><p>
     Group profiles have these LDAP attributes
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-group-attributes</code>
    </p><p>
     Default:
     <code class="literal">cn</code>,
     <code class="literal">iplanet-am-group-subscribable</code>,
     <code class="literal">dn</code>,
     <code class="literal">objectclass</code>,
     <code class="literal">uniqueMember</code>
    </p></dd><dt><span class="term">Attribute Name for Group Membership</span></dt><dd><p>
     LDAP attribute in the member's LDAP entry
     whose values are the groups to which a member belongs
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-memberof</code>
    </p></dd><dt><span class="term">Attribute Name of Unique Member</span></dt><dd><p>
     Attribute in the group's LDAP entry
     whose values are the members of the group
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-uniquemember</code>
    </p><p>
     Default:
     <code class="literal">uniqueMember</code>
    </p></dd><dt><span class="term">Attribute Name of Group Member URL</span></dt><dd><p>
     Attribute in the dynamic group's LDAP entry
     whose values are LDAP URLs specifying members of the group
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-memberurl</code>
    </p><p>
     Default:
     <code class="literal">memberUrl</code>
    </p></dd><dt><span class="term">LDAP Roles Search Attribute</span></dt><dd><p>
     When searching for a role by name, match values against this attribute
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-roles-search-attribute</code>
    </p><p>
     Default:
     <code class="literal">cn</code>
    </p></dd><dt><span class="term">LDAP Roles Search Filter</span></dt><dd><p>
     When searching for roles, apply this LDAP search filter as well
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-roles-search-filter</code>
    </p><p>
     Default:
     <code class="literal">(&amp;(objectclass=ldapsubentry)(objectclass=nsmanagedroledefinition))</code>
    </p></dd><dt><span class="term">LDAP Roles Object Class</span></dt><dd><p>
     Role profiles have these LDAP object classes
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-role-objectclass</code>
    </p><p>
     Default:
     <code class="literal">ldapsubentry</code>,
     <code class="literal">nsmanagedroledefinition</code>,
     <code class="literal">nsroledefinition</code>,
     <code class="literal">nssimpleroledefinition</code>,
     <code class="literal">top</code>
    </p></dd><dt><span class="term">LDAP Filter Roles Search Attribute</span></dt><dd><p>
     When searching for a filtered role by name, match values against this attribute
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-filterroles-search-attribute</code>
    </p><p>
     Default:
     <code class="literal">cn</code>
    </p></dd><dt><span class="term">LDAP Filter Roles Search Filter</span></dt><dd><p>
     When searching for filtered roles, apply this LDAP search filter as well
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-filterroles-search-filter</code>
    </p><p>
     Default:
     <code class="literal">(&amp;(objectclass=ldapsubentry)(objectclass=nsfilteredroledefinition))</code>
    </p></dd><dt><span class="term">LDAP Filter Roles Object Class</span></dt><dd><p>
     Filtered role profiles have these LDAP object classes
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-filterrole-objectclass</code>
    </p><p>
     Default:
     <code class="literal">ldapsubentry</code>,
     <code class="literal">nscomplexroledefinition</code>,
     <code class="literal">nsfilteredroledefinition</code>,
     <code class="literal">nsroledefinition</code>
    </p></dd><dt><span class="term">LDAP Filter Roles Attributes</span></dt><dd><p>
     Filtered role profiles have these LDAP attributes
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-filterrole-attributes</code>
    </p><p>
     Default:
     <code class="literal">nsRoleFilter</code>
    </p></dd><dt><span class="term">Attribute Name for Filtered Role Membership</span></dt><dd><p>
     LDAP attribute in the member's LDAP entry
     whose values are the filtered roles to which a member belongs
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-nsrole</code>
    </p><p>
     Default:
     <code class="literal">nsrole</code>
    </p></dd><dt><span class="term">Attribute Name of Role Membership</span></dt><dd><p>
     LDAP attribute in the member's LDAP entry
     whose values are the roles to which a member belongs
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-nsroledn</code>
    </p><p>
     Default:
     <code class="literal">nsRoleDN</code>
    </p></dd><dt><span class="term">Attribute Name of Filtered Role Filter</span></dt><dd><p>
     LDAP attribute whose values are the filters for filtered roles
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-nsrolefilter</code>
    </p><p>
     Default:
     <code class="literal">nsRoleFilter</code>
    </p></dd><dt><span class="term">Persistent Search Base DN</span></dt><dd><p>
     Base DN for LDAP persistent searches used
     to receive notification of changes in directory server data
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-psearchbase</code>
    </p><p>
     Default:
     <code class="literal"><em class="replaceable"><code>base-dn</code></em></code>
    </p></dd><dt><span class="term">Persistent Search Filter</span></dt><dd><p>
     LDAP filter to apply when performing persistent searches
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-psearch-filter</code>
    </p><p>
     Default:
     <code class="literal">(objectclass=*)</code>
    </p></dd><dt><span class="term">Persistent Search Scope</span></dt><dd><p>
     LDAP searches can apply to a single entry (SCOPE_BASE),
     entries directly below the search DN (SCOPE_ONE),
     or all entries below the search DN (SEARCH_SUB)
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-psearch-scope</code>
    </p><p>
     Default:
     <code class="literal">SCOPE_SUB</code>
    </p></dd><dt><span class="term">The Delay Time Between Retries</span></dt><dd><p>
     How long to wait after receiving an error result
     that indicates OpenAM should try the LDAP operation again
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">com.iplanet.am.ldap.connection.delay.between.retries</code>
    </p><p>
     Default:
     1000 milliseconds
    </p></dd><dt><span class="term">DN Cache Enabled</span></dt><dd><p>
     Whether to enable the DN cache, which is used to cache DN lookups
     that can happen in bursts during authentication.
     As the cache can become stale when a user is moved or renamed,
     enable DN caching when the directory service allows move/rename operations (Mod DN),
     and when OpenAM uses persistent searches to obtain notification of such updates.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-dncache-enabled</code>
    </p><p>
     Default:
     true
    </p></dd><dt><span class="term">DN Cache Size</span></dt><dd><p>
     Maximum number of DNs cached when caching is enabled
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-dncache-size</code>
    </p><p>
     Default:
     1500 items
    </p></dd></dl></div></div><div lang="en" class="section"><div class="titlepage"><div><div><h3 class="title"><a name="sec-data-stores-tivoli"></a>4.3.7.&nbsp;Hints for Configuring Tivoli Directory Server Data Stores</h3></div></div></div><p>
  Use these hints when configuring Tivoli Directory Server Data Stores.
 </p><a class="indexterm" name="d16037e15486"></a><p>
  <span class="command"><strong>ssoadm</strong></span> service name:
  <code class="literal">sunIdentityRepositoryService</code>
 </p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Name</span></dt><dd><p>
     Name for the data store configuration
    </p></dd><dt><span class="term">Load schema when finished</span></dt><dd><p>
     Add appropriate LDAP schema to the directory server
     when saving the configuration.
     The LDAP Bind DN user must have access to perform this operation.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">idRepoLoadSchema</code>
    </p><p>
     Default:
     false
    </p></dd><dt><span class="term">LDAP Server</span></dt><dd><p>
     <code class="literal"><em class="replaceable"><code>host</code></em>:<em class="replaceable"><code>port</code></em></code>
     to contact the directory server, with optional
     <code class="literal">|<em class="replaceable"><code>server_ID</code></em>|<em class="replaceable"><code>site_ID</code></em></code>
     for deployments with multiple servers and sites
    </p><div class="orderedlist"><p>
      OpenAM uses the optional settings to determine
      which directory server to contact first.
      OpenAM tries to contact directory servers
      in the following priority order, with highest priority first.
     </p><ol class="orderedlist" type="1"><li class="listitem"><p>
       The first directory server in the list
       whose <em class="replaceable"><code>server_ID</code></em>
       matches the current OpenAM server
      </p></li><li class="listitem"><p>
       The first directory server in the list
       whose <em class="replaceable"><code>site_ID</code></em>
       matches the current OpenAM server
      </p></li><li class="listitem"><p>
       The first directory server in the remaining list
      </p></li></ol></div><p>
     If the directory server is not available,
     OpenAM proceeds to the next directory server in the list.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-ldap-server</code>
    </p><p>
     Default:
     <code class="literal"><em class="replaceable"><code>host</code></em>:<em class="replaceable"><code>port</code></em></code>
     of the initial directory server configured for this OpenAM server
    </p></dd><dt><span class="term">LDAP Bind DN</span></dt><dd><p>
     Bind DN for connecting to the directory server.
     Some OpenAM capabilities require write access to directory entries.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-authid</code>
    </p></dd><dt><span class="term">LDAP Bind Password</span></dt><dd><p>
     Bind password for connecting to the directory server
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-authpw</code>
    </p></dd><dt><span class="term">LDAP Organization DN</span></dt><dd><p>
     The base DN under which to find user and group profiles
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-organization_name</code>
    </p><p>
     Default:
     <code class="literal"><em class="replaceable"><code>base-dn</code></em></code>
    </p></dd><dt><span class="term">LDAP SSL/TLS Enabled</span></dt><dd><p>
     Whether to use LDAPS or StartTLS to connect to the directory server.
     If you enable SSL/TLS, OpenAM must be able to trust server certificates,
     either because the server certificates were signed by a CA
     whose certificate is already included in the trust store
     used by the container where OpenAM runs,
     or because you imported the certificates into the trust store.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-ssl-enabled</code>
    </p><p>
     Default:
     false
    </p></dd><dt><span class="term">LDAP Connection Pool Maximum Size</span></dt><dd><p>
     Maximum number of connections to the directory server.
     Make sure the directory service can cope
     with the maximum number of client connections across all servers.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-connection_pool_max_size</code>
    </p><p>
     Default:
     10
    </p></dd><dt><span class="term">LDAP Connection Heartbeat Interval</span></dt><dd><p>
     How often to send a heartbeat request to the directory server
     to ensure that the connection does not remain idle.
     Some network administrators configure firewalls
     and load balancers to drop connections that are idle for too long.
     You can turn this off by setting the value to 0 or to a negative number.
     To set the units for the interval use LDAP Connection Heartbeat Time Unit.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">openam-idrepo-ldapv3-heartbeat-interval</code>
    </p><p>
     Default:
     10
    </p></dd><dt><span class="term">LDAP Connection Heartbeat Time Unit</span></dt><dd><p>
     Time unit for the LDAP Connection Heartbeat Interval setting
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">openam-idrepo-ldapv3-heartbeat-timeunit</code>
    </p><p>
     Default:
     <code class="literal">second</code>
    </p></dd><dt><span class="term">Maximum Results Returned from Search</span></dt><dd><p>
     A cap for the number of search results to request.
     For example when using the Subjects tab to view profiles,
     even if you set
     Configuration &gt; Console &gt; Administration &gt; Maximum Results Returned from Search
     to a larger number, OpenAM does not exceed this setting.
     Rather than raise this number,
     consider narrowing your search to match fewer directory entries.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-max-result</code>
    </p><p>
     Default:
     1000
    </p></dd><dt><span class="term">Search Timeout</span></dt><dd><p>
     Maximum time to wait for search results in seconds.
     Does not apply to persistent searches.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-time-limit</code>
    </p><p>
     Default:
     10
    </p></dd><dt><span class="term">LDAPv3 Plug-in Search Scope</span></dt><dd><p>
     LDAP searches can apply to a single entry (SCOPE_BASE),
     entries directly below the search DN (SCOPE_ONE),
     or all entries below the search DN (SEARCH_SUB)
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-search-scope</code>
    </p><p>
     Default:
     <code class="literal">SCOPE_SUB</code>
    </p></dd><dt><span class="term">LDAPv3 Repository Plug-in Class Name</span></dt><dd><p>
     OpenAM identity repository implementation
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sunIdRepoClass</code>
    </p><p>
     Default:
     <code class="literal">org.forgerock.openam.idrepo.ldap.DJLDAPv3Repo</code>
    </p></dd><dt><span class="term">Attribute Name Mapping</span></dt><dd><p>
     Map of OpenAM profile attribute names to directory server attribute names
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sunIdRepoAttributeMapping</code>
    </p></dd><dt><span class="term">LDAPv3 Plug-in Supported Types and Operations</span></dt><dd><p>
     Map of OpenAM operations that can be performed in the specified OpenAM contexts
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sunIdRepoSupportedOperations</code>
    </p><p>
     Default:
     <code class="literal">group=read,create,edit,delete</code>,
     <code class="literal">realm=read,create,edit,delete,service</code>,
     <code class="literal">user=read,create,edit,delete,service</code>
    </p></dd><dt><span class="term">LDAP Users Search Attribute</span></dt><dd><p>
     When searching for a user by name, match values against this attribute
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-users-search-attribute</code>
    </p><p>
     Default:
     <code class="literal">cn</code>
    </p></dd><dt><span class="term">LDAP Users Search Filter</span></dt><dd><p>
     When searching for users, apply this LDAP search filter as well
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-users-search-filter</code>
    </p><p>
     Default:
     <code class="literal">(objectclass=inetorgperson)</code>
    </p></dd><dt><span class="term">LDAP People Container Naming Attribute</span></dt><dd><p>
     RDN attribute of the LDAP base DN which contains user profiles
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-people-container-name</code>
    </p><p>
     Default:
     <code class="literal">ou</code>
    </p></dd><dt><span class="term">LDAP People Container Value</span></dt><dd><p>
     RDN attribute value of the LDAP base DN which contains user profiles
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-people-container-value</code>
    </p></dd><dt><span class="term">LDAP User Object Class</span></dt><dd><p>
     User profiles have these LDAP object classes
    </p><p>
     OpenAM handles only those attributes listed in this setting.
     OpenAM discards any unlisted attributes from requests
     and the request proceeds without the attribute.
    </p><p>
     For example, with default settings
     if you request that OpenAM execute a search that asks for
     the <code class="literal">mailAlternateAddress</code> attribute,
     OpenAM does the search, but does not request
     <code class="literal">mailAlternateAddress</code>.
     In the same way, OpenAM does perform an update operation
     with a request to set the value of an unlisted attribute
     like <code class="literal">mailAlternateAddress</code>,
     but it drops the unlisted attribute from the update request.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-user-objectclass</code>
    </p><p>
     Default:
     <code class="literal">devicePrintProfilesContainer</code>,
     <code class="literal">forgerock-am-dashboard-service</code>,
     <code class="literal">inetorgperson</code>,
     <code class="literal">inetuser</code>,
     <code class="literal">iplanet-am-auth-configuration-service</code>,
     <code class="literal">iplanet-am-managed-person</code>,
     <code class="literal">iplanet-am-user-service</code>,
     <code class="literal">iPlanetPreferences</code>,
     <code class="literal">organizationalperson</code>,
     <code class="literal">person</code>,
     <code class="literal">sunAMAuthAccountLockout</code>,
     <code class="literal">sunFederationManagerDataStore</code>,
     <code class="literal">sunFMSAML2NameIdentifier</code>,
     <code class="literal">sunIdentityServerLibertyPPService</code>,
     <code class="literal">top</code>
    </p></dd><dt><span class="term">LDAP User Attributes</span></dt><dd><p>
     User profiles have these LDAP attributes
    </p><p>
     OpenAM handles only those attributes listed in this setting.
     OpenAM discards any unlisted attributes from requests
     and the request proceeds without the attribute.
    </p><p>
     For example, with default settings
     if you request that OpenAM execute a search that asks for
     the <code class="literal">mailAlternateAddress</code> attribute,
     OpenAM does the search, but does not request
     <code class="literal">mailAlternateAddress</code>.
     In the same way, OpenAM does perform an update operation
     with a request to set the value of an unlisted attribute
     like <code class="literal">mailAlternateAddress</code>,
     but it drops the unlisted attribute from the update request.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-user-attributes</code>
    </p><p>
     Default:
     <code class="literal">adminRole</code>,
     <code class="literal">assignedDashboard</code>,
     <code class="literal">authorityRevocationList</code>,
     <code class="literal">caCertificate</code>,
     <code class="literal">cn</code>,
     <code class="literal">devicePrintProfiles</code>,
     <code class="literal">distinguishedName</code>,
     <code class="literal">dn</code>,
     <code class="literal">employeeNumber</code>,
     <code class="literal">givenName</code>,
     <code class="literal">inetUserHttpURL</code>,
     <code class="literal">inetUserStatus</code>,
     <code class="literal">iplanet-am-auth-configuration</code>,
     <code class="literal">iplanet-am-session-add-session-listener-on-all-sessions</code>,
     <code class="literal">iplanet-am-session-destroy-sessions</code>,
     <code class="literal">iplanet-am-session-get-valid-sessions</code>,
     <code class="literal">iplanet-am-session-max-caching-time</code>,
     <code class="literal">iplanet-am-session-max-idle-time</code>,
     <code class="literal">iplanet-am-session-max-session-time</code>,
     <code class="literal">iplanet-am-session-quota-limit</code>,
     <code class="literal">iplanet-am-session-service-status</code>,
     <code class="literal">iplanet-am-user-account-life</code>,
     <code class="literal">iplanet-am-user-admin-start-dn</code>,
     <code class="literal">iplanet-am-user-alias-list</code>,
     <code class="literal">iplanet-am-user-auth-config</code>,
     <code class="literal">iplanet-am-user-auth-modules</code>,
     <code class="literal">iplanet-am-user-failure-url</code>,
     <code class="literal">iplanet-am-user-federation-info-key</code>,
     <code class="literal">iplanet-am-user-federation-info</code>,
     <code class="literal">iplanet-am-user-login-status</code>,
     <code class="literal">iplanet-am-user-password-reset-force-reset</code>,
     <code class="literal">iplanet-am-user-password-reset-options</code>,
     <code class="literal">iplanet-am-user-password-reset-question-answer</code>,
     <code class="literal">iplanet-am-user-success-url</code>,
     <code class="literal">mail</code>,
     <code class="literal">manager</code>,
     <code class="literal">memberOf</code>,
     <code class="literal">objectClass</code>,
     <code class="literal">postalAddress</code>,
     <code class="literal">preferredlanguage</code>,
     <code class="literal">preferredLocale</code>,
     <code class="literal">preferredtimezone</code>,
     <code class="literal">sn</code>,
     <code class="literal">sun-fm-saml2-nameid-info</code>,
     <code class="literal">sun-fm-saml2-nameid-infokey</code>,
     <code class="literal">sunAMAuthInvalidAttemptsData</code>,
     <code class="literal">sunIdentityMSISDNNumber</code>,
     <code class="literal">sunIdentityServerDiscoEntries</code>,
     <code class="literal">sunIdentityServerPPAddressCard</code>,
     <code class="literal">sunIdentityServerPPCommonNameAltCN</code>,
     <code class="literal">sunIdentityServerPPCommonNameCN</code>,
     <code class="literal">sunIdentityServerPPCommonNameFN</code>,
     <code class="literal">sunIdentityServerPPCommonNameMN</code>,
     <code class="literal">sunIdentityServerPPCommonNamePT</code>,
     <code class="literal">sunIdentityServerPPCommonNameSN</code>,
     <code class="literal">sunIdentityServerPPDemographicsAge</code>,
     <code class="literal">sunIdentityServerPPDemographicsBirthDay</code>,
     <code class="literal">sunIdentityServerPPDemographicsDisplayLanguage</code>,
     <code class="literal">sunIdentityServerPPDemographicsLanguage</code>,
     <code class="literal">sunIdentityServerPPDemographicsTimeZone</code>,
     <code class="literal">sunIdentityServerPPEmergencyContact</code>,
     <code class="literal">sunIdentityServerPPEmploymentIdentityAltO</code>,
     <code class="literal">sunIdentityServerPPEmploymentIdentityJobTitle</code>,
     <code class="literal">sunIdentityServerPPEmploymentIdentityOrg</code>,
     <code class="literal">sunIdentityServerPPEncryPTKey</code>,
     <code class="literal">sunIdentityServerPPFacadegreetmesound</code>,
     <code class="literal">sunIdentityServerPPFacadeGreetSound</code>,
     <code class="literal">sunIdentityServerPPFacadeMugShot</code>,
     <code class="literal">sunIdentityServerPPFacadeNamePronounced</code>,
     <code class="literal">sunIdentityServerPPFacadeWebSite</code>,
     <code class="literal">sunIdentityServerPPInformalName</code>,
     <code class="literal">sunIdentityServerPPLegalIdentityAltIdType</code>,
     <code class="literal">sunIdentityServerPPLegalIdentityAltIdValue</code>,
     <code class="literal">sunIdentityServerPPLegalIdentityDOB</code>,
     <code class="literal">sunIdentityServerPPLegalIdentityGender</code>,
     <code class="literal">sunIdentityServerPPLegalIdentityLegalName</code>,
     <code class="literal">sunIdentityServerPPLegalIdentityMaritalStatus</code>,
     <code class="literal">sunIdentityServerPPLegalIdentityVATIdType</code>,
     <code class="literal">sunIdentityServerPPLegalIdentityVATIdValue</code>,
     <code class="literal">sunIdentityServerPPMsgContact</code>,
     <code class="literal">sunIdentityServerPPSignKey</code>,
     <code class="literal">telephoneNumber</code>,
     <code class="literal">uid</code>,
     <code class="literal">userCertificate</code>,
     <code class="literal">userPassword</code>
    </p></dd><dt><span class="term">Create User Attribute Mapping</span></dt><dd><p>
     When creating a user profile,
     apply this map of OpenAM profile attribute names
     to directory server attribute names.
    </p><p>
     Attributes not mapped to another attribute
     (for example, <code class="literal">cn</code>)
     and attributes mapped to themselves
     (for example, <code class="literal">cn=cn</code>)
     take the value of the username
     unless the attribute values are provided when creating the profile.
     The object classes for user profile LDAP entries
     generally require Common Name (cn) and Surname (sn) attributes,
     so this prevents an LDAP constraint violation
     when performing the add operation.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-createuser-attr-mapping</code>
    </p><p>
     Default:
     <code class="literal">cn</code>, <code class="literal">sn</code>
    </p></dd><dt><span class="term">Attribute Name of User Status</span></dt><dd><p>
     Attribute to check/set user status
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-isactive</code>
    </p><p>
     Default:
     <code class="literal">inetuserstatus</code>
    </p></dd><dt><span class="term">User Status Active Value</span></dt><dd><p>
     Active users have the user status attribute set to this value.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-active</code>
    </p><p>
     Default:
     <code class="literal">Active</code>
    </p></dd><dt><span class="term">User Status Inactive Value</span></dt><dd><p>
     Inactive users have the user status attribute set to this value.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-inactive</code>
    </p><p>
     Default:
     <code class="literal">Inactive</code>
    </p></dd><dt><span class="term">Authentication Naming Attribute</span></dt><dd><p>
     RDN attribute for building the bind DN when given a username and password
     to authenticate a user against the directory server
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-auth-naming-attr</code>
    </p><p>
     Default:
     <code class="literal">cn</code>
    </p></dd><dt><span class="term">LDAP Groups Search Attribute</span></dt><dd><p>
     When searching for a group by name, match values against this attribute
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-groups-search-attribute</code>
    </p><p>
     Default:
     <code class="literal">cn</code>
    </p></dd><dt><span class="term">LDAP Groups Search Filter</span></dt><dd><p>
     When searching for groups, apply this LDAP search filter as well
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-groups-search-filter</code>
    </p><p>
     Default:
     <code class="literal">(objectclass=groupOfNames)</code>
    </p></dd><dt><span class="term">LDAP Groups Container Naming Attribute</span></dt><dd><p>
     RDN attribute of the LDAP base DN which contains group profiles
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-group-container-name</code>
    </p><p>
     Default:
     <code class="literal">ou</code>
    </p></dd><dt><span class="term">LDAP Groups Container Value</span></dt><dd><p>
     RDN attribute value of the LDAP base DN which contains group profiles
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-group-container-value</code>
    </p></dd><dt><span class="term">LDAP Groups Object Class</span></dt><dd><p>
     Group profiles have these LDAP object classes
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-group-objectclass</code>
    </p><p>
     Default:
     <code class="literal">groupofnames</code>, <code class="literal">top</code>
    </p></dd><dt><span class="term">LDAP Groups Attributes</span></dt><dd><p>
     Group profiles have these LDAP attributes
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-group-attributes</code>
    </p><p>
     Default:
     <code class="literal">cn</code>,
     <code class="literal">description</code>,
     <code class="literal">dn</code>,
     <code class="literal">member</code>,
     <code class="literal">objectclass</code>,
     <code class="literal">ou</code>
    </p></dd><dt><span class="term">Attribute Name for Group Membership</span></dt><dd><p>
     LDAP attribute in the member's LDAP entry
     whose values are the groups to which a member belongs
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-memberof</code>
    </p></dd><dt><span class="term">Attribute Name of Unique Member</span></dt><dd><p>
     Attribute in the group's LDAP entry
     whose values are the members of the group
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-uniquemember</code>
    </p><p>
     Default:
     <code class="literal">member</code>
    </p></dd><dt><span class="term">Default Group Member's User DN</span></dt><dd><p>
     DN of member added to all newly created groups
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-dftgroupmember</code>
    </p></dd><dt><span class="term">Persistent Search Base DN</span></dt><dd><p>
     Base DN for LDAP persistent searches used
     to receive notification of changes in directory server data
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-psearchbase</code>
    </p><p>
     Default:
     <code class="literal"><em class="replaceable"><code>base-dn</code></em></code>
    </p></dd><dt><span class="term">Persistent Search Filter</span></dt><dd><p>
     LDAP filter to apply when performing persistent searches
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-psearch-filter</code>
    </p><p>
     Default:
     <code class="literal">(objectclass=*)</code>
    </p></dd><dt><span class="term">Persistent Search Scope</span></dt><dd><p>
     LDAP searches can apply to a single entry (SCOPE_BASE),
     entries directly below the search DN (SCOPE_ONE),
     or all entries below the search DN (SEARCH_SUB)
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-config-psearch-scope</code>
    </p><p>
     Default:
     <code class="literal">SCOPE_SUB</code>
    </p></dd><dt><span class="term">The Delay Time Between Retries</span></dt><dd><p>
     How long to wait after receiving an error result
     that indicates OpenAM should try the LDAP operation again
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">com.iplanet.am.ldap.connection.delay.between.retries</code>
    </p><p>
     Default:
     1000 milliseconds
    </p></dd><dt><span class="term">DN Cache Enabled</span></dt><dd><p>
     Whether to enable the DN cache, which is used to cache DN lookups
     that can happen in bursts during authentication.
     As the cache can become stale when a user is moved or renamed,
     enable DN caching when the directory service allows move/rename operations (Mod DN),
     and when OpenAM uses persistent searches to obtain notification of such updates.
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-dncache-enabled</code>
    </p><p>
     Default:
     true
    </p></dd><dt><span class="term">DN Cache Size</span></dt><dd><p>
     Maximum number of DNs cached when caching is enabled
    </p><p>
     <span class="command"><strong>ssoadm</strong></span> attribute:
     <code class="literal">sun-idrepo-ldapv3-dncache-size</code>
    </p><p>
     Default:
     1500 items
    </p></dd></dl></div></div></div><div class="footnotes"><br><hr class="footnote-hr"><div id="ftn.d16037e8755" class="footnote"><p><a href="#d16037e8755" class="para"><sup class="para">[5] </sup></a>
      The Realm/DNS Alias option refers to an FQDN
      that can be used to represent the realm.
      It is not related to the CNAME record used in DNS database zones.
      In other words, the Realm/DNS Alias option shown in the console
      does not conform to the definition of DNS Aliases described in
      <a class="link" href="http://tools.ietf.org/html/rfc2219" target="_blank">RFC 2219</a>.
     </p></div></div></div><div lang="en" class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="chap-agents"></a>Chapter&nbsp;5.&nbsp;Configuring Policy Agent Profiles</h1></div></div></div><div class="toc"><div class="toc-title">Table of Contents</div><dl class="toc"><dt><span class="section"><a href="#gateway-or-policy-agent">5.1. Open Identity Gateway or Policy Agent?</a></span></dt><dt><span class="section"><a href="#kinds-of-agent-profiles">5.2. Kinds of Agent Profiles</a></span></dt><dt><span class="section"><a href="#create-agent-profiles">5.3. Creating Agent Profiles</a></span></dt><dt><span class="section"><a href="#delegate-agent-profile-creation">5.4. Delegating Agent Profile Creation</a></span></dt><dt><span class="section"><a href="#configure-web-policy-agent">5.5. Configuring Web Policy Agents</a></span></dt><dt><span class="section"><a href="#configure-j2ee-policy-agent">5.6. Configuring Java EE Policy Agents</a></span></dt><dt><span class="section"><a href="#configure-wsp-policy-agent">5.7. Configuring Web Service Provider Policy Agents</a></span></dt><dt><span class="section"><a href="#configure-wsc-policy-agent">5.8. Configuring Web Service Client Policy Agents</a></span></dt><dt><span class="section"><a href="#configure-sts-policy-agent">5.9. Configuring Security Token Service Client Policy Agents</a></span></dt><dt><span class="section"><a href="#configure-22-policy-agent">5.10. Configuring Version 2.2 Policy Agents</a></span></dt><dt><span class="section"><a href="#configure-oauth2-client">5.11. Configuring OAuth 2.0 &amp; OpenID Connect 1.0 Clients</a></span></dt><dt><span class="section"><a href="#configure-agent-auth">5.12. Configuring Agent Authenticators</a></span></dt></dl></div><a class="indexterm" name="d16037e16623"></a><p> You install policy agents in web servers and web application containers
  to enforce access policies OpenAM applies to protected web sites and web
  applications. Policy agents depend on OpenAM for all authentication and
  authorization decisions. Their primary responsibility consists in enforcing
  what OpenAM decides in a way that is unobtrusive to the user. In organizations
  with many servers, you might well install many policy agents.</p><p>Policy agents can have local configurations where they are installed,
  but usually you store all policy agent configuration information in the
  OpenAM configuration store, defining policy agent profiles for each, and then
  you let the policy agents access their profiles through OpenAM such that you
  manage all agent configuration changes centrally. This chapter describes how
  to set up policy agent profiles in OpenAM for centralized configuration.</p><div lang="en" class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="gateway-or-policy-agent"></a>5.1.&nbsp;Open Identity Gateway or Policy Agent?</h2></div></div></div><a class="indexterm" name="d16037e16638"></a><p>OpenAM includes both the
  <a class="link" href="http://openig.forgerock.org/" target="_blank">Open Identity
  Gateway (OpenIG)</a> and also a variety of policy agents.
  Both OpenIG
  and also the policy agents enforce policy, redirecting users to authenticate
  when necessary, and controlling access to protected resources. Yet, the
  Identity Gateway runs as a self-contained reverse proxy located between the
  users and the protected applications. Policy agents are installed into the
  servers where applications run, intercepting requests in that context.</p><p>The OpenIG allows you to protect access to applications not
  suited for a policy agent. Not all web servers and Java EE applications have
  policy agents. Not all operating systems work with policy agents.</p><p>Policy agents have the advantage, where you can install them,
  of sitting within your existing server infrastructure. Once you have
  agents installed into the servers with web applications or sites to protect,
  then you can manage their configurations centrally from OpenAM.</p><p>Of course, for organizations with both servers where you can install
  policy agents and also applications that you must protect without touching
  the server, you can use policy agents on the former and the OpenIG
  for the latter.</p></div><div lang="en" class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="kinds-of-agent-profiles"></a>5.2.&nbsp;Kinds of Agent Profiles</h2></div></div></div><a class="indexterm" name="d16037e16656"></a><p>When you open the OpenAM console to configure agents for the top level
  realm, you can choose from a number of different types of agents. Web and J2EE policy
  agents are the most common, requiring the least integration effort.</p><a class="indexterm" name="d16037e16663"></a><div class="variablelist"><dl class="variablelist"><dt><span class="term">Web</span></dt><dd><p>You install web agents in web servers to protect web sites.</p></dd><dt><span class="term">J2EE</span></dt><dd><p>You install J2EE agents in web application containers to protect
     web applications.</p></dd><dt><span class="term">Web Service Provider</span></dt><dd><p>WSP agents are for use with Web Services Security.</p></dd><dt><span class="term">Web Service Client</span></dt><dd><p>WSC agents are for use with Web Services Security.</p></dd><dt><span class="term">STS Client</span></dt><dd><p>The Security Token Service client agent is for securing
     requests to the Security Token Service.</p></dd><dt><span class="term">2.2 Agents</span></dt><dd><p>Version 2.2 web and Java EE policy agents hold their configuration
     locally, connecting to OpenAM with a user name, password combination.
     This kind of agent is provided for backwards compatibility.</p></dd><dt><span class="term">OAuth 2.0 Client Agent</span></dt><dd><p>OAuth 2.0 clients are registered using this type of policy agent
     profile.</p></dd><dt><span class="term">Agent Authenticator</span></dt><dd><p>The agent authenticator can read agent profiles by connecting
     to OpenAM with a user name, password combination, but unlike the
     agent profile administrator, cannot change agent configuration.</p></dd></dl></div></div><div lang="en" class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="create-agent-profiles"></a>5.3.&nbsp;Creating Agent Profiles</h2></div></div></div><a class="indexterm" name="d16037e16721"></a><p>This section concerns creating agent profiles, and creating groups
  that let agents inherit settings when you have many agents with nearly
  the same profile settings.</p><div class="procedure"><a name="create-agent-profile"></a><div class="procedure-title">Procedure&nbsp;5.1.&nbsp;To Create an Agent Profile</div><p>To create a new Java EE policy agent profile, you need a name and
   password for the agent, and the URLs to OpenAM and the application to
   protect.</p><ol class="procedure" type="1"><li class="step"><p>On the Access Control tab page of the OpenAM console, click the link
    for the realm in which you manage agents.</p></li><li class="step"><p>Click the Agents tab, click the tab page for the kind of agent you
    want to create, and then click the New... button in the Agent table.</p></li><li class="step"><p>Provide a name for the agent, and also the URLs to OpenAM and to
    the application to protect, then click Create. 
    Note that for Java EE policy agents, an example URL must include
    the <code class="literal">agentapp</code> context:
    <code class="uri">http://www.example.com:8080/agentapp</code>.
   </p><div class="mediaobject" align="center"><a name="figure-create-agent"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/create-agent.png" align="middle" height="360" alt="Creating a new agent profile"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-create-agent.html" target="longdesc">D</a>]</span></div></div></li><li class="step"><p>After creating the agent profile, you can click the link to the
    new profile to adjust and export the configuration.</p></li></ol></div><div class="procedure"><a name="create-agent-group"></a><div class="procedure-title">Procedure&nbsp;5.2.&nbsp;To Create an Agent Profile Group &amp; Inherit Settings</div><a class="indexterm" name="d16037e16764"></a><p>Agent profile groups let you set up multiple agents to inherit
   settings from the group. To create a new Java EE agent profile group,
   you need a name and the URL to the OpenAM server in which you store the
   profile.</p><ol class="procedure" type="1"><li class="step"><p>On the Access Control tab page of the OpenAM console, click the link
    for the realm in which you manage agents.</p></li><li class="step"><p>Click the Agents tab, click the tab page for the kind of agent you
    want to create, and then click the New... button in the Group table.</p><p>After creating the group profile, you can click the link to the new
    group profile to fine-tune or export the configuration.</p></li><li class="step"><p>Inherit group settings by selecting your agent profile, and then
    selecting the group name in the Group drop-down list near the top of
    the profile page.</p><p>You can then adjust inheritance by clicking Inheritance Settings
    on the agent profile page.</p></li></ol></div><div class="procedure"><a name="create-agent-profile-cli"></a><div class="procedure-title">Procedure&nbsp;5.3.&nbsp;To Create an Agent Profile Using the Command Line</div><p>You can create a policy agent profile in OpenAM using the
   <span class="command"><strong>ssoadm</strong></span> command-line tool. You do so by specifying
   the agent properties either as a list of attributes, or by using an
   agent properties file as shown below. Export an existing policy
   agent configuration before you start to see what properties you
   want to set when creating the agent profile.</p><p>The following procedure demonstrates creating a policy agent
   profile using the <span class="command"><strong>ssoadm</strong></span> command.</p><ol class="procedure" type="1"><li class="step"><p>Make sure the <span class="command"><strong>ssoadm</strong></span> command is installed as
    described in the <em class="citetitle">Installation Guide</em> procedure,
    <a href="../install-guide/index.html#install-openam-admin-tools" class="link"><em class="citetitle">To Set Up
     Administration Tools</em></a>.</p></li><li class="step"><p>Determine the list of properties to set in the agent profile.</p><p>The following properties file shows a minimal configuration for a
    policy agent profile.</p><div class="screen"><pre>
$ <strong>cat myAgent.properties</strong>
com.sun.identity.agents.config.agenturi.prefix=http://www.example.com:80/amagent
com.sun.identity.agents.config.cdsso.cdcservlet.url[0]=https://openam.example.com:8443/
  openam/cdcservlet
com.sun.identity.agents.config.fqdn.default=www.example.com
com.sun.identity.agents.config.login.url[0]=http://openam.example.com:8443/
  openam/UI/Login
com.sun.identity.agents.config.logout.url[0]=http://openam.example.com:8443/
  openam/UI/Logout
com.sun.identity.agents.config.remote.logfile=amAgent_www_example_com_80.log
com.sun.identity.agents.config.repository.location=centralized
com.sun.identity.client.notification.url=http://www.example.com:80/
  UpdateAgentCacheServlet?shortcircuit=false
com.sun.identity.client.notification.url=http://www.example.com:80/
  UpdateAgentCacheServlet?shortcircuit=false
sunIdentityServerDeviceKeyValue[0]=agentRootURL=http://www.example.com:80/
sunIdentityServerDeviceStatus=Active
userpassword=password
    </pre></div></li><li class="step"><p>Set up a password file used when authenticating to OpenAM.
    The password file must be read-only for the user who creates the policy
    agent profile, and must not be accessible to other users.
   </p><div class="screen"><pre>
    $ <strong>echo password &gt; /tmp/pwd.txt</strong>
    $ <strong>chmod 400 /tmp/pwd.txt</strong>
   </pre></div></li><li class="step"><p>Create the profile in OpenAM.</p><div class="screen"><pre>
    $ <strong>ssoadm \
    create-agent \
    --realm / \
    --agentname myAgent \
    --agenttype J2EE \
    --adminid amadmin
    --password-file /tmp/pwd.txt \
    --datafile myAgent.properties</strong>

    <em>Agent configuration was created.</em>
   </pre></div><p>At this point you can view the profile in OpenAM Console under
    Access Control &gt; <em class="replaceable"><code>Realm Name</code></em> &gt; Agents to make
    sure the configuration is what you expect.</p></li></ol></div></div><div lang="en" class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="delegate-agent-profile-creation"></a>5.4.&nbsp;Delegating Agent Profile Creation</h2></div></div></div><a class="indexterm" name="d16037e16852"></a><p>If you want to create policy agent profiles when installing policy
  agents, then you need the credentials of an OpenAM user who can read and
  write agent profiles.</p><p>You can use the OpenAM administrator account when creating policy agent
  profiles. If however you delegate policy agent installation, then you might
  not want to share OpenAM administrator credentials with everyone who
  installs policy agents.</p><div class="procedure"><a name="create-agent-administrators"></a><div class="procedure-title">Procedure&nbsp;5.4.&nbsp;To Create Agent Administrators for a Realm</div><a class="indexterm" name="d16037e16864"></a><p>Follow these steps to create <em class="firstterm">agent administrator</em>
   users for a realm.</p><ol class="procedure" type="1"><li class="step"><p>In OpenAM console, browse to Access Control &gt; <em class="replaceable"><code>Realm
    Name</code></em> &gt; Subjects.</p></li><li class="step"><p>Under Group click New... and create a group for agent
    administrators.</p></li><li class="step"><p>Switch to the Privileges tab for the realm, and click the name of the
    group you created.</p></li><li class="step"><p>Select "Read and write access to all configured Agents," and then
    Save your work.</p></li><li class="step"><p>Return to the Subjects tab, and under User create as many agent
    administrator users as needed.</p></li><li class="step"><p>For each agent administrator user, edit the user profile.</p><p>Under the Group tab of the user profile, add the user to agent
    profile administrator group, and then Save your work.</p></li><li class="step"><p>Provide each system administrator who installs policy agents with
    their agent administrator credentials.</p><p>When installing the policy agent with the
    <code class="option">--custom-install</code> option, the system administrator can
    choose the option to create the profile during installation, and then
    provide the agent administrator user name and the path to a read-only
    file containing the agent administrator password. For silent installs,
    you can add the <code class="option">--acceptLicense</code> option to auto-accept the
    software license agreement. </p></li></ol></div></div><div lang="en" class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="configure-web-policy-agent"></a>5.5.&nbsp;Configuring Web Policy Agents</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="#configure-web-pa-global-props">5.5.1. Configuring Web Policy Agent Global Properties</a></span></dt><dt><span class="section"><a href="#configure-web-pa-application-props">5.5.2. Configuring Web Policy Agent Application Properties</a></span></dt><dt><span class="section"><a href="#configure-web-pa-sso-props">5.5.3. Configuring Web Policy Agent SSO Properties</a></span></dt><dt><span class="section"><a href="#configure-web-pa-services-props">5.5.4. Configuring Web Policy Agent OpenAM Services Properties</a></span></dt><dt><span class="section"><a href="#configure-web-pa-misc-props">5.5.5. Configuring Web Policy Agent Miscellaneous Properties</a></span></dt><dt><span class="section"><a href="#configure-web-pa-advanced-props">5.5.6. Configuring Web Policy Agent Advanced Properties</a></span></dt></dl></div><a class="indexterm" name="d16037e16915"></a><p>When you create a web policy agent profile and install the agent,
  you can choose to store the agent configuration centrally and configure
  the agent through OpenAM console. Alternatively, you can choose to store
  the agent configuration locally and configure the agent by changing
  values in the properties file. This section covers centralized configuration,
  indicating the corresponding properties for use in a local configuration
  file where applicable.

  <a href="#ftn.d16037e16924" class="footnote" name="d16037e16924"><sup class="footnote">[6]</sup></a>
 </p><div class="tip"><h3 class="title">Tip</h3><p>To show the agent properties in configuration file format that
   correspond to what you see in the console, click Export Configuration
   after editing agent properties.</p><p>This corresponds to the local Java properties configuration file
   that is set up when you install an agent, for example in
   <code class="filename">Agent_001/config/OpenSSOAgentConfiguration.properties</code>.</p></div><p>After changing properties specified as "Hot swap: no" you must
  restart the agent's container for the changes to take effect.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="configure-web-pa-global-props"></a>5.5.1.&nbsp;Configuring Web Policy Agent Global Properties</h3></div></div></div><a class="indexterm" name="d16037e16944"></a><p>This section covers global web agent properties. After creating the
   agent profile, you access these properties in the OpenAM console under
   Access Control &gt; <em class="replaceable"><code>Realm Name</code></em> &gt; Agents &gt;
   Web &gt; <em class="replaceable"><code>Agent Name</code></em> &gt; Global.</p><div class="variablelist"><a name="web-agent-profile-properties"></a><div class="variablelist-title">Profile properties</div><dl class="variablelist"><dt><span class="term">Group</span></dt><dd><p>For assigning the agent to a previously configured web agent group
      in order to inherit selected properties from the group.</p></dd><dt><span class="term">Password</span></dt><dd><p>Agent password used when creating the password file and when
      installing the agent.</p></dd><dt><span class="term">Status</span></dt><dd><p>Status of the agent configuration.</p></dd><dt><span class="term">Location of Agent Configuration Repository</span></dt><dd><p>Indicates agent's configuration located either on agent's host or
      centrally on OpenAM server.</p><p>If you change this to a local configuration, you can no longer
      manage the policy agent configuration through OpenAM console.</p><p>Property: <code class="literal">com.sun.identity.agents.config.repository.location</code></p></dd><dt><span class="term">Agent Configuration Change Notification</span></dt><dd><p>Enable agent to receive notification messages from OpenAM server for
      configuration changes.</p><p>Property: <code class="literal">com.sun.identity.agents.config.change.notification.enable</code></p></dd><dt><span class="term">Enable Notifications</span></dt><dd><p>If enabled, the agent receives policy updates from the OpenAM
      notification mechanism to maintain its internal cache. If disabled, the
      agent must poll OpenAM for changes.</p><p>Property: <code class="literal">com.sun.identity.agents.config.notification.enable</code></p><p>Hot swap: no</p></dd><dt><span class="term">Agent Notification URL</span></dt><dd><p>URL used by agent to register notification listeners.</p><p>Property: <code class="literal">com.sun.identity.client.notification.url</code></p><p>Hot swap: no</p></dd><dt><span class="term">Agent Deployment URI Prefix</span></dt><dd><p>The default value is
      <code class="literal"><em class="replaceable"><code>agent-root-URL</code></em>/amagent</code>.</p><p>Property: <code class="literal">com.sun.identity.agents.config.agenturi.prefix</code></p><p>Hot swap: yes</p></dd><dt><span class="term">Configuration Reload Interval</span></dt><dd><p>Interval in minutes to fetch agent configuration from OpenAM. Used
      if notifications are disabled. Default: 60.</p><p>Property: <code class="literal">com.sun.identity.agents.config.polling.interval</code></p><p>Hot swap: no</p></dd><dt><span class="term">Configuration Cleanup Interval</span></dt><dd><p>Interval in minutes to cleanup old agent configuration entries
      unless they are referenced by current requests. Default: 30.</p><p>Property: <code class="literal">com.sun.identity.agents.config.cleanup.interval</code></p><p>Hot swap: no</p></dd><dt><span class="term">Agent Root URL for CDSSO</span></dt><dd><p>The agent root URL for CDSSO. The valid value is in the format
      <code class="literal"><em class="replaceable"><code>protocol</code></em>://<em class="replaceable"><code>hostname</code></em>:<em class="replaceable"><code>port</code></em>/</code>
      where <em class="replaceable"><code>protocol</code></em> represents the protocol used,
      such as <code class="literal">http</code> or <code class="literal">https</code>,
      <em class="replaceable"><code>hostname</code></em> represents the host name of the
      system where the agent resides, and <em class="replaceable"><code>port</code></em>
      represents the port number on which the agent is installed.
      The slash following the port number is required.</p><p>If your agent system also has virtual host names, add URLs with
      the virtual host names to this list as well. OpenAM checks that the
      <code class="literal">goto</code> URLs match one of the agent root URLs for
      CDSSO.</p></dd></dl></div><div class="variablelist"><a name="web-agent-general-properties"></a><div class="variablelist-title">General properties</div><a class="indexterm" name="d16037e17107"></a><dl class="variablelist"><dt><span class="term">SSO Only Mode</span></dt><dd><p>When enabled, the agent enforces authentication, so that upon verification
      of the user's identity, the user receives a session token.</p><p>Property: <code class="literal">com.sun.identity.agents.config.sso.only</code></p></dd><dt><span class="term">Resources Access Denied URL</span></dt><dd><p>The URL of the customized access denied page. If no value is
      specified (default), then the agent returns an HTTP status of 403
      (Forbidden).</p><p>Property: <code class="literal">com.sun.identity.agents.config.access.denied.url</code></p></dd><dt><span class="term">Agent Debug Level</span></dt><dd><p>Default is <code class="literal">Error</code>. Increase to
      <code class="literal">Message</code> or even <code class="literal">All</code> for
      fine-grained detail.</p><p>Property: <code class="literal">com.sun.identity.agents.config.debug.level</code></p><p>You can set the level in the configuration file by module using
      the format
      <code class="literal"><em class="replaceable"><code>module</code></em>[:<em class="replaceable"><code>level</code></em>][,<em class="replaceable"><code>module</code></em>[:<em class="replaceable"><code>level</code></em>]]*</code>,
      where <em class="replaceable"><code>module</code></em> is one of
      <code class="literal">AuthService</code>, <code class="literal">NamingService</code>,
      <code class="literal">PolicyService</code>, <code class="literal">SessionService</code>,
      <code class="literal">PolicyEngine</code>, <code class="literal">ServiceEngine</code>,
      <code class="literal">Notification</code>, <code class="literal">PolicyAgent</code>,
      <code class="literal">RemoteLog</code>, or <code class="literal">all</code>,
      and <em class="replaceable"><code>level</code></em> is one of the following.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">0</code>: Disable logging from specified module</p><p>At this level the agent nevertheless logs messages having the
        level value <code class="literal">always</code>.</p></li><li class="listitem"><p><code class="literal">1</code>: Log error messages</p></li><li class="listitem"><p><code class="literal">2</code>: Log warning and error messages</p></li><li class="listitem"><p><code class="literal">3</code>: Log info, warning, and error messages</p></li><li class="listitem"><p><code class="literal">4</code>: Log debug, info, warning, and error messages</p></li><li class="listitem"><p><code class="literal">5</code>: Like level 4, but with even more debugging messages</p></li></ul></div><p>When you omit <em class="replaceable"><code>level</code></em>, the agent uses the
      default level, which is the level associated with the
      <code class="literal">all</code> module.</p><p>The following example used in the local configuration sets the
      log overall level to debug for all messages.</p><pre class="literallayout">com.sun.identity.agents.config.debug.level=all:5</pre></dd><dt><span class="term">Agent Debug File Rotation</span></dt><dd><p>When enabled, rotate the debug file when specified file size is
      reached.</p><p>Property: <code class="literal">com.sun.identity.agents.config.debug.file.rotate</code></p></dd><dt><span class="term">Agent Debug File Size</span></dt><dd><p>Debug file size in bytes beyond which the log file is rotated. The
      minimum is 1048576 bytes (1 MB), and lower values are reset to 1 MB.
      OpenAM console sets a default of 10 MB.</p><p>Property: <code class="literal">com.sun.identity.agents.config.debug.file.size</code></p></dd></dl></div><div class="variablelist"><a name="web-agent-audit-properties"></a><div class="variablelist-title">Audit properties</div><dl class="variablelist"><dt><span class="term">Audit Access Types</span></dt><dd><p>Types of messages to log based on user URL access attempts.</p><p>Property: <code class="literal">com.sun.identity.agents.config.audit.accesstype</code></p><p>Valid values for the configuration file property include
      <code class="literal">LOG_NONE</code>, <code class="literal">LOG_ALLOW</code>,
      <code class="literal">LOG_DENY</code>, and <code class="literal">LOG_BOTH</code>.</p></dd><dt><span class="term">Audit Log Location</span></dt><dd><p>Specifies where audit messages are logged. By default, audit
      messages are logged remotely.</p><p>Property: <code class="literal">com.sun.identity.agents.config.log.disposition</code></p><p>Valid values for the configuration file property include
      <code class="literal">REMOTE</code>, <code class="literal">LOCAL</code>, and
      <code class="literal">ALL</code>.</p></dd><dt><span class="term">Remote Log Filename</span></dt><dd><p>Name of file stored on OpenAM server that contains agent audit
      messages if log location is remote or all.</p><p>Property: <code class="literal">com.sun.identity.agents.config.remote.logfile</code></p><p>Hot swap: no</p></dd><dt><span class="term">Remote Audit Log Interval</span></dt><dd><p>Periodic interval in minutes in which audit log messages are sent
      to the remote log file.</p><p>Property: <code class="literal">com.sun.identity.agents.config.remote.log.interval</code></p><p>Default: 5</p><p>Hot swap: no</p></dd><dt><span class="term">Rotate Local Audit Log</span></dt><dd><p>When enabled, audit log files are rotated when reaching the
      specified size.</p><p>Property: <code class="literal">com.sun.identity.agents.config.local.log.rotate</code></p></dd><dt><span class="term">Local Audit Log Rotation Size</span></dt><dd><p>Beyond this size limit in bytes the agent rotates the local audit
      log file if rotation is enabled.</p><p>Property: <code class="literal">com.sun.identity.agents.config.local.log.size</code></p><p>Default: 50 MB</p></dd></dl></div><div class="variablelist"><a name="web-agent-fqdn-properties"></a><div class="variablelist-title">Fully Qualified Domain Name Checking properties</div><dl class="variablelist"><dt><span class="term">FQDN Check</span></dt><dd><p>Enables checking of FQDN default value and FQDN map values.</p><p>Property: <code class="literal">com.sun.identity.agents.config.fqdn.check.enable</code></p></dd><dt><span class="term">FQDN Default</span></dt><dd><p>Fully qualified domain name that the users should use in order to
      access resources. Without this value, the web server can fail to
      start, thus you set the property on agent installation, and only change
      it when absolutely necessary.</p><p>This property ensures that when users access protected resources
      on the web server without specifying the FQDN, the agent can redirect
      the users to URLs containing the correct FQDN.</p><p>Property: <code class="literal">com.sun.identity.agents.config.fqdn.default</code></p></dd><dt><span class="term">FQDN Virtual Host Map</span></dt><dd><p>Enables virtual hosts, partial hostname and IP address to access
      protected resources. Maps invalid or virtual name keys to valid FQDN
      values so the agent can properly redirect users and the agents receive
      cookies belonging to the domain.</p><p>To map <code class="literal">myserver</code> to
      <code class="literal">myserver.mydomain.example</code>, enter
      <code class="literal">myserver</code> in the Map Key field, and enter
      <code class="literal">myserver.mydomain.example</code> in the Corresponding Map Value
      field. This corresponds to
      <code class="literal">com.sun.identity.agents.config.fqdn.mapping[myserver]= myserver.mydomain.example</code>.</p><p>Invalid FQDN values can cause the web server to become unusable
      or render resources inaccessible.</p><p>Property: <code class="literal">com.sun.identity.agents.config.fqdn.mapping</code></p></dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="configure-web-pa-application-props"></a>5.5.2.&nbsp;Configuring Web Policy Agent Application Properties</h3></div></div></div><a class="indexterm" name="d16037e17424"></a><p>This section covers application web agent properties. After creating
   the agent profile, you access these properties in the OpenAM console under
   Access Control &gt; <em class="replaceable"><code>Realm Name</code></em> &gt; Agents &gt;
   Web &gt; <em class="replaceable"><code>Agent Name</code></em> &gt; Application.</p><div class="variablelist"><a name="web-agent-not-enforced-url-properties"></a><div class="variablelist-title">Not Enforced URL Processing properties</div><dl class="variablelist"><dt><span class="term">Ignore Path Info for Not Enforced URLs</span></dt><dd><p>When enabled, the path info and query are stripped from the
      request URL before being compared with the URLs of the not enforced list
      for those URLs containing a wildcard character. This prevents a user
      from accessing <code class="literal">http://host/index.html</code> by requesting
      <code class="literal">http://host/index.html/hack.gif</code> when the not enforced
      list includes <code class="literal">http://host/*.gif</code>.</p><p>For a more generally applicable setting, see
      <a class="xref" href="#web-agent-ignore-path-info-properties" title="Ignore Path Info properties">Ignore Path Info properties</a>.</p><p>Property: <code class="literal">com.sun.identity.agents.config.ignore.path.info.for.not.enforced.list</code></p></dd><dt><span class="term">Enable Regular Expressions for Not Enforced URLs (Not yet in OpenAM console)</span></dt><dd><p>Enable use of <a class="link" href="http://www.pcre.org/pcre.txt" target="_blank">Perl-compatible regular expressions</a> in
      Not Enforced URL settings by using the following property under Advanced
      &gt; Custom Properties in the agent profile.</p><pre class="literallayout">com.forgerock.agents.notenforced.url.regex.enable=true</pre></dd><dt><span class="term">Not Enforced URLs</span></dt><dd><p>List of URLs for which no authentication is required. You can use
      wildcards to define a pattern for a URL.</p><p>The <code class="literal">*</code> wildcard matches all characters except
      question mark (<code class="literal">?</code>), cannot be escaped, and spans
      multiple levels in a URL. Multiple forward slashes do not match a
      single forward slash, so <code class="literal">*</code> matches
      <code class="literal">mult/iple/dirs</code>, yet <code class="literal">mult/*/dirs</code>
      does not match <code class="literal">mult/dirs</code>.</p><p>The <code class="literal">-*-</code> wildcard matches all characters except
      forward slash (<code class="literal">/</code>) or question mark
      (<code class="literal">?</code>), and cannot be escaped. As it does not match
      <code class="literal">/</code>, <code class="literal">-*-</code> does not span multiple
      levels in a URL.</p><p>OpenAM does not let you mix <code class="literal">*</code> and
      <code class="literal">-*-</code> in the same URL.</p><p>Examples include
      <code class="literal">http://www.example.com/logout.html</code>,
      <code class="literal">http://www.example.com/images/*</code>,
      <code class="literal">http://www.example.com/css/-*-</code>, and
      <code class="literal">http://www.example.com/*.jsp?locale=*</code>.</p><p>Trailing forward slashes are not recognized as part of a resource
      name. Therefore <code class="literal">http://www.example.com/images//</code> and
      <code class="literal">http://www.example.com/images</code> are equivalent.</p><p>Property: <code class="literal">com.sun.identity.agents.config.notenforced.url</code></p><p>If you enabled use of <a class="link" href="http://www.pcre.org/pcre.txt" target="_blank">Perl-compatible regular expressions</a> to match
      Not Enforced URLs, then all your settings must be done using regular
      expressions. (Do not mix settings; use either the mechanism
      described above or Perl-compatible regular expressions, but not both.)</p><p>The following example shows settings where no authentication is
      required for URLs whose path ends <code class="literal">/publicA</code> or
      <code class="literal">/publicB</code> (with or without query string parameters),
      and no authentication is required to access .png, .jpg, .gif, .js, or .css
      files under URLs that do not contain <code class="literal">/protectedA/</code>
      or <code class="literal">/protectedB/</code>.</p><pre class="literallayout">.*/(PublicServletA|PublicServletB)(\?.*|$)
      ^(?!.*(/protectedA/|/protectedB/)).*\.(png|jpg|gif|js|css)(\?.*|$)</pre></dd><dt><span class="term">Invert Not Enforced URLs</span></dt><dd><p>Only enforce not enforced list of URLs. In other words, enforce
      policy only for those URLs and patterns specified in the list.</p><p>Property: <code class="literal">com.sun.identity.agents.config.notenforced.url.invert</code></p></dd><dt><span class="term">Fetch Attributes for Not Enforced URLs</span></dt><dd><p>When enabled, the agent fetches profile, response, and session
      attributes that are mapped by doing policy evaluation, and forwards
      these attributes to not enforced URLs.</p><p>Property: <code class="literal">com.sun.identity.agents.config.notenforced.url.attributes.enable</code></p></dd></dl></div><div class="variablelist"><a name="web-agent-not-enforced-ip-properties"></a><div class="variablelist-title">Not Enforced IP Processing Properties</div><dl class="variablelist"><dt><span class="term">Not Enforced Client IP List</span></dt><dd><p>No authentication and authorization are required for the requests
      coming from these client IP addresses.</p><p>Property: <code class="literal">com.sun.identity.agents.config.notenforced.ip</code></p><div class="note"><h3 class="title">Note</h3><p>
       Loopback addresses are not considered valid IPs on the Not Enforced IP list.
       If specified, the policy agent ignores the loopback address.
      </p></div></dd><dt><span class="term">CIDR Client IP Specification (Not yet in OpenAM console)</span></dt><dd><p>As of version 3.0.4, web policy agents with this property set to
      <code class="literal">cidr</code> can use IPv4 netmasks and IP ranges instead of
      wildcards as values for Not Enforced Client IP addresses. Version 3.0.5
      adds support for IPv6, including the IPv6 loopback address,
      <code class="literal">::1</code>.</p><p>When the parameter is defined, wildcards are ignored in Not
      Enforced Client IP settings. Instead, you can use settings such as
      those shown in the following examples.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Netmask Example</span></dt><dd><p>To disable policy agent enforcement for addresses in
         192.168.1.1 to 192.168.1.255, use the following setting.</p><pre class="literallayout">com.sun.identity.agents.config.notenforced.ip = 192.168.1.1/24</pre><p>The following example shows an IPv6 address with a corresponding network mask.</p><pre class="literallayout">com.sun.identity.agents.config.notenforced.ip = 2001:5c0:9168:0:0:0:0:2/128</pre><p>Currently the policy agent stops evaluating properties after
         reaching an invalid netmask in the list.</p></dd><dt><span class="term">IP Range Example</span></dt><dd><p>To disable policy agent enforcement for addresses between
         192.168.1.1 to 192.168.4.3 inclusive, use the following setting.</p><pre class="literallayout">com.sun.identity.agents.config.notenforced.ip = 192.168.1.1-192.168.4.3</pre><p>The following example shows a range of IPv6 addresses. The example
         is displayed over two lines for formatting purposes.
        </p><pre class="literallayout">com.sun.identity.agents.config.notenforced.ip = \
    2001:5c0:9168:0:0:0:0:1-2001:5c0:9168:0:0:0:0:2</pre></dd></dl></div><p>Property: <code class="literal">com.forgerock.agents.config.notenforced.ip.handler</code></p><p>Hot swap: no</p></dd><dt><span class="term">Client IP Validation</span></dt><dd><p>When enabled, validate that the subsequent browser requests come
      from the same IP address that the SSO token is initially issued
      against.</p><p>Property: <code class="literal">com.sun.identity.agents.config.client.ip.validation.enable</code></p></dd></dl></div><div class="variablelist"><a name="web-agent-profile-attributes-processing-properties"></a><div class="variablelist-title">Profile Attributes Processing properties</div><dl class="variablelist"><dt><span class="term">Profile Attribute Fetch Mode</span></dt><dd><p>When set to <code class="literal">HTTP_COOKIE</code> or
      <code class="literal">HTTP_HEADER</code>, profile attributes are introduced into
      the cookie or the headers, respectively.</p><p>Property: <code class="literal">com.sun.identity.agents.config.profile.attribute.fetch.mode</code></p></dd><dt><span class="term">Profile Attribute Map</span></dt><dd><p>Maps the profile attributes to HTTP headers for the currently
      authenticated user. Map Keys are LDAP attribute names, and Map Values
      are HTTP header names.</p><p>To populate the value of profile attribute CN under
      <code class="literal">CUSTOM-Common-Name</code>: enter CN in the Map Key field,
      and enter <code class="literal">CUSTOM-Common-Name</code> in the Corresponding
      Map Value field. This corresponds to
      <code class="literal">com.sun.identity.agents.config.profile.attribute.mapping[cn]=CUSTOM-Common-Name</code>.</p><p>In most cases, in a destination application where an HTTP header
      name shows up as a request header, it is prefixed by
      <code class="literal">HTTP_</code>, lower case letters become upper case, and
      hyphens (<code class="literal">-</code>) become underscores (<code class="literal">_</code>).
      For example, <code class="literal">common-name</code> becomes
      <code class="literal">HTTP_COMMON_NAME</code>.</p><p>Property: <code class="literal">com.sun.identity.agents.config.profile.attribute.mapping</code></p></dd></dl></div><div class="variablelist"><a name="web-agent-response-attributes-processing-properties"></a><div class="variablelist-title">Response Attributes Processing properties</div><dl class="variablelist"><dt><span class="term">Response Attribute Fetch Mode</span></dt><dd><p>When set to <code class="literal">HTTP_COOKIE</code> or
      <code class="literal">HTTP_HEADER</code>, response attributes are introduced into
      the cookie or the headers, respectively.</p><p>Property: <code class="literal">com.sun.identity.agents.config.response.attribute.fetch.mode</code></p></dd><dt><span class="term">Response Attribute Map</span></dt><dd><p>Maps the policy response attributes to HTTP headers for the
      currently authenticated user. The response attribute is
      the attribute in the policy response to be fetched.</p><p>To populate the value of response attribute <code class="literal">uid</code>
      under <code class="literal">CUSTOM-User-Name</code>: enter <code class="literal">uid</code>
      in the Map Key field, and enter <code class="literal">CUSTOM-User-Name</code> in
      the Corresponding Map Value field. This corresponds to
      <code class="literal">com.sun.identity.agents.config.response.attribute.mapping[uid]=Custom-User-Name</code>.</p><p>In most cases, in a destination application where an HTTP header
      name shows up as a request header, it is prefixed by
      <code class="literal">HTTP_</code>, lower case letters become upper case, and
      hyphens (<code class="literal">-</code>) become underscores (<code class="literal">_</code>).
      For example, <code class="literal">response-attr-one</code> becomes
      <code class="literal">HTTP_RESPONSE_ATTR_ONE</code>.</p><p>Property: <code class="literal">com.sun.identity.agents.config.response.attribute.mapping</code></p></dd></dl></div><div class="variablelist"><a name="web-agent-session-attributes-processing-properties"></a><div class="variablelist-title">Session Attributes Processing properties</div><dl class="variablelist"><dt><span class="term">Session Attribute Fetch Mode</span></dt><dd><p>When set to <code class="literal">HTTP_COOKIE</code> or
      <code class="literal">HTTP_HEADER</code>, session attributes are introduced into the
      cookie or the headers, respectively.</p><p>Property: <code class="literal">com.sun.identity.agents.config.session.attribute.fetch.mode</code></p></dd><dt><span class="term">Session Attribute Map</span></dt><dd><p>Maps session attributes to HTTP headers for the currently
      authenticated user. The session attribute is the attribute in the session
      to be fetched.</p><p>To populate the value of session attribute
      <code class="literal">UserToken</code> under <code class="literal">CUSTOM-userid</code>:
      enter <code class="literal">UserToken</code> in the Map Key field, and enter
      <code class="literal">CUSTOM-userid</code> in
      the Corresponding Map Value field. This corresponds to
      <code class="literal">com.sun.identity.agents.config.session.attribute.mapping[UserToken] =CUSTOM-userid</code>.</p><p>In most cases, in a destination application where an HTTP header
      name shows up as a request header, it is prefixed by
      <code class="literal">HTTP_</code>, lower case letters become upper case, and
      hyphens (<code class="literal">-</code>) become underscores (<code class="literal">_</code>).
      For example, <code class="literal">success-url</code> becomes
      <code class="literal">HTTP_SUCCESS_URL</code>.</p><p>Property: <code class="literal">com.sun.identity.agents.config.session.attribute.mapping</code></p></dd></dl></div><div class="variablelist"><a name="web-agent-attributes-fetching-properties"></a><div class="variablelist-title">Common Attributes Fetching Processing properties</div><dl class="variablelist"><dt><span class="term">Attribute Multi Value Separator</span></dt><dd><p>Specifies separator for multiple values. Applies to all types of
      attributes such as profile, session and response attributes. Default:
      <code class="literal">|</code>.</p><p>Property: <code class="literal">com.sun.identity.agents.config.attribute.multi.value.separator</code></p></dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="configure-web-pa-sso-props"></a>5.5.3.&nbsp;Configuring Web Policy Agent SSO Properties</h3></div></div></div><a class="indexterm" name="d16037e17871"></a><p>This section covers SSO web agent properties. After creating the
   agent profile, you access these properties in the OpenAM console under
   Access Control &gt; <em class="replaceable"><code>Realm Name</code></em> &gt; Agents &gt;
   Web &gt; <em class="replaceable"><code>Agent Name</code></em> &gt; SSO</p><div class="variablelist"><a name="web-agent-cookie-properties"></a><div class="variablelist-title">Cookie properties</div><dl class="variablelist"><dt><span class="term">Cookie Name</span></dt><dd><p>Name of the SSO Token cookie used between the OpenAM server and
      the agent. Default: <code class="literal">iPlanetDirectoryPro</code>.</p><p>Property: <code class="literal">com.sun.identity.agents.config.cookie.name</code></p><p>Hot swap: no</p></dd><dt><span class="term">Cookie Security</span></dt><dd><p>When enabled, the agent marks cookies secure, sending them only
      if the communication channel is secure.</p><p>Property: <code class="literal">com.sun.identity.agents.config.cookie.secure</code></p><p>Hot swap: no</p></dd><dt><span class="term">HTTPOnly Cookies (Not yet in OpenAM console)</span></dt><dd><p>As of version 3.0.5, web policy agents with this property set to
      <code class="literal">true</code> mark cookies as HTTPOnly, to prevent scripts
      and third-party programs from accessing the cookies.</p><p>Property: <code class="literal">com.sun.identity.cookie.httponly</code></p></dd></dl></div><div class="variablelist"><a name="web-agent-cdsso-properties"></a><div class="variablelist-title">Cross Domain SSO properties</div><dl class="variablelist"><dt><span class="term">Cross Domain SSO</span></dt><dd><p>Enables Cross Domain Single Sign On.</p><p>Property: <code class="literal">com.sun.identity.agents.config.cdsso.enable</code></p></dd><dt><span class="term">CDSSO Servlet URL</span></dt><dd><p>List of URLs of the available CDSSO controllers that the agent can
      use for CDSSO processing. For example,
      <code class="literal">http://openam.example.com:8080/openam/cdcservlet</code>.</p><p>Property: <code class="literal">com.sun.identity.agents.config.cdsso.cdcservlet.url</code></p></dd><dt><span class="term">Cookies Domain List</span></dt><dd><p>List of domains, such as <code class="literal">.example.com</code>, in which
      cookies have to be set in CDSSO. If this property is left blank, then
      the fully qualified domain name of the cookie for the agent server
      is used to set the cookie domain, meaning that a host cookie rather than
      a domain cookie is set.</p><p>To set the list to <code class="literal">.example.com</code>, and
      <code class="literal">.example.net</code> using the configuration file property,
      include the following.</p><pre class="literallayout">com.sun.identity.agents.config.cdsso.cookie.domain[0]=.example.com
      com.sun.identity.agents.config.cdsso.cookie.domain[1]=.example.net</pre><p>Property: <code class="literal">com.sun.identity.agents.config.cdsso.cookie.domain</code></p></dd></dl></div><div class="variablelist"><a name="web-agent-cookie-reset-properties"></a><div class="variablelist-title">Cookie Reset properties</div><dl class="variablelist"><dt><span class="term">Cookie Reset</span></dt><dd><p>When enabled, agent resets cookies in the response before
      redirecting to authentication.</p><p>Property: <code class="literal">com.sun.identity.agents.config.cookie.reset.enable</code></p></dd><dt><span class="term">Cookie Reset Name List</span></dt><dd><p>List of cookies in the format
      <code class="literal"><em class="replaceable"><code>name</code></em>[=<em class="replaceable"><code>value</code></em>][;Domain=<em class="replaceable"><code>value</code></em>]</code>.</p><p>Concrete examples include the following with two list items
      configured.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">LtpaToken</code>, corresponding to
        <code class="literal">com.sun.identity.agents.config.cookie.reset[0]=LtpaToken</code>.
        The default domain is taken from FQDN Default.</p></li><li class="listitem"><p><code class="literal">token=value;Domain=subdomain.domain.com</code>,
        corresponding to
        <code class="literal">com.sun.identity.agents.config.cookie.reset[1]= token=value;Domain=subdomain.domain.com</code></p></li></ul></div><p>Property: <code class="literal">com.sun.identity.agents.config.cookie.reset</code></p></dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="configure-web-pa-services-props"></a>5.5.4.&nbsp;Configuring Web Policy Agent OpenAM Services Properties</h3></div></div></div><a class="indexterm" name="d16037e18034"></a><p>This section covers OpenAM services web agent properties. After
   creating the agent profile, you access these properties in the OpenAM console
   under Access Control &gt; <em class="replaceable"><code>Realm Name</code></em> &gt;
   Agents &gt; Web &gt; <em class="replaceable"><code>Agent Name</code></em> &gt; OpenAM
   Services.</p><div class="variablelist"><a name="web-agent-login-url-properties"></a><div class="variablelist-title">Login URL properties</div><dl class="variablelist"><dt><span class="term">OpenAM Login URL</span></dt><dd><p>OpenAM login page URL, such as
      <code class="literal">http://openam.example.com:8080/openam/UI/Login</code>, to
      which the agent redirects incoming users without sufficient credentials
      so that they can authenticate.</p><p>Property: <code class="literal">com.sun.identity.agents.config.login.url</code></p></dd><dt><span class="term">OpenAM Conditional Login URL (Not yet in OpenAM console)</span></dt><dd><p>
  To conditionally redirect users based on the incoming request URL,
  set this property.
 </p><p>
  This takes the incoming request domain to match,
  a vertical bar ( <code class="literal">|</code> ),
  and then a comma-separated list of URLs to which to redirect incoming users.
 </p><p>
  If the domain before the vertical bar matches an incoming request URL,
  then the policy agent uses the list of URLs
  to determine how to redirect the user-agent.

  If the global property FQDN Check
  (<code class="literal">com.sun.identity.agents.config.fqdn.check.enable</code>)
  is enabled for the policy agent,
  then the policy agent iterates through the list
  until it finds an appropriate redirect URL that matches the FQDN check.

  Otherwise, the policy agent redirects the user-agent
  to the first URL in the list.
 </p><p>
  Property: <code class="literal">com.forgerock.agents.conditional.login.url</code>
 </p><p>
  Examples:

  <code class="literal">com.forgerock.agents.conditional.login.url[0]=
  login.example.com|http://openam1.example.com/openam/UI/Login,
  http://openam2.example.com/openam/UI/Login</code>,

  <code class="literal">com.forgerock.agents.conditional.login.url[1]=
  signin.example.com|http://openam3.example.com/openam/UI/Login,
  http://openam4.example.com/openam/UI/Login</code>
 </p><p>
  If CDSSO is enabled for the policy agent,
  then this property takes CDSSO Servlet URLs for its values
  (<code class="literal">com.sun.identity.agents.config.cdsso.cdcservlet.url</code>),
  rather than OpenAM login URLs.
 </p><p>
  CDSSO examples:

  <code class="literal">com.forgerock.agents.conditional.login.url[0]=
  login.example.com|http://openam1.example.com/openam/cdcservlet,
  http://openam2.example.com/openam/cdcservlet</code>,

  <code class="literal">com.forgerock.agents.conditional.login.url[1]=
  signin.example.com|http://openam3.example.com/openam/cdcservlet,
  http://openam4.example.com/openam/cdcservlet</code>
 </p></dd><dt><span class="term">Agent Connection Timeout</span></dt><dd><p>Timeout period in seconds for an agent connection with OpenAM auth
      server.</p><p>Property: <code class="literal">com.sun.identity.agents.config.auth.connection.timeout</code></p><p>Default: 2</p></dd><dt><span class="term">Polling Period for Primary Server</span></dt><dd><p>Interval in minutes, agent polls to check the primary server is up
      and running. Default: 5.</p><p>Property: <code class="literal">com.sun.identity.agents.config.poll.primary.server</code></p><p>Hot swap: no</p></dd></dl></div><div class="variablelist"><a name="web-agent-logout-url-properties"></a><div class="variablelist-title">Logout URL properties</div><dl class="variablelist"><dt><span class="term">OpenAM Logout URL</span></dt><dd><p>OpenAM logout page URL, such as
      <code class="literal">http://openam.example.com:8080/openam/UI/Logout</code>.</p><p>Property: <code class="literal">com.sun.identity.agents.config.logout.url</code></p></dd><dt><span class="term">Enable Logout URL Redirect (Not yet in OpenAM console)</span></dt><dd><p>Logout URL redirect is enabled by default.</p><p>When this is disabled, instead of redirecting the user-agent, the
      policy agent performs session logout in the background and then continues
      processing access to the current URL. Disable this using Advanced &gt;
      Custom Properties in the agent profile.</p><pre class="literallayout">com.forgerock.agents.config.logout.redirect.disable=true</pre></dd></dl></div><div class="variablelist"><a name="web-agent-agent-logout-url-properties"></a><div class="variablelist-title">Agent Logout URL properties</div><dl class="variablelist"><dt><span class="term">Logout URL List</span></dt><dd><p>List of application logout URLs, such as
      <code class="literal">http://www.example.com/logout.html</code>.
      The user is logged out of the OpenAM session when these URLs are accessed.
      When using this property, specify a value for the Logout Redirect URL
      property.</p><p>Property: <code class="literal">com.sun.identity.agents.config.agent.logout.url</code></p></dd><dt><span class="term">Agent Logout URL Regular Expression (Not yet in OpenAM console)</span></dt><dd><p><a class="link" href="http://www.pcre.org/pcre.txt" target="_blank">Perl-compatible regular expression</a> that matches logout URLs.
      Set this using Advanced &gt; Custom Properties in the agent profile.</p><p>For example, to match URLs with <code class="literal">protectedA</code> or
      <code class="literal">protectedB</code> in the path and <code class="literal">op=logout</code>
      in the query string, use the following setting.</p><pre class="brush: ini;">com.forgerock.agents.agent.logout.url.regex= \
      .*(/protectedA\?|/protectedB\?/).*(\&amp;op=logout\&amp;)(.*|$)</pre><p>When you use this property, the agent ignores the settings for
      Logout URL List.</p></dd><dt><span class="term">Logout Cookies List for Reset</span></dt><dd><p>Cookies to be reset upon logout in the same format as the cookie
      reset list.</p><p>Property: <code class="literal">com.sun.identity.agents.config.logout.cookie.reset</code></p></dd><dt><span class="term">Logout Redirect URL</span></dt><dd><p>User gets redirected to this URL after logout. Specify this
      property alongside a Logout URL List.</p><p>Property: <code class="literal">com.sun.identity.agents.config.logout.redirect.url</code></p></dd></dl></div><div class="variablelist"><a name="web-agent-policy-client-service-properties"></a><div class="variablelist-title">Policy Client Service properties</div><dl class="variablelist"><dt><span class="term">Policy Cache Polling Period</span></dt><dd><p>Polling interval in minutes during which an entry remains valid
      after being added to the agent's cache.</p><p>Property: <code class="literal">com.sun.identity.agents.config.policy.cache.polling.interval</code></p><p>Hot swap: no</p></dd><dt><span class="term">SSO Cache Polling Period</span></dt><dd><p>Polling interval in minutes during which an SSO entry remains valid
      after being added to the agent's cache.</p><p>Property: <code class="literal">com.sun.identity.agents.config.sso.cache.polling.interval</code></p><p>Hot swap: no</p></dd><dt><span class="term">User ID Parameter</span></dt><dd><p>Agent sets this value for User Id passed in the session from
      OpenAM to the REMOTE_USER server variable. Default: UserToken.</p><p>Property: <code class="literal">com.sun.identity.agents.config.userid.param</code></p></dd><dt><span class="term">User ID Parameter Type</span></dt><dd><p>User ID can be fetched from either SESSION or LDAP attributes.
      Default: <code class="literal">SESSION</code>.</p><p>Property: <code class="literal">com.sun.identity.agents.config.userid.param.type</code></p></dd><dt><span class="term">Fetch Policies from Root Resource</span></dt><dd><p>When enabled, the agent caches the policy decision of the
      resource and all resources from the root of the resource down. For
      example, if the resource is <code class="literal">http://host/a/b/c</code>, then
      the root of the resource is <code class="literal">http://host/</code>. This setting
      can be useful when a client is expect to access multiple resources on the
      same path. Yet, caching can be expensive if very many policies are
      defined for the root resource.</p><p>Property: <code class="literal">com.sun.identity.agents.config.fetch.from.root.resource</code></p><p>Default: false</p><p>Hot swap: no</p></dd><dt><span class="term">Retrieve Client Hostname</span></dt><dd><p>When enabled, get the client hostname through DNS reverse lookup
      for use in policy evaluation. This setting can impact performance.</p><p>Property: <code class="literal">com.sun.identity.agents.config.get.client.host.name</code></p></dd><dt><span class="term">Policy Clock Skew</span></dt><dd><p>Time in seconds used adjust time difference between agent system
      and OpenAM. Clock skew in seconds = AgentTime - OpenAMServerTime.</p><p>Use this property to adjust for small time differences encountered
      despite use of a time synchronization service. When this property is
      not set and agent time is greater than OpenAM server time, the agent
      can make policy calls to the OpenAM server before the policy subject
      cache has expired, or you can see infinite redirection occur.</p><p>Property: <code class="literal">com.sun.identity.agents.config.policy.clock.skew</code></p><p>Hot swap: no</p></dd><dt><span class="term">Realm</span></dt><dd><p>
      Realm where OpenAM starts policy evaluation for this policy agent.
     </p><p>
      Default: / (top level realm)
     </p><p>
      Edit this property when OpenAM should start policy evaluation
      in a realm other than the top level realm, <code class="literal">/</code>,
      when handling policy decision requests from this policy agent.
     </p><p>
      This property is recognized by OpenAM, not the policy agent.
     </p><p>
      Property: <code class="literal">org.forgerock.openam.agents.config.policy.evaluation.realm</code>
     </p><p>
      Hot swap: yes
     </p></dd><dt><span class="term">Application</span></dt><dd><p>
      Application where OpenAM looks for policies to evaluate
      for this policy agent.
     </p><p>
      Default: <code class="literal">iPlanetAMWebAgentService</code>
     </p><p>
      Edit this property when OpenAM should look for policies
      that belong to an application other than
      <code class="literal">iPlanetAMWebAgentService</code>
      when handling policy decision requests from this policy agent.
     </p><p>
      This property is recognized by OpenAM, not the policy agent.
     </p><p>
      Property: <code class="literal">org.forgerock.openam.agents.config.policy.evaluation.application</code>
     </p><p>
      Hot swap: yes
     </p></dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="configure-web-pa-misc-props"></a>5.5.5.&nbsp;Configuring Web Policy Agent Miscellaneous Properties</h3></div></div></div><a class="indexterm" name="d16037e18362"></a><p>This section covers miscellaneous web agent properties. After creating
   the agent profile, you access these properties in the OpenAM console under
   Access Control &gt; <em class="replaceable"><code>Realm Name</code></em> &gt; Agents &gt;
   Web &gt; <em class="replaceable"><code>Agent Name</code></em> &gt; Miscellaneous.</p><div class="variablelist"><a name="web-agent-advice-handling-properties"></a><div class="variablelist-title">Advice Handling properties</div><dl class="variablelist"><dt><span class="term">Composite Advice Handling (Not yet in OpenAM console)</span></dt><dd><p>As of version 3.0.4, when set to <code class="literal">true</code>, the agent
      sends composite advice in the query (GET request) instead of sending it
      through a POST request.</p><p>Property: <code class="literal">com.sun.am.use_redirect_for_advice</code></p></dd></dl></div><div class="variablelist"><a name="web-agent-locale-properties"></a><div class="variablelist-title">Locale properties</div><dl class="variablelist"><dt><span class="term">Agent Locale</span></dt><dd><p>The default locale for the agent.</p><p>Property: <code class="literal">com.sun.identity.agents.config.locale</code></p><p>Hot swap: no</p></dd></dl></div><div class="variablelist"><a name="web-agent-anonymous-user-properties"></a><div class="variablelist-title">Anonymous user properties</div><dl class="variablelist"><dt><span class="term">Anonymous User</span></dt><dd><p>Enable or disable REMOTE_USER processing for anonymous users.</p><p>Property: <code class="literal">com.sun.identity.agents.config.anonymous.user.enable</code></p></dd></dl></div><div class="variablelist"><a name="web-agent-cookie-processing-properties"></a><div class="variablelist-title">Cookie Processing properties</div><dl class="variablelist"><dt><span class="term">Encode special characters in Cookies</span></dt><dd><p>When enabled, use URL encoding for special characters in cookies.
      This is useful when profile, session, and response attributes contain
      special characters, and the attributes fetch mode is set to
      <code class="literal">HTTP_COOKIE</code>.</p><p>Property: <code class="literal">com.sun.identity.agents.config.encode.cookie.special.chars.enable</code></p></dd><dt><span class="term">Profile Attributes Cookie Prefix</span></dt><dd><p>Sets cookie prefix in the attributes headers. Default:
      <code class="literal">HTTP_</code>.</p><p>Property: <code class="literal">com.sun.identity.agents.config.profile.attribute.cookie.prefix</code></p></dd><dt><span class="term">Profile Attributes Cookie Maxage</span></dt><dd><p>Maximum age in seconds of custom cookie headers. Default:
      300.</p><p>Property: <code class="literal">com.sun.identity.agents.config.profile.attribute.cookie.maxage</code></p></dd></dl></div><div class="variablelist"><a name="web-agent-url-handling-properties"></a><div class="variablelist-title">URL Handling properties</div><dl class="variablelist"><dt><span class="term">URL Comparison Case Sensitivity Check</span></dt><dd><p>When enabled, enforces case insensitivity in both policy and
      not enforced URL evaluation.</p><p>Property: <code class="literal">com.sun.identity.agents.config.url.comparison.case.ignore</code></p></dd><dt><span class="term">Encode URL's Special Characters</span></dt><dd><p>When enabled, encodes the URL which has special characters before
      doing policy evaluation.</p><p>Property: <code class="literal">com.sun.identity.agents.config.encode.url.special.chars.enable</code></p></dd></dl></div><div class="variablelist"><a name="web-agent-ignore-naming-url-properties"></a><div class="variablelist-title">Ignore Naming URL properties</div><dl class="variablelist"><dt><span class="term">Ignore Preferred Naming URL in Naming Request</span></dt><dd><p>When enabled, do not send a preferred naming URL in the naming request.</p><p>Property: <code class="literal">com.sun.identity.agents.config.ignore.preferred.naming.url</code></p></dd></dl></div><div class="variablelist"><a name="web-agent-invalid-url-properties"></a><div class="variablelist-title">Invalid URL properties (Not yet in OpenAM console)</div><dl class="variablelist"><dt><span class="term">Invalid URL Regular Expression</span></dt><dd><p>Use a <a class="link" href="http://www.pcre.org/" target="_blank">Perl-compatible regular expression</a> to filter out invalid
      request URLs. The policy agent reject requests to invalid URLs
      with HTTP 403 Forbidden status without further processing. Use Advanced
      &gt; Custom Properties to set this in the agent profile.</p><p>For example, to filter out URLs containing the symbols in the list
      ./, /., /, ., ,\, %00-%1f, %7f-%ff, %25, %2B, %2C, %7E, .info, use the
      following setting.</p><pre class="brush: ini;">com.forgerock.agents.agent.invalid.url.regex= \
     ^((?!(|/\.|\./||*|\.info|%25|%2B|%2C|%[0-1][0-9a-fA-F]|%[7-9a-fA-F][0-9a-fA-F])).)$</pre></dd></dl></div><div class="variablelist"><a name="web-agent-ignore-server-check-properties"></a><div class="variablelist-title">Ignore Server Check properties</div><dl class="variablelist"><dt><span class="term">Ignore Server Check</span></dt><dd><p>When enabled, do not check whether OpenAM is up before doing a
      302 redirect.</p><p>Property: <code class="literal">com.sun.identity.agents.config.ignore.server.check</code></p></dd></dl></div><div class="variablelist"><a name="web-agent-ignore-path-info-properties"></a><div class="variablelist-title">Ignore Path Info properties</div><dl class="variablelist"><dt><span class="term">Ignore Path Info in Request URL</span></dt><dd><p>When enabled, strip path info from the request URL while doing the
      Not Enforced List check, and URL policy evaluation. This is designed
      to prevent a user from accessing a URI by appending the matching pattern
      in the policy or not enforced list.</p><p>For example, if the not enforced list includes
      <code class="literal">http://host/*.gif</code>, then stripping path info from the
      request URI prevents access to <code class="literal">http://host/index.html</code>
      by using <code class="literal">http://host/index.html?hack.gif</code>.</p><p>However, when a web server is configured as a reverse proxy for a
      J2EE application server, the path info is interpreted to map a resource
      on the proxy server rather than the application server. This prevents the
      not enforced list or the policy from being applied to the part of the URI
      below the application server path if a wildcard character is used.</p><p>For example, if the not enforced list includes
      <code class="literal">http://host/webapp/servcontext/*</code> and the request URL is
      <code class="literal">http://host/webapp/servcontext/example.jsp</code>, the path
      info is <code class="literal">/servcontext/example.jsp</code> and the resulting
      request URL with path info stripped is
      <code class="literal">http://host/webapp/</code>, which does not match the
      not enforced list. Thus when this property is enabled, path info is
      not stripped from the request URL even if there is a wildcard in the not
      enforced list or policy.</p><p>Make sure therefore when this property is enabled that there is
      nothing following the wildcard in the not enforced list or policy.</p><p>Property: <code class="literal">com.sun.identity.agents.config.ignore.path.info</code></p></dd></dl></div><div class="variablelist"><a name="web-agent-multi-byte-properties"></a><div class="variablelist-title">Multi-byte Enable properties</div><dl class="variablelist"><dt><span class="term">Native Encoding of Profile Attributes</span></dt><dd><p>When enabled, the agent encodes the LDAP header values in the
      default encoding of operating system locale. When disabled, the agent
      uses UTF-8.</p><p>Property: <code class="literal">com.sun.identity.agents.config.convert.mbyte.enable</code></p></dd></dl></div><div class="variablelist"><a name="web-agent-goto-parameter-name-properties"></a><div class="variablelist-title">Goto Parameter Name properties</div><dl class="variablelist"><dt><span class="term">Goto Parameter Name</span></dt><dd><p>Property used only when CDSSO is enabled. Only change the default
      value, <code class="literal">goto</code> when the login URL has a landing page
      specified such as,
      <code class="literal">com.sun.identity.agents.config.cdsso.cdcservlet.url
       = http://openam.example.com:8080/openam/cdcservlet?goto=
       http://www.example.com/landing.jsp</code>.
      The agent uses this parameter to append the original request URL
      to this cdcservlet URL. The landing page consumes this parameter to
      redirect to the original URL.</p><p>As an example, if you set this value to <code class="literal">goto2</code>,
      then the complete URL sent for authentication is
      <code class="literal">http://openam.example.com:8080/openam/cdcservlet?goto=
       http://www.example.com/landing.jsp?goto2=http://www.example.com/original.jsp</code>.</p><p>Property: <code class="literal">com.sun.identity.agents.config.redirect.param</code></p></dd></dl></div><div class="variablelist"><a name="web-agent-deprecated-properties"></a><div class="variablelist-title">Deprecated Agent properties</div><dl class="variablelist"><dt><span class="term">Anonymous User Default Value</span></dt><dd><p>User ID of unauthenticated users. Default:
      <code class="literal">anonymous</code>.</p><p>Property: <code class="literal">com.sun.identity.agents.config.anonymous.user.id</code></p></dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="configure-web-pa-advanced-props"></a>5.5.6.&nbsp;Configuring Web Policy Agent Advanced Properties</h3></div></div></div><a class="indexterm" name="d16037e18628"></a><p>This section covers advanced web agent properties. After creating the
   agent profile, you access these properties in the OpenAM console under
   Access Control &gt; <em class="replaceable"><code>Realm Name</code></em> &gt; Agents &gt;
   Web &gt; <em class="replaceable"><code>Agent Name</code></em> &gt; Advanced.</p><div class="variablelist"><a name="web-agent-client-identification-properties"></a><div class="variablelist-title">Client Identification properties</div><p>If the agent is behind a proxy or load balancer, then the agent can
    get client IP and host name values from the proxy or load balancer. For
    proxies and load balancer that support providing the client IP and host
    name in HTTP headers, you can use the following properties.</p><p>When multiple proxies or load balancers sit in the request path,
    the header values can include a comma-separated list of values with the
    first value representing the client, as in
    <code class="literal">client,next-proxy,first-proxy</code>.</p><dl class="variablelist"><dt><span class="term">Client IP Address Header</span></dt><dd><p>HTTP header name that holds the IP address of the client.</p><p>Property: <code class="literal">com.sun.identity.agents.config.client.ip.header</code></p></dd><dt><span class="term">Client Hostname Header</span></dt><dd><p>HTTP header name that holds the hostname of the client.</p><p>Property: <code class="literal">com.sun.identity.agents.config.client.hostname.header</code></p></dd></dl></div><div class="variablelist"><a name="web-agent-lb-properties"></a><div class="variablelist-title">Load Balancer properties</div><dl class="variablelist"><dt><span class="term">Load Balancer Setup</span></dt><dd><p>Enable if a load balancer is used for OpenAM services.</p><p>Property: <code class="literal">com.sun.identity.agents.config.load.balancer.enable</code></p><p>Hot swap: no</p></dd><dt><span class="term">Override Request URL Protocol</span></dt><dd><p>Enable if the agent is sitting behind a SSL/TLS off-loader,
      load balancer, or proxy such that the protocol users use is different
      from the protocol the agent uses. When enabled, the protocol is overridden
      with the value from the Agent Deployment URI Prefix (property:
      <code class="literal">com.sun.identity.agents.config.agenturi.prefix</code>).</p><p>Property: <code class="literal">com.sun.identity.agents.config.override.protocol</code></p></dd><dt><span class="term">Override Request URL Host</span></dt><dd><p>Enable if the agent is sitting behind a SSL/TLS off-loader,
      load balancer, or proxy such that the host name users use is different
      from the host name the agent uses. When enabled, the host is overridden
      with the value from the Agent Deployment URI Prefix (property:
      <code class="literal">com.sun.identity.agents.config.agenturi.prefix</code>).</p><p>Property: <code class="literal">com.sun.identity.agents.config.override.host</code></p></dd><dt><span class="term">Override Request URL Port</span></dt><dd><p>Enable if the agent is sitting behind a SSL/TLS off-loader,
      load balancer, or proxy such that the port users use is different
      from the port the agent uses. When enabled, the port is overridden
      with the value from the Agent Deployment URI Prefix (property:
      <code class="literal">com.sun.identity.agents.config.agenturi.prefix</code>).</p><p>Property: <code class="literal">com.sun.identity.agents.config.override.port</code></p></dd><dt><span class="term">Override Notification URL</span></dt><dd><p>Enable if the agent is sitting behind a SSL/TLS off-loader,
      load balancer, or proxy such that the URL users use is different
      from the URL the agent uses. When enabled, the URL is overridden
      with the value from the Agent Deployment URI Prefix (property:
      <code class="literal">com.sun.identity.agents.config.agenturi.prefix</code>).</p><p>Property: <code class="literal">com.sun.identity.agents.config.override.notification.url</code></p></dd></dl></div><div class="variablelist"><a name="web-agent-post-data-preservation-properties"></a><div class="variablelist-title">Post Data Preservation properties</div><dl class="variablelist"><dt><span class="term">POST Data Preservation</span></dt><dd><p>Enables HTTP POST data preservation. This feature is available in
      the Apache 2.2, Microsoft IIS 6, Microsoft IIS 7, and Sun Java System
      Web Server web policy agents as of version 3.0.3.</p><p>Property: <code class="literal">com.sun.identity.agents.config.postdata.preserve.enable</code></p></dd><dt><span class="term">POST Data Entries Cache Period</span></dt><dd><p>POST cache entry lifetime in minutes. Default: 10.</p><p>Property: <code class="literal">com.sun.identity.agents.config.postcache.entry.lifetime</code></p></dd><dt><span class="term">POST Data Preservation Cookie Name (Not yet in OpenAM Console)</span></dt><dd><p>When HTTP POST data preservation is enabled, override properties
      are set to true, and the agent is behind a load balancer, then this
      property sets the name and value of the sticky cookie to use.</p><p>Property: <code class="literal">com.sun.identity.agents.config.postdata.preserve.lbcookie</code></p></dd><dt><span class="term">Post Data Preservation URI Prefix (Not yet in OpenAM Console)</span></dt><dd><p>If you run multiple web servers with policy agents behind a load
      balancer that directs traffic based on the request URI, and you need to
      preserve POST data, then set this property.</p><p>By default, policy agents use a dummy URL for POST data preservation,
      <code class="literal">http://<em class="replaceable"><code>agent.host</code></em>:<em class="replaceable"><code>port</code></em>/dummypost/sunpostpreserve</code>,
      to handle POST data across redirects to and from OpenAM. When you set this
      property, the policy agent prefixes the property value to the dummy URL
      path. In other words, when you set
      <code class="literal">com.forgerock.agents.config.pdpuri.prefix = app1</code>,
      the policy agent uses the dummy URL,
      <code class="literal">http://<em class="replaceable"><code>agent.host</code></em>:<em class="replaceable"><code>port</code></em>/app1/dummypost/sunpostpreserve</code>.</p><p>Next, use the prefix you set when you define load balancer URI
      rules. This ensures that clients end up being redirected to the policy
      agent that preserved the POST data.</p><p>Property: <code class="literal">com.forgerock.agents.config.pdpuri.prefix</code></p></dd></dl></div><div class="variablelist"><a name="web-agent-sjsws-properties"></a><div class="variablelist-title">Sun Java System Proxy Server properties</div><dl class="variablelist"><dt><span class="term">Override Proxy Server's Host and Port</span></dt><dd><p>When enabled ignore the host and port settings.</p><p>Property: <code class="literal">com.sun.identity.agents.config.proxy.override.host.port</code></p><p>Hot swap: no</p></dd></dl></div><div class="variablelist"><a name="web-agent-iis-properties"></a><div class="variablelist-title">Microsoft IIS Server properties</div><dl class="variablelist"><dt><span class="term">Authentication Type</span></dt><dd><p>The agent should normally perform authentication, so this is not
      required. If necessary, set to <code class="literal">none</code>.</p><p>Property: <code class="literal">com.sun.identity.agents.config.iis.auth.type</code></p><p>Hot swap: no</p></dd><dt><span class="term">Replay Password Key</span></dt><dd><p>DES key for decrypting the basic authentication password in the
      session.</p><p>Property: <code class="literal">com.sun.identity.agents.config.replaypasswd.key</code></p></dd><dt><span class="term">Filter Priority</span></dt><dd><p>The loading priority of filter, DEFAULT, HIGH, LOW, or MEDIUM.</p><p>Property: <code class="literal">com.sun.identity.agents.config.iis.filter.priority</code></p></dd><dt><span class="term">Filter configured with OWA</span></dt><dd><p>Enable if the IIS agent filter is configured for OWA.</p><p>Property: <code class="literal">com.sun.identity.agents.config.iis.owa.enable</code></p></dd><dt><span class="term">Change URL Protocol to https</span></dt><dd><p>Enable to avoid IE6 security pop-ups.</p><p>Property: <code class="literal">com.sun.identity.agents.config.iis.owa.enable.change.protocol</code></p></dd><dt><span class="term">Idle Session Timeout Page URL</span></dt><dd><p>URL of the local idle session timeout page.</p><p>Property: <code class="literal">com.sun.identity.agents.config.iis.owa.enable.session.timeout.url</code></p></dd></dl></div><div class="variablelist"><a name="web-agent-domino-properties"></a><div class="variablelist-title">IBM Lotus Domino Server properties</div><dl class="variablelist"><dt><span class="term">Check User in Domino Database</span></dt><dd><p>When enabled, the agent checks whether the user exists in the
      Domino name database.</p><p>Property: <code class="literal">com.sun.identity.agents.config.domino.check.name.database</code></p></dd><dt><span class="term">Use LTPA token</span></dt><dd><p>Enable if the agent needs to use LTPA Token.</p><p>Property: <code class="literal">com.sun.identity.agents.config.domino.ltpa.enable</code></p></dd><dt><span class="term">LTPA Token Cookie Name</span></dt><dd><p>The name of the cookie that contains the LTPA token.</p><p>Property: <code class="literal">com.sun.identity.agents.config.domino.ltpa.cookie.name</code></p></dd><dt><span class="term">LTPA Token Configuration Name</span></dt><dd><p>The configuration name that the agent uses in order to employ the
      LTPA token mechanism.</p><p>Property: <code class="literal">com.sun.identity.agents.config.domino.ltpa.config.name</code></p></dd><dt><span class="term">LTPA Token Organization Name</span></dt><dd><p>The organization name to which the LTPA token belongs.</p><p>Property: <code class="literal">com.sun.identity.agents.config.domino.ltpa.org.name</code></p></dd></dl></div><div class="variablelist"><a name="web-agent-custom-properties"></a><div class="variablelist-title">Custom properties</div><dl class="variablelist"><dt><span class="term">Custom Properties</span></dt><dd><p>Additional properties to augment the set of properties supported
      by agent. Such properties take the following forms.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">customproperty=custom-value1</code></p></li><li class="listitem"><p><code class="literal">customlist[0]=customlist-value-0</code></p></li><li class="listitem"><p><code class="literal">customlist[1]=customlist-value-1</code></p></li><li class="listitem"><p><code class="literal">custommap[key1]=custommap-value-1</code></p></li><li class="listitem"><p><code class="literal">custommap[key2]=custommap-value-2</code></p></li></ul></div><p>Property: <code class="literal">com.sun.identity.agents.config.freeformproperties</code></p></dd></dl></div></div></div><div lang="en" class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="configure-j2ee-policy-agent"></a>5.6.&nbsp;Configuring Java EE Policy Agents</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="#configure-j2ee-pa-global-props">5.6.1. Configuring Java EE Policy Agent Global Properties</a></span></dt><dt><span class="section"><a href="#configure-j2ee-pa-application-props">5.6.2. Configuring Java EE policy agent Application Properties</a></span></dt><dt><span class="section"><a href="#configure-j2ee-pa-sso-props">5.6.3. Configuring Java EE policy agent SSO Properties</a></span></dt><dt><span class="section"><a href="#configure-j2ee-pa-services-props">5.6.4. Configuring Java EE policy agent OpenAM Services Properties</a></span></dt><dt><span class="section"><a href="#configure-j2ee-pa-misc-props">5.6.5. Configuring Java EE policy agent Miscellaneous Properties</a></span></dt><dt><span class="section"><a href="#configure-j2ee-pa-advanced-props">5.6.6. Configuring Java EE policy agent Advanced Properties</a></span></dt></dl></div><a class="indexterm" name="d16037e18983"></a><p>When you create a Java EE policy agent profile and install the agent,
  you can choose to store the agent configuration centrally and configure
  the agent through OpenAM console. Alternatively, you can choose to store
  the agent configuration locally and configure the agent by changing
  values in the properties file. This section covers centralized configuration,
  indicating the corresponding properties for use in a local configuration
  file where applicable.

  <a href="#ftn.d16037e18990" class="footnote" name="d16037e18990"><sup class="footnote">[7]</sup></a></p><div class="tip"><h3 class="title">Tip</h3><p>To show the agent properties in configuration file format that
   correspond to what you see in the console, click Export Configuration
   after editing agent properties.</p></div><p>After changing properties specified as "Hot swap: no" you must
  restart the application server or web server, or the agent's container.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="configure-j2ee-pa-global-props"></a>5.6.1.&nbsp;Configuring Java EE Policy Agent Global Properties</h3></div></div></div><p>This section covers global Java EE agent properties. After creating the
   agent profile, you access these properties in the OpenAM console under
   Access Control &gt; <em class="replaceable"><code>Realm Name</code></em> &gt; Agents &gt;
   Java EE &gt; <em class="replaceable"><code>Agent Name</code></em> &gt; Global.</p><div class="variablelist"><a name="j2ee-agent-profile-properties"></a><div class="variablelist-title">Profile properties</div><dl class="variablelist"><dt><span class="term">Group</span></dt><dd><p>For assigning the agent to a previously configured Java EE agent group
      in order to inherit selected properties from the group.</p></dd><dt><span class="term">Password</span></dt><dd><p>Agent password used when creating the password file and when
      installing the agent.</p></dd><dt><span class="term">Status</span></dt><dd><p>Status of the agent configuration.</p></dd><dt><span class="term">Agent Notification URL</span></dt><dd><p>URL used by agent to register notification listeners.</p><p>Property: <code class="literal">com.sun.identity.client.notification.url</code></p><p>Hot swap: no</p></dd><dt><span class="term">Location of Agent Configuration Repository</span></dt><dd><p>Indicates agent's configuration located either on agent's host or
      centrally on OpenAM server.</p><p>If you change this to a local configuration, you can no longer
      manage the policy agent configuration through OpenAM console.</p><p>Property: <code class="literal">com.sun.identity.agents.config.repository.location</code></p></dd><dt><span class="term">Configuration Reload Interval</span></dt><dd><p>Interval in seconds to fetch agent configuration from OpenAM. Used
      if notifications are disabled. Default: 0</p><p>Property: <code class="literal">com.sun.identity.agents.config.load.interval</code></p></dd><dt><span class="term">Agent Configuration Change Notification</span></dt><dd><p>Enable agent to receive notification messages from OpenAM server for
      configuration changes.</p><p>Property: <code class="literal">com.sun.identity.agents.config.change.notification.enable</code></p></dd><dt><span class="term">Agent Root URL for CDSSO</span></dt><dd><p>The agent root URL for CDSSO. The valid value is in the format
      <code class="literal"><em class="replaceable"><code>protocol</code></em>://<em class="replaceable"><code>hostname</code></em>:<em class="replaceable"><code>port</code></em>/</code>
      where <em class="replaceable"><code>protocol</code></em> represents the protocol used,
      such as <code class="literal">http</code> or <code class="literal">https</code>,
      <em class="replaceable"><code>hostname</code></em> represents the host name of the
      system where the agent resides, and <em class="replaceable"><code>port</code></em>
      represents the port number on which the agent is installed.
      The slash following the port number is required.</p><p>If your agent system also has virtual host names, add URLs with
      the virtual host names to this list as well. OpenAM checks that
      <code class="literal">goto</code> URLs match one of the agent root URLs for
      CDSSO.</p></dd></dl></div><div class="variablelist"><a name="j2ee-agent-general-properties"></a><div class="variablelist-title">General properties</div><dl class="variablelist"><dt><span class="term">Agent Filter Mode</span></dt><dd><p>Specifies how the agent filters requests to protected web
      applications. The global value functions as a default, and applies for
      protected applications that do not have their own filter settings.
      Valid settings include the following.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">ALL</code></span></dt><dd><p>Enforce both the Java EE policy defined for the web container where
         the protected application runs, and also OpenAM policies.</p><p>When setting the filter mode to <code class="literal">ALL</code>, set the
         Map Key, but do not set any Corresponding Map Value.</p></dd><dt><span class="term"><code class="literal">J2EE_POLICY</code></span></dt><dd><p>Enforce only the J2EE policy defined for the web container where
         the protected application runs.</p></dd><dt><span class="term"><code class="literal">NONE</code></span></dt><dd><p>Do not enforce policies to protect resources. In other words,
         turn off access management. Not for use in production.</p></dd><dt><span class="term"><code class="literal">SSO_ONLY</code></span></dt><dd><p>Enforce only authentication, not policies.</p></dd><dt><span class="term"><code class="literal">URL_POLICY</code></span></dt><dd><p>Enforce only URL resource-based policies defined in OpenAM.</p><p>When setting the filter mode to <code class="literal">URL_POLICY</code>,
         set the Map Key to the application name and the Corresponding Map
         Value to <code class="literal">URL_POLICY</code>.</p></dd></dl></div><p>Property: <code class="literal">com.sun.identity.agents.config.filter.mode</code></p><p>Hot swap: no</p></dd><dt><span class="term">HTTP Session Binding</span></dt><dd><p>When enabled the agent invalidates the HTTP session upon login
      failure, when the user has no SSO session, or when the principal user
      name does not match the SSO user name.</p><p>Property: <code class="literal">com.sun.identity.agents.config.httpsession.binding</code></p></dd><dt><span class="term">Login Attempt Limit</span></dt><dd><p>When set to a value other than zero, this defines the maximum
      number of failed login attempts allowed during a single browser session,
      after which the agent blocks requests from the user.</p><p>Property: <code class="literal">com.sun.identity.agents.config.login.attempt.limit</code></p></dd><dt><span class="term">Custom Response Header</span></dt><dd><p>Specifies the custom headers the agent sets for the client. The
      key is the header name. The value is the header value.</p><p>Property: <code class="literal">com.sun.identity.agents.config.response.header</code></p><p>For example,
      <code class="literal">com.sun.identity.agents.config.response.header[Cache-Control]=no-cache</code>.</p></dd><dt><span class="term">Redirect Attempt Limit</span></dt><dd><p>When set to a value other than zero, this defines the maximum number
      of redirects allowed for a single browser session, after which the agent
      blocks the request.</p><p>Property: <code class="literal">com.sun.identity.agents.config.redirect.attempt.limit</code></p></dd><dt><span class="term">Agent Debug Level</span></dt><dd><p>Default is <code class="literal">Error</code>. Increase to
      <code class="literal">Message</code> for fine-grained detail.</p><p>Property: <code class="literal">com.iplanet.services.debug.level</code></p></dd></dl></div><div class="variablelist"><a name="j2ee-user-mapping-properties"></a><div class="variablelist-title">User Mapping properties</div><dl class="variablelist"><dt><span class="term">User Mapping Mode</span></dt><dd><p>Specifies the mechanism used to determine the user ID.</p><p>Property: <code class="literal">com.sun.identity.agents.config.user.mapping.mode</code></p></dd><dt><span class="term">User Attribute Name</span></dt><dd><p>Specifies the data store attribute that contains the user ID.</p><p>Property: <code class="literal">com.sun.identity.agents.config.user.attribute.name</code></p></dd><dt><span class="term">User Principal Flag</span></dt><dd><p>When enabled, OpenAM uses both the principal user name and also the
      user ID for authentication.</p><p>Property: <code class="literal">com.sun.identity.agents.config.user.principal</code></p></dd><dt><span class="term">User Token Name</span></dt><dd><p>Specifies the session property name for the authenticated user's
      ID. Default: <code class="literal">UserToken</code>.</p><p>Property: <code class="literal">com.sun.identity.agents.config.user.token</code></p></dd></dl></div><div class="variablelist"><a name="j2ee-agent-audit-properties"></a><div class="variablelist-title">Audit properties</div><dl class="variablelist"><dt><span class="term">Audit Access Types</span></dt><dd><p>Types of messages to log based on user URL access attempts.</p><p>Property: <code class="literal">com.sun.identity.agents.config.audit.accesstype</code></p><p>Valid values for the configuration file property include
      <code class="literal">LOG_NONE</code>, <code class="literal">LOG_ALLOW</code>,
      <code class="literal">LOG_DENY</code>, and <code class="literal">LOG_BOTH</code>.</p></dd><dt><span class="term">Audit Log Location</span></dt><dd><p>Specifies where audit messages are logged. By default, audit
      messages are logged remotely.</p><p>Property: <code class="literal">com.sun.identity.agents.config.log.disposition</code></p><p>Valid values for the configuration file property include
      <code class="literal">REMOTE</code>, <code class="literal">LOCAL</code>, and
      <code class="literal">ALL</code>.</p></dd><dt><span class="term">Remote Log Filename</span></dt><dd><p>Name of file stored on OpenAM server that contains agent audit
      messages if log location is remote or all.</p><p>Property: <code class="literal">com.sun.identity.agents.config.remote.logfile</code></p><p>Hot swap: no</p></dd><dt><span class="term">Rotate Local Audit Log</span></dt><dd><p>When enabled, audit log files are rotated when reaching the
      specified size.</p><p>Property: <code class="literal">com.sun.identity.agents.config.local.log.rotate</code></p></dd><dt><span class="term">Local Audit Log Rotation Size</span></dt><dd><p>Beyond this size limit in bytes the agent rotates the local audit
      log file if rotation is enabled.</p><p>Property: <code class="literal">com.sun.identity.agents.config.local.log.size</code></p><p>Default: 50 MB</p></dd></dl></div><div class="variablelist"><a name="j2ee-agent-fqdn-properties"></a><div class="variablelist-title">Fully Qualified Domain Name Checking properties</div><dl class="variablelist"><dt><span class="term">FQDN Check</span></dt><dd><p>Enables checking of FQDN default value and FQDN map values.</p><p>Property: <code class="literal">com.sun.identity.agents.config.fqdn.check.enable</code></p></dd><dt><span class="term">FQDN Default</span></dt><dd><p>Fully qualified domain name that the users should use in order to
      access resources.</p><p>This property ensures that when users access protected resources
      on the web server without specifying the FQDN, the agent can redirect
      the users to URLs containing the correct FQDN.</p><p>Property: <code class="literal">com.sun.identity.agents.config.fqdn.default</code></p></dd><dt><span class="term">FQDN Virtual Host Map</span></dt><dd><p>Enables virtual hosts, partial hostname and IP address to access
      protected resources. Maps invalid or virtual name keys to valid FQDN
      values so the agent can properly redirect users and the agents receive
      cookies belonging to the domain.</p><p>To map <code class="literal">myserver</code> to
      <code class="literal">myserver.mydomain.example</code>, enter
      <code class="literal">myserver</code> in the Map Key field, and enter
      <code class="literal">myserver.mydomain.example</code> in the Corresponding Map Value
      field. This corresponds to
      <code class="literal">com.sun.identity.agents.config.fqdn.mapping[myserver]= myserver.mydomain.example</code>.</p><p>Property: <code class="literal">com.sun.identity.agents.config.fqdn.mapping</code></p></dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="configure-j2ee-pa-application-props"></a>5.6.2.&nbsp;Configuring Java EE policy agent Application Properties</h3></div></div></div><p>This section covers application J2EE agent properties. After creating
   the agent profile, you access these properties in the OpenAM console under
   Access Control &gt; <em class="replaceable"><code>Realm Name</code></em> &gt; Agents &gt;
   J2EE &gt; <em class="replaceable"><code>Agent Name</code></em> &gt; Application.</p><div class="variablelist"><a name="j2ee-agent-login-processing-properties"></a><div class="variablelist-title">Login Processing properties</div><dl class="variablelist"><dt><span class="term">Login Form URI</span></dt><dd><p>Specifies the list of absolute URIs corresponding to a protected
      application's <code class="filename">web.xml</code>
      <code class="literal">form-login-page</code> element, such as
      <code class="literal">/myApp/jsp/login.jsp</code>.</p><p>Property: <code class="literal">com.sun.identity.agents.config.login.form</code></p></dd><dt><span class="term">Login Error URI</span></dt><dd><p>Specifies the list of absolute URIs corresponding to a protected
      application's <code class="filename">web.xml</code>
      <code class="literal">form-error-page</code> element, such as
      <code class="literal">/myApp/jsp/error.jsp</code>.</p><p>Property: <code class="literal">com.sun.identity.agents.config.login.error.uri</code></p></dd><dt><span class="term">Use Internal Login</span></dt><dd><p>When enabled, the agent uses the internal default content file
      for the login.</p><p>Property: <code class="literal">com.sun.identity.agents.config.login.use.internal</code></p></dd><dt><span class="term">Login Content File Name</span></dt><dd><p>Full path name to the file containing custom login content when
      Use Internal Login is enabled.</p><p>Property: <code class="literal">com.sun.identity.agents.config.login.content.file</code></p></dd></dl></div><div class="variablelist"><a name="j2ee-agent-logout-processing-properties"></a><div class="variablelist-title">Logout Processing properties</div><dl class="variablelist"><dt><span class="term">Application Logout Handler</span></dt><dd><p>Specifies how logout handlers map to specific applications. The key
      is the web application name. The value is the logout handler class.</p><p>To set a global logout handler for applications without other
      logout handlers defined, leave the key empty and set the value to the
      global logout handler class name,
      <code class="literal">GlobalApplicationLogoutHandler</code>.</p><p>To set a logout handler for a specific application, set the key
      to the name of the application, and the value to the logout handler class
      name.</p><p>Property: <code class="literal">com.sun.identity.agents.config.logout.application.handler</code></p></dd><dt><span class="term">Application Logout URI</span></dt><dd><p>Specifies request URIs that indicate logout events. The key is the
      web application name. The value is the application logout URI.</p><p>To set a global logout URI for applications without other logout
      URIs defined, leave the key empty and set the value to the global logout
      URI, <code class="literal">/logout.jsp</code>.</p><p>To set a logout URI for a specific application, set the key to the
      name of the application, and the value to the application logout
      page.</p><p>Property: <code class="literal">com.sun.identity.agents.config.logout.uri</code></p></dd><dt><span class="term">Logout Request Parameter</span></dt><dd><p>Specifies parameters in the HTTP request that indicate logout
      events. The key is the web application name. The value is the logout
      request parameter.</p><p>To set a global logout request parameter for applications without
      other logout request parameters defined, leave the key empty and set the
      value to the global logout request parameter,
      <code class="literal">logoutparam</code>.</p><p>To set a logout request parameter for a specific application, set
      the key to the name of the application, and the value to the application
      logout request parameter, such as <code class="literal">logoutparam</code>.</p><p>Property: <code class="literal">com.sun.identity.agents.config.logout.request.param</code></p></dd><dt><span class="term">Logout Introspect Enabled</span></dt><dd><p>When enabled, the agent checks the HTTP request body to locate the
      Logout Request Parameter you set.</p><p>Property: <code class="literal">com.sun.identity.agents.config.logout.introspect.enabled</code></p></dd><dt><span class="term">Logout Entry URI</span></dt><dd><p>Specifies the URIs to return after successful logout and subsequent
      authentication. The key is the web application name. The value is the
      URI to return.</p><p>To set a global logout entry URI for applications without other
      logout entry URIs defined, leave the key empty and set the value to the
      global logout entry URI, <code class="literal">/welcome.html</code>.</p><p>To set a logout entry URI for a specific application, set the key
      to the name of the application, and the value to the application
      logout entry URI, such as <code class="literal">/myApp/welcome.html</code>.</p><p>Property: <code class="literal">com.sun.identity.agents.config.logout.entry.uri</code></p></dd></dl></div><div class="variablelist"><a name="j2ee-agent-access-denied-uri-processing-properties"></a><div class="variablelist-title">Access Denied URI Processing properties</div><dl class="variablelist"><dt><span class="term">Resource Access Denied URI</span></dt><dd><p>Specifies the URIs of custom pages to return when access is denied.
      The key is the web application name. The value is the custom URI.</p><p>To set a global custom access denied URI for applications without
      other custom access denied URIs defined, leave the key empty and set the
      value to the global custom access denied URI,
      <code class="literal">/sample/accessdenied.html</code>.</p><p>To set a custom access denied URI for a specific application, set
      the key to the name of the application, and the value to the application
      access denied URI, such as <code class="literal">/myApp/accessdenied.html</code>.</p><p>Property: <code class="literal">com.sun.identity.agents.config.access.denied.uri</code></p></dd></dl></div><div class="variablelist"><a name="j2ee-agent-not-enforced-uri-properties"></a><div class="variablelist-title">Not Enforced URI Processing properties</div><dl class="variablelist"><dt><span class="term">Not Enforced URIs</span></dt><dd><p>List of URIs for which no authentication is required, and the agent
      does not protect access. You can use wildcards to define a pattern for a
      URI.</p><p>The <code class="literal">*</code> wildcard matches all characters except
      question mark (<code class="literal">?</code>), cannot be escaped, and spans
      multiple levels in a URI. Multiple forward slashes do not match a
      single forward slash, so <code class="literal">*</code> matches
      <code class="literal">mult/iple/dirs</code>, yet <code class="literal">mult/*/dirs</code>
      does not match <code class="literal">mult/dirs</code>.</p><p>The <code class="literal">-*-</code> wildcard matches all characters except
      forward slash (<code class="literal">/</code>) or question mark
      (<code class="literal">?</code>), and cannot be escaped. As it does not match
      <code class="literal">/</code>, <code class="literal">-*-</code> does not span multiple
      levels in a URI.</p><p>OpenAM does not let you mix <code class="literal">*</code> and
      <code class="literal">-*-</code> in the same URI.</p><p>Examples include <code class="literal">/logout.html</code>,
      <code class="literal">/images/*</code>, <code class="literal">/css/-*-</code>, and
      <code class="literal">/*.jsp?locale=*</code>.</p><p>Trailing forward slashes are not recognized as part of a resource
      name. Therefore <code class="literal">/images//</code> and
      <code class="literal">/images</code> are equivalent.</p><p>Property: <code class="literal">com.sun.identity.agents.config.notenforced.uri</code></p></dd><dt><span class="term">Invert Not Enforced URIs</span></dt><dd><p>Only enforce not enforced list of URIs. In other words, enforce
      policy only for those URIs and patterns specified in the list.</p><p>Property: <code class="literal">com.sun.identity.agents.config.notenforced.uri.invert</code></p></dd><dt><span class="term">Not Enforced URIs Cache Enabled</span></dt><dd><p>When enabled, the agent caches evaluation of the not enforced URI
      list.</p><p>Property: <code class="literal">com.sun.identity.agents.config.notenforced.uri.cache.enable</code></p></dd><dt><span class="term">Not Enforced URIs Cache Size</span></dt><dd><p>When caching is enabled, this limits the number of not enforced
      URIs cached.</p><p>Property: <code class="literal">com.sun.identity.agents.config.notenforced.uri.cache.size</code></p><p>Default: 1000</p></dd><dt><span class="term">Refresh Session Idle Time</span></dt><dd><p>When enabled, the agent reset the session idle time when granting
      access to a not enforced URI, prolonging the time before the user must
      authenticate again.</p><p>Property: <code class="literal">com.sun.identity.agents.config.notenforced.refresh.session.idletime</code></p></dd></dl></div><div class="variablelist"><a name="j2ee-agent-not-enforced-ip-properties"></a><div class="variablelist-title">Not Enforced IP Processing properties</div><dl class="variablelist"><dt><span class="term">Not Enforced Client IP List</span></dt><dd><p>No authentication and authorization are required for the requests
      coming from these client IP addresses.</p><p>Property: <code class="literal">com.sun.identity.agents.config.notenforced.ip</code></p><div class="note"><h3 class="title">Note</h3><p>
       Loopback addresses are not considered valid IPs on the Not Enforced IP list.
       If specified, the policy agent ignores the loopback address.
      </p></div></dd><dt><span class="term">Not Enforced IP Invert List</span></dt><dd><p>Only enforce the not enforced list of IP addresses. In other words,
      enforce policy only for those client addresses and patterns specified in
      the list.</p><p>Property: <code class="literal">com.sun.identity.agents.config.notenforced.ip.invert</code></p></dd><dt><span class="term">Not Enforced IP Cache Flag</span></dt><dd><p>When enabled, the agent caches evaluation of the not enforced IP
      list.</p><p>Property: <code class="literal">com.sun.identity.agents.config.notenforced.ip.cache.enable</code></p></dd><dt><span class="term">Not Enforced IP Cache Size</span></dt><dd><p>When caching is enabled, this limits the number of not enforced
      addresses cached.</p><p>Property: <code class="literal">com.sun.identity.agents.config.notenforced.ip.cache.size</code></p><p>Default: 1000</p></dd></dl></div><div class="variablelist"><a name="j2ee-agent-profile-attributes-processing-properties"></a><div class="variablelist-title">Profile Attributes Processing properties</div><dl class="variablelist"><dt><span class="term">Profile Attribute Fetch Mode</span></dt><dd><p>When set to <code class="literal">HTTP_COOKIE</code> or
      <code class="literal">HTTP_HEADER</code>, profile attributes are introduced into
      the cookie or the headers, respectively. When set to
      <code class="literal">REQUEST_ATTRIBUTE</code>, profile attributes are part
      of the HTTP request.</p><p>Property: <code class="literal">com.sun.identity.agents.config.profile.attribute.fetch.mode</code></p></dd><dt><span class="term">Profile Attribute Map</span></dt><dd><p>Maps the profile attributes to HTTP headers for the currently
      authenticated user. Map Keys are attribute names, and Map Values
      are HTTP header names. The user profile can be stored in LDAP or any
      other arbitrary data store.
     </p><p>To populate the value of profile attribute CN under
      <code class="literal">CUSTOM-Common-Name</code>: enter CN in the Map Key field,
      and enter <code class="literal">CUSTOM-Common-Name</code> in the Corresponding
      Map Value field. This corresponds to
      <code class="literal">com.sun.identity.agents.config.profile.attribute.mapping[cn]=CUSTOM-Common-Name</code>.</p><p>In most cases, in a destination application where an HTTP header
      name shows up as a request header, it is prefixed by
      <code class="literal">HTTP_</code>, lower case letters become upper case, and
      hyphens (<code class="literal">-</code>) become underscores (<code class="literal">_</code>).
      For example, <code class="literal">common-name</code> becomes
      <code class="literal">HTTP_COMMON_NAME</code>.</p><p>Property: <code class="literal">com.sun.identity.agents.config.profile.attribute.mapping</code></p></dd></dl></div><div class="variablelist"><a name="j2ee-agent-response-attributes-processing-properties"></a><div class="variablelist-title">Response Attributes Processing properties</div><dl class="variablelist"><dt><span class="term">Response Attribute Fetch Mode</span></dt><dd><p>When set to <code class="literal">HTTP_COOKIE</code> or
      <code class="literal">HTTP_HEADER</code>, response attributes are introduced into
      the cookie or the headers, respectively. When set to
      <code class="literal">REQUEST_ATTRIBUTE</code>, response attributes are part
      of the HTTP request.</p><p>Property: <code class="literal">com.sun.identity.agents.config.response.attribute.fetch.mode</code></p></dd><dt><span class="term">Response Attribute Map</span></dt><dd><p>Maps the policy response attributes to HTTP headers for the
      currently authenticated user. The response attribute is
      the attribute in the policy response to be fetched.</p><p>To populate the value of response attribute <code class="literal">uid</code>
      under <code class="literal">CUSTOM-User-Name</code>: enter <code class="literal">uid</code>
      in the Map Key field, and enter <code class="literal">CUSTOM-User-Name</code> in
      the Corresponding Map Value field. This corresponds to
      <code class="literal">com.sun.identity.agents.config.response.attribute.mapping[uid]=Custom-User-Name</code>.</p><p>In most cases, in a destination application where an HTTP header
      name shows up as a request header, it is prefixed by
      <code class="literal">HTTP_</code>, lower case letters become upper case, and
      hyphens (<code class="literal">-</code>) become underscores (<code class="literal">_</code>).
      For example, <code class="literal">response-attr-one</code> becomes
      <code class="literal">HTTP_RESPONSE_ATTR_ONE</code>.</p><p>Property: <code class="literal">com.sun.identity.agents.config.response.attribute.mapping</code></p></dd></dl></div><div class="variablelist"><a name="j2ee-agent-common-attributes-fetching-properties"></a><div class="variablelist-title">Common Attributes Fetching Processing properties</div><dl class="variablelist"><dt><span class="term">Cookie Separator Character</span></dt><dd><p>Specifies the separator for multiple values of the same attribute
      when it is set as a cookie. Default: <code class="literal">|</code> (also known as the vertical bar character).</p><p>Property: <code class="literal">com.sun.identity.agents.config.attribute.cookie.separator</code></p></dd><dt><span class="term">Fetch Attribute Date Format</span></dt><dd><p>Specifies the <code class="literal">java.text.SimpleDateFormat</code> of date
      attribute values used when an attribute is set in an HTTP header. Default:
      <code class="literal">EEE, d MMM yyyy hh:mm:ss z</code>.</p><p>Property: <code class="literal">com.sun.identity.agents.config.attribute.date.format</code></p></dd><dt><span class="term">Attribute Cookie Encode</span></dt><dd><p>When enabled, attribute values are URL encoded before being set as
      a cookie.</p><p>Property: <code class="literal">com.sun.identity.agents.config.attribute.cookie.encode</code></p></dd></dl></div><div class="variablelist"><a name="j2ee-agent-session-attributes-processing-properties"></a><div class="variablelist-title">Session Attributes Processing properties</div><dl class="variablelist"><dt><span class="term">Session Attribute Fetch Mode</span></dt><dd><p>When set to <code class="literal">HTTP_COOKIE</code> or
      <code class="literal">HTTP_HEADER</code>, session attributes are introduced into the
      cookie or the headers, respectively. When set to
      <code class="literal">REQUEST_ATTRIBUTE</code>, session attributes are part
      of the HTTP request.</p><p>Property: <code class="literal">com.sun.identity.agents.config.session.attribute.fetch.mode</code></p></dd><dt><span class="term">Session Attribute Map</span></dt><dd><p>Maps session attributes to HTTP headers for the currently
      authenticated user. The session attribute is the attribute in the session
      to be fetched.</p><p>To populate the value of session attribute
      <code class="literal">UserToken</code> under <code class="literal">CUSTOM-userid</code>:
      enter <code class="literal">UserToken</code> in the Map Key field, and enter
      <code class="literal">CUSTOM-userid</code> in
      the Corresponding Map Value field. This corresponds to
      <code class="literal">com.sun.identity.agents.config.session.attribute.mapping[UserToken]=CUSTOM-userid</code>.</p><p>In most cases, in a destination application where an HTTP header
      name shows up as a request header, it is prefixed by
      <code class="literal">HTTP_</code>, lower case letters become upper case, and
      hyphens (<code class="literal">-</code>) become underscores (<code class="literal">_</code>).
      For example, <code class="literal">success-url</code> becomes
      <code class="literal">HTTP_SUCCESS_URL</code>.</p><p>Property: <code class="literal">com.sun.identity.agents.config.session.attribute.mapping</code></p></dd></dl></div><div class="variablelist"><a name="j2ee-agent-privilege-attributes-properties"></a><div class="variablelist-title">Privilege Attributes Processing properties</div><p>Privileged attributes are sued when the agent is running in
    <code class="literal">ALL</code> or <code class="literal">J2EE_POLICY</code> filter mode.
    Privileged attributes contain the list of declarative Java EE roles that the
    user can have.
   </p><dl class="variablelist"><dt><span class="term">Default Privileged Attribute</span></dt><dd><p>Specifies that every authenticated user
      with a valid OpenAM session will have the
      <code class="literal">AUTHENTICATED_USERS</code> role.</p><p>Property: <code class="literal">com.sun.identity.agents.config.default.privileged.attribute</code></p></dd><dt><span class="term">Privileged Attribute Type</span></dt><dd><p>Specifies the group and role memberships that will be turned into roles for each
      user.</p><p>Property: <code class="literal">com.sun.identity.agents.config.privileged.attribute.type</code></p></dd><dt><span class="term">Privileged Attributes To Lower Case</span></dt><dd><p>Specifies how privileged attribute types should be converted to
      lower case.</p><p>Property: <code class="literal">com.sun.identity.agents.config.privileged.attribute.tolowercase</code></p></dd><dt><span class="term">Privileged Session Attribute</span></dt><dd><p>Specifies the list of session property names when an authenticated
      user's roles are store within a session property.
     </p><p>Property: <code class="literal">com.sun.identity.agents.config.privileged.session.attribute</code></p></dd><dt><span class="term">Enable Privileged Attribute Mapping</span></dt><dd><p>When enabled, lets you use Privileged Attribute Mapping.</p><p>Property: <code class="literal">com.sun.identity.agents.config.privileged.attribute.mapping.enable</code></p></dd><dt><span class="term">Privileged Attribute Mapping</span></dt><dd><p>OpenAM allows original attribute values to be mapped to other
      values. For example, you can map UUIDs to principal names in roles
      specified in a web application's deployment descriptor. For example, to
      map the UUID <code class="literal">id=employee,ou=group,o=openam</code> to the
      principal name <code class="literal">am_employee_role</code> in the deployment
      descriptor, set the key to
      <code class="literal">id=employee,ou=group,o=openam</code>, and the value to
      <code class="literal">am_employee_role</code>.</p><p>Property: <code class="literal">com.sun.identity.agents.config.privileged.attribute.mapping</code></p></dd></dl></div><div class="variablelist"><a name="j2ee-agent-custom-authentication-properties"></a><div class="variablelist-title">Custom Authentication Processing properties</div><dl class="variablelist"><dt><span class="term">Custom Authentication Handler</span></dt><dd><p>Specifies custom authentication handler classes for users
      authenticated with the application server. The key is the web application
      name and the value is the authentication handler class name.</p><p>Property: <code class="literal">com.sun.identity.agents.config.auth.handler</code></p></dd><dt><span class="term">Custom Logout Handler</span></dt><dd><p>Specifies custom logout handler classes to log users out of the
      application server. The key is the web application name and the value is
      the logout handler class name.</p><p>Property: <code class="literal">com.sun.identity.agents.config.logout.handler</code></p></dd><dt><span class="term">Custom Verification Handler</span></dt><dd><p>Specifies custom verification classes to validate user credentials
      with the local user repository. The key is the web application name and
      the value is the validation handler class name.</p><p>Property: <code class="literal">com.sun.identity.agents.config.verification.handler</code></p></dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="configure-j2ee-pa-sso-props"></a>5.6.3.&nbsp;Configuring Java EE policy agent SSO Properties</h3></div></div></div><p>This section covers SSO J2EE agent properties. After creating the
   agent profile, you access these properties in the OpenAM console under
   Access Control &gt; <em class="replaceable"><code>Realm Name</code></em> &gt; Agents &gt;
   J2EE &gt; <em class="replaceable"><code>Agent Name</code></em> &gt; SSO</p><div class="variablelist"><a name="j2ee-agent-cookie-properties"></a><div class="variablelist-title">Cookie properties</div><dl class="variablelist"><dt><span class="term">Cookie Name</span></dt><dd><p>Name of the SSO Token cookie used between the OpenAM server and
      the agent. Default: <code class="literal">iPlanetDirectoryPro</code>.</p><p>Property: <code class="literal">com.iplanet.am.cookie.name</code></p><p>Hot swap: no</p></dd></dl></div><div class="variablelist"><a name="j2ee-agent-caching-properties"></a><div class="variablelist-title">Caching properties</div><dl class="variablelist"><dt><span class="term">SSO Cache Enable</span></dt><dd><p>When enabled, the agent exposes SSO Cache through the agent SDK
      APIs.</p><p>Property: <code class="literal">com.sun.identity.agents.config.amsso.cache.enable</code></p></dd></dl></div><div class="variablelist"><a name="j2ee-agent-cdsso-properties"></a><div class="variablelist-title">Cross Domain SSO properties</div><dl class="variablelist"><dt><span class="term">Cross Domain SSO</span></dt><dd><p>Enables Cross Domain Single Sign On.</p><p>Property: <code class="literal">com.sun.identity.agents.config.cdsso.enable</code></p></dd><dt><span class="term">CDSSO Redirect URI</span></dt><dd><p>Specifies a URI the agent uses to process CDSSO requests.</p><p>Property: <code class="literal">com.sun.identity.agents.config.cdsso.redirect.uri</code></p></dd><dt><span class="term">CDSSO Servlet URL</span></dt><dd><p>List of URLs of the available CDSSO controllers that the agent can
      use for CDSSO processing. For example,
      <code class="literal">http://openam.example.com:8080/openam/cdcservlet</code>.</p><p>Property: <code class="literal">com.sun.identity.agents.config.cdsso.cdcservlet.url</code></p></dd><dt><span class="term">CDSSO Clock Skew</span></dt><dd><p>When set to a value other than zero, specifies the clock skew in
      seconds that the agent accepts when determining the validity of the CDSSO
      authentication response assertion.</p><p>Property: <code class="literal">com.sun.identity.agents.config.cdsso.clock.skew</code></p></dd><dt><span class="term">CDSSO Trusted ID Provider</span></dt><dd><p>Specifies the list of OpenAM servers or identity providers the
      agent trusts when evaluating CDC Liberty Responses.</p><p>Property: <code class="literal">com.sun.identity.agents.config.cdsso.trusted.id.provider</code></p></dd><dt><span class="term">CDSSO Secure Enable</span></dt><dd><p>When enabled, the agent marks the SSO Token cookie as secure, thus
      the cookie is only transmitted over secure connections.</p><p>Property: <code class="literal">com.sun.identity.agents.config.cdsso.secure.enable</code></p></dd><dt><span class="term">CDSSO Domain List</span></dt><dd><p>List of domains, such as <code class="literal">.example.com</code>, in which
      cookies have to be set in CDSSO.</p><p>Property: <code class="literal">com.sun.identity.agents.config.cdsso.domain</code></p></dd></dl></div><div class="variablelist"><a name="j2ee-agent-cookie-reset-properties"></a><div class="variablelist-title">Cookie Reset properties</div><dl class="variablelist"><dt><span class="term">Cookie Reset</span></dt><dd><p>When enabled, agent resets cookies in the response before
      redirecting to authentication.</p><p>Property: <code class="literal">com.sun.identity.agents.config.cookie.reset.enable</code></p></dd><dt><span class="term">Cookie Reset Name List</span></dt><dd><p>List of cookies to reset if Cookie Reset is enabled.</p><p>Property: <code class="literal">com.sun.identity.agents.config.cookie.reset.name</code></p></dd><dt><span class="term">Cookie Reset Domain Map</span></dt><dd><p>Specifies how names from the Cookie Reset Name List correspond to
      cookie domain values when the cookie is reset.</p><p>Property: <code class="literal">com.sun.identity.agents.config.cookie.reset.domain</code></p></dd><dt><span class="term">Cookie Reset Path Map</span></dt><dd><p>Specifies how names from the Cookie Reset Name List correspond to
      cookie paths when the cookie is reset.</p><p>Property: <code class="literal">com.sun.identity.agents.config.cookie.reset.path</code></p></dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="configure-j2ee-pa-services-props"></a>5.6.4.&nbsp;Configuring Java EE policy agent OpenAM Services Properties</h3></div></div></div><p>This section covers OpenAM services J2EE agent properties. After
   creating the agent profile, you access these properties in the OpenAM console
   under Access Control &gt; <em class="replaceable"><code>Realm Name</code></em> &gt;
   Agents &gt; J2EE &gt; <em class="replaceable"><code>Agent Name</code></em> &gt; OpenAM
   Services.</p><div class="variablelist"><a name="j2ee-agent-login-url-properties"></a><div class="variablelist-title">Login URL properties</div><dl class="variablelist"><dt><span class="term">OpenAM Login URL</span></dt><dd><p>OpenAM login page URL, such as
      <code class="literal">http://openam.example.com:8080/openam/UI/Login</code>, to
      which the agent redirects incoming users without sufficient credentials
      so that they can authenticate.
      If CDSSO is enabled, this property is not used, instead the CDCServlet URL
      will be used.
     </p><p>Property: <code class="literal">com.sun.identity.agents.config.login.url</code></p></dd><dt><span class="term">OpenAM Conditional Login URL (Not yet in OpenAM console)</span></dt><dd><p>
  To conditionally redirect users based on the incoming request URL,
  set this property.
 </p><p>
  This takes the incoming request domain to match,
  a vertical bar ( <code class="literal">|</code> ),
  and then a comma-separated list of URLs to which to redirect incoming users.
 </p><p>
  If the domain before the vertical bar matches an incoming request URL,
  then the policy agent uses the list of URLs
  to determine how to redirect the user-agent.

  If the global property FQDN Check
  (<code class="literal">com.sun.identity.agents.config.fqdn.check.enable</code>)
  is enabled for the policy agent,
  then the policy agent iterates through the list
  until it finds an appropriate redirect URL that matches the FQDN check.

  Otherwise, the policy agent redirects the user-agent
  to the first URL in the list.
 </p><p>
  Property: <code class="literal">com.sun.identity.agents.config.conditional.login.url</code>
 </p><p>
  Examples:

  <code class="literal">com.sun.identity.agents.config.conditional.login.url[0]=
  login.example.com|http://openam1.example.com/openam/UI/Login,
  http://openam2.example.com/openam/UI/Login</code>,

  <code class="literal">com.sun.identity.agents.config.conditional.login.url[1]=
  signin.example.com|http://openam3.example.com/openam/UI/Login,
  http://openam4.example.com/openam/UI/Login</code>
 </p><p>
  If CDSSO is enabled for the policy agent,
  then this property takes CDSSO Servlet URLs for its values
  (<code class="literal">com.sun.identity.agents.config.cdsso.cdcservlet.url</code>),
  rather than OpenAM login URLs.
 </p><p>
  CDSSO examples:

  <code class="literal">com.sun.identity.agents.config.conditional.login.url[0]=
  login.example.com|http://openam1.example.com/openam/cdcservlet,
  http://openam2.example.com/openam/cdcservlet</code>,

  <code class="literal">com.sun.identity.agents.config.conditional.login.url[1]=
  signin.example.com|http://openam3.example.com/openam/cdcservlet,
  http://openam4.example.com/openam/cdcservlet</code>
 </p></dd><dt><span class="term">Login URL Prioritized</span></dt><dd><p>When enabled, OpenAM uses the priority defined in the OpenAM Login
      URL list as the priority for Login and CDSSO URLs when handling
      failover.</p><p>Property: <code class="literal">com.sun.identity.agents.config.login.url.prioritized</code></p></dd><dt><span class="term">Login URL Probe</span></dt><dd><p>When enabled, OpenAM checks the availability of OpenAM Login URLs
      before redirecting to them.</p><p>Property: <code class="literal">com.sun.identity.agents.config.login.url.probe.enabled</code></p></dd><dt><span class="term">Login URL Probe Timeout</span></dt><dd><p>Timeout period in milliseconds for OpenAM to determine whether
      to failover between Login URLs when Login URL Probe is enabled.</p><p>Property: <code class="literal">com.sun.identity.agents.config.login.url.probe.timeout</code></p><p>Default: 2000</p></dd></dl></div><div class="variablelist"><a name="j2ee-agent-logout-url-properties"></a><div class="variablelist-title">Logout URL properties</div><dl class="variablelist"><dt><span class="term">OpenAM Logout URL</span></dt><dd><p>OpenAM logout page URLs, such as
      <code class="literal">http://openam.example.com:8080/openam/UI/Logout</code>. The
      user is logged out of the OpenAM session when accessing these URLs.</p><p>Property: <code class="literal">com.sun.identity.agents.config.logout.url</code></p></dd><dt><span class="term">OpenAM Conditional Logout URL (Not yet in OpenAM console)</span></dt><dd><p>The values take the incoming request URL to match and a
      comma-separated list of URLs to which to redirect users logging
      out.</p><p>Property: <code class="literal">com.sun.identity.agents.config.conditional.logout.url</code></p><p>Example: <code class="literal">com.sun.identity.agents.config.conditional.logout.url[0]=
      logout.example.com|http://openam1.example.com/openam/UI/Logout,
      http://openam2.example.com/openam/UI/Logout</code></p></dd><dt><span class="term">Logout URL Prioritized</span></dt><dd><p>When enabled, OpenAM uses the priority defined in the OpenAM Logout
      URL list as the priority for Logout URLs when handling failover.</p><p>Property: <code class="literal">com.sun.identity.agents.config.logout.url.prioritized</code></p></dd><dt><span class="term">Logout URL Probe</span></dt><dd><p>When enabled, OpenAM checks the availability of OpenAM Logout URLs
      before redirecting to them.</p><p>Property: <code class="literal">com.sun.identity.agents.config.logout.url.probe.enabled</code></p></dd><dt><span class="term">Logout URL Probe Timeout</span></dt><dd><p>Timeout period in milliseconds for OpenAM to determine whether
      to failover between Logout URLs when Logout URL Probe is enabled.</p><p>Property: <code class="literal">com.sun.identity.agents.config.logout.url.probe.timeout</code></p><p>Default: 2000</p></dd></dl></div><div class="variablelist"><a name="j2ee-agent-agent-authn-service-properties"></a><div class="variablelist-title">Authentication Service properties</div><dl class="variablelist"><dt><span class="term">OpenAM Authentication Service Protocol</span></dt><dd><p>Specifies the protocol used by the OpenAM authentication
      service.</p><p>Property: <code class="literal">com.iplanet.am.server.protocol</code></p><p>Hot swap: no</p></dd><dt><span class="term">OpenAM Authentication Service Host Name</span></dt><dd><p>Specifies the OpenAM authentication service host name.</p><p>Property: <code class="literal">com.iplanet.am.server.host</code></p><p>Hot swap: no</p></dd><dt><span class="term">OpenAM Authentication Service Port</span></dt><dd><p>Specifies the OpenAM authentication service port number.</p><p>Property: <code class="literal">com.iplanet.am.server.port</code></p><p>Hot swap: no</p></dd></dl></div><div class="variablelist"><a name="j2ee-agent-policy-client-service-properties"></a><div class="variablelist-title">Policy Client Service properties</div><dl class="variablelist"><dt><span class="term">Realm</span></dt><dd><p>
      Realm where OpenAM starts policy evaluation for this policy agent.
     </p><p>
      Default: / (top level realm)
     </p><p>
      Edit this property when OpenAM should start policy evaluation
      in a realm other than the top level realm, <code class="literal">/</code>,
      when handling policy decision requests from this policy agent.
     </p><p>
      This property is recognized by OpenAM, not the policy agent.
     </p><p>
      Property: <code class="literal">org.forgerock.openam.agents.config.policy.evaluation.realm</code>
     </p><p>
      Hot swap: yes
     </p></dd><dt><span class="term">Application</span></dt><dd><p>
      Application where OpenAM looks for policies to evaluate
      for this policy agent.
     </p><p>
      Default: <code class="literal">iPlanetAMWebAgentService</code>
     </p><p>
      Edit this property when OpenAM should look for policies
      that belong to an application other than
      <code class="literal">iPlanetAMWebAgentService</code>
      when handling policy decision requests from this policy agent.
     </p><p>
      This property is recognized by OpenAM, not the policy agent.
     </p><p>
      Property: <code class="literal">org.forgerock.openam.agents.config.policy.evaluation.application</code>
     </p><p>
      Hot swap: yes
     </p></dd><dt><span class="term">Enable Policy Notifications</span></dt><dd><p>When enabled, OpenAM sends notification about changes to policy.</p><p>Property: <code class="literal">com.sun.identity.agents.notification.enabled</code></p><p>Hot swap: no</p></dd><dt><span class="term">Policy Client Polling Interval</span></dt><dd><p>Specifies the time in minutes after which the policy cache is
      refreshed.</p><p>Property: <code class="literal">com.sun.identity.agents.polling.interval</code></p><p>Default: 3</p><p>Hot swap: no</p></dd><dt><span class="term">Policy Client Cache Mode</span></dt><dd><p>Set to cache mode subtree when only a small number of policy rules
      are defined. For large numbers of policy rules, set to self.</p><p>Property: <code class="literal">com.sun.identity.policy.client.cacheMode</code></p><p>Default: self</p><p>Hot swap: no</p></dd><dt><span class="term">Policy Client Boolean Action Values</span></dt><dd><p>Specifies the values, such as <code class="literal">allow</code> and
      <code class="literal">deny</code>, that are associated with boolean policy
      decisions. The string is presented below in multiple lines for readability
      purposes.
     </p><p>Default: <code class="literal">iPlanetAMWebAgentService|GET|allow|deny:
      iPlanetAMWebAgentService|POST|allow|deny:
      iPlanetAMWebAgentService|PUT|allow|deny:
      iPlanetAMWebAgentService|DELETE|allow|deny:
      iPlanetAMWebAgentService|HEAD|allow|deny:
      iPlanetAMWebAgentService|OPTIONS|allow|deny:
      iPlanetAMWebAgentService|PATCH|allow|deny</code></p><p>Property: <code class="literal">com.sun.identity.policy.client.booleanActionValues</code></p><p>Hot swap: no</p></dd><dt><span class="term">Policy Client Resource Comparators</span></dt><dd><p>Specifies the comparators used for service names in policy.</p><p>Default: <code class="literal">serviceType=iPlanetAMWebAgentService|
      class=com.sun.identity.policy.plugins.HttpURLResourceName|wildcard=*|
      delimiter=/|caseSensitive=false</code></p><p>Property: <code class="literal">com.sun.identity.policy.client.resourceComparators</code></p><p>Hot swap: no</p></dd><dt><span class="term">Policy Client Clock Skew</span></dt><dd><p>Time in seconds used to adjust time difference between agent system
      and OpenAM. Clock skew in seconds = AgentTime - OpenAMServerTime.</p><p>Default: 10.</p><p>Property: <code class="literal">com.sun.identity.policy.client.clockSkew</code></p><p>Hot swap: no</p></dd><dt><span class="term">URL Policy Env GET Parameters</span></dt><dd><p>Specifies the list of HTTP GET request parameters whose names and
      values the agents sets in the environment map for URL policy evaluation
      by the OpenAM server.</p><p>Property: <code class="literal">com.sun.identity.agents.config.policy.env.get.param</code></p></dd><dt><span class="term">URL Policy Env POST Parameters</span></dt><dd><p>Specifies the list of HTTP POST request parameters whose names and
      values the agents sets in the environment map for URL policy evaluation
      by the OpenAM server.</p><p>Property: <code class="literal">com.sun.identity.agents.config.policy.env.post.param</code></p></dd><dt><span class="term">URL Policy Env jsession Parameters</span></dt><dd><p>Specifies the list of HTTP session attributes whose names and
      values the agents sets in the environment map for URL policy evaluation
      by the OpenAM server.</p><p>Property: <code class="literal">com.sun.identity.agents.config.policy.env.jsession.param</code></p></dd><dt><span class="term">Use HTTP-Redirect for composite advice</span></dt><dd><p>When enabled, the remote policy client is configured to use
      HTTP-Redirect instead of HTTP-POST for composite advice.</p><p>Property: <code class="literal">com.sun.identity.agents.config.policy.advice.use.redirect</code></p></dd></dl></div><div class="variablelist"><a name="j2ee-agent-user-data-cache-service-properties"></a><div class="variablelist-title">User Data Cache Service properties</div><dl class="variablelist"><dt><span class="term">Enable Notification of User Data Caches</span></dt><dd><p>When enabled, receive notification from OpenAM to update user
      management data caches.</p><p>Property: <code class="literal">com.sun.identity.idm.remote.notification.enabled</code></p><p>Hot swap: no</p></dd><dt><span class="term">User Data Cache Polling Time</span></dt><dd><p>If notifications are not enabled and set to a value other than zero,
      specifies the time in minutes after which the agent polls to update
      cached user management data.</p><p>Property: <code class="literal">com.iplanet.am.sdk.remote.pollingTime</code></p><p>Default: 1</p><p>Hot swap: no</p></dd><dt><span class="term">Enable Notification of Service Data Caches</span></dt><dd><p>When enabled, receive notification from OpenAM to update service
      configuration data caches.</p><p>Property: <code class="literal">com.sun.identity.sm.notification.enabled</code></p><p>Hot swap: no</p></dd><dt><span class="term">Service Data Cache Time</span></dt><dd><p>If notifications are not enabled and set to a value other than zero,
      specifies the time in minutes after which the agent polls to update
      cached service configuration data.</p><p>Property: <code class="literal">com.sun.identity.sm.cacheTime</code></p><p>Default: 1</p><p>Hot swap: no</p></dd></dl></div><div class="variablelist"><a name="j2ee-agent-session-client-service-properties"></a><div class="variablelist-title">Session Client Service properties</div><dl class="variablelist"><dt><span class="term">Enable Client Polling</span></dt><dd><p>When enabled, the session client polls to update the session cache
      rather than relying on notifications from OpenAM.</p><p>Property: <code class="literal">com.iplanet.am.session.client.polling.enable</code></p><p>Hot swap: no</p></dd><dt><span class="term">Client Polling Period</span></dt><dd><p>Specifies the time in seconds after which the session client
      requests an update from OpenAM for cached session information.</p><p>Property: <code class="literal">com.iplanet.am.session.client.polling.period</code></p><p>Default: 180</p><p>Hot swap: no</p></dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="configure-j2ee-pa-misc-props"></a>5.6.5.&nbsp;Configuring Java EE policy agent Miscellaneous Properties</h3></div></div></div><p>This section covers miscellaneous J2EE agent properties. After creating
   the agent profile, you access these properties in the OpenAM console under
   Access Control &gt; <em class="replaceable"><code>Realm Name</code></em> &gt; Agents &gt;
   J2EE &gt; <em class="replaceable"><code>Agent Name</code></em> &gt; Miscellaneous.</p><div class="variablelist"><a name="j2ee-agent-locale-properties"></a><div class="variablelist-title">Locale properties</div><dl class="variablelist"><dt><span class="term">Locale Language</span></dt><dd><p>The default language for the agent.</p><p>Property: <code class="literal">com.sun.identity.agents.config.locale.language</code></p><p>Hot swap: no</p></dd><dt><span class="term">Locale Country</span></dt><dd><p>The default country for the agent.</p><p>Property: <code class="literal">com.sun.identity.agents.config.locale.country</code></p><p>Hot swap: no</p></dd></dl></div><div class="variablelist"><a name="j2ee-agent-port-check-properties"></a><div class="variablelist-title">Port Check Processing properties</div><dl class="variablelist"><dt><span class="term">Port Check Enable</span></dt><dd><p>When enabled, activate port checking, correcting requests on the
      wrong port.</p><p>Property: <code class="literal">com.sun.identity.agents.config.port.check.enable</code></p></dd><dt><span class="term">Port Check File</span></dt><dd><p>Specifies the name of the file containing the content to handle
      requests on the wrong port when port checking is enabled.</p><p>Property: <code class="literal">com.sun.identity.agents.config.port.check.file</code></p></dd><dt><span class="term">Port Check Setting</span></dt><dd><p>Specifies which ports correspond to which protocols. The agent uses
      the map when handling requests with invalid port numbers during port
      checking.</p><p>Property: <code class="literal">com.sun.identity.agents.config.port.check.setting</code></p></dd></dl></div><div class="variablelist"><a name="j2ee-agent-bypass-principal-list-properties"></a><div class="variablelist-title">Bypass Principal List properties</div><dl class="variablelist"><dt><span class="term">Bypass Principal List</span></dt><dd><p>Specifies a list of principals the agent bypasses for
      authentication and search purposes, such as <code class="literal">guest</code>
      or <code class="literal">testuser</code>.</p><p>Property: <code class="literal">com.sun.identity.agents.config.bypass.principal</code></p></dd></dl></div><div class="variablelist"><a name="j2ee-agent-password-encryptor-properties"></a><div class="variablelist-title">Agent Password Encryptor properties</div><dl class="variablelist"><dt><span class="term">Encryption Provider</span></dt><dd><p>Specifies the agent's encryption provider class.</p><p>Default: <code class="literal">com.iplanet.services.util.JCEEncryption</code></p><p>Property: <code class="literal">com.iplanet.security.encryptor</code></p><p>Hot swap: no</p></dd></dl></div><div class="variablelist"><a name="j2ee-agent-ignore-path-info-properties"></a><div class="variablelist-title">Ignore Path Info properties</div><dl class="variablelist"><dt><span class="term">Ignore Path Info in Request URL</span></dt><dd><p>When enabled, strip path info from the request URL while doing the
      Not Enforced List check, and URL policy evaluation. This is designed
      to prevent a user from accessing a URI by appending the matching pattern
      in the policy or not enforced list.</p><p>For example, if the not enforced list includes
      <code class="literal">/*.gif</code>, then stripping path info from the request URL
      prevents access to <code class="literal">http://host/index.html</code> by using
      <code class="literal">http://host/index.html?hack.gif</code>.</p><p>Property: <code class="literal">com.sun.identity.agents.config.ignore.path.info</code></p></dd></dl></div><div class="variablelist"><a name="j2ee-agent-deprecated-properties"></a><div class="variablelist-title">Deprecated Client Browser User Agent Properties</div><dl class="variablelist"><dt><span class="term">Goto Parameter Name</span></dt><dd><p>Property used only when CDSSO is enabled. Only change the default
      value, <code class="literal">goto</code> when the login URL has a landing page
      specified such as,
      <code class="literal">com.sun.identity.agents.config.cdsso.cdcservlet.url
       = http://openam.example.com:8080/openam/cdcservlet?goto=
       http://www.example.com/landing.jsp</code>.
      The agent uses this parameter to append the original request URL
      to this cdcservlet URL. The landing page consumes this parameter to
      redirect to the original URL.</p><p>As an example, if you set this value to <code class="literal">goto2</code>,
      then the complete URL sent for authentication is
      <code class="literal">http://openam.example.com:8080/openam/cdcservlet?goto=
       http://www.example.com/landing.jsp?goto2=http://www.example.com/original.jsp</code>.</p><p>Property: <code class="literal">com.sun.identity.agents.config.redirect.param</code></p></dd><dt><span class="term">Legacy User Agent Support Enable</span></dt><dd><p>When enabled, provide support for legacy browsers.</p><p>Property: <code class="literal">com.sun.identity.agents.config.legacy.support.enable</code></p></dd><dt><span class="term">Legacy User Agent List</span></dt><dd><p>List of header values that identify legacy browsers. Entries can
      use the wildcard character, <code class="literal">*</code>.</p><p>Property: <code class="literal">com.sun.identity.agents.config.legacy.user.agent</code></p></dd><dt><span class="term">Legacy User Agent Redirect URI</span></dt><dd><p>Specifies a URI the agent uses to redirect legacy user agent
      requests.</p><p>Property: <code class="literal">com.sun.identity.agents.config.legacy.redirect.uri</code></p></dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="configure-j2ee-pa-advanced-props"></a>5.6.6.&nbsp;Configuring Java EE policy agent Advanced Properties</h3></div></div></div><p>This section covers advanced J2EE agent properties. After creating the
   agent profile, you access these properties in the OpenAM console under
   Access Control &gt; <em class="replaceable"><code>Realm Name</code></em> &gt; Agents &gt;
   J2EE &gt; <em class="replaceable"><code>Agent Name</code></em> &gt; Advanced.</p><div class="variablelist"><a name="j2ee-agent-client-identification-properties"></a><div class="variablelist-title">Client Identification properties</div><p>If the agent is behind a proxy or load balancer, then the agent can
    get client IP and host name values from the proxy or load balancer. For
    proxies and load balancer that support providing the client IP and host
    name in HTTP headers, you can use the following properties.</p><p>When multiple proxies or load balancers sit in the request path,
    the header values can include a comma-separated list of values with the
    first value representing the client, as in
    <code class="literal">client,next-proxy,first-proxy</code>.</p><dl class="variablelist"><dt><span class="term">Client IP Address Header</span></dt><dd><p>HTTP header name that holds the IP address of the client.</p><p>Property: <code class="literal">com.sun.identity.agents.config.client.ip.header</code></p></dd><dt><span class="term">Client Hostname Header</span></dt><dd><p>HTTP header name that holds the hostname of the client.</p><p>Property: <code class="literal">com.sun.identity.agents.config.client.hostname.header</code></p></dd></dl></div><div class="variablelist"><a name="j2ee-agent-web-service-processing-properties"></a><div class="variablelist-title">Web Service Processing properties</div><dl class="variablelist"><dt><span class="term">Web Service Enable</span></dt><dd><p>Enable web service processing.</p><p>Property: <code class="literal">com.sun.identity.agents.config.webservice.enable</code></p></dd><dt><span class="term">Web Service End Points</span></dt><dd><p>Specifies a list of web application end points that represent web
      services.</p><p>Property: <code class="literal">com.sun.identity.agents.config.webservice.endpoint</code></p></dd><dt><span class="term">Web Service Process GET Enable</span></dt><dd><p>When enabled, the agent processes HTTP GET requests for web service
      endpoints.</p><p>Property: <code class="literal">com.sun.identity.agents.config.webservice.process.get.enable</code></p></dd><dt><span class="term">Web Service Authenticator</span></dt><dd><p>Specifies a class implementing
      <code class="literal">com.sun.identity.agents.filter.IWebServiceAuthenticator</code>,
      used to authenticate web service requests.</p><p>Property: <code class="literal">com.sun.identity.agents.config.webservice.authenticator</code></p></dd><dt><span class="term">Web Service Response Processor</span></dt><dd><p>Specifies a class implementing
      <code class="literal">com.sun.identity.agents.filter.IWebServiceResponseProcessor</code>,
      used to process web service responses.</p><p>Property: <code class="literal">com.sun.identity.agents.config.webservice.responseprocessor</code></p></dd><dt><span class="term">Web Service Internal Error Content File</span></dt><dd><p>Specifies a file the agent uses to generate an internal error fault
      for the client application.</p><p>Property: <code class="literal">com.sun.identity.agents.config.webservice.internalerror.content</code></p></dd><dt><span class="term">Web Service Authorization Error Content File</span></dt><dd><p>Specifies a file the agent uses to generate an authorization error
      fault for the client application.</p><p>Property: <code class="literal">com.sun.identity.agents.config.webservice.autherror.content</code></p></dd></dl></div><div class="variablelist"><a name="j2ee-agent-alternate-url-properties"></a><div class="variablelist-title">Alternate Agent URL properties</div><dl class="variablelist"><dt><span class="term">Alternative Agent Host Name</span></dt><dd><p>Specifies the host name of the agent protected server to show to
      client browsers, rather than the actual host name.</p><p>Property: <code class="literal">com.sun.identity.agents.config.agent.host</code></p></dd><dt><span class="term">Alternative Agent Port Name</span></dt><dd><p>Specifies the port number of the agent protected server to show to
      client browsers, rather than the actual port number.</p><p>Property: <code class="literal">com.sun.identity.agents.config.agent.port</code></p></dd><dt><span class="term">Alternative Agent Protocol</span></dt><dd><p>Specifies the protocol used to contact the agent from the browser
      client browsers, rather than the actual protocol used by the server.
      Either <code class="literal">http</code> or <code class="literal">https</code>.</p><p>Property: <code class="literal">com.sun.identity.agents.config.agent.protocol</code></p></dd></dl></div><div class="variablelist"><a name="j2ee-agent-jboss-properties"></a><div class="variablelist-title">JBoss Application Server properties</div><dl class="variablelist"><dt><span class="term">WebAuthentication Available</span></dt><dd><p>When enabled, allow programmatic authentication with the JBoss
      container using the WebAuthentication feature. This feature works only with
      certain versions of JBoss when the <code class="literal">J2EE_POLICY</code> or
      <code class="literal">ALL</code> filter mode is in use.</p><p>Property: <code class="literal">com.sun.identity.agents.config.jboss.webauth.available</code></p><div class="note"><h3 class="title">Note</h3><p>This setting is not necessary for the JBoss v7 agent.</p></div></dd></dl></div><div class="variablelist"><a name="j2ee-agent-xss-detection-properties"></a><div class="variablelist-title">Cross Site Scripting Detection properties</div><dl class="variablelist"><dt><span class="term">Possible XSS code elements</span></dt><dd><p>Specifies strings that, when found in the request, cause the agent
      to redirect the client to an error page.</p><p>Property: <code class="literal">com.sun.identity.agents.config.xss.code.elements</code></p></dd><dt><span class="term">XSS detection redirect URI</span></dt><dd><p>Maps applications to URIs of customized pages to which to redirect
      clients upon detection of XSS code elements.</p><p>For example, to redirect clients of MyApp to
      <code class="literal">/myapp/error.html</code>, enter MyApp as the Map Key and
      <code class="literal">/myapp/error.html</code> as the Corresponding Map
      Value.</p><p>Property: <code class="literal">com.sun.identity.agents.config.xss.redirect.uri</code></p></dd></dl></div><div class="variablelist"><a name="j2ee-agent-post-data-preservation-properties"></a><div class="variablelist-title">Post Data Preservation properties</div><dl class="variablelist"><dt><span class="term">POST Data Preservation</span></dt><dd><p>Enables HTTP POST data preservation, storing POST data before
      redirecting the browser to the login screen, and then autosubmitting
      the same POST after successful authentication to the original URL.</p><p>Property: <code class="literal">com.sun.identity.agents.config.postdata.preserve.enable</code></p></dd><dt><span class="term">Missing PDP entry URI</span></dt><dd><p>Specifies a list of application-specific URIs if the referenced
      Post Data Preservation entry cannot be found in the local cache because
      it has exceeded its POST entry TTL. Either the agent redirects to a
      URI in this list, or it shows an HTTP 403 Forbidden error.</p><p>Property: <code class="literal">com.sun.identity.agents.config.postdata.preserve.cache.noentry.url</code></p></dd><dt><span class="term">POST entry TTL</span></dt><dd><p>POST data storage lifetime in milliseconds. Default: 300000.</p><p>Property: <code class="literal">com.sun.identity.agents.config.postdata.preserve.cache.entry.ttl</code></p></dd><dt><span class="term">PDP Stickysession mode</span></dt><dd><p>Specifies whether to create a cookie, or to append a query string to
      the URL to assist with sticky load balancing.</p><p>Property: <code class="literal">com.sun.identity.agents.config.postdata.preserve.stickysession.mode</code></p></dd><dt><span class="term">PDP Stickysession key-value</span></dt><dd><p>Specifies the key-value pair for stickysession mode. For example,
      a setting of <code class="literal">lb=myserver</code> either sets an
      <code class="literal">lb</code> cookie with <code class="literal">myserver</code> value, or
      adds <code class="literal">lb=myserver</code> to the URL query string.</p><p>Property: <code class="literal">com.sun.identity.agents.config.postdata.preserve.stickysession.value</code></p></dd></dl></div><div class="variablelist"><a name="j2ee-agent-custom-properties"></a><div class="variablelist-title">Custom properties</div><dl class="variablelist"><dt><span class="term">Custom Properties</span></dt><dd><p>Additional properties to augment the set of properties supported
      by agent. Such properties take the following forms.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">customproperty=custom-value1</code></p></li><li class="listitem"><p><code class="literal">customlist[0]=customlist-value-0</code></p></li><li class="listitem"><p><code class="literal">customlist[1]=customlist-value-1</code></p></li><li class="listitem"><p><code class="literal">custommap[key1]=custommap-value-1</code></p></li><li class="listitem"><p><code class="literal">custommap[key2]=custommap-value-2</code></p></li></ul></div><p>Property: <code class="literal">com.sun.identity.agents.config.freeformproperties</code></p></dd></dl></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="configure-wsp-policy-agent"></a>5.7.&nbsp;Configuring Web Service Provider Policy Agents</h2></div></div></div><a class="indexterm" name="d16037e21265"></a><p>This section covers Web Service Provider (WSP) properties. WSPs
  both validate incoming web service requests from Web Service Clients (WSC),
  and also secure outgoing responses sent back to WSCs.</p><div lang="en" class="note"><h3 class="title">Note</h3><p>
  The current implementation of the WSSAuth Authentication module, along with
  the Web Service Provider, Web Service Client and STS Client Policy agents,
  were developed for versions 1.0 and 1.3 of the WS-Trust standard. ForgeRock
  now includes configuration options for the RESTful Security Token Service
  (STS), compatible with version 1.4 of the WS-Trust standard, which uses
  client certificate and Kerberos JASPI authentication modules.
 </p><p>
  For more information on the new implementation of STS, see
  <a href="../admin-guide/index.html#chap-rest-sts" class="link"><em class="citetitle">The RESTful Security
   Token Service</em></a>.
 </p></div><p>After creating a WSP profile, you access WSP properties in the
  OpenAM console under Access Control &gt; <em class="replaceable"><code>Realm Name</code></em>
  &gt; Agents &gt; Web Service Provider &gt; <em class="replaceable"><code>Agent
  Name</code></em>.</p><div class="variablelist"><a name="wsp-general-properties"></a><div class="variablelist-title">General properties</div><dl class="variablelist"><dt><span class="term">Group</span></dt><dd><p>For assigning the agent to a previously configured agent group in
     order to inherit selected properties from the group.</p></dd><dt><span class="term">Password</span></dt><dd><p>Agent password used when creating the password file and when
     installing the agent.</p></dd><dt><span class="term">Status</span></dt><dd><p>Status of the agent configuration.</p></dd><dt><span class="term">Universal Identifier</span></dt><dd><p>OpenAM identifier for the agent configuration.</p></dd></dl></div><div class="variablelist"><a name="wsp-security-properties"></a><div class="variablelist-title">Security properties</div><dl class="variablelist"><dt><span class="term">Security Mechanism</span></dt><dd><p>Specifies the mechanisms allowed to validate the web service
     request.</p></dd><dt><span class="term">Authentication Chain</span></dt><dd><p>Specifies which OpenAM authentication chain consumes the credentials
     from the web service request to authenticate the WSC.</p></dd><dt><span class="term">Token Conversion Type</span></dt><dd><p>Specifies how to covert the incoming token before issuing requests
     to other WSPs.</p></dd><dt><span class="term">Preserve Security Headers in Message</span></dt><dd><p>Yes means the agent preserves SOAP security headers from the request
     for subsequent processing.</p></dd><dt><span class="term">Detect Message Replay</span></dt><dd><p>Yes means the agent checks whether the request is a replay of
     an earlier request, and if so, rejects the request.</p></dd><dt><span class="term">Detect User Token Replay</span></dt><dd><p>Yes means the agent checks whether the user token is a replay
     from an earlier requests, and if so, rejects the request.</p></dd><dt><span class="term">Private Key Type</span></dt><dd><p>Specifies the type of key, such as <code class="literal">PublicKey</code>,
     used to verify the request signature.</p></dd><dt><span class="term">Liberty Service Type URN</span></dt><dd><p>Specifies the Universal Resource Name for the Liberty service type
     used for lookups.</p></dd><dt><span class="term">DNS Claim</span></dt><dd><p>Specifies a Uniform Resource Identifier shared by the WSP and
     WSC.</p></dd><dt><span class="term">Credential for User Token</span></dt><dd><p>Specifies the user name and password credentials compared with
     the user name security token in a request.</p></dd></dl></div><div class="variablelist"><a name="wsp-saml-conf-properties"></a><div class="variablelist-title">SAML Configuration properties</div><dl class="variablelist"><dt><span class="term">SAML Attribute Mapping</span></dt><dd><p>Maps SAML attribute names from the incoming request to attribute
     names as retrieved from the SSOToken or the identity repository, used to
     have the Security Token Service generate an appropriate SAML
     assertion.</p></dd><dt><span class="term">SAML NameID Mapper Plugin</span></dt><dd><p>Specifies the class name of a plugin used to perform SAML account
     mapping.</p></dd><dt><span class="term">SAML Attributes Namespace</span></dt><dd><p>Identifies the attribute name space used when generating SAML
     assertions.</p></dd><dt><span class="term">Include Memberships</span></dt><dd><p>Yes means the agent includes the principal's membership as a
     SAML attribute.</p></dd></dl></div><div class="variablelist"><a name="wsp-signing-and-encryption-properties"></a><div class="variablelist-title">Signing and Encryption properties</div><dl class="variablelist"><dt><span class="term">Is Request Signature Verified</span></dt><dd><p>Yes means verify signatures in requests.</p></dd><dt><span class="term">Is Response Signed Enabled</span></dt><dd><p>Yes means the agent signs the specified parts of the response with
     its x509 certificate.</p></dd><dt><span class="term">Signing Reference Type</span></dt><dd><p>Specifies how the x509 certificate used to sign responses is
     referenced in the response.</p></dd><dt><span class="term">Is Request Decrypted</span></dt><dd><p>Yes means do decrypt the specified parts of incoming requests.</p></dd><dt><span class="term">Is Response Encrypted</span></dt><dd><p>Yes means do encrypt the outgoing response.</p></dd><dt><span class="term">Encryption Algorithm</span></dt><dd><p>Specifies whether to use Advanced Encryption Standard, corresponding
     to an Encryption Strength of 128, 192, or 256, or to use Triple DES with
     a key length of 0, 112, or 168.</p></dd><dt><span class="term">Encryption Strength</span></dt><dd><p>Specifies the key length used for encryption.</p></dd></dl></div><div class="variablelist"><a name="wsp-keystore-properties"></a><div class="variablelist-title">Key Store properties</div><dl class="variablelist"><dt><span class="term">Public Key Alias of Web Service Client</span></dt><dd><p>Specifies the alias of the certificate in the key store used to
     verify request signatures and encrypt responses.</p></dd><dt><span class="term">Private Key Alias</span></dt><dd><p>Specifies the alias of the certificate in the key store used to
     sign responses and decrypt requests.</p></dd><dt><span class="term">Key Store Usage</span></dt><dd><p>If you use your own, custom key store, specify how to access it
     here.</p></dd></dl></div><div class="variablelist"><a name="wsp-end-points-properties"></a><div class="variablelist-title">End Points properties</div><dl class="variablelist"><dt><span class="term">Web Service Security Proxy End Point</span></dt><dd><p>If the WSC sends requests through a web service proxy, specify that
     as the end point here.</p></dd><dt><span class="term">Web Service End Point</span></dt><dd><p>Specifies the end point to which the WSC sends requests.</p></dd></dl></div><div class="variablelist"><a name="wsp-kerberos-properties"></a><div class="variablelist-title">Kerberos Configuration properties</div><dl class="variablelist"><dt><span class="term">Kerberos Domain Server</span></dt><dd><p>Specifies the fully qualified domain name of the Kerberos
     Distribution Center service.</p></dd><dt><span class="term">Kerberos Domain</span></dt><dd><p>Specifies the Kerberos Distribution Center domain name. For
     Windows environments this is the domain controller domain name.</p></dd><dt><span class="term">Kerberos Service Principal</span></dt><dd><p>Specifies the Kerberos principal used by OpenAM, using the form
     <code class="literal">HTTP/<em class="replaceable"><code>openam-fqdn</code></em>@<em class="replaceable"><code>krb-domain</code></em></code>,
     where <em class="replaceable"><code>openam-fqdn</code></em> is the fully qualified domain
     name for OpenAM, and <em class="replaceable"><code>krb-domain</code></em> is the
     Kerberos Domain.</p></dd><dt><span class="term">Kerberos Key Tab File</span></dt><dd><p>Specifies the Kerberos keytab file using the form
     <code class="literal"><em class="replaceable"><code>openam-host</code></em>.HTTP.keytab</code>,
     where <em class="replaceable"><code>openam-host</code></em> is the host name for
     OpenAM.</p></dd><dt><span class="term">Verify Kerberos Signature</span></dt><dd><p>Yes means the agent signs the Kerberos token.</p></dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="configure-wsc-policy-agent"></a>5.8.&nbsp;Configuring Web Service Client Policy Agents</h2></div></div></div><a class="indexterm" name="d16037e21551"></a><p>This section covers Web Service Client (WSC) properties. WSCs
  both secure outgoing requests sent to Web Service Providers (WSP),
  and also validate incoming from WSPs.</p><div lang="en" class="note"><h3 class="title">Note</h3><p>
  The current implementation of the WSSAuth Authentication module, along with
  the Web Service Provider, Web Service Client and STS Client Policy agents,
  were developed for versions 1.0 and 1.3 of the WS-Trust standard. ForgeRock
  now includes configuration options for the RESTful Security Token Service
  (STS), compatible with version 1.4 of the WS-Trust standard, which uses
  client certificate and Kerberos JASPI authentication modules.
 </p><p>
  For more information on the new implementation of STS, see
  <a href="../admin-guide/index.html#chap-rest-sts" class="link"><em class="citetitle">The RESTful Security
   Token Service</em></a>.
 </p></div><p>After creating a WSC profile, you access WSC properties in the
  OpenAM console under Access Control &gt; <em class="replaceable"><code>Realm Name</code></em>
  &gt; Agents &gt; Web Service Client &gt; <em class="replaceable"><code>Agent
  Name</code></em>.</p><div class="variablelist"><a name="wsc-general-properties"></a><div class="variablelist-title">General properties</div><dl class="variablelist"><dt><span class="term">Group</span></dt><dd><p>For assigning the agent to a previously configured agent group in
     order to inherit selected properties from the group.</p></dd><dt><span class="term">Password</span></dt><dd><p>Agent password used when creating the password file and when
     installing the agent.</p></dd><dt><span class="term">Status</span></dt><dd><p>Status of the agent configuration.</p></dd><dt><span class="term">Universal Identifier</span></dt><dd><p>OpenAM identifier for the agent configuration.</p></dd></dl></div><div class="variablelist"><a name="wsc-security-properties"></a><div class="variablelist-title">Security properties</div><dl class="variablelist"><dt><span class="term">Security Mechanism</span></dt><dd><p>Specifies the mechanism used to secure web service requests.</p></dd><dt><span class="term">STS Configuration</span></dt><dd><p>Specifies the agent used to secure requests to the Security Token
     Service. Associated with the STSSecurity Security Mechanism.</p></dd><dt><span class="term">Discovery Configuration</span></dt><dd><p>Specifies the agent used to secure requests to the Discovery
     Service. Associated with the LibertyDiscoverySecurity Security Mechanism.</p></dd><dt><span class="term">User Authentication Required</span></dt><dd><p>Yes means users must authenticate to access the WSC's protected
     page.</p></dd><dt><span class="term">Preserve Security Headers in Message</span></dt><dd><p>Yes means the agent preserves SOAP security headers in the request
     for subsequent processing.</p></dd><dt><span class="term">User Pass Through Security Token</span></dt><dd><p>Yes means the agent passes along the Security Token from the Subject,
     rather than generating a token or requesting it from the Security Token
     Service.</p></dd><dt><span class="term">Liberty Service Type URN</span></dt><dd><p>Specifies the Universal Resource Name for the Liberty service type
     used for lookups.</p></dd><dt><span class="term">Credential for User Token</span></dt><dd><p>Specifies the user name and password credentials shared with the
     WSP and used to generate a Username Security Token.</p></dd><dt><span class="term">DNS Claim</span></dt><dd><p>Specifies a Uniform Resource Identifier shared by the WSP and
     WSC.</p></dd></dl></div><div class="variablelist"><a name="wsc-saml-conf-properties"></a><div class="variablelist-title">SAML Configuration properties</div><dl class="variablelist"><dt><span class="term">SAML Attribute Mapping</span></dt><dd><p>Maps SAML attribute names from the outgoing request to attribute
     names as retrieved from the SSOToken or the identity repository.</p></dd><dt><span class="term">SAML NameID Mapper Plugin</span></dt><dd><p>Specifies the class name of a plugin used to perform SAML account
     mapping.</p></dd><dt><span class="term">SAML Attributes Namespace</span></dt><dd><p>Identifies the attribute name space used when generating SAML
     assertions.</p></dd><dt><span class="term">Include Memberships</span></dt><dd><p>Yes means the agent includes the principal's membership as a
     SAML attribute.</p></dd></dl></div><div class="variablelist"><a name="wsc-signing-and-encryption-properties"></a><div class="variablelist-title">Signing and Encryption properties</div><dl class="variablelist"><dt><span class="term">Is Request Signed Enabled</span></dt><dd><p>Yes means the agent signs the specified parts of the request with
     its x509 certificate.</p></dd><dt><span class="term">Signing Reference Type</span></dt><dd><p>Specifies how the x509 certificate used to sign requests is
     referenced in the request.</p></dd><dt><span class="term">Is Response Signature Verified</span></dt><dd><p>Yes means verify signatures in responses.</p></dd><dt><span class="term">Is Request Encryption Enabled</span></dt><dd><p>Yes means do encrypt the specified parts of outgoing requests.</p></dd><dt><span class="term">Encryption Algorithm</span></dt><dd><p>Specifies whether to use Advanced Encryption Standard, corresponding
     to an Encryption Strength of 128, 192, or 256, or to use Triple DES with
     a key length of 0, 112, or 168.</p></dd><dt><span class="term">Encryption Strength</span></dt><dd><p>Specifies the key length used for encryption.</p></dd><dt><span class="term">Is Response Decrypted</span></dt><dd><p>Yes means do decrypt the incoming response.</p></dd></dl></div><div class="variablelist"><a name="wsc-keystore-properties"></a><div class="variablelist-title">Key Store properties</div><dl class="variablelist"><dt><span class="term">Public Key Alias of Web Service Provider</span></dt><dd><p>Specifies the alias of the certificate in the key store used to
     sign requests and decrypt responses.</p></dd><dt><span class="term">Private Key Alias</span></dt><dd><p>Specifies the alias of the certificate in the key store used to
     verify response signatures and encrypt requests.</p></dd><dt><span class="term">Key Store Usage</span></dt><dd><p>If you use your own, custom key store, specify how to access it
     here.</p></dd></dl></div><div class="variablelist"><a name="wsc-end-points-properties"></a><div class="variablelist-title">End Points properties</div><dl class="variablelist"><dt><span class="term">Web Service Security Proxy End Point</span></dt><dd><p>If the WSC sends requests through a web service proxy, specify that
     as the end point here.</p></dd><dt><span class="term">Web Service End Point</span></dt><dd><p>Specifies the end point to which the WSC sends requests.</p></dd></dl></div><div class="variablelist"><a name="wsc-kerberos-properties"></a><div class="variablelist-title">Kerberos Configuration properties</div><dl class="variablelist"><dt><span class="term">Kerberos Domain Server</span></dt><dd><p>Specifies the fully qualified domain name of the Kerberos
     Distribution Center service.</p></dd><dt><span class="term">Kerberos Domain</span></dt><dd><p>Specifies the Kerberos Distribution Center domain name. For
     Windows environments this is the domain controller domain name.</p></dd><dt><span class="term">Kerberos Service Principal</span></dt><dd><p>Specifies the Kerberos principal used by OpenAM, using the form
     <code class="literal">HTTP/<em class="replaceable"><code>openam-fqdn</code></em>@<em class="replaceable"><code>krb-domain</code></em></code>,
     where <em class="replaceable"><code>openam-fqdn</code></em> is the fully qualified domain
     name for OpenAM, and <em class="replaceable"><code>krb-domain</code></em> is the
     Kerberos Domain.</p></dd><dt><span class="term">Kerberos Ticket Cache Directory</span></dt><dd><p>Specifies the directory in which Kerberos Ticket Granting Tickets
     (TGT) are cached. The <span class="command"><strong>kinit</strong></span> command stores the TGT from
     the KDC here.</p></dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="configure-sts-policy-agent"></a>5.9.&nbsp;Configuring Security Token Service Client Policy Agents</h2></div></div></div><a class="indexterm" name="d16037e21817"></a><a class="indexterm" name="d16037e21822"></a><p>This section covers Security Token Service (STS) Client properties. STS
  clients both secure outgoing requests to trust authorities, and also validate
  incoming requests from trust authorities. You can configure STS clients to
  work with OpenAM's Security Token Service and with its Discovery
  Service.</p><div lang="en" class="note"><h3 class="title">Note</h3><p>
  The current implementation of the WSSAuth Authentication module, along with
  the Web Service Provider, Web Service Client and STS Client Policy agents,
  were developed for versions 1.0 and 1.3 of the WS-Trust standard. ForgeRock
  now includes configuration options for the RESTful Security Token Service
  (STS), compatible with version 1.4 of the WS-Trust standard, which uses
  client certificate and Kerberos JASPI authentication modules.
 </p><p>
  For more information on the new implementation of STS, see
  <a href="../admin-guide/index.html#chap-rest-sts" class="link"><em class="citetitle">The RESTful Security
   Token Service</em></a>.
 </p></div><p>After creating an STS Client profile, you access STS Client properties
  in the OpenAM console under Access Control &gt; <em class="replaceable"><code>Realm
  Name</code></em> &gt; Agents &gt; STS Client &gt; <em class="replaceable"><code>Agent
  Name</code></em>.</p><div class="variablelist"><a name="sts-agent-general-properties"></a><div class="variablelist-title">General properties</div><dl class="variablelist"><dt><span class="term">Group</span></dt><dd><p>For assigning the agent to a previously configured agent group in
     order to inherit selected properties from the group.</p></dd><dt><span class="term">Password</span></dt><dd><p>Agent password used when creating the password file and when
     installing the agent.</p></dd><dt><span class="term">Status</span></dt><dd><p>Status of the agent configuration.</p></dd><dt><span class="term">WS-Trust Version</span></dt><dd><p>Specifies whether to use WS-Trust 1.3 or 1.0.</p></dd><dt><span class="term">Universal Identifier</span></dt><dd><p>OpenAM identifier for the agent configuration.</p></dd></dl></div><div class="variablelist"><a name="sts-agent-security-properties"></a><div class="variablelist-title">Security properties</div><dl class="variablelist"><dt><span class="term">Security Mechanism</span></dt><dd><p>Specifies the mechanism used to secure the STS request.</p></dd><dt><span class="term">STS Configuration</span></dt><dd><p>Specifies the STS Client agent profile to use if the security
     mechanism is STS Security.</p></dd><dt><span class="term">Preserve Security Headers in Message</span></dt><dd><p>Yes means the agent preserves SOAP security headers for subsequent
     processing.</p></dd><dt><span class="term">Credential for User Token</span></dt><dd><p>Specifies the user name and password credentials the agent uses
     to generate a Username security token.</p></dd><dt><span class="term">Requested Key Type</span></dt><dd><p>Specifies the type of key, such as <code class="literal">PublicKey</code>,
     used to encrypt responses.</p></dd><dt><span class="term">Requested Claims</span></dt><dd><p>Specifies the Uniform Resource Identifiers for the claims to
     be represented in the Security Token.</p></dd><dt><span class="term">DNS Claim</span></dt><dd><p>Specifies a Uniform Resource Identifier shared by the agent and the
     WSC.</p></dd></dl></div><div class="variablelist"><a name="sts-agent-saml-conf-properties"></a><div class="variablelist-title">SAML Configuration properties</div><dl class="variablelist"><dt><span class="term">SAML Attribute Mapping</span></dt><dd><p>Maps SAML attribute names from the incoming request to attribute
     names as retrieved from the SSOToken or the identity repository, used to
     have the Security Token Service generate an appropriate SAML
     assertion.</p></dd><dt><span class="term">SAML NameID Mapper Plugin</span></dt><dd><p>Specifies the class name of a plugin used to perform SAML account
     mapping.</p></dd><dt><span class="term">SAML Attributes Namespace</span></dt><dd><p>Identifies the attribute name space used when generating SAML
     assertions.</p></dd><dt><span class="term">Include Memberships</span></dt><dd><p>Yes means the agent includes the principal's membership as a
     SAML attribute.</p></dd></dl></div><div class="variablelist"><a name="sts-agent-signing-and-encryption-properties"></a><div class="variablelist-title">Signing and Encryption properties</div><dl class="variablelist"><dt><span class="term">Is Response Signature Verified</span></dt><dd><p>Yes means verify signatures in responses.</p></dd><dt><span class="term">Is Request Signed Enabled</span></dt><dd><p>Yes means the agent signs the specified parts of the request with
     its x509 certificate.</p></dd><dt><span class="term">Signing Reference Type</span></dt><dd><p>Specifies how the x509 certificate used to sign requests is
     referenced in the request.</p></dd><dt><span class="term">Is Request Encryption Enabled</span></dt><dd><p>Yes means do encrypt the specified parts of requests.</p></dd><dt><span class="term">Is Response Decrypted</span></dt><dd><p>Yes means do decrypt the response.</p></dd><dt><span class="term">Encryption Algorithm</span></dt><dd><p>Specifies whether to use Advanced Encryption Standard, corresponding
     to an Encryption Strength of 128, 192, or 256, or to use Triple DES with
     a key length of 0, 112, or 168.</p></dd><dt><span class="term">Encryption Strength</span></dt><dd><p>Specifies the key length used for encryption.</p></dd></dl></div><div class="variablelist"><a name="sts-agent-keystore-properties"></a><div class="variablelist-title">Key Store properties</div><dl class="variablelist"><dt><span class="term">Public Key Alias of Web Service Provider</span></dt><dd><p>Specifies the alias of the certificate in the key store used to
     verify response signatures and encrypt requests.</p></dd><dt><span class="term">Private Key Alias</span></dt><dd><p>Specifies the alias of the certificate in the key store used to
     sign requests and decrypt responses.</p></dd><dt><span class="term">Key Store Usage</span></dt><dd><p>If you use your own, custom key store, specify how to access it
     here.</p></dd></dl></div><div class="variablelist"><a name="sts-agent-end-points-properties"></a><div class="variablelist-title">End Points properties</div><dl class="variablelist"><dt><span class="term">Security Token Service End Point</span></dt><dd><p>Specifies the URL to the Security Token Service end point.</p></dd><dt><span class="term">Security Token Service MEX End Point</span></dt><dd><p>Specifies the URL to the Security Token Service message exchange
     end point.</p></dd></dl></div><div class="variablelist"><a name="sts-agent-kerberos-properties"></a><div class="variablelist-title">Kerberos Configuration properties</div><dl class="variablelist"><dt><span class="term">Kerberos Domain Server</span></dt><dd><p>Specifies the fully qualified domain name of the Kerberos
     Distribution Center service.</p></dd><dt><span class="term">Kerberos Domain</span></dt><dd><p>Specifies the Kerberos Distribution Center domain name. For
     Windows environments this is the domain controller domain name.</p></dd><dt><span class="term">Kerberos Service Principal</span></dt><dd><p>Specifies the Kerberos principal used by OpenAM, using the form
     <code class="literal">HTTP/<em class="replaceable"><code>openam-fqdn</code></em>@<em class="replaceable"><code>krb-domain</code></em></code>,
     where <em class="replaceable"><code>openam-fqdn</code></em> is the fully qualified domain
     name for OpenAM, and <em class="replaceable"><code>krb-domain</code></em> is the
     Kerberos Domain.</p></dd><dt><span class="term">Kerberos Ticket Cache Directory</span></dt><dd><p>Specifies the directory in which Kerberos Ticket Granting Tickets
     (TGT) are cached. The <span class="command"><strong>kinit</strong></span> command stores the TGT from
     the KDC here.</p></dd></dl></div></div><div lang="en" class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="configure-22-policy-agent"></a>5.10.&nbsp;Configuring Version 2.2 Policy Agents</h2></div></div></div><a class="indexterm" name="d16037e22084"></a><p>This section covers version 2.2 agent properties. Version 2.2 agents
  store their configurations locally, with a user name, password combination
  used to connect to OpenAM.</p><div class="warning"><h3 class="title">Warning</h3><p>ForgeRock no longer supports 2.2 agents. Documentation exists only for
   legacy systems. Do not use 2.2 policy agents for new deployments.
  </p></div><p>After creating the agent profile, you access agent properties in the
  OpenAM console under Access Control &gt; <em class="replaceable"><code>Realm Name</code></em>
  &gt; Agents &gt; 2.2 Agents &gt; <em class="replaceable"><code>Agent Name</code></em>.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Password</span></dt><dd><p>Specifies the password the agent uses to connect to OpenAM.</p></dd><dt><span class="term">Status</span></dt><dd><p>Specifies whether the agent profile is active, and so can be
     used.</p></dd><dt><span class="term">Description</span></dt><dd><p>Specifies a short description for the agent.</p></dd><dt><span class="term">Agent Key Value(s)</span></dt><dd><p>Additional key-value pairs that OpenAM uses to receive agent
     requests concerning credential assertions.</p><p>OpenAM currently supports one property,
     <code class="literal">agentRootURL=<em class="replaceable"><code>protocol</code></em>://<em class="replaceable"><code>host</code></em>:<em class="replaceable"><code>port</code></em>/</code>
     where the key is case-sensitive.</p></dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="configure-oauth2-client"></a>5.11.&nbsp;Configuring OAuth 2.0 &amp; OpenID Connect 1.0 Clients</h2></div></div></div><a class="indexterm" name="d16037e22144"></a><a class="indexterm" name="d16037e22151"></a><a class="indexterm" name="d16037e22156"></a><p>When you want to register an OAuth 2.0 client with OpenAM as the
  OAuth 2.0 authorization server, or register an OpenID Connect 1.0 client
  through OpenAM console, then create an OAuth 2.0 Client agent profile.
  After creating the agent profile, you can further configure the properties
  in the OpenAM console under Access Control &gt; <em class="replaceable"><code>Realm
  Name</code></em> &gt; Agents &gt; OAuth 2.0 Client &gt; <em class="replaceable"><code>Client
  Name</code></em>.</p><div class="itemizedlist"><p>The topmost configuration fields are for both OAuth 2.0 and OpenID
   Connect 1.0, whereas others are specifically for OpenID Connect 1.0.</p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="#configure-oauth2-client-common" title="Common Client Configuration">Common Client Configuration</a></p></li><li class="listitem"><p><a class="xref" href="#configure-oauth2-client-openid-connect" title="OpenID Connect 1.0 Client Configuration">OpenID Connect 1.0 Client Configuration</a></p></li></ul></div><div class="variablelist"><a name="configure-oauth2-client-common"></a><div class="variablelist-title">Common Client Configuration</div><p>The following configuration fields are common to OAuth 2.0 and OpenID
   Connect 1.0 clients.</p><dl class="variablelist"><dt><span class="term">Group</span></dt><dd><p>Set this if you have configured an OAuth 2.0 Client agent
     group.</p></dd><dt><span class="term">Status</span></dt><dd><p>Whether the client profile is active for use.</p></dd><dt><span class="term">Client password</span></dt><dd><p>The client password as described by RFC 6749 in the section,
     <a class="link" href="http://tools.ietf.org/html/rfc6749#section-2.3.1" target="_blank">Client Password</a>.</p></dd><dt><span class="term">Client type</span></dt><dd><p>Confidential clients can maintain confidentiality of their
     credentials. Public clients cannot.</p><p>A web application running on a server where its credentials are
     protected is an example of a confidential client.</p><p>A JavaScript client running in a browser is an example of a public
     client.</p></dd><dt><span class="term">Redirection URIs</span></dt><dd><p>Specify client redirection endpoint URIs as described by RFC 6749
     in the section, <a class="link" href="http://tools.ietf.org/html/rfc6749#section-3.1.2" target="_blank">Redirection
     Endpoint</a>. OpenAM's OAuth 2.0 authorization service redirects the
     the resource owner's user-agent back to this endpoint during the
     authorization code grant process. If your client has more than one
     redirection URI, then it must specify the redirection URI to use in
     the authorization request.</p><p>Redirection URIs are required for OpenID Connect 1.0 clients.</p></dd><dt><span class="term">Scopes</span></dt><dd><p>Specify scopes in <code class="literal"><em class="replaceable"><code>scope</code></em></code>
     or <code class="literal"><em class="replaceable"><code>scope</code></em>|<em class="replaceable"><code>locale</code></em>|<em class="replaceable"><code>localized
     description</code></em></code> format. These scopes are to be
     presented to the resource owner when the resource owner is asked to
     authorize client access to protected resources.</p></dd><dt><span class="term">Display name</span></dt><dd><p>Specify a client name to display to the resource owner
     when the resource owner is asked to authorize client access to protected
     resources. Valid formats include <code class="literal"><em class="replaceable"><code>name</code></em></code> or <code class="literal"><em class="replaceable"><code>locale</code></em>|<em class="replaceable"><code>localized
     name</code></em></code>.</p></dd><dt><span class="term">Display description</span></dt><dd><p>Specify a client description to display to the resource owner
     when the resource owner is asked to authorize client access to protected
     resources. Valid formats include <code class="literal"><em class="replaceable"><code>description</code></em></code> or <code class="literal"><em class="replaceable"><code>locale</code></em>|<em class="replaceable"><code>localized
     description</code></em></code>.</p></dd><dt><span class="term">Default Scope(s)</span></dt><dd><p>Specify scopes in <code class="literal"><em class="replaceable"><code>scope</code></em></code>
     or <code class="literal"><em class="replaceable"><code>scope</code></em>|<em class="replaceable"><code>locale</code></em>|<em class="replaceable"><code>localized
     description</code></em></code> format. These scopes are set
     automatically when tokens are issued.</p></dd><dt><span class="term">Response Types</span></dt><dd><p>
      Specify response type lists that the client uses.
     </p><div class="itemizedlist"><p>
       The default lists are the following.
      </p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
        <code class="literal">code</code>
       </p></li><li class="listitem"><p>
        <code class="literal">token</code>
       </p></li><li class="listitem"><p>
        <code class="literal">id_token</code>
       </p></li><li class="listitem"><p>
        <code class="literal">code token</code>
       </p></li><li class="listitem"><p>
        <code class="literal">token id_token</code>
       </p></li><li class="listitem"><p>
        <code class="literal">code id_token</code>
       </p></li><li class="listitem"><p>
        <code class="literal">code token id_token</code>
       </p></li></ul></div></dd><dt><span class="term">Contacts</span></dt><dd><p>
      Specify email address of users who administer the client.
     </p></dd><dt><span class="term">Client Name</span></dt><dd><p>
      Specify a human-readable name for the client.
     </p></dd><dt><span class="term">Client JWT Bearer Public Key Certificate</span></dt><dd><p>
      Specify the public key certificate of the client's key pair
      that is used to sign JWTs issued by the client
      and used for client authentication or to request access tokens.
     </p><p>
      This is the base64-encoded X509 certificate containing the public key
      in PEM format, as in the following example.
     </p><pre class="brush: plain;">
-----BEGIN CERTIFICATE-----
MIIDETCCAfmgAwIBAgIEU8SXLjANBgkqhkiG9w0BAQsFADA5MRswGQYDVQQKExJvcGVuYW0uZXhh
bXBsZS5jb20xGjAYBgNVBAMTEWp3dC1iZWFyZXItY2xpZW50MB4XDTE0MTAyNzExNTY1NloXDTI0
MTAyNDExNTY1NlowOTEbMBkGA1UEChMSb3BlbmFtLmV4YW1wbGUuY29tMRowGAYDVQQDExFqd3Qt
YmVhcmVyLWNsaWVudDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAID4ZZ/DIGEBr4QC
2uz0GYFOCUlAPanxX21aYHSvELsWyMa7DJlD+mnjaF8cPRRMkhYZFXDJo/AVcjyblyT3ntqL+2Js
3D7TmS6BSjkxZWsJHyhJIYEoUwwloc0kizgSm15MwBMcbnksQVN5VWiOe4y4JMbi30t6k38lM62K
KtaSPP6jvnW1LTmL9uiqLWz54AM6hU3NlCI3J6Rfh8waBIPAEjmHZNquOl2uGgWumzubYDFJbomL
SQqO58RuKVaSVMwDbmENtMYWXIKQL2xTt5XAbwEQEgJ/zskwpA2aQt1HE6de3UymOhONhRiu4rk3
AIEnEVbxrvy4Ik+wXg7LZVsCAwEAAaMhMB8wHQYDVR0OBBYEFIuI7ejuZTg5tJsh1XyRopGOMBcs
MA0GCSqGSIb3DQEBCwUAA4IBAQBM/+/tYYVIS6LvPl3mfE8V7x+VPXqj/uK6UecAbfmRTrPk1ph+
jjI6nmLX9ncomYALWL/JFiSXcVsZt3/412fOqjakFVS0PmK1vEPxDlav1drnVA33icy1wORRRu5/
qA6mwDYPAZSbm5cDVvCR7Lt6VqJ+D0V8GABFxUw9IaX6ajTqkWhldY77usvNeTD0Xc4R7OqSBrnA
SNCaUlJogWyzhbFlmE9Ne28j4RVpbz/EZn0oc/cHTJ6Lryzsivf4uDO1m3M3kM/MUyXc1Zv3rqBj
TeGSgcqEAd6XlGXY1+M/yIeouUTi0F1bk1rNlqJvd57Xb4CEq17tVbGBm0hkECM8
-----END CERTIFICATE-----
     </pre><p>
      You can generate a key pair and export the certificate
      by using the Java <span class="command"><strong>keytool</strong></span> command.
     </p><div class="screen"><pre>
$ <strong>keytool \
 -genkeypair \
 -keysize 2048 \
 -alias self-signed \
 -keyalg rsa \
 -dname "CN=jwt-bearer-client,O=openam.example.com" \
 -keystore keystore.jks \
 -keypass changeit \
 -storepass changeit \
 -validity 3650 \
 -v</strong>
<em>Generating 2,048 bit RSA key pair and self-signed certificate (SHA256withRSA)
 with a validity of 3,650 days
    for: CN=jwt-bearer-client, O=openam.example.com
[Storing keystore.jks]</em>

$ <strong>keytool \
 -list \
 -alias self-signed \
 -rfc \
 -keystore keystore.jks \
 -keypass changeit \
 -storepass changeit</strong>
<em>Alias name: self-signed
Creation date: Oct 27, 2014
Entry type: PrivateKeyEntry
Certificate chain length: 1
Certificate[1]:
-----BEGIN CERTIFICATE-----
MIIDETCCAfmgAwIBAgIEU8SXLjANBgkqhkiG9w0BAQsFADA5MRswGQYDVQQKExJvcGVuYW0uZXhh
bXBsZS5jb20xGjAYBgNVBAMTEWp3dC1iZWFyZXItY2xpZW50MB4XDTE0MTAyNzExNTY1NloXDTI0
MTAyNDExNTY1NlowOTEbMBkGA1UEChMSb3BlbmFtLmV4YW1wbGUuY29tMRowGAYDVQQDExFqd3Qt
YmVhcmVyLWNsaWVudDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAID4ZZ/DIGEBr4QC
2uz0GYFOCUlAPanxX21aYHSvELsWyMa7DJlD+mnjaF8cPRRMkhYZFXDJo/AVcjyblyT3ntqL+2Js
3D7TmS6BSjkxZWsJHyhJIYEoUwwloc0kizgSm15MwBMcbnksQVN5VWiOe4y4JMbi30t6k38lM62K
KtaSPP6jvnW1LTmL9uiqLWz54AM6hU3NlCI3J6Rfh8waBIPAEjmHZNquOl2uGgWumzubYDFJbomL
SQqO58RuKVaSVMwDbmENtMYWXIKQL2xTt5XAbwEQEgJ/zskwpA2aQt1HE6de3UymOhONhRiu4rk3
AIEnEVbxrvy4Ik+wXg7LZVsCAwEAAaMhMB8wHQYDVR0OBBYEFIuI7ejuZTg5tJsh1XyRopGOMBcs
MA0GCSqGSIb3DQEBCwUAA4IBAQBM/+/tYYVIS6LvPl3mfE8V7x+VPXqj/uK6UecAbfmRTrPk1ph+
jjI6nmLX9ncomYALWL/JFiSXcVsZt3/412fOqjakFVS0PmK1vEPxDlav1drnVA33icy1wORRRu5/
qA6mwDYPAZSbm5cDVvCR7Lt6VqJ+D0V8GABFxUw9IaX6ajTqkWhldY77usvNeTD0Xc4R7OqSBrnA
SNCaUlJogWyzhbFlmE9Ne28j4RVpbz/EZn0oc/cHTJ6Lryzsivf4uDO1m3M3kM/MUyXc1Zv3rqBj
TeGSgcqEAd6XlGXY1+M/yIeouUTi0F1bk1rNlqJvd57Xb4CEq17tVbGBm0hkECM8
-----END CERTIFICATE-----</em>
     </pre></div></dd></dl></div><div class="variablelist"><a name="configure-oauth2-client-openid-connect"></a><div class="variablelist-title">OpenID Connect 1.0 Client Configuration</div><p>The following optional configuration fields are for OpenID Connect 1.0
   clients.</p><dl class="variablelist"><dt><span class="term">ID Token Signed Response Algorithm</span></dt><dd><p>Algorithm that the ID Token for this client must be signed with</p><p>
      Default: <code class="literal">RS256</code>
      (RSA with SHA256, where the RSA key comes from the OpenAM keystore)
     </p><p>Valid values are listed in <em class="citetitle">JSON Web Algorithms
     (JWA)</em>: <a class="link" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms#section-3.1" target="_blank"><em class="citetitle">"alg" (Algorithm) Header Parameter Values for JWS</em></a>.
     OpenAM supports <code class="literal">HmacSHA256</code>,
     <code class="literal">HmacSHA384</code>, and <code class="literal">HmacSHA512</code>.</p></dd><dt><span class="term">Post Logout Redirect URI</span></dt><dd><p>URI to which to redirect the user-agent after the client logout
      process</p></dd><dt><span class="term">Access Token</span></dt><dd><p>The <code class="literal">registration_access_token</code> value that you
     provide when registering the client, and then subsequently when reading
     or updating the client profile.</p></dd><dt><span class="term">Client Session URI</span></dt><dd><p>The relying party (client) URI to which the OpenID Connect Provider
     sends session changed notification messages using the HTML 5 postMessage
     API.</p></dd></dl></div></div><div lang="en" class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="configure-agent-auth"></a>5.12.&nbsp;Configuring Agent Authenticators</h2></div></div></div><a class="indexterm" name="d16037e22454"></a><p>An <em class="firstterm">agent authenticator</em> has read-only access to
  multiple agent profiles defined in the same realm, typically allowing an
  agent to read web service agent profiles.</p><p>After creating the agent profile, you access agent properties in the
  OpenAM console under Access Control &gt; <em class="replaceable"><code>Realm Name</code></em>
  &gt; Agents &gt; Agent Authenticator &gt; <em class="replaceable"><code>Agent
   Name</code></em>.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Password</span></dt><dd><p>Specifies the password the agent uses to connect to OpenAM.</p></dd><dt><span class="term">Status</span></dt><dd><p>Specifies whether the agent profile is active, and so can be
     used.</p></dd><dt><span class="term">Agent Profiles allow to Read</span></dt><dd><p>Specifies which agent profiles in the realm the agent authenticator
     can read.</p></dd><dt><span class="term">Agent Root URL for CDSSO</span></dt><dd><p>Specifies the list of agent root URLs for CDSSO. The valid value is
     in the format
     <code class="literal"><em class="replaceable"><code>protocol</code></em>://<em class="replaceable"><code>hostname</code></em>:<em class="replaceable"><code>port</code></em>/</code>
     where <em class="replaceable"><code>protocol</code></em> represents the protocol used,
     such as <code class="literal">http</code> or <code class="literal">https</code>,
     <em class="replaceable"><code>hostname</code></em> represents the host name of the
     system where the agent resides, and <em class="replaceable"><code>port</code></em>
     represents the port number on which the agent is installed.
     The slash following the port number is required.</p><p>If your agent system also has virtual host names, add URLs with
     the virtual host names to this list as well. OpenAM checks that
     <code class="literal">goto</code> URLs match one of the agent root URLs for
     CDSSO.</p></dd></dl></div></div><div class="footnotes"><br><hr class="footnote-hr"><div id="ftn.d16037e16924" class="footnote"><p><a href="#d16037e16924" class="para"><sup class="para">[6] </sup></a>The configuration file syntax is that
   of a standard Java properties file. See <a class="link" href="http://download.oracle.com/javase/6/docs/api/java/util/Properties.html#load%28java.io.Reader%29" target="_top">java.util.Properties.load</a> for a description of the format. The value
   of a property specified multiple times is not defined.</p></div><div id="ftn.d16037e18990" class="footnote"><p><a href="#d16037e18990" class="para"><sup class="para">[7] </sup></a>The configuration file syntax is that
   of a standard Java properties file. See
   <a class="link" href="http://download.oracle.com/javase/6/docs/api/java/util/Properties.html#load%28java.io.Reader%29" target="_top">java.util.Properties.load()</a>
   for a description of the format. The value of a property specified multiple
   times is not defined.</p></div></div></div><div lang="en" class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="chap-audit-logging"></a>Chapter&nbsp;6.&nbsp;Configuring Audit Logging</h1></div></div></div><div class="toc"><div class="toc-title">Table of Contents</div><dl class="toc"><dt><span class="section"><a href="#log-mgmt-global-settings">6.1. Configuring Audit Logging</a></span></dt><dt><span class="section"><a href="#log-mgmt-core">6.2. Audit Logging to Flat Files</a></span></dt><dt><span class="section"><a href="#log-mgmt-syslog">6.3. Audit Logging to a Syslog Server</a></span></dt><dt><span class="section"><a href="#log-mgmt-agents">6.4. Audit Logging in OpenAM Policy Agents</a></span></dt></dl></div><a class="indexterm" name="d16037e22532"></a><p>
  OpenAM servers generate two types of log files: audit logs and debug logs.
 </p><p>
  Audit logs capture normal operational information about OpenAM usage.
  Audit file records are structured: they adhere to a consistent, documented
  file format. You can configure OpenAM to write audit logs to flat files,
  relational database tables, or a syslog server.
 </p><p>
  OpenAM policy agents also produce agent audit logs. Agent audit logs
  provide a trail of policy agent activity.
 </p><p>
  OpenAM services can capture a variety of information in debug logs, which you
  can use when troubleshooting OpenAM. For more information about the OpenAM
  debug logs, see
  <a href="../admin-guide/index.html#debug-logging" class="link">
   <em class="citetitle">Debug Logging</em>.
  </a>
 </p><p>
  The OpenAM Logging Service encapsulates the audit logging configuration.
  The Logging Service is an OpenAM system service. There is a single audit
  logging configuration for the entire OpenAM deployment.
 </p><p>
  OpenAM lets you change the log level on the fly. OpenAM also supports
  log rotation, secure logging, and log message buffering.
 </p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="log-mgmt-global-settings"></a>6.1.&nbsp;Configuring Audit Logging</h2></div></div></div><p>
  To configure OpenAM logging properties, log in to the OpenAM
  console as OpenAM administrator, and browse to Configuration &gt; System &gt;
  Logging.
 </p><p>For more information on the available settings, see the <a href="../reference/index.html#system-logging" class="link">Audit Logging</a>
   reference.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="log-mgmt-core"></a>6.2.&nbsp;Audit Logging to Flat Files</h2></div></div></div><p>
   By default, OpenAM audit logs are written to files in the
   configuration directory for the instance, such as
   <code class="filename">$HOME/openam/log/</code>.
  </p><p>
   OpenAM sends messages to different log files, each named after the
   service logging the message, with two different types log files per service:
   <code class="filename">.access</code>
   and<code class="filename">.error</code>. Thus the
   current log files for the authentication service are named
   <code class="filename">amAuthentication.access</code>
   and
   <code class="filename">amAuthentication.error</code>.
  </p><p>
   See the
   <a href="../reference/index.html#chap-log-messages" class="link">
    Log Messages
   </a>
   reference for details.
  </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="log-mgmt-syslog"></a>6.3.&nbsp;Audit Logging to a Syslog Server</h2></div></div></div><p>OpenAM supports sending audit log messages to a syslog server for
   collation.</p><p>You can enable syslog audit logging by using the OpenAM console,
   or the <code class="filename">ssoadm</code> command.</p><div class="procedure"><a name="enable-syslog-audit-logging-console"></a><div class="procedure-title">Procedure&nbsp;6.1.&nbsp;Enabling Syslog Audit Logging by Using the OpenAM Console</div><ol class="procedure" type="1"><li class="step"><p>Login to the OpenAM console as OpenAM administrator.</p></li><li class="step"><p>Browse to Configuration &gt; System &gt; Logging.</p></li><li class="step"><p>Set the <span class="emphasis"><em>Logging Type</em></span> option to
    <code class="literal">Syslog</code>.</p></li><li class="step"><p>Complete the following settings as appropriate for your syslog
     server:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">Syslog server host</code></p></li><li class="listitem"><p><code class="literal">Syslog server port</code></p></li><li class="listitem"><p><code class="literal">Syslog server protocol</code></p></li><li class="listitem"><p><code class="literal">Syslog facility</code></p></li><li class="listitem"><p><code class="literal">Syslog connection timeout</code></p></li></ul></div><p>For information on these settings, see the <a href="../reference/index.html#system-logging" class="link">Audit Logging</a>
     reference.</p></li><li class="step"><p>Save your work.</p></li></ol></div><div class="procedure"><a name="enable-syslog-audit-logging-SSOADM"></a><div class="procedure-title">Procedure&nbsp;6.2.&nbsp;Enabling Syslog Audit Logging by Using SSOADM</div><ol class="procedure" type="1"><li class="step"><p>Create a text file, for example
     <code class="filename">MySyslogServerSettings.txt</code> containing the settings
     used when audit logging to a syslog server, as shown below:</p><div class="screen"><pre>
<strong>iplanet-am-logging-syslog-port=<em><strong>514</strong></em>
iplanet-am-logging-syslog-protocol=<em><strong>UDP</strong></em>
iplanet-am-logging-type=Syslog
iplanet-am-logging-syslog-connection-timeout=<em><strong>30</strong></em>
iplanet-am-logging-syslog-host=<em><strong>localhost</strong></em>
iplanet-am-logging-syslog-facility=<em><strong>local5</strong></em></strong>
</pre></div></li><li class="step"><p>Use the following SSOADM command to configure audit logging to
     a syslog server:</p><div class="screen"><pre>$ <strong>ssoadm \
 set-attr-defs \
 --adminid amadmin \
 --password-file /tmp/pwd.txt \
 --servicename iPlanetAMLoggingService \
 --schematype Global \
 --datafile <em><strong>MySyslogServerSettings.txt</strong></em></strong>

 <em>Schema attribute defaults were set.</em>
</pre></div></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="log-mgmt-agents"></a>6.4.&nbsp;Audit Logging in OpenAM Policy Agents</h2></div></div></div><p>
   By default, OpenAM Policy Agents log to local files in their
   configuration directories for debugging. The exact location depends on
   where you installed the agent.
  </p><p>
   By default OpenAM policy agents send log messages remotely to OpenAM
   when you log auditing information about URL access attempts. To configure
   audit logging for a centrally managed policy agent, login to the OpenAM
   console as administrator, and browse to Access Control &gt;
   <em class="replaceable"><code>Realm Name</code></em>
   &gt; Agents &gt;
   <em class="replaceable"><code>Agent Type</code></em>
   &gt;
   <em class="replaceable"><code>Agent
    Name
   </code></em>
   &gt; Global, and then scroll down to the Audit
   section.
  </p></div></div><div lang="en" class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="chap-mobile"></a>Chapter&nbsp;7.&nbsp;Working with Mobile Devices &amp; Applications</h1></div></div></div><div class="toc"><div class="toc-title">Table of Contents</div><dl class="toc"><dt><span class="section"><a href="#mobile-oauth">7.1. Simplifying Access on Mobile Devices</a></span></dt><dt><span class="section"><a href="#mobile-oath">7.2. Protecting Access for Mobile Users</a></span></dt><dt><span class="section"><a href="#mobile-rest">7.3. Simplifying Access with REST APIs</a></span></dt><dt><span class="section"><a href="#get-mobile-sample-apps">7.4. Getting Source Code for Sample Mobile Applications</a></span></dt></dl></div><p>When building applications that run on mobile devices, you can use
 the same OpenAM service that you also use for access management in your
 web, cloud, and other applications. OpenAM has features that make it
 particularly well suited for the mobile world, too.</p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="mobile-oauth"></a>7.1.&nbsp;Simplifying Access on Mobile Devices</h2></div></div></div><p>On many mobile devices, users want to avoid repeatedly entering
  credentials such as an email address or user name and a password. They
  do not want new credentials to manage for every application they try.
  They do not want to share their credentials across applications. Instead
  users want single sign-on with few identity providers. They want to
  authorize access for applications rather than share their
  credentials.</p><p>
   OpenAM supports modern web standards including
   <a href="../admin-guide/index.html#chap-oauth2" class="link">OAuth 2.0</a>,
   <span class="olink">OpenID Connect 1.0</span>, and
   <a class="link" href="http://gsmamobileeconomy.com/gsmamc/" target="_blank">GSMA Mobile Connect</a>.
   After registering an application with OpenAM as an OAuth/OpenID Connect client,
   the application can then redirect a user to OpenAM
   to authenticate and to authorize access to resources that the user owns,
   such as profile data.
   The application gets an access token that can be used
   to gain authorized access without requiring the user to share credentials.
   OpenID Connect extends OAuth,
   standardizing how client applications discover
   and register with identity providers,
   and also defining how applications can manage user sessions
   and handle logout when they no longer want to authorize access.
  </p><div class="mediaobject" align="center"><a name="figure-mobile-oauth"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/mobile-oauth.png" align="middle" height="360" alt="OAuth 2.0 with a mobile application"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-mobile-oauth.html" target="longdesc">D</a>]</span></div></div><p>An OAuth 2.0 client application can thus make simplify the user
  experience on the phone to authorizing access.</p><div class="mediaobject" align="center"><a name="figure-oauth2-phone"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/oauth2-phone.png" align="middle" height="360" alt="OAuth 2.0 mobile application demonstration"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-oauth2-phone.html" target="longdesc">D</a>]</span></div></div><p>In addition to serving as an identity provider, OpenAM can also
  function as an OAuth 2.0 client, protecting access to resources within
  your control based on authorization granted by an identity provider who
  users already know and use, such as Facebook, Google, MSN and others.
  OpenAM's built in authorization policy management makes it
  straightforward to integrate this capability into your
  applications.</p><p>The OAuth and OpenID Connect standards specify REST interfaces,
  making them essentially programming language-independent and accessible
  for web applications and mobile applications alike.</p><p>
   Mobile Connect is an application of OpenID Connect
   that enables authentication to work through a mobile phone,
   regardless of the service provided or the device consuming the service.
   Mobile Connect therefore allows Mobile Network Operators
   to act as an identity provider for their customers.
   OpenAM fits well in Mobile Connect deployments as it can play
   both the role of OpenID Provider and also of Authenticator,
   with many authentication modules built in as described in
   <a class="xref" href="#mobile-oath" title="7.2.&nbsp;Protecting Access for Mobile Users">Section&nbsp;7.2, &#8220;Protecting Access for Mobile Users&#8221;</a>.
   For details on using OpenAM in a Mobile Connect installation, see
   <a href="../admin-guide/index.html#mobile-connect" class="link"><em class="citetitle">Using OpenAM with Mobile Connect</em></a>.
  </p><p>OpenAM also supports <a class="link" href="http://www.openauthentication.org/" target="_blank">Open Authentication</a> architecture with the OATH module
  mentioned in the next section.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="mobile-oath"></a>7.2.&nbsp;Protecting Access for Mobile Users</h2></div></div></div><p>You must give users access to your organization's resources while
  they are on the go. At the same time you must manage risk. OpenAM
  supports risk-based adaptive authentication, device fingerprints,
  one-time passwords and other multi-factor authentication capabilities
  that help you do both. As OpenAM handles authentication through
  plugin modules that you can chain, your OpenAM service can meet a
  variety of requirements.</p><p>OpenAM's <a href="../admin-guide/index.html#adaptive-auth-module-conf-hints" class="link">Adaptive Risk authentication
  module</a> lets you add risk assessment to any authentication module
  chain, dynamically requiring stronger authentication when circumstances
  require it (new location, ancient last login time, new device, new IP address,
  specific application, and so forth). You can add the <span class="olink">Device Print module</span>
  to an authentication chain to fingerprint users' devices for additional risk
  assessment, making it easier to handle sign-on when users bring their
  own devices.</p><div class="mediaobject" align="center"><a name="figure-adaptive-auth-module-again"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/adaptive-auth-module.png" align="middle" height="360" alt="Including the Adaptive Risk module in an authentication chain"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-adaptive-auth-module-again.html" target="longdesc">D</a>]</span></div></div><p>OpenAM also lets you decide exactly what stronger authentication
  means in your situation. You can for example add multi-factor
  authentication involving mobile devices using OpenAM's <a href="../admin-guide/index.html#OATH-module-conf-hints" class="link">OATH</a> and <a href="../admin-guide/index.html#hotp-module-conf-hints" class="link">HOTP</a>
  modules either to use a one-time password soft token generated on a
  device, or to send a one-time password in a text message to a mobile
  phone.</p><p>In addition to capabilities supporting new applications, OpenAM
  integrates well with existing systems needed by users on the move.
  Whether users are authenticating from a mobile device through a gateway
  using an MSISDN, starting single sign-on by logging on to a laptop, or
  connecting to a VPN with certificate based authentication, OpenAM has an
  authentication module for that.</p><div class="mediaobject" align="center"><a name="figure-openam-modules"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/openam-modules.png" align="middle" height="360" alt="OpenAM authentication modules"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-openam-modules.html" target="longdesc">D</a>]</span></div></div><p>All of these capabilities are available with OpenAM out of the
  box.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="mobile-rest"></a>7.3.&nbsp;Simplifying Access with REST APIs</h2></div></div></div><p>Representational State Transfer (REST) is a architectural style
  designed in parallel with HTTP. REST simplifies integration and
  deployment while enabling layered, web-scale services. REST APIs in OpenAM
  implement REST in a way that reuses common HTTP verbs and decouples APIs
  from the programming languages that developers use to interact with them.
  OpenAM exposes REST APIs for many capabilities such as those in the following
  list.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Authentication (including a callback mechanism so applications can
    work with all OpenAM authentication modules)</p></li><li class="listitem"><p>Logout</p></li><li class="listitem"><p>Managing groups</p></li><li class="listitem"><p>Managing policy agent profiles</p></li><li class="listitem"><p>Managing realms</p></li><li class="listitem"><p>Managing user profiles</p></li><li class="listitem"><p>OAuth 2.0 authorization</p></li><li class="listitem"><p>OpenAM native authorization</p></li><li class="listitem"><p>OpenID Connect 1.0 authorization</p></li><li class="listitem"><p>Resetting forgotten passwords</p></li><li class="listitem"><p>Token validation</p></li><li class="listitem"><p>User self-registration</p></li></ul></div><div class="mediaobject" align="center"><a name="figure-openam-single"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/openam-single.png" align="middle" height="360" alt="OpenAM capabilities in a single image"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-openam-single.html" target="longdesc">D</a>]</span></div></div><p>As <a href="../dev-guide/index.html#chap-rest" class="link">OpenAM REST APIs</a>
  provide language-independent access, they make it easier to build cross-device
  applications. Developers can use the same APIs to access OpenAM both from
  web applications and also from native mobile applications.</p><p>Furthermore OpenAM REST APIs are built on an underlying common
  REST framework, designed to provide common access to resource providers.
  The common REST framework standardizes both how resource providers serve
  standard requests (create, read, update, delete, query, patch), and also
  how resource providers offer extended operations in a managed way (using
  actions). Applications built to interact with OpenAM REST APIs
  increasingly can interoperate with other products in the ForgeRock stack
  such as <a class="link" href="http://forgerock.com/what-we-offer/open-identity-stack/openidm/" target="_blank">OpenIDM for identity management</a> and <a class="link" href="http://forgerock.com/what-we-offer/open-identity-stack/opendj/" target="_blank">OpenDJ for highly available data</a>.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="get-mobile-sample-apps"></a>7.4.&nbsp;Getting Source Code for Sample Mobile Applications</h2></div></div></div><p>
   You can get source code for sample mobile applications
   from ForgeRock's public source code repository under
   <code class="literal">https://svn.forgerock.org/commons/samples/mobile</code>.
  </p><p>
   For example, if you have a Mac running OS X 10.8 or later
   with Xcode installed, try the <a class="link" href="http://commons.forgerock.org/samples/mobile/ios/openam-ios-oauth2-sample-app/" target="_blank">OpenAM OAuth 2.0 iOS Sample App</a>.
  </p><div class="mediaobject" align="center"><a name="figure-ios-oauth2-sample-app"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/ios-oauth2-sample-app.png" align="middle" height="360" alt="OpenAM OAuth 2.0 iOS Sample App"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-ios-oauth2-sample-app.html" target="longdesc">D</a>]</span></div></div></div></div><div lang="en" class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="chap-pwd-reset"></a>Chapter&nbsp;8.&nbsp;Configuring User Self-Service Features</h1></div></div></div><div class="toc"><div class="toc-title">Table of Contents</div><dl class="toc"><dt><span class="section"><a href="#user-self-registration">8.1. Configuring User Self-Registration</a></span></dt><dt><span class="section"><a href="#about-pwd-reset">8.2. About Password Reset</a></span></dt><dt><span class="section"><a href="#forgotten-pwd-reset">8.3. Resetting Forgotten Passwords (Legacy)</a></span></dt></dl></div><a class="indexterm" name="d16037e22895"></a><p>This chapter focuses on how to enable OpenAM features that allow users
  to self register from the Login page and reset their own
  passwords in secure fashion.
 </p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="user-self-registration"></a>8.1.&nbsp;Configuring User Self-Registration</h2></div></div></div><p>
   OpenAM provides a self-registration feature that allows users to add
   themselves to the system.
   On the Login page, the user clicks a Register link, which sends a request to
   the OpenAM server. OpenAM responds to request by sending a
   Register Your Account page where the user enters his or her email address.
  </p><p>
   After the user enters his or her email, OpenAM responds by sending a
   notification containing a confirmation link to the user's email address.
   When the user clicks the link, OpenAM confirms the operation and presents the user
   with a registration page where the user enters their account information.
  </p><div class="procedure"><a name="configure-user-self-registration"></a><div class="procedure-title">Procedure&nbsp;8.1.&nbsp;To Configure User Self-Registration</div><ol class="procedure" type="1"><li class="step"><p>Configure the Email Service to send mail
     notifications to users who self-register.
    </p><p>
     You can configure these globally
     in OpenAM console at Configuration &gt; Global &gt; Email Service.
     Alternatively, you can configure them for an individual realm under
     Access Control &gt; <em class="replaceable"><code>Realm Name</code></em> &gt; Services.</p></li><li class="step"><p>Configure User Self Service to enable self-registration.
    </p><p>
     You can configure these globally in OpenAM console at
     Configure &gt; Global &gt; User Self Service. On the User Self Service page, click
     the <code class="literal">Enabled</code> checkbox next to Self-Registration for Users,
     and then click Save.
    </p></li></ol></div><p>
   At this point users can self-register by clicking a Register link on the
   Login page.
  </p><div class="mediaobject" align="center"><a name="figure-user-self-register-login"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/user-self-register-login.png" align="middle" height="360" alt="User Self-Registration link"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-user-self-register-login.html" target="longdesc">D</a>]</span></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="about-pwd-reset"></a>8.2.&nbsp;About Password Reset</h2></div></div></div><p>Users who know their passwords, but must reset them because for example
   the password is going to expire, can reset their passwords by successfully
   authenticating to OpenAM, visiting their end user pages, such as
   <code class="literal">http://openam.example.com:8080/openam/XUI/#profile/</code>, and
   clicking Change Security Data to display the change password page.</p><div class="figure"><a name="figure-console-change-pwd-xui"></a><div class="figure-title">Figure&nbsp;8.1.&nbsp;OpenAM Security Data Change page</div><div class="figure-contents"><div class="mediaobject" align="center"><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/console-change-pwd-xui.png" align="middle" height="360" alt="OpenAM Change Password page"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="ld-d16037e22947.html" target="longdesc">D</a>]</span></div></div></div></div><br class="figure-break"><p>You therefore do not need to configure password reset for users
  who can remember their current password. Instead, you point them to the
  <code class="literal">XUI/#profile</code> page to let them do it themselves.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="forgotten-pwd-reset"></a>8.3.&nbsp;Resetting Forgotten Passwords (Legacy)</h2></div></div></div><p>
   OpenAM can provide self-service password reset for forgotten passwords
   when end user pages are served by the classic UI.
   To enable self-service password reset, you must configure the password
   reset service itself, which consists mainly of setting up secret questions,
   and configuring an SMTP mail server to send reset passwords to the users
   of the service.
  </p><div class="tip"><h3 class="title">Tip</h3><p>Users must be able to access their mail after the service resets
   their passwords, or they will not be able to receive the new password.
   Therefore, do not set up the service to reset the password used to access
   the email account specified in the user's profile.</p></div><div class="procedure"><a name="set-up-pwd-reset-service"></a><div class="procedure-title">Procedure&nbsp;8.2.&nbsp;To Set Up the Password Reset Service</div><p>You can configure the password reset service for OpenAM, letting
   each realm inherit the global settings. Alternatively, you can choose to
   configure the service only for an individual realm.</p><div class="tip"><h3 class="title">Tip</h3><p>
     Resetting a user password can have repercussions on the user profile.
     For example, a user data store directory service
     could enforce a policy to require password changes on reset.
     OpenAM's LDAP authentication module can deal with policies
     based on the Behera Internet-Draft,
     <a class="link" href="http://tools.ietf.org/html/draft-behera-ldap-password-policy-09" target="_blank">Password Policy for LDAP Directories</a>,
     though its default DataStore authentication module cannot.
    </p><p>
     When the user data store directory service
     enforces password reset policies,
     then either use the LDAP authentication module
     in the authentication chain,
     or rely on some other means of resetting user passwords.
    </p></div><ol class="procedure" type="1"><li class="step"><p>Configure the Password Reset service in one of the following ways.</p><ul class="stepalternatives">
     <li class="step"><p>To configure the service globally for all realms, login to OpenAM
      Console as administrator and browse to Configuration &gt; Global &gt;
      Password Reset in the Global Properties list.</p></li>

     <li class="step"><p>To configure the service for a particular realm, login to OpenAM
      console as the realm administrator and browse to Access Control &gt;
      <em class="replaceable"><code>Realm Name</code></em> &gt; Services, then click Add...
      to add a new Password Reset service configuration.</p></li>
    </ul></li><li class="step"><p>In the Password Reset page, use the following hints to adjust
    settings, and then save your work.</p><p>In addition to the User Validation and Secret Question values
    provided, you must configure at least the Bind DN and Bind Password
    of the user who can reset passwords in the LDAP data store.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">User Validation</span></dt><dd><p>OpenAM uses this LDAP attribute and the value entered by the
       user to look up the user profile in the data store.</p></dd><dt><span class="term">Secret Question</span></dt><dd><p>This list corresponds to property values held in the file
       <code class="filename">amPasswordReset.properties</code> inside
       <code class="filename">openam-core-12.0.0.jar</code>, which you can find
       under <code class="filename">WEB-INF/lib/</code> where OpenAM is installed.</p><p>To make changes, extract a version from
       <code class="filename">openam-core-12.0.0.jar</code>, copy it to
       <code class="filename">WEB-INF/classes/</code> where OpenAM is deployed, and
       then edit
       <code class="filename">WEB-INF/classes/amPasswordReset.properties</code>.</p><p>Localized versions of this file are named
       <code class="filename">amPasswordReset_<em class="replaceable"><code>locale</code></em>.properties</code>.
       You should localize only the questions at the end, leaving the rest of
       the localized file as is. For example if the default properties file
       contains:</p><pre class="literallayout">favourite-restaurant=What is your favorite restaurant?</pre><p>Then <code class="filename">WEB-INF/classes/amPasswordReset_fr.properties</code>
       ought to contain:</p><pre class="literallayout">favourite-restaurant=Quel est votre restaurant pr&eacute;f&eacute;r&eacute; ?</pre><p>After changing these files, you must restart OpenAM.</p></dd><dt><span class="term">Search Filter</span></dt><dd><p>An additional LDAP search filter you specify here is &amp;-ed
       with the filter constructed for user validation to find the user
       entry in the data store.</p></dd><dt><span class="term">Base DN</span></dt><dd><p>If you specify no base DN for the search, the search for the user
       entry starts from the base DN for the realm.</p></dd><dt><span class="term">Bind DN</span></dt><dd><p>The DN of the user with access to change passwords in the
       LDAP data store.</p></dd><dt><span class="term">Bind Password</span></dt><dd><p>The password of the user with access to change passwords in the
       LDAP data store.</p></dd><dt><span class="term">Reset Password Creator</span></dt><dd><p>Classname of a plugin that implements the
       <code class="literal">PasswordGenerator</code> interface.</p><p>Default: <code class="literal">com.sun.identity.password.plugins.RandomPasswordGenerator</code></p></dd><dt><span class="term">Password Reset Notification Class</span></dt><dd><p>Classname of a plugin that implements the
       <code class="literal">NotifyPassword</code> interface.</p><p>Default: <code class="literal">com.sun.identity.password.plugins.EmailPassword</code></p></dd><dt><span class="term">Password Reset</span></dt><dd><p>Enables the service.</p></dd><dt><span class="term">Personal Question</span></dt><dd><p>When enabled, allows the user to create custom secret
       questions.</p></dd><dt><span class="term">Maximum Number of Questions</span></dt><dd><p>Maximum number of questions to ask during password reset.</p></dd><dt><span class="term">Force Change Password on Next Login</span></dt><dd><p>When enabled, the user must change her password next time she
       logs in after OpenAM resets her password.</p></dd><dt><span class="term">Password Reset Failure Lockout</span></dt><dd><p>When enabled, the user only gets the specified number of tries
       before her account is locked.</p></dd><dt><span class="term">Password Reset Failure Lockout Count</span></dt><dd><p>If Password Reset Failure Lockout is enabled, this specifies the
       maximum number of tries to reset a password within the specified
       interval before the user's account is locked.</p></dd><dt><span class="term">Password Reset Failure Lockout Interval</span></dt><dd><p>This interval applies when Password Reset Failure Lockout is
       enabled, and when Password Reset Failure Lockout Count is set. During
       this interval, a user can try to reset her password the specified
       number of times before being locked out. For example, if this interval
       is 5 minutes and the count is set to 3, a user gets 3 tries during
       a given 5 minute interval to reset her password.</p></dd><dt><span class="term">Email Address to Send Lockout Notification</span></dt><dd><p>This specifies the administrator address(es) which receive(s)
       notification on user account lockout. Each address must be a full
       email address such as <code class="literal">admin@example.com</code>, or
       <code class="literal">admin@host.domain</code>.</p><p>OpenAM must be able to send mail through an SMTP-capable service
       for this to work. See <a class="xref" href="#set-up-mail-notification" title="Procedure&nbsp;8.3.&nbsp;To Set Up SMTP Mail Notification">Procedure&nbsp;8.3, &#8220;To Set Up SMTP Mail Notification&#8221;</a>.</p></dd><dt><span class="term">Warn User After N Failures</span></dt><dd><p>If you configure Password Reset Failure Lockout, set this to
       warn users who are about to use up their count of tries.</p></dd><dt><span class="term">Password Reset Failure Lockout Duration</span></dt><dd><p>If you configure Password Reset Failure Lockout, set this to a
       number of minutes other than <code class="literal">0</code> so that lockout is
       temporary, requiring only that the locked-out user wait to try again
       to reset her password, rather than necessarily require help from
       an administrator.</p></dd><dt><span class="term">Password Reset Lockout Attribute Name</span></dt><dd><p>If you configure Password Reset Failure Lockout, then OpenAM sets
       sets data store attribute to <code class="literal">inactive</code> upon
       lockout.</p></dd><dt><span class="term">Password Reset Lockout Attribute Value</span></dt><dd><p>If set to <code class="literal">inactive</code>, then a user who is locked
       out cannot attempt to reset her password if the Password Reset
       Failure Lockout Duration is <code class="literal">0</code>.</p></dd><dt><span class="term">Password Reset E-mail Attribute Name</span></dt><dd><p>Identity attribute that holds the user's email address.</p><p>Default: <code class="literal">mail</code></p></dd></dl></div></li><li class="step"><p>If you changed Secret Questions in the
    <code class="filename">WEB-INF/classes/amPasswordReset.properties</code> file or in
    any localized versions, restart OpenAM for the changes to take
    effect.</p></li></ol></div><div class="procedure"><a name="set-up-mail-notification"></a><div class="procedure-title">Procedure&nbsp;8.3.&nbsp;To Set Up SMTP Mail Notification</div><p>By default, OpenAM expects the SMTP service to listen on
   <code class="literal">localhost:25</code>. You can change these settings.</p><ol class="procedure" type="1"><li class="step"><p>In the OpenAM console, click the Configuration &gt; Servers and
    Sites &gt; Default Server Settings.</p></li><li class="step"><p>In the Edit server-default page, scroll down to Mail Server to
    change the Mail Server Host Name or Mail Server Port Number.</p></li><li class="step"><p>Save your work.</p></li><li class="step"><p>By default, OpenAM sends password reset notifications from
    <code class="literal">&lt;Password-Administrator&gt;</code>.</p><p>To set a valid from address, extract
    <code class="filename">amPasswordResetModuleMsgs.properties</code> from
    <code class="filename">openam-core-12.0.0.jar</code>, copy it to
    <code class="filename">WEB-INF/classes/</code> where OpenAM is deployed, and then
    edit the file to change the <code class="literal">fromAddress.label</code> property
    value, as in the following example.</p><pre class="literallayout">fromAddress.label=no-reply@example.com</pre><p>Save your work, and then restart OpenAM for the properties file change
    to take effect.</p></li></ol></div><div class="procedure"><a name="prepare-users-for-pwd-reset"></a><div class="procedure-title">Procedure&nbsp;8.4.&nbsp;To Prepare Users to Reset Passwords</div><p>Before a user can reset her password, she must choose answers for
   secret questions.</p><ol class="procedure" type="1"><li class="step"><p>When her account is first created, direct the user to her
    <code class="literal">idm/EndUser</code> page, such as
    <code class="literal">http://openam.example.com:8080/openam/idm/EndUser</code>,
    where she can provide a valid email address to recover the reset password
    and can edit Password Reset Options.</p><div class="mediaobject" align="center"><a name="figure-console-end-user"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/console-end-user.png" align="middle" height="360" alt="The OpenAM end user page"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-console-end-user.html" target="longdesc">D</a>]</span></div></div><p>By default OpenAM console redirects end users to this page when
    they login.</p></li><li class="step"><p>After the user updates her secret questions, she can use the
    password reset service when necessary.</p><div class="mediaobject" align="center"><a name="figure-console-secret-questions"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/console-secret-questions.png" align="middle" height="360" alt="The OpenAM secret question page"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-console-secret-questions.html" target="longdesc">D</a>]</span></div></div><div class="note"><h3 class="title">Note</h3><p>Answers to secret questions are case sensitive.</p></div></li></ol></div><div class="procedure"><a name="redirect-to-reset-pwd"></a><div class="procedure-title">Procedure&nbsp;8.5.&nbsp;To Direct Users to Reset Passwords</div><p>Having setup her email and answers to secret questions, the user
   can use the reset password service.</p><p>Create a test subject and use these steps to validate your
   configuration.</p><ol class="procedure" type="1"><li class="step"><p>Send the user with a forgotten password to enter her user ID at
    the password reset URL.</p><p>If the user is in the default realm use <code class="literal">password</code>
    at the end of the URL to OpenAM, as in
    <code class="literal">http://openam.example.com:8080/openam/password</code>.</p><p>If the password reset service is enabled only for the user's realm
    and not the parent realm, or the realm to reset the password is different
    from the user's default realm, use <code class="literal">ui/PWResetUserValidation?realm=<em class="replaceable"><code>realm
    name</code></em>, as in</code>
    <code class="literal">http://openam.example.com:8080/openam/ui/PWResetUserValidation?realm=<em class="replaceable"><code>realm
    name</code></em></code>.</p><div class="mediaobject" align="center"><a name="figure-console-user-validation"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/console-user-validation.png" align="middle" height="360" alt="The OpenAM user validation page"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-console-user-validation.html" target="longdesc">D</a>]</span></div></div></li><li class="step"><p>The user answers the specified questions, and clicks OK.</p><p>OpenAM resets the password, sending mail to the SMTP service
    you configured.</p><div class="mediaobject" align="center"><a name="figure-console-answer-questions"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/console-answer-questions.png" align="middle" height="360" alt="The OpenAM user validation page"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-console-answer-questions.html" target="longdesc">D</a>]</span></div></div><p>When the user clicks OK, OpenAM sends the email and shows a
    confirmation message.</p><p>The user receives the email with a line such as the following.</p><pre class="literallayout">Your OpenAM password was changed to:  647bWluw</pre></li><li class="step"><p>The user logs in using the new password.</p><p>If you configured the system to force a change on password reset,
    then OpenAM requires the user to change her password.</p></li></ol></div></div></div><div lang="en" class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="chap-sso"></a>Chapter&nbsp;9.&nbsp;Configuring Single Sign-On within One Domain</h1></div></div></div><div class="toc"><div class="toc-title">Table of Contents</div><dl class="toc"><dt><span class="section"><a href="#sso-cookies">9.1. The Basics of the HTTP Cookie</a></span></dt><dt><span class="section"><a href="#sso-process">9.2. Cookies and the SSO Session Process</a></span></dt><dt><span class="section"><a href="#sso-problems">9.3. Potential Problems</a></span></dt><dt><span class="section"><a href="#configure-sso-one-domain">9.4. Configure SSO on One Domain</a></span></dt></dl></div><p>This chapter describes the configuration of <em class="firstterm">Single Sign-On</em> (SSO) services for
        multiple resources on one domain. To understand how SSO works, you need to understand some key elements of the
        HTTP cookie, as described in RFC 6525, <a class="link" href="http://tools.ietf.org/html/rfc6265" target="_blank">
        HTTP State Management Mechanism</a>.</p><a class="indexterm" name="d16037e23368"></a><p>With SSO a user can access multiple independent services from a single session.</p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sso-cookies"></a>9.1.&nbsp;The Basics of the HTTP Cookie</h2></div></div></div><p>Within an HTTP cookie, you can store a single custom
        <code class="literal"><em class="replaceable"><code>name</code></em>=<em class="replaceable"><code>value</code></em></code> pair, such as
        <code class="literal"><em class="replaceable"><code>sessionid</code></em>=<em class="replaceable"><code>value</code></em></code>.
        Other custom names within a cookie are as follows.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Domain</span></dt><dd><p>Normally set to the domain from where the cookie was issued. To work with multiple subdomains,
                    the <code class="varname">Domain</code> should be set to a URL like
                    <code class="varname">Domain</code><code class="literal">=example.net</code>. This is also known as the cookie domain,
                    as defined in the
                    <a href="../reference/index.html#chap-config-ref" class="link">
                    <em class="citetitle">Configuration Reference</em></a> chapter of the Reference document.
                    A cookie domain set to <code class="literal">example.net</code> will work for subdomains such as
                    <code class="literal">app1.example.net</code> and <code class="literal">service1.example.net</code>.
                    </p></dd><dt><span class="term">Path</span></dt><dd><p>The directory in the URL to which the cookie applies. If the <code class="varname">Path</code>
                    <code class="literal">=/openam</code>, the cookie applies to the <code class="filename">/openam</code> subdirectory of
                    the FQDN, and lower level directories, including <code class="filename">openam/UI</code> and
                    <code class="filename">openam/UI/Login</code>.</p></dd><dt><span class="term">Secure</span></dt><dd><p>If the <code class="varname">Secure</code> name is included, the cookie can be transferred only over
                    HTTPS. When a request is made over HTTP, the cookie is not made available to the application.</p></dd><dt><span class="term">HttpOnly</span></dt><dd><p>When the <code class="varname">HttpOnly</code> name is included, that cookie will not be accessible
                    through JavaScript. According to
                    <a class="link" href="http://tools.ietf.org/html/rfc6265#section-4.1.2.6" target="_blank">RFC 6265</a>,
                    the noted flag "instructs the user agent to omit the cookie when providing access to cookies via
                    'non-HTTP' APIs (such as a web browser API that exposes cookies to scripts)."</p></dd><dt><span class="term">Expires</span></dt><dd><p>The lifetime of a cookie can be limited, with an <code class="varname">Expires</code> name configured
                        with a time, based on UTC (GMT).</p></dd></dl></div><div class="note"><h3 class="title">Note</h3><p>Be careful. Do not take a shortcut with a top-level domain. Web browser clients today are designed to
            ignore cookies set to top-level domains including <code class="literal">com</code>, <code class="literal">net</code>, and
            <code class="literal">co.uk</code>. In addition, a cookie with a value like <code class="varname">Domain</code>=
            <code class="literal">app1.example.net</code> will not work for similar subdomains such as
            <code class="literal">app2.example.net</code>.</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sso-process"></a>9.2.&nbsp;Cookies and the SSO Session Process</h2></div></div></div><p>OpenAM uses cookies to track user sessions. The diagram shown next illustrates how OpenAM assigns and tracks
    cookies.</p><div class="itemizedlist"><p>In the diagram:</p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>The domain shown in the description is <code class="literal">example.net</code></p></li><li class="listitem"><p>The protected resource application can be found on <code class="literal">app.example.net</code></p></li><li class="listitem"><p>The OpenAM server is located on <code class="literal">sso.example.net</code>.</p></li></ul></div><div class="mediaobject" align="center"><a name="figure-sso-auth-flow"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/sso-auth-flow.png" align="middle" height="360" alt="SSO with Policy Agent"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-sso-auth-flow.html" target="longdesc">D</a>]</span></div></div><p>A client points his browser to a protected resource application. An agent on the
    application checks the client browser cookies for the presence of a session ID, a component of
    an SSO Token. If such a Session ID exists and is valid, the agent requests validation  (see arrow 8).</p><p>If no valid session ID currently exists, the agent redirects the client to OpenAM for authentication (AuthN).
    The client is then sent to OpenAM for AuthN. If the client submits valid credentials, the AuthN service
    creates a session cookie. The SSO Token and configured domain name is embedded in that cookie. OpenAM issues an HTTP
    redirect to send the client browser back to the protected resource. The SSO Token is actually a Java Object.</p><p>The agent then verifies the validity of the session with the OpenAM session service, before granting access.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sso-problems"></a>9.3.&nbsp;Potential Problems</h2></div></div></div><p>In general, problems with SSO relate to some sort of mismatch of domain names. For example, a cookie that is
    configured on a third-level domain such as <code class="literal">sso.example.net</code> will not work with an application on a
    similar domain such as <code class="literal">app.example.net</code>. Even if the Session ID is valid, the application will not
    receive the SSO Token. The request is then redirected to OpenAM. The client gets what appears as a SSO Token in the
    diagram, which is actually a valid SSO tracking cookie that redirects immediately, and the cycle continues.
    Other issues that may lead to similar problems are shown here.
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>When a cookie domain does not match a domain for the protected application</p><p>Assume the application is configured on a domain named <code class="literal">example.org</code>. That application
        will not receive an SSO Token configured on the <code class="literal">example.net</code> domain.</p></li><li class="listitem"><p>When a third-level domain is used for the SSO Token</p><p>If an SSO Token is configured on <code class="literal">sso.example.net</code>, an application on
        <code class="literal">app.example.net</code> does not receive the corresponding cookie. In this case, the solution is to
        configure the SSO Token on <code class="literal">example.net</code>.</p></li><li class="listitem"><p>When the <code class="varname">Secure</code> flag is used with a regular HTTP application</p><p>If you need encrypted communications for an application protected by OpenAM, use the
        <code class="varname">Secure</code> flag and make sure the application is accessible over HTTPS.</p></li><li class="listitem"><p>When the path listed in the cookie does not match the path for the application</p><p>Perhaps the cookie is configured with an <code class="filename">/helloworld</code> path; that won't match an
        application that might be configured with an <code class="filename">/hellomars</code> path. In that case, the application
        will not receive the cookie.</p></li><li class="listitem"><p>When an inappropriate name is used for the cookie domain</p><p>As noted earlier, client browsers are configured to ignore first-level domains such as
        <code class="literal">com</code> and <code class="literal">net</code> as well as functional equivalents such as
        <code class="literal">co.uk</code> and <code class="literal">co.jp</code>.</p></li><li class="listitem"><p>When working with different browsers</p><p>The <code class="literal"><em class="replaceable"><code>name</code></em></code>=<code class="literal"><em class="replaceable"><code>value</code></em></code>
        pairs described earlier may not apply to all browsers. The requirements for an HTTP cookie sent to an IE
        browser may differ from the requirements for other standard browsers such as Firefox and Chrome. Based on
        anecdotal reports, IE does not recognize domain names that start with a number. In addition, IE reportedly
        refuses cookies that include the underscore (_) character in the FQDN.</p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="configure-sso-one-domain"></a>9.4.&nbsp;Configure SSO on One Domain</h2></div></div></div><p>Now that you have read about the SSO process, you should be able to set it up on a server configured with
        OpenAM and a web service protected by an OpenAM agent. The following procedure assumes that you know how to
        configure OpenAM, the Apache Web server, and associated OpenAM Apache agent.</p><div class="procedure"><a name="sso-one-domain-procedure"></a><div class="procedure-title">Procedure&nbsp;9.1.&nbsp;Configure SSO on One Domain</div><ol class="procedure" type="1"><li class="step"><p>Install OpenAM as described in the <a href="../install-guide/index.html#install-guide" class="link"><em class="citetitle">OpenAM
            12.0.0 Installation Guide</em></a>. This procedure uses a Server URL of 
            <code class="literal">http://openam.example.net:8080/openam</code>.</p></li><li class="step"><p>
             Install the appropriate policy agent, as described in the
             <a class="link" href="http://docs.forgerock.org/en/openam-pa/3.3.0/web-users-guide/#web-users-guide" target="_blank"><em class="citetitle">OpenAM Web Policy Agent User's Guide</em></a>
             or the
             <a class="link" href="http://docs.forgerock.org/en/openam-pa/3.3.0/jee-users-guide/#jee-users-guide" target="_blank"><em class="citetitle">OpenAM Java EE Policy Agent User's Guide</em></a>.
             This procedure uses an agent URL of <code class="literal">http://app.example.net:80</code>,
             and an agent name of <code class="literal">webagent1</code>.
            </p></li><li class="step"><p>Make sure that both URLs are configured with IP addresses, as described in the chapter on
            <a href="../install-guide/index.html#chap-install-core" class="link">
            <em class="citetitle">Installing OpenAM Core Services</em></a>.</p></li><li class="step"><p>
             Return to the OpenAM server on <code class="literal">http://openam.example.net:8080/openam</code>. Log in as
             the administrative user, normally <code class="literal">amadmin</code>. To activate and configure the agent,
             follow the procedure described in the
             <a class="link" href="http://docs.forgerock.org/en/openam-pa/3.3.0/web-users-guide/#web-users-guide" target="_blank"><em class="citetitle">OpenAM Web Policy Agent User's Guide</em></a>
             or the
             <a class="link" href="http://docs.forgerock.org/en/openam-pa/3.3.0/jee-users-guide/#jee-users-guide" target="_blank"><em class="citetitle">OpenAM Java EE Policy Agent User's Guide</em></a>.
            </p></li><li class="step"><p>Now you can configure SSO Only mode. In the OpenAM console, click Access Control &gt;
                <em class="replaceable"><code>Realm Name</code></em> &gt; Agents &gt; <em class="replaceable"><code>webagent1</code></em>. Scroll down
                to SSO Only Mode and activate the Enabled box.</p></li><li class="step"><p>Save your changes.</p></li><li class="step"><p>Make sure you have configured the SSO domain, in this case, <code class="literal">example.net</code>. Click
            Configuration &gt; System &gt; Platform. Make sure <code class="literal">example.net</code> (or your chosen domain)
            is selected as a cookie domain.</p></li><li class="step"><p>Save your changes.</p></li><li class="step"><p>Restart the web server. The agent should be active. You should now be able to log out of the OpenAM
            server.</p></li><li class="step"><p>Verify the agent URL, in this case, <code class="literal">http://app.example.net</code>. The OpenAM
            web agent should now redirect requests to the OpenAM server.</p></li></ol></div><p>If you want to configure OpenAM and an application on two different cookie domains, such as <code class="literal">example.org
    </code> and <code class="literal">example.net</code>, you will need to set up Cross-Domain SSO (CDSSO). For more
        information, see the chapter on
        <a href="../admin-guide/index.html#chap-cdsso" class="link">
            <em class="citetitle">Configuring Cross-Domain Single Sign On</em></a>.</p></div></div><div lang="en" class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="chap-cdsso"></a>Chapter&nbsp;10.&nbsp;Configuring Cross-Domain Single Sign On</h1></div></div></div><p>This chapter shows you how to configure cross-domain single sign on
 (CDSSO). When you have multiple domains in a single organization, CDSSO lets
 your OpenAM servers in one domain work with policy agents from other
 domains.</p><p>CDSSO is an OpenAM-specific capability. For single sign on across
 multiple organizations or when integrating with other access management
 software, use OpenAM's federation capabilities.</p><a class="indexterm" name="d16037e23735"></a><p><em class="firstterm">Cross-domain single sign on</em> provides
 a safe mechanism for managing access across multiple different domains that
 you control. CDSSO lets OpenAM authenticate users redirected by policy agents
 in other DNS domains.</p><p>Single sign on depends on cookies to store session information. Yet for
 for security reasons, browsers do not let a web site in one domain to get
 access to a cookie from another domain. With CDSSO, the policy agents work
 around this by negotiating with OpenAM to allow access.</p><p>The Java EE policy agent allows CDSSO by using a mechanism to write
 the SSO token from OpenAM authentication to a cookie with the domain
 the host where the agent runs. The following sequence diagram illustrates
 this mechanism.</p><div class="mediaobject" align="center"><a name="figure-cdsso-jee-sequence"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/cdsso-jee-sequence.png" align="middle" height="360" alt="Java EE policy agent mechanism for CDSSO"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-cdsso-jee-sequence.html" target="longdesc">D</a>]</span></div></div><p>Whereas the Java EE policy agent has an endpoint specifically to handle
 the cookie domain translation, the web policy agent handles the request
 directly as shown in the following sequence diagram.</p><div class="mediaobject" align="center"><a name="figure-cdsso-web-sequence"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/cdsso-web-sequence.png" align="middle" height="360" alt="Web policy agent mechanism for CDSSO"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-cdsso-web-sequence.html" target="longdesc">D</a>]</span></div></div><div class="itemizedlist"><p>This chapter includes the following procedures.</p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="#enable-cdsso-jee-agent" title="Procedure&nbsp;10.1.&nbsp;To Enable CDSSO For a Java EE Policy Agent">Procedure&nbsp;10.1, &#8220;To Enable CDSSO For a Java EE Policy Agent&#8221;</a></p></li><li class="listitem"><p><a class="xref" href="#enable-cdsso-web-agent" title="Procedure&nbsp;10.2.&nbsp;To Enable CDSSO For a Web Policy Agent">Procedure&nbsp;10.2, &#8220;To Enable CDSSO For a Web Policy Agent&#8221;</a></p></li><li class="listitem"><p><a class="xref" href="#show-cdsso-login-progress" title="Procedure&nbsp;10.3.&nbsp;To Indicate Progress During CDSSO Login">Procedure&nbsp;10.3, &#8220;To Indicate Progress During CDSSO Login&#8221;</a></p></li><li class="listitem"><p><a class="xref" href="#enable-cdsso-cookie-hijacking-protection" title="Procedure&nbsp;10.5.&nbsp;To Protect Against Cookie Hijacking">Procedure&nbsp;10.5, &#8220;To Protect Against Cookie Hijacking&#8221;</a></p></li></ul></div><p>
  The federation mechanism associated with SAML 2.0 can be used
  as an alternative to CDSSO for both Web and Java EE policy agents.
  While using SAML 2.0 adds complexity, it supports attribute mapping,
  which may be useful when the two domains are associated
  with data stores that use different attribute names.
  See the section,
  <a href="../admin-guide/index.html#using-saml2-with-policy-agents" class="link"><em class="citetitle">SAML 2.0 &amp; Policy Agents</em></a>, for details.
 </p><div class="procedure"><a name="enable-cdsso-jee-agent"></a><div class="procedure-title">Procedure&nbsp;10.1.&nbsp;To Enable CDSSO For a Java EE Policy Agent</div><ol class="procedure" type="1"><li class="step"><p>In the OpenAM console, browse to Access Control &gt;
   <em class="replaceable"><code>Realm Name</code></em> &gt; Agents &gt; J2EE &gt;
   <em class="replaceable"><code>Agent Name</code></em> &gt; SSO.</p></li><li class="step"><p>Scroll down and enable Cross Domain SSO.</p></li><li class="step"><p>Check that the CDSSO Redirect URI is set.</p><p>Depending on where you deployed your Java EE agent application, the
   default is something like <code class="literal">/agentapp/sunwCDSSORedirectURI</code>.</p></li><li class="step"><p>Set the list of URLs for CDSSO Servlet URL to the Cross Domain
   Controller Servlet URLs of the servers the agent accesses, such as
   <code class="literal">http://openam.example.com:8080/openam/cdcservlet</code>.</p><p>If the agent accesses OpenAM through a load balancer, use the load
   balancer URLs, such as
   <code class="literal">http://load-balancer.example.com:8080/openam/cdcservlet</code>.</p></li><li class="step"><p>Leave the CDSSO Clock Skew set to 0.</p><p>Make sure instead that the clocks on the servers where you run OpenAM
   and policy agents are synchronized.</p></li><li class="step"><p>Set the list of URLs for CDSSO Trusted ID Provider to the Cross Domain
   Controller Servlet URLs of the OpenAM servers the agent accesses, such
   <code class="literal">http://openam.example.com:8080/openam/cdcservlet</code>.</p><p>This list should include one CDC Servlet URL for every OpenAM server
   the agent might access. You do not need to include site or load balancer
   URLs.</p></li><li class="step"><p>To protect the SSO token from network snooping, you can select CDSSO
   Secure Enable to mark the SSO token cookie as secure.</p><p>If you select this, then the SSO token cookie can only be sent over
   a secure connection (HTTPS).</p></li><li class="step"><p>Add the domains involved in CDSSO in the CDSSO Domain List.</p></li><li class="step"><p>If necessary, update the Agent Root URL for CDSSO list on the Global
   tab page.</p><p>If the policy agent is on a server with virtual host names, add the
   virtual host URLs to the list.</p><p>If the policy agent is behind a load balancer, add the load balancer
   URL to the list.</p></li><li class="step"><p>Save your work.</p></li></ol></div><div class="procedure"><a name="enable-cdsso-web-agent"></a><div class="procedure-title">Procedure&nbsp;10.2.&nbsp;To Enable CDSSO For a Web Policy Agent</div><ol class="procedure" type="1"><li class="step"><p>In the OpenAM console, browse to Access Control &gt;
   <em class="replaceable"><code>Realm Name</code></em> &gt; Agents &gt; Web &gt;
   <em class="replaceable"><code>Agent Name</code></em> &gt; SSO.</p></li><li class="step"><p>Enable Cross Domain SSO.</p></li><li class="step"><p>Set the list of URLs for CDSSO Servlet URL to the Cross Domain
   Controller Servlet URLs of the servers the agent accesses, such as
   <code class="literal">http://openam.example.com:8080/openam/cdcservlet</code>.</p><p>If the agent accesses OpenAM through a load balancer, use the load
   balancer URLs, such as
   <code class="literal">http://load-balancer.example.com:8080/openam/cdcservlet</code>.</p></li><li class="step"><p>Add the domains involved in CDSSO in the Cookies Domain List.</p></li><li class="step"><p>If necessary, update the Agent Root URL for CDSSO list on the Global
   tab page.</p><p>If the policy agent is on a server with virtual host names, add the
   virtual host URLs to the list.</p><p>If the policy agent is behind a load balancer, add the load balancer
   URL to the list.</p></li><li class="step"><p>Save your work.</p></li></ol></div><div class="procedure"><a name="show-cdsso-login-progress"></a><div class="procedure-title">Procedure&nbsp;10.3.&nbsp;To Indicate Progress During CDSSO Login</div><p>The default self-submitting form page that OpenAM presents to users
  contains hidden fields, but is otherwise blank. If you want to show users
  that the operation is in progress, then customize the necessary JSP.</p><ol class="procedure" type="1"><li class="step"><p>Edit a copy of the file
   <code class="filename">config/federation/default/cdclogin.jsp</code> to add a
   clue that SSO is in progress, such as an image.</p><p>You can find this file where you deployed OpenAM, such as
   <code class="filename">/path/to/tomcat/webapps/openam/config/federation/default/cdclogin.jsp</code>.</p><p>When you add an image or other presentation element, make sure that
   you retain the form and JavaScript as is.</p></li><li class="step"><p>Unpack OpenAM-12.0.0.war, and replace the file with your
   modified version.</p><p>Also include any images you reference in the page.</p></li><li class="step"><p>Pack up your custom version of OpenAM, and then deploy it in your
   web container.</p></li></ol></div><div class="procedure"><a name="access-cdsso-login-ui"></a><div class="procedure-title">Procedure&nbsp;10.4.&nbsp;To Access the CDSSO Authentication Login</div><p>When a client makes an access request to some protected resource in a cross
   domain single sign-on (CDSSO) deployment, the policy agent
   redirects the client to the Cross Domain Controller Servlet (CDCServlet) URL.
   The CDCServlet determines that the client needs to be authenticated and proxies
   the request through to an authentication interface, which typically is at <code class="literal">/UI/Login</code>:
  </p><pre class="literallayout">http://openam.example.com:8080/openam/UI/Login</pre><p>If your application requires access to a specific URL, you can use the
   <code class="literal">loginURI</code> parameter to do so.</p><ol class="procedure" type="1"><li class="step"><p>For example, you can access the previous authentication UI URL as follows:</p><pre class="literallayout">http://openam.example.com:8080/openam/cdcservlet?loginURI=/UI/Login</pre></li><li class="step"><p>If you have another authentication UI deployed at <code class="literal">/openam/customLoginURI</code>,
    you can access this URL at: </p><pre class="literallayout">http://openam.example.com:8080/openam/cdcservlet?loginURI=/customLoginURI</pre><p>
    In this case, you must also add the custom login URI to the whitelist
    that is specified by using
    the <code class="literal">org.forgerock.openam.cdc.validLoginURIs</code> property.
   </p><ol type="a" class="substeps"><li class="step"><p>
      In OpenAM console, browse to Configuration &gt; Servers and Sites &gt;
      Default Server Settings &gt; Advanced.
     </p></li><li class="step"><p>
      Add a property with the following settings.
     </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
        Property Name: <code class="literal">org.forgerock.openam.cdc.validLoginURIs</code>
       </p></li><li class="listitem"><p>
        Property Value: <code class="literal">/UI/Login,/customLoginURI</code>
       </p></li></ul></div></li><li class="step"><p>
      Save your changes.
     </p></li></ol><p>
    For more information about this property,
    see the <em class="citetitle">Reference</em> section on advanced properties,
    <a href="../reference/index.html#servers-advanced-configuration" class="link"><em class="citetitle">Servers &gt; Advanced</em></a>.
   </p></li></ol></div><div class="procedure"><a name="enable-cdsso-cookie-hijacking-protection"></a><div class="procedure-title">Procedure&nbsp;10.5.&nbsp;To Protect Against Cookie Hijacking</div><p>When cookies are set for an entire domain such as
  <code class="literal">.example.com</code>, an attacker who steals a cookie can use it
  from any host in the domain such as <code class="literal">untrusted.example.com</code>.
  Cookie hijacking protection restricts cookies to the fully-qualified domain
  name (FQDN) of the host where they are issued, such as
  <code class="literal">openam-server.example.com</code> and
  <code class="literal">server-with-agent.example.com</code>, using CDSSO to handle
  authentication and authorization.</p><p>For CDSSO with cookie hijacking protection, when a client successfully
  authenticates OpenAM issues the master SSO token cookie for its FQDN.
  OpenAM issues <em class="firstterm">restricted token</em> cookies for the
  other FQDNs where the policy agents reside. The client ends up with cookies
  having different session identifiers for different FQDNs, and the OpenAM
  server stores the correlation between the master SSO token and restricted
  tokens, such that the client only has one master session internally in
  OpenAM.</p><p>To protect against cookie hijacking you restrict the OpenAM server
  domain to the server where OpenAM runs. This sets the domain of the SSO token
  cookie to the host running the OpenAM server that issued the token. You also
  enable use of a unique SSO token cookie. For your Java EE policy agents, you
  enable use of the unique SSO token cookie in the agent configuration as
  well.</p><ol class="procedure" type="1"><li class="step"><p>In the OpenAM console, browse to Configuration &gt; System &gt;
   Platform.</p></li><li class="step"><p>
    Remove all domains from the Cookies Domains list,
    or if OpenAM is behind a load balancer, use the load balancer host name
    such as <code class="literal">load-balancer.example.com</code>.
   </p></li><li class="step"><p>Save your work.</p></li><li class="step"><p>In the OpenAM console, browse to Configuration &gt; Servers and Sites
   &gt; Default Server Settings &gt; Advanced, and then make the necessary
   changes.</p><ol type="a" class="substeps"><li class="step"><p>Change the setting for the property
     <code class="literal">com.sun.identity.enableUniqueSSOTokenCookie</code> to
     <code class="literal">true</code>, from the default <code class="literal">false</code>.</p></li><li class="step"><p>Make sure that the property
     <code class="literal">com.sun.identity.authentication.uniqueCookieName</code> is
     set to the name of the cookie that will hold the URL to the OpenAM server
     that authenticated the user.</p><p>The default name is <code class="literal">sunIdentityServerAuthNServer</code>.</p></li></ol><p>Save your work.</p></li><li class="step"><p>Browse to Configuration &gt; Servers and Sites &gt; <em class="replaceable"><code>Server
   Name</code></em> &gt; Advanced, and add the property
   <code class="literal">com.sun.identity.authentication.uniqueCookieDomain</code>,
   setting the value to the fully-qualified domain name of the current OpenAM
   server, such as <code class="literal">openam.example.com</code>.</p><p>Then Save your work.</p></li><li class="step"><p>For each Java EE policy agent, browse in the OpenAM console to Access
   Control &gt; <em class="replaceable"><code>Realm Name</code></em> &gt; Agents &gt; J2EE &gt;
   <em class="replaceable"><code>Agent Name</code></em> &gt; Advanced &gt; Custom Properties,
   and add <code class="literal">com.sun.identity.enableUniqueSSOTokenCookie=true</code>
   to the list.</p></li><li class="step"><p>Save your work.</p></li><li class="step"><p>Restart OpenAM or the container in which it runs for the configuration
   changes to take effect.</p></li></ol></div></div><div lang="en" class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="chap-federation"></a>Chapter&nbsp;11.&nbsp;Managing SAML 2.0 Federation</h1></div></div></div><div class="toc"><div class="toc-title">Table of Contents</div><dl class="toc"><dt><span class="section"><a href="#about-federation">11.1. About SAML 2.0 SSO &amp; Federation</a></span></dt><dt><span class="section"><a href="#set-up-federation">11.2. Setting Up SAML 2.0 SSO</a></span></dt><dt><span class="section"><a href="#configure-idp">11.3. Configuring Identity Providers</a></span></dt><dt><span class="section"><a href="#configure-sp">11.4. Configuring Service Providers</a></span></dt><dt><span class="section"><a href="#configure-cot">11.5. Configuring Circles of Trust</a></span></dt><dt><span class="section"><a href="#saml2-failover">11.6. Configuring Providers for Failover</a></span></dt><dt><span class="section"><a href="#google-apps-as-sp">11.7. Configuring Google Apps as a Remote Service Provider</a></span></dt><dt><span class="section"><a href="#salesforce-as-sp">11.8. Configuring Salesforce CRM as a Remote Service Provider</a></span></dt><dt><span class="section"><a href="#using-saml2-sso-slo">11.9. Using SAML 2.0 Single Sign-On &amp; Single Logout</a></span></dt><dt><span class="section"><a href="#saml2-ecp-config">11.10. Configuring OpenAM For the ECP Profile</a></span></dt><dt><span class="section"><a href="#federation-linking-accounts">11.11. Managing Federated Accounts</a></span></dt><dt><span class="section"><a href="#using-saml2-artifacts">11.12. Using SAML 2.0 Artifacts</a></span></dt><dt><span class="section"><a href="#using-saml2-with-policy-agents">11.13. SAML 2.0 &amp; Policy Agents</a></span></dt></dl></div><p>This chapter addresses how to set up and manage SAML 2.0 SSO for
 single sign on and single log out across resources belonging to
 organizations participating in a circle of trust.</p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="about-federation"></a>11.1.&nbsp;About SAML 2.0 SSO &amp; Federation</h2></div></div></div><a class="indexterm" name="d16037e24086"></a><p>SAML 2.0 SSO is part of federated access management. Federation lets
  access management cross organizational boundaries. Federation helps
  organizations share identities and services without giving away their
  identity information, or the services they provide.</p><p>To bridge heterogeneous systems, federation requires interoperability,
  and thus depends on standards for orchestrating interaction and exchanging
  information between providers. OpenAM federation relies on standards such as
  <a class="link" href="http://saml.xml.org/saml-specifications" target="_top">Security Assertion
  Markup Language (SAML) 2.0</a>. SAML 2.0 describes the messages, how they
  are relayed, how they are exchanged, and common use cases.</p><div class="itemizedlist"><p>To achieve SAML 2.0 SSO, OpenAM separates <em class="firstterm">identity
   providers</em> from <em class="firstterm">service providers</em>,
   lets you include them them in a <em class="firstterm">circle of trust</em>, and
   has you configure how the providers in the circle of trust interact.</p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>An identity provider stores and serves identity profiles, and
    handles authentication.</p></li><li class="listitem"><p>A service provider offers services that access protected
    resources, and handles authorization.</p></li><li class="listitem"><p>A circle of trust groups at least one identity provider and at least
    one service provider who agree to share authentication information, with
    assertions about authenticated users that let service providers make
    authorization decisions.</p><p>Providers in a circle of trust share <em class="firstterm">metadata</em>,
    configuration information that federation partners require to access each
    others' services.</p></li><li class="listitem"><p>SAML 2.0 SSO maps attributes from accounts at the identity provider to
    attributes on accounts at the service provider. The identity provider makes
    assertions to the service provider, for example to attest that a user has
    authenticated with the identity provider. The service provider then
    consumes assertions from the identity provider to make authorization
    decisions, for example to let an authenticated user complete a purchase
    that gets charged to the user's account at the identity provider.</p></li></ul></div><p>In federation deployments where not all providers support SAML 2.0,
  OpenAM can act as a multi-protocol hub, translating for providers who rely
  on other and older standards such as SAML 1.x, Liberty Alliance Project
  frameworks, and WS-Federation (for integration with Active Directory
  Federation Services, for example).</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="set-up-federation"></a>11.2.&nbsp;Setting Up SAML 2.0 SSO</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="#deploy-idp-discovery">11.2.1. Deploying the Identity Provider Discovery Service</a></span></dt></dl></div><div class="itemizedlist"><p>Before you set up SAML 2.0 SSO in OpenAM, you must:</p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Know which providers participate in the circle of trust.</p></li><li class="listitem"><p>Know how OpenAM installations act as identity providers, or
    service providers.</p></li><li class="listitem"><p>Agree with other providers on a synchronized time service.</p></li><li class="listitem"><p>For identity information exchanged with other participants in a
    circle of trust, define how to map shared user attributes. Local user
    profile attribute names should map to user profile attribute names at other
    providers.</p><p>For example, if you exchange user identifiers with your partners, and
    you call it <code class="literal">uid</code> whereas another partner calls it
    <code class="literal">userid</code>, then you map your <code class="literal">uid</code> to
    your partner's <code class="literal">userid</code>.</p></li><li class="listitem"><p>Import the keys used to sign assertions into the JKS key store in
    your OpenAM configuration directory. You can use the Java
    <span class="command"><strong>keytool</strong></span> command.</p><p>The OpenAM configuration key store is located at the top level of
    the configuration directory, such as
    <code class="filename">$HOME/openam/keystore.jks</code>. The password,
    stored in <code class="filename">$HOME/openam/.keypass</code>, is
    <code class="literal">changeit</code> by default. Also by default the only key
    available is for a self-signed certificate (alias: test) installed with
    OpenAM.</p></li></ul></div><p>During set up, you must share metadata for providers that you host
  with other providers in the circle of trust. You must also configure
  remote providers, connecting to other providers by importing their
  metadata.</p><p>In OpenAM terms, a hosted provider is one served by the current
  OpenAM server, whereas a remote provider is one hosted elsewhere.</p><div class="itemizedlist"><p>This section covers the following topics.</p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="#create-hosted-idp" title="Procedure&nbsp;11.1.&nbsp;To Create a Hosted Identity Provider">Procedure&nbsp;11.1, &#8220;To Create a Hosted Identity Provider&#8221;</a></p></li><li class="listitem"><p><a class="xref" href="#create-hosted-sp" title="Procedure&nbsp;11.2.&nbsp;To Create a Hosted Service Provider">Procedure&nbsp;11.2, &#8220;To Create a Hosted Service Provider&#8221;</a></p></li><li class="listitem"><p><a class="xref" href="#create-remote-idp" title="Procedure&nbsp;11.3.&nbsp;To Create a Remote Identity Provider">Procedure&nbsp;11.3, &#8220;To Create a Remote Identity Provider&#8221;</a></p></li><li class="listitem"><p><a class="xref" href="#create-remote-sp" title="Procedure&nbsp;11.4.&nbsp;To Create a Remote Service Provider">Procedure&nbsp;11.4, &#8220;To Create a Remote Service Provider&#8221;</a></p></li><li class="listitem"><p><a class="xref" href="#create-fedlet" title="Procedure&nbsp;11.5.&nbsp;To Create a Fedlet for Service Providers">Procedure&nbsp;11.5, &#8220;To Create a Fedlet for Service Providers&#8221;</a></p></li><li class="listitem"><p><a class="xref" href="#deploy-idp-discovery" title="11.2.1.&nbsp;Deploying the Identity Provider Discovery Service">Section&nbsp;11.2.1, &#8220;Deploying the Identity Provider Discovery Service&#8221;</a></p></li></ul></div><div class="procedure"><a name="create-hosted-idp"></a><div class="procedure-title">Procedure&nbsp;11.1.&nbsp;To Create a Hosted Identity Provider</div><a class="indexterm" name="d16037e24204"></a><ol class="procedure" type="1"><li class="step"><p>On the OpenAM console Common Tasks page, click Create Hosted Identity
    Provider.</p></li><li class="step"><p>Unless you already have metadata for the provider, accept the
    Name for this identity provider in the field provided, or provide your
    own unique identifier.</p><p>The default name is the URL to the current server which hosts the
    identity provider.</p></li><li class="step"><p>Select the Signing Key you imported into the OpenAM key store.</p></li><li class="step"><p>Either add the provider to the circle of trust you already created,
    or select Add to new and provide a New Circle of Trust name.</p></li><li class="step"><p>For the attributes you share, map service provider attribute names
    (Name in Assertion), to user profile names from your identity repository
    (Local Attribute Name).</p><p>
     Use this approach to set up a mapping with all SPs in the Circle of Trust
     that do not have their own specific mappings configured.
    </p><div lang="en" class="itemizedlist"><p>
  The default mapping implementation has additional features
  beyond simply retrieving string attributes from the user profile.
 </p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
   Add an attribute that takes a static value
   by enclosing the profile attribute name in double quotes (<code class="literal">"</code>).
  </p><p>
   For example, you can add a static SAML attribute
   called <code class="literal">partnerID</code>
   with a value of <code class="literal">staticPartnerIDValue</code>
   by adding <code class="literal">partnerID</code> as the Name in Assertion
   with <code class="literal">"staticPartnerIDValue"</code> as the Local Attribute Name.
  </p></li><li class="listitem"><p>
   Base64 encode binary attributes when adding them to the SAML attributes
   by adding <code class="literal">;binary</code> to the end of the attribute name,
   as in the following example:
  </p><pre class="literallayout">objectGUID=objectGUID;binary</pre><p>
   This maps the local binary attribute <code class="literal">objectGUID</code>
   to a SAML attribute called <code class="literal">objectGUID</code>
   that is Base64 encoded.
  </p></li><li class="listitem"><p>
   Use <code class="literal">NameFormatURI</code> format
   as shown in the following example:
  </p><pre class="literallayout">urn:oasis:names:tc:SAML:2.0:attrname-format:uri|objectGUID=objectGUID;binary</pre></li></ul></div></li><li class="step"><p>Click Configure to save your configuration.</p></li><li class="step"><p>Export the XML-based metadata from your provider to share
    with other providers in your circle of trust.</p><div class="screen"><pre>
$ <strong>curl \
 --output metadata.xml \
 "http://www.idp.example:8080/openam/saml2/jsp/exportmetadata.jsp?entityid=\
http://www.idp.example:8080/openam&amp;realm=/<em><strong>realm-name</strong></em>"</strong>
    </pre></div><p>When you have configured only the top-level realm,
    <code class="literal">/</code>, you can omit the query string.</p><p>Alternatively, provide the URL, to other providers so they can load
    the metadata.</p></li></ol></div><div class="procedure"><a name="create-hosted-sp"></a><div class="procedure-title">Procedure&nbsp;11.2.&nbsp;To Create a Hosted Service Provider</div><a class="indexterm" name="d16037e24300"></a><ol class="procedure" type="1"><li class="step"><p>On the OpenAM console Common Tasks page, click Create Hosted Service
    Provider.</p></li><li class="step"><p>Unless you already have metadata for the provider, accept the
    Name for this service provider in the field provided, or provide your
    own unique identifier.</p><p>The default name is the URL to the current server which hosts the
    service provider.</p></li><li class="step"><p>Either add the provider to the circle of trust you already created,
    or select Add to new and provide a New Circle of Trust name.</p></li><li class="step"><p>If the identity provider has not already mapped the attributes you
    share, map identity provider attribute names (Name in Assertion), to user
    profile names from your identity repository (Local Attribute Name).</p></li><li class="step"><p>Click Configure to save your configuration.</p></li><li class="step"><p>Export the XML-based metadata from your provider to share
    with other providers in your circle of trust.</p><div class="screen"><pre>
$ <strong>curl \
 --output metadata.xml \
 "http://www.sp.example:8080/openam/saml2/jsp/exportmetadata.jsp?entityid=\
http://www.sp.example:8080/openam&amp;realm=/<em><strong>realm-name</strong></em>"</strong>
    </pre></div><p>When you have configured only the top-level realm,
    <code class="literal">/</code>, you can omit the query string.</p><p>Alternatively, provide the URL, to other providers so they can load
    the metadata.</p></li></ol></div><div class="procedure"><a name="create-remote-idp"></a><div class="procedure-title">Procedure&nbsp;11.3.&nbsp;To Create a Remote Identity Provider</div><a class="indexterm" name="d16037e24343"></a><ol class="procedure" type="1"><li class="step"><p>Obtain the identity provider metadata, or the URL where you can
    obtain it.</p></li><li class="step"><p>On the OpenAM console Common Tasks page, click Register Remote
    Identity Provider.</p></li><li class="step"><p>Provide the identity provider metadata or link to obtain
    metadata.</p></li><li class="step"><p>Either add the provider to the circle of trust you already created,
    or select Add to new and provide a New Circle of Trust name.</p></li><li class="step"><p>Click Configure to save your configuration.</p></li></ol></div><div class="procedure"><a name="create-remote-sp"></a><div class="procedure-title">Procedure&nbsp;11.4.&nbsp;To Create a Remote Service Provider</div><a class="indexterm" name="d16037e24366"></a><ol class="procedure" type="1"><li class="step"><p>Obtain the service provider metadata, or the URL where you can
    obtain it.</p></li><li class="step"><p>On the OpenAM console Common Tasks page, click Register Remote Service
    Provider.</p></li><li class="step"><p>Provide the identity provider metadata or link to obtain
    metadata.</p></li><li class="step"><p>If the identity provider has not already mapped the attributes you
    share, map identity provider attribute names (Name in Assertion), to user
    profile names from your identity repository (Local Attribute Name).</p><p>
     Use this approach to set up a mapping that is specific to this SP.
    </p><div lang="en" class="itemizedlist"><p>
  The default mapping implementation has additional features
  beyond simply retrieving string attributes from the user profile.
 </p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
   Add an attribute that takes a static value
   by enclosing the profile attribute name in double quotes (<code class="literal">"</code>).
  </p><p>
   For example, you can add a static SAML attribute
   called <code class="literal">partnerID</code>
   with a value of <code class="literal">staticPartnerIDValue</code>
   by adding <code class="literal">partnerID</code> as the Name in Assertion
   with <code class="literal">"staticPartnerIDValue"</code> as the Local Attribute Name.
  </p></li><li class="listitem"><p>
   Base64 encode binary attributes when adding them to the SAML attributes
   by adding <code class="literal">;binary</code> to the end of the attribute name,
   as in the following example:
  </p><pre class="literallayout">objectGUID=objectGUID;binary</pre><p>
   This maps the local binary attribute <code class="literal">objectGUID</code>
   to a SAML attribute called <code class="literal">objectGUID</code>
   that is Base64 encoded.
  </p></li><li class="listitem"><p>
   Use <code class="literal">NameFormatURI</code> format
   as shown in the following example:
  </p><pre class="literallayout">urn:oasis:names:tc:SAML:2.0:attrname-format:uri|objectGUID=objectGUID;binary</pre></li></ul></div></li><li class="step"><p>Either add the provider to the circle of trust you already created,
    or select Add to new and provide a New Circle of Trust name.</p></li><li class="step"><p>Click Configure to save your configuration.</p></li></ol></div><div class="procedure"><a name="create-fedlet"></a><div class="procedure-title">Procedure&nbsp;11.5.&nbsp;To Create a Fedlet for Service Providers</div><a class="indexterm" name="d16037e24442"></a><p>When your organization acts as the identity provider, and you want
   quickly to enable service providers to federate their services with yours,
   you can provide them with a <em class="firstterm">fedlet</em>. A fedlet is
   a small Java or .NET web application that can act as a service provider for
   a specific identity provider without requiring that you install all of
   OpenAM.</p><p>Fedlets support the following SAML 2.0 features.</p><div class="table"><a name="fedlet-saml2-features"></a><div class="table-title">Table&nbsp;11.1.&nbsp;Fedlet Support for SAML 2.0 Features</div><div class="table-contents"><table summary="Fedlet Support for SAML 2.0 Features" border="0"><colgroup><col width="66%"><col width="17%"><col width="17%"></colgroup><thead><tr><th>SAML 2.0 Feature</th><th>Java Fedlet</th><th>.NET Fedlet</th></tr></thead><tbody><tr><td>IDP &amp; SP-initiated Single Sign-On (HTTP Artifact)</td><td>Supported</td><td>Supported</td></tr><tr><td>IDP &amp; SP-initiated Single Sign-On (HTTP POST)</td><td>Supported</td><td>Supported</td></tr><tr><td>IDP &amp; SP-initiated Single Logout (HTTP POST)</td><td>Supported</td><td>Supported</td></tr><tr><td>IDP &amp; SP-initiated Single Logout (HTTP Redirect)</td><td>Supported</td><td>Supported</td></tr><tr><td>Sign Requests &amp; Responses</td><td>Supported</td><td>Supported</td></tr><tr><td>Encrypt Assertion, Attribute, &amp; NameID Elements</td><td>Supported</td><td>Supported</td></tr><tr><td>Export SP Metadata</td><td>Supported</td><td>Supported</td></tr><tr><td>Attribute Queries</td><td>Supported</td><td>Supported</td></tr><tr><td>XACML Requests</td><td>Supported</td><td>Not supported</td></tr><tr><td>Multiple IDPs</td><td>Supported</td><td>Supported</td></tr><tr><td>External IDP Discovery Service</td><td>Supported</td><td>Supported</td></tr><tr><td>Bundled IDP Reader Service for Discovery</td><td>Supported</td><td>Not supported</td></tr></tbody></table></div></div><br class="table-break"><p>For more information on using fedlets, see <a href="../dev-guide/index.html#chap-fedlet-java" class="link"><em class="citetitle">Using Fedlets in
   Java Web Applications</em></a> and <a href="../dev-guide/index.html#chap-fedlet-dotnet" class="link"><em class="citetitle">Using Fedlets in
   .NET Applications</em></a> in the <em class="citetitle">Developer's
   Guide</em>.</p><p>The following procedure describes how to create a Java Fedlet.</p><ol class="procedure" type="1"><li class="step"><p>If you have not done so already, set up your identity provider.</p></li><li class="step"><p>Enter the URL where the service provider will deploy the fedlet you
    create, and name the fedlet. If you create multiple fedlets, use the URL
    as a unique name that shows who has deployed the fedlet.</p></li><li class="step"><p>For the attributes you share, map service provider attribute names
    (Name in Assertion), to user profile names from your identity repository
    (Local Attribute Name).</p></li><li class="step"><p>Click Create to generate the <code class="filename">Fedlet.zip</code>
    file under the OpenAM configuration directory, such as
    <code class="filename">$HOME/openam/myfedlets/httpwwwexamplecom80myapp/Fedlet.zip</code>.</p></li><li class="step"><p>Give the <code class="filename">Fedlet.zip</code> file to the service
    provider for deployment.</p></li></ol></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="deploy-idp-discovery"></a>11.2.1.&nbsp;Deploying the Identity Provider Discovery Service</h3></div></div></div><p>When your circle of trust includes multiple identity providers, then
   service providers must discover which identity provider corresponds to a
   request. You can deploy the identity provider discovery service for this
   purpose as a separate web application.</p><p>Browsers only send cookies for the originating domain. Therefore
   when a browser accesses the service provider in the <code class="literal">www.sp.example</code>
   domain, the service provider has no way of knowing whether the user has
   perhaps already authenticated at <code class="literal">www.this-idp.example</code> or at
   <code class="literal">www.that-idp.example</code>. The providers therefore host an identity
   provider discovery service in a common domain, such as
   <code class="literal">www.disco.example</code>, and use that service to discover where
   the user logged in. The identity provider discover service essentially
   writes and reads cookies from the common domain. The providers configure
   their circle of trust to use the identity provider discovery service
   as part of SAML 2.0 federation.</p><p>Deploying the identity provider discovery service involves the
   following stages.</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Deploy the .war file into your web application container.</p></li><li class="listitem"><p>Configure the discovery service.</p></li><li class="listitem"><p>Add the identity provider discovery service endpoints for writing
     cookies to and reading cookies from the common domain to the circle of
     trust configurations for the providers.</p></li><li class="listitem"><p>Share metadata between identity providers and the service
     provider.</p></li></ol></div><div class="procedure"><a name="deploy-idpdisco-on-tomcat"></a><div class="procedure-title">Procedure&nbsp;11.6.&nbsp;To Deploy the Discovery Service on Tomcat</div><p>How you deploy the discovery service .war file depends on your web
    application container. The procedure in this section shows how to deploy
    on Apache Tomcat.</p><ol class="procedure" type="1"><li class="step"><p>Copy the <code class="filename">IDPDiscovery-12.0.0.war</code> file to
     the <code class="filename">webapps/</code> directory.</p><div class="screen"><pre>
$ <strong>cp ~/Downloads/openam/IDPDiscovery-12.0.0.war \
 /path/to/tomcat/webapps/disco.war</strong>
     </pre></div></li><li class="step"><p>Access the configuration screen through your browser.</p><p>In this example, Apache Tomcat listens for HTTP requests on
     <code class="literal">www.disco.example:8080</code>, and Tomcat has unpacked the
     application under <code class="literal">/disco</code>, so the URL is
     <code class="literal">http://www.disco.example:8080/disco</code>, which redirects to
     <code class="filename">Configurator.jsp</code>.</p></li></ol></div><div class="procedure"><a name="configure-idpdisco-deployed"></a><div class="procedure-title">Procedure&nbsp;11.7.&nbsp;To Configure the Discovery Service</div><ol class="procedure" type="1"><li class="step"><p>Configure the identity provider discovery service.</p><div class="mediaobject" align="center"><a name="figure-idp-disco-config"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/idp-disco-config.png" align="middle" height="360" alt="Completed discovery service configuration screen"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-idp-disco-config.html" target="longdesc">D</a>]</span></div></div><p>Hints for discovery service configuration parameters follow.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Debug Directory</span></dt><dd><p>The discovery service logs to flat files in this directory.</p></dd><dt><span class="term">Debug Level</span></dt><dd><p>Default is <code class="literal">error</code>. Other options include
        <code class="literal">error</code>, <code class="literal">warning</code>,
        <code class="literal">message</code>, and <code class="literal">off</code>.</p><p>Set this to <code class="literal">message</code> in order to see the
        service working when you run your initial tests.</p></dd><dt><span class="term">Cookie Type</span></dt><dd><p>Set to PERSISTENT if you have configured OpenAM to use persistent
        cookies, meaning single sign on cookies that can continue to be valid
        after the browser is closed.</p></dd><dt><span class="term">Cookie Domain</span></dt><dd><p>The cookie domain is the common cookie domain used in your circle
        of trust for identity provider discovery, in this case
        <code class="literal">.disco.example</code>.</p></dd><dt><span class="term">Secure Cookie</span></dt><dd><p>Set this to true if clients should only return cookies when
        a secure connection is used.</p></dd><dt><span class="term">Encode Cookie</span></dt><dd><p>Leave this true unless your OpenAM installation requires that you
        do not encode cookies. Normally cookies are encoded such that cookies
        remain valid in HTTP.</p></dd><dt><span class="term">HTTP-Only Cookie</span></dt><dd><p>Set to true to use HTTPOnly cookies if needed to help prevent
        third-party programs and scripts from accessing the cookies.</p></dd></dl></div></li><li class="step"><p>Restrict permissions to the discovery service configuration file in
     <code class="filename">$HOME/libIDPDiscoveryConfig.properties</code>, where $HOME
     corresponds to the user who runs the web container where you deployed the
     service.</p></li></ol></div><div class="procedure"><a name="add-idpdisco-to-circle-of-trust"></a><div class="procedure-title">Procedure&nbsp;11.8.&nbsp;To Add the Discovery Service to Your Circles of Trust</div><p>Each provider has a circle of trust including itself. You configure
    each of these circles of trust to use the identity provider discovery
    service as described in the following steps.</p><ol class="procedure" type="1"><li class="step"><p>On the service provider console, login as OpenAM
     Administrator.</p></li><li class="step"><p>On the service provider console, under Federation &gt; Circle of
     Trust &gt; <em class="replaceable"><code>Circle of Trust Name</code></em>
     add SAML2 Writer and Reader Service URLs for the identity provider
     discovery service endpoints, and Save your work.</p><p>In this example, the writer URL is
     <code class="literal">http://www.disco.example:8080/disco/saml2writer</code>, and the
     reader URL is
     <code class="literal">http://www.disco.example:8080/disco/saml2reader</code>.</p></li><li class="step"><p>On each identity provider console, login as OpenAM
     Administrator.</p></li><li class="step"><p>On the identity provider console, under Federation &gt; Circle of
     Trust Configuration &gt; <em class="replaceable"><code>Circle of Trust Name</code></em>
     also add SAML2 Writer and Reader Service URLs for the identity provider
     discovery service endpoints, and Save your work.</p></li></ol></div><div class="procedure"><a name="share-idpdisco-sp-metadata"></a><div class="procedure-title">Procedure&nbsp;11.9.&nbsp;To Share Identity &amp; Service Provider Metadata</div><p>Before performing these steps, install the administration tools
    for each provider as described in <a href="../install-guide/index.html#install-openam-admin-tools" class="link"><em class="citetitle">To Set Up
    Administration Tools</em></a>. The administration tools include
    the <span class="command"><strong>ssoadm</strong></span> tool that you need to export metadata.</p><ol class="procedure" type="1"><li class="step"><p>On each identity provider console, register the service provider as
     a remote service provider adding to the circle of trust you configured
     to use the identity provider discovery service.</p><p>The URL to the service provider metadata is something like
     <code class="literal">http://www.sp.example:8080/openam/saml2/jsp/exportmetadata.jsp</code>.</p></li><li class="step"><p>Obtain metadata for each identity provider.</p><div class="screen"><pre>
$ <strong>ssh www.this-idp.example</strong>
$ <strong>cd /path/to/openam-tools/admin/openam/bin</strong>
$ <strong>./ssoadm \
 create-metadata-templ \
 --entityid "http://www.this-idp.example:8080/openam" \
 --adminid amadmin \
 --password-file /tmp/pwd.txt \
 --identityprovider /idp \
 --meta-data-file this-standard.xml \
 --extended-data-file this-extended.xml</strong>
<em>Hosted entity configuration was written to this-extended.xml.
Hosted entity descriptor was written to this-standard.xml.</em>

$ <strong>ssh www.that-idp.example</strong>
$ <strong>cd /path/to/openam-tools/admin/openam/bin</strong>
$ <strong>./ssoadm \
 create-metadata-templ \
 --entityid "http://www.that-idp.example:8080/openam" \
 --adminid amadmin \
 --password-file /tmp/pwd.txt \
 --identityprovider /idp \
 --meta-data-file that-standard.xml \
 --extended-data-file that-extended.xml</strong>

<em>Hosted entity configuration was written to that-extended.xml.
Hosted entity descriptor was written to that-standard.xml.</em>
     </pre></div></li><li class="step"><p>For each identity provider extended metadata file, change the value
     of the <code class="literal">hosted</code> attribute to <code class="literal">0</code>,
     meaning the identity provider is remote.</p></li><li class="step"><p>On the service provider, add the identity providers to the circle of
     trust using the identity provider metadata.</p><div class="screen"><pre>
$ <strong>ssh www.sp.example</strong>
$ <strong>cd /path/to/openam-tools/admin/openam/bin</strong>
$ <strong>./ssoadm \
 import-entity \
 --cot discocot \
 --meta-data-file ~/Downloads/this-standard.xml \
 --extended-data-file ~/Downloads/this-extended.xml \
 --adminid amadmin \
 --password-file /tmp/pwd.txt</strong>

<em>Import file, /Users/mark/Downloads/this-standard.xml.
Import file, /Users/mark/Downloads/this-extended.xml.</em>
$ <strong>./ssoadm \
 import-entity \
 --cot discocot \
 --meta-data-file ~/Downloads/that-standard.xml \
 --extended-data-file ~/Downloads/that-extended.xml \
 --adminid amadmin \
 --password-file /tmp/pwd.txt</strong>

<em>Import file, /Users/mark/Downloads/that-standard.xml.
Import file, /Users/mark/Downloads/that-extended.xml.</em>
     </pre></div></li><li class="step"><p>Test your work by using the Federation Connectivity Test that
     you start from the service provider console under Common Tasks &gt;
     Test Federation Connectivity.</p><p>When the test is done, you can see messages from the
     <code class="literal">CookieWriterServlet</code> in the
     <code class="filename">libIDPDiscovery</code> log file where you set up
     logging when you configured the identity provider discovery
     service, such as <code class="filename">/tmp/debug/libIDPDiscovery</code>.
     Output generated during a test follows, with some lines folded to fit
     on the printed page.</p><pre class="brush: plain;">
08/08/2012 11:43:38:341 AM CEST: Thread[http-bio-8080-exec-4,5,main]
CookieUtils.init : idpDiscoveryOnlyWar=true
08/08/2012 11:43:38:341 AM CEST: Thread[http-bio-8080-exec-4,5,main]
CookieWriterServlet Initializing...
08/08/2012 11:43:38:341 AM CEST: Thread[http-bio-8080-exec-4,5,main]
CookieWriterServlet.doGetPost: Preferred Cookie Name is _saml_idp
08/08/2012 11:43:38:341 AM CEST: Thread[http-bio-8080-exec-4,5,main]
CookieWriterServlet.doGetPost: URL Scheme is null, set to https.
08/08/2012 11:43:38:341 AM CEST: Thread[http-bio-8080-exec-4,5,main]
CookieWriterServlet.doGetPost: Preferred IDP Cookie Not found
08/08/2012 11:43:38:342 AM CEST: Thread[http-bio-8080-exec-4,5,main]
CookieWriterServlet.doGetPost: Cookie Type is PERSISTENT
08/08/2012 11:43:38:342 AM CEST: Thread[http-bio-8080-exec-4,5,main]
CookieWriterServlet.doGetPost: Cookie value is
 aHR0cDovL3d3dy50aGF0LWlkcC5jb206ODA4MC9vcGVuYW0=
08/08/2012 11:43:38:342 AM CEST: Thread[http-bio-8080-exec-4,5,main]
CookieWriterServlet.doGetPost: Preferred Cookie Name _saml_idp
08/08/2012 11:43:38:343 AM CEST: Thread[http-bio-8080-exec-4,5,main]
CookieWriterServlet.doGetPost: Redirect to
 http://www.that-idp.example:8080/openam/SSORedirect/metaAlias/idp?resInfoID=
 s28bc4db004f1365d78d07d69846c54a3c850fe801
08/08/2012 11:43:46:957 AM CEST: Thread[http-bio-8080-exec-4,5,main]
CookieWriterServlet.doGetPost: Preferred Cookie Name is _saml_idp
08/08/2012 11:43:46:957 AM CEST: Thread[http-bio-8080-exec-4,5,main]
CookieUtils:cookieValue=aHR0cDovL3d3dy50aGF0LWlkcC5jb206ODA4MC9vcGVuYW0=,
 result=aHR0cDovL3d3dy50aGF0LWlkcC5jb206ODA4MC9vcGVuYW0=
08/08/2012 11:43:46:957 AM CEST: Thread[http-bio-8080-exec-4,5,main]
CookieWriterServlet.doGetPost: Cookie Type is PERSISTENT
08/08/2012 11:43:46:957 AM CEST: Thread[http-bio-8080-exec-4,5,main]
CookieWriterServlet.doGetPost: Cookie value is
 aHR0cDovL3d3dy50aGF0LWlkcC5jb206ODA4MC9vcGVuYW0=
08/08/2012 11:43:46:957 AM CEST: Thread[http-bio-8080-exec-4,5,main]
CookieWriterServlet.doGetPost: Preferred Cookie Name _saml_idp
08/08/2012 11:43:46:957 AM CEST: Thread[http-bio-8080-exec-4,5,main]
CookieWriterServlet.doGetPost: Redirect to
 http://www.that-idp.example:8080/openam/SSORedirect/metaAlias/idp?resInfoID=
 s2ce9c465cf39c96f31e1dcf009cf9943695d82901
     </pre></li></ol></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="configure-idp"></a>11.3.&nbsp;Configuring Identity Providers</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="#idp-assertion-content">11.3.1. Hints for Assertion Content</a></span></dt><dt><span class="section"><a href="#idp-assertion-processing">11.3.2. Hints for Assertion Processing</a></span></dt><dt><span class="section"><a href="#idp-services">11.3.3. Hints for Services</a></span></dt><dt><span class="section"><a href="#idp-advanced">11.3.4. Hints for Advanced Settings</a></span></dt></dl></div><a class="indexterm" name="d16037e24882"></a><p>Once you have set up an identity provider, you can configure it
  through the OpenAM console under Federation &gt; Entity Providers &gt;
  <em class="replaceable"><code>Provider Name</code></em>.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="idp-assertion-content"></a>11.3.1.&nbsp;Hints for Assertion Content</h3></div></div></div><p>Use the following hints to adjust settings on the Assertion Content
   tab page.</p><div class="variablelist"><a name="idp-signing-encryption"></a><div class="variablelist-title">Signing and Encryption</div><dl class="variablelist"><dt><span class="term">Request/Response Signing</span></dt><dd><p>Specifies what parts of messages the identity provider requires
      the service provider to sign digitally.</p></dd><dt><span class="term">Encryption</span></dt><dd><p>When selected, the service provider must encrypt NameID
      elements.</p></dd><dt><span class="term">Certificate Aliases</span></dt><dd><p>Specifies aliases for certificates in the OpenAM key store that are
      used to handle digital signatures, and to handle encrypted messages.</p><p>Specify a Key Pass if the private key password is different from
      the key store password, which is stored encrypted in the
      <code class="filename">.keypass</code> file for the server. For instructions
      on working with key pairs, also see <a href="../admin-guide/index.html#change-signing-key" class="link"><em class="citetitle">To Change the
      Signing Key for Federation</em></a>.</p></dd></dl></div><div class="variablelist"><a name="idp-nameid-format"></a><div class="variablelist-title">NameID Format</div><dl class="variablelist"><dt><span class="term">NameID Format List</span></dt><dd><p>Specifies the supported name identifiers for users that are shared
      between providers for single sign on. If no name identifier is specified
      when initiating single sign on, then the identity provider uses the first
      one in the list.</p></dd><dt><span class="term">NameID Value List</span></dt><dd><p>Maps name identifier formats to user profile attributes. The
      <code class="literal">persistent</code> and <code class="literal">transient</code> name
      identifiers need not be mapped.</p></dd></dl></div><div class="variablelist"><a name="idp-authentication-context"></a><div class="variablelist-title">Authentication Context</div><dl class="variablelist"><dt><span class="term">Mapper</span></dt><dd><p>Specifies a class that implements the
      <code class="literal">IDPAuthnContextMapper</code> interface and sets up the
      authentication context.</p></dd><dt><span class="term">Default Authentication Context</span></dt><dd><p>Specifies the authentication context used if no authentication
      context specified in the request.</p></dd><dt><span class="term">Supported Contexts</span></dt><dd><p>Specifies the supported authentication contexts, where the Key
      and Value can specify a corresponding OpenAM authentication method,
      and the Level corresponds to an authentication module authentication
      level.</p></dd></dl></div><div class="variablelist"><a name="idp-assertion-time"></a><div class="variablelist-title">Assertion Time</div><dl class="variablelist"><dt><span class="term">Not-Before Time Skew</span></dt><dd><p>Grace period in seconds for the <code class="literal">NotBefore</code> time
      in assertions.</p></dd><dt><span class="term">Effective Time</span></dt><dd><p>Validity in seconds of an assertion.</p></dd></dl></div><div class="variablelist"><a name="idp-basic-authentication"></a><div class="variablelist-title">Basic Authentication</div><dl class="variablelist"><dt><span class="term">Enabled, User Name, Password</span></dt><dd><p>When enabled, authenticate with the specified user name and
      password at SOAP end points.</p></dd></dl></div><div class="variablelist"><a name="idp-assertion-cache"></a><div class="variablelist-title">Assertion Cache</div><dl class="variablelist"><dt><span class="term">Enabled</span></dt><dd><p>When enabled, cache assertions.</p></dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="idp-assertion-processing"></a>11.3.2.&nbsp;Hints for Assertion Processing</h3></div></div></div><p>Use the following hints to adjust settings on the Assertion Processing
   tab page.</p><div class="variablelist"><a name="idp-attribute-mapper"></a><div class="variablelist-title">Attribute Mapper</div><dl class="variablelist"><dt><span class="term">Attribute Mapper</span></dt><dd><p>Specifies a class that implements the attribute mapping.</p><p>The default implementation attempts to retrieve the mapped attribute
      values from the user profile first. If the attribute values are not
      present in the user's profile, then it attempts to retrieve them from the
      user's session.</p><p>Default: <code class="literal">com.sun.identity.saml2.plugins.DefaultIDPAttributeMapper</code></p></dd><dt><span class="term">Attribute Map</span></dt><dd><p>Maps SAML attributes to user profile attributes.</p><p>The user profile attributes used here must both be allowed in user
      profiles, and also be specified for the identity repository. See the
      <em class="citetitle">Developer's Guide</em> chapter, <a href="../dev-guide/index.html#chap-custom-attr" class="link"><em class="citetitle">Customizing
      Profile Attributes</em></a>, for instructions on allowing
      additional attributes in user profiles.</p><p>To specify the list of profile attributes for an LDAP identity
      repository, login to OpenAM Console as administrator and browse to
      Access Control &gt; <em class="replaceable"><code>Realm Name</code></em> &gt; Data Stores, and
      click the data store name to open the configuration page. Scroll down to
      User Configuration, and edit the LDAP User Attributes list, and then
      click Save to keep your work.</p><p>The default IDP mapping implementation allows you to add static values
      in addition to values taken from the user profile. You add a static value
      by enclosing the profile attribute name in double quotes
      (<code class="literal">"</code>), as in the following examples.</p><p>To add a static SAML attribute called <code class="literal">nameID</code>
      with a value of <code class="literal">staticNameIDValue</code> with a name format of
      <code class="literal">urn:oasis:names:tc:SAML:2.0:attrname-format:uri</code>, add
      the following mapping.</p><pre class="literallayout">urn:oasis:names:tc:SAML:2.0:attrname-format:uri|nameID="staticNameIDValue"</pre></dd></dl></div><div class="variablelist"><a name="idp-account-mapper"></a><div class="variablelist-title">Account Mapper</div><dl class="variablelist"><dt><span class="term">Account Mapper</span></dt><dd><p>Specifies a class that implements <code class="literal">AccountMapper</code>
      to map remote users to local user profiles.</p></dd></dl></div><div class="variablelist"><a name="idp-local-configuration"></a><div class="variablelist-title">Local Configuration</div><dl class="variablelist"><dt><span class="term">Auth URL</span></dt><dd><p>URL where users are redirected to authenticate.</p></dd><dt><span class="term">Reverse Proxy URL</span></dt><dd><p>When a reverse proxy is used for SAML endpoints, it is specified here.</p></dd><dt><span class="term">External Application Logout URL</span></dt><dd><p>URL to which to send an HTTP POST including all cookies when
      receiving a logout request. To add a user session property as a POST
      parameter, include it in the URL query string as a
      <code class="literal">appsessionproperty</code> parameter.</p></dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="idp-services"></a>11.3.3.&nbsp;Hints for Services</h3></div></div></div><p>Use the following hints to adjust settings on the Services tab
   page.</p><div class="variablelist"><a name="idp-meta-alias"></a><div class="variablelist-title">MetaAlias</div><dl class="variablelist"><dt><span class="term">MetaAlias</span></dt><dd><p>Used to locate the providers entity identifier, specified as
      <code class="literal">[/<em class="replaceable"><code>realm-name</code></em>]*/<em class="replaceable"><code>provider-name</code></em></code>, where neither
      <em class="replaceable"><code>realm-name</code></em> nor
      <em class="replaceable"><code>provider-name</code></em> can contain slash characters
      (<code class="literal">/</code>). For example:
      <code class="literal">/myRealm/mySubrealm/idp</code>.</p></dd></dl></div><div class="variablelist"><a name="idp-service-attributes"></a><div class="variablelist-title">IDP Service Attributes</div><dl class="variablelist"><dt><span class="term">Artifact Resolution Service</span></dt><dd><p>Specifies the end point to handle artifact resolution. The Index
      is a unique number identifier for the end point.</p></dd><dt><span class="term">Single Logout Service</span></dt><dd><p>Specifies the end points to handle single logout, depending on
      the SAML binding selected.</p></dd><dt><span class="term">Manage NameID Service</span></dt><dd><p>Specifies the end points to handle name identifiers, depending on
      the SAML binding selected.</p></dd><dt><span class="term">Single SignOn Service</span></dt><dd><p>Specifies the end points to handle single sign on.</p></dd></dl></div><div class="variablelist"><a name="idp-nameid-mapping"></a><div class="variablelist-title">NameID Mapping</div><dl class="variablelist"><dt><span class="term">URL</span></dt><dd><p>Specifies the end point to handle name identifier mapping.</p></dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="idp-advanced"></a>11.3.4.&nbsp;Hints for Advanced Settings</h3></div></div></div><p>Use the following hints to adjust settings on the Advanced tab
   page.</p><div class="variablelist"><a name="idp-sae-configuration"></a><div class="variablelist-title">SAE Configuration</div><dl class="variablelist"><dt><span class="term">IDP URL</span></dt><dd><p>Specifies the end point to handle Secure Attribute Exchange
      requests.</p></dd><dt><span class="term">Application Security Configuration</span></dt><dd><p>Specifies how to handle encryption for Secure Attribute Exchange
      operations.</p></dd></dl></div><div class="variablelist"><a name="idp-ecp-configuration"></a><div class="variablelist-title">ECP Configuration</div><dl class="variablelist"><dt><span class="term">IDP Session Mapper</span></dt><dd><p>Specifies the class that finds a valid session from an HTTP
      servlet request to an identity provider with a SAML Enhanced Client or
      Proxy profile.</p></dd></dl></div><div class="variablelist"><a name="idp-session-synchronization"></a><div class="variablelist-title">Session Synchronization</div><dl class="variablelist"><dt><span class="term">Enabled</span></dt><dd><p>When enabled, the identity provider notifies service providers
      to log the user out when a session expires.</p></dd></dl></div><div class="variablelist"><a name="idp-finder-implementation"></a><div class="variablelist-title">IDP Finder Implementation</div><dl class="variablelist"><dt><span class="term">IDP Finder Implementation Class</span></dt><dd><p>Specifies a class that finds the preferred identity provider to
      handle a proxied authentication request.</p></dd><dt><span class="term">IDP Finder JSP</span></dt><dd><p>Specifies a JSP that presents the list of identity providers to
      the user.</p></dd><dt><span class="term">Enable Proxy IDP Finder For All SPs</span></dt><dd><p>When enabled, apply the finder for all remote service
      providers.</p></dd></dl></div><div class="variablelist"><a name="idp-relay-state-url-list"></a><div class="variablelist-title">Relay State URL List</div><dl class="variablelist"><dt><span class="term">Relay State URL List</span></dt><dd><p>List of URLs to which to redirect users after the request has
      been handled. Used if not specified in the service provider extended
      metadata.</p></dd></dl></div><div class="variablelist"><a name="idp-adapter"></a><div class="variablelist-title">IDP Adapter</div><dl class="variablelist"><dt><span class="term">IDP Adapter Class</span></dt><dd><p>Specifies a class to invoke immediately before sending a
      SAML 2.0 response.</p></dd></dl></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="configure-sp"></a>11.4.&nbsp;Configuring Service Providers</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="#sp-assertion-content">11.4.1. Hints for Assertion Content</a></span></dt><dt><span class="section"><a href="#sp-assertion-processing">11.4.2. Hints for Assertion Processing</a></span></dt><dt><span class="section"><a href="#sp-services">11.4.3. Hints for Services</a></span></dt><dt><span class="section"><a href="#sp-advanced">11.4.4. Hints for Advanced Settings</a></span></dt></dl></div><a class="indexterm" name="d16037e25252"></a><p>Once you have set up a service provider, you can configure it
  through the OpenAM console under Federation &gt; Entity Providers &gt;
  <em class="replaceable"><code>Provider Name</code></em>.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="sp-assertion-content"></a>11.4.1.&nbsp;Hints for Assertion Content</h3></div></div></div><p>Use the following hints to adjust settings on the Assertion Content
   tab page.</p><div class="variablelist"><a name="sp-signing-encryption"></a><div class="variablelist-title">Signing and Encryption</div><dl class="variablelist"><dt><span class="term">Request/Response Signing</span></dt><dd><p>Specifies what parts of messages the service provider requires
      the identity provider to sign digitally.</p></dd><dt><span class="term">Encryption</span></dt><dd><p>The identity provider must encrypt selected elements.</p></dd><dt><span class="term">Certificate Aliases</span></dt><dd><p>Specifies aliases for certificates in the OpenAM key store that are
      used to handle digital signatures, and to handle encrypted messages.</p></dd></dl></div><div class="variablelist"><a name="sp-nameid-format"></a><div class="variablelist-title">NameID Format</div><dl class="variablelist"><dt><span class="term">NameID Format List</span></dt><dd><p>Specifies the supported name identifiers for users that are shared
      between providers for single sign on. If no name identifier is specified
      when initiating single sign on, then the service provider uses the first
      one in the list supported by the identity provider.</p></dd><dt><span class="term">Disable Federation persistence if NameID Format is unspecified</span></dt><dd><p>When enabled, the NameID Format in the authentication response is
      <code class="literal">urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified</code>,
      and the Account Mapper has identified the local user, the service provider
      does not persist federation information in the user profile.</p></dd></dl></div><div class="variablelist"><a name="sp-authentication-context"></a><div class="variablelist-title">Authentication Context</div><dl class="variablelist"><dt><span class="term">Mapper</span></dt><dd><p>Specifies a class that implements the
      <code class="literal">SPAuthnContextMapper</code> interface and sets up the
      authentication context.</p></dd><dt><span class="term">Default Authentication Context</span></dt><dd><p>Specifies the authentication context used if no authentication
      context specified in the request.</p></dd><dt><span class="term">Supported Contexts</span></dt><dd><p>Specifies the supported authentication contexts. The Level
      corresponds to an authentication module authentication level.</p></dd><dt><span class="term">Comparison Type</span></dt><dd><p>How the authentication context in the assertion response must
      compare to the supported contexts.</p></dd></dl></div><div class="variablelist"><a name="sp-assertion-time"></a><div class="variablelist-title">Assertion Time</div><dl class="variablelist"><dt><span class="term">Assertion Time Skew</span></dt><dd><p>Grace period in seconds for the <code class="literal">NotBefore</code> time
      in assertions.</p></dd></dl></div><div class="variablelist"><a name="sp-basic-authentication"></a><div class="variablelist-title">Basic Authentication</div><dl class="variablelist"><dt><span class="term">Enabled, User Name, Password</span></dt><dd><p>When enabled, authenticate with the specified user name and
      password at SOAP end points.</p></dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="sp-assertion-processing"></a>11.4.2.&nbsp;Hints for Assertion Processing</h3></div></div></div><p>Use the following hints to adjust settings on the Assertion Processing
   tab page.</p><div class="variablelist"><a name="sp-attribute-mapper"></a><div class="variablelist-title">Attribute Mapper</div><dl class="variablelist"><dt><span class="term">Attribute Mapper</span></dt><dd><p>Specifies a class that implements the attribute mapping.</p></dd><dt><span class="term">Attribute Map</span></dt><dd><p>Maps SAML attributes to user profile attributes.</p></dd></dl></div><div class="variablelist"><a name="sp-auto-federation"></a><div class="variablelist-title">Auto Federation</div><dl class="variablelist"><dt><span class="term">Enabled</span></dt><dd><p>When enabled, automatically federate user's accounts at different
      providers based on the specified profile attribute.</p></dd><dt><span class="term">Attribute</span></dt><dd><p>Specifies the user profile attribute to match accounts at different
      providers.</p></dd></dl></div><div class="variablelist"><a name="sp-account-mapper"></a><div class="variablelist-title">Account Mapper</div><dl class="variablelist"><dt><span class="term">Account Mapper</span></dt><dd><p>Specifies a class that implements <code class="literal">AccountMapper</code>
      to map remote users to local user profiles.</p></dd><dt><span class="term">Use Name ID as User ID</span></dt><dd><p>When selected, fall back to using the name identifier from the
      assertion to find the user.</p></dd></dl></div><div class="variablelist"><a name="sp-artifact-message-encoding"></a><div class="variablelist-title">Artifact Message Encoding</div><dl class="variablelist"><dt><span class="term">Encoding</span></dt><dd><p>Specifies the message encoding format for artifacts.</p></dd></dl></div><div class="variablelist"><a name="sp-transient-user"></a><div class="variablelist-title">Transient User</div><dl class="variablelist"><dt><span class="term">Transient User</span></dt><dd><p>Specifies the user profile to which to map all identity provider
      users when sending transient name identifiers.</p></dd></dl></div><div class="variablelist"><a name="sp-url"></a><div class="variablelist-title">URL</div><dl class="variablelist"><dt><span class="term">Local Authentication URL</span></dt><dd><p>Specifies the local login URL.</p></dd><dt><span class="term">Intermediate URL</span></dt><dd><p>Specifies a URL to which the user is redirected after
      authentication but before the original URL requested.</p></dd><dt><span class="term">External Application Logout URL</span></dt><dd><p>Specifies the URL to which to send an HTTP POST including all
      cookies when receiving a logout request. To add a user session property
      as a POST parameter, include it in the URL query string as a
      <code class="literal">appsessionproperty</code> parameter.</p></dd></dl></div><div class="variablelist"><a name="sp-default-relay-state-url"></a><div class="variablelist-title">Default Relay State URL</div><dl class="variablelist"><dt><span class="term">Default Relay State URL</span></dt><dd><p>Specifies the URL to which to redirect users after the request has
      been handled. Used if not specified in the response.</p></dd></dl></div><div class="variablelist"><a name="sp-adapter"></a><div class="variablelist-title">Adapter</div><dl class="variablelist"><dt><span class="term">Adapter</span></dt><dd><p>Specifies a class that implements the
      <code class="literal">FederationSPAdapter</code> interface and performs application
      specific processing during the federation process.</p></dd><dt><span class="term">Adapter Environment</span></dt><dd><p>Specifies environment variables passed to the adapter class.</p></dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="sp-services"></a>11.4.3.&nbsp;Hints for Services</h3></div></div></div><p>Use the following hints to adjust settings on the Services tab
   page.</p><div class="variablelist"><a name="sp-meta-alias"></a><div class="variablelist-title">MetaAlias</div><dl class="variablelist"><dt><span class="term">MetaAlias</span></dt><dd><p>Used to locate the providers entity identifier, specified as
      <code class="literal">[/<em class="replaceable"><code>realm-name</code></em>]*/<em class="replaceable"><code>provider-name</code></em></code>, where neither
      <em class="replaceable"><code>realm-name</code></em> nor
      <em class="replaceable"><code>provider-name</code></em> can contain slash characters
      (<code class="literal">/</code>). For example:
      <code class="literal">/myRealm/mySubrealm/sp</code>.</p></dd></dl></div><div class="variablelist"><a name="sp-service-attributes"></a><div class="variablelist-title">SP Service Attributes</div><dl class="variablelist"><dt><span class="term">Single Logout Service</span></dt><dd><p>Specifies the end points to handle single logout, depending on
      the SAML binding selected.</p></dd><dt><span class="term">Manage NameID Service</span></dt><dd><p>Specifies the end points to handle name identifiers, depending on
      the SAML binding selected.</p></dd><dt><span class="term">Assertion Consumer Service</span></dt><dd><p>Specifies the end points to consume assertions, with Index
      corresponding to the index of the URL in the standard metadata.</p></dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="sp-advanced"></a>11.4.4.&nbsp;Hints for Advanced Settings</h3></div></div></div><p>Use the following hints to adjust settings on the Advanced tab
   page.</p><div class="variablelist"><a name="sp-sae-configuration"></a><div class="variablelist-title">SAE Configuration</div><dl class="variablelist"><dt><span class="term">SP URL</span></dt><dd><p>Specifies the end point to handle Secure Attribute Exchange
      requests.</p></dd><dt><span class="term">SP Logout URL</span></dt><dd><p>Specifies the end point of the service provider that can handle
      global logout requests.</p></dd><dt><span class="term">Application Security Configuration</span></dt><dd><p>Specifies how to handle encryption for Secure Attribute Exchange
      operations.</p></dd></dl></div><div class="variablelist"><a name="sp-ecp-configuration"></a><div class="variablelist-title">ECP Configuration</div><dl class="variablelist"><dt><span class="term">Request IDP List Finder Implementation</span></dt><dd><p>Specifies a class that returns a list of preferred identity
      providers trusted by the SAML Enhanced Client or Proxy profile.</p></dd><dt><span class="term">Request IDP List Get Complete</span></dt><dd><p>Specifies a URI reference used to retrieve the complete identity
      provider list if the <code class="literal">IDPList</code> element is not
      complete.</p></dd><dt><span class="term">Request IDP List</span></dt><dd><p>Specifies a list of identity providers for the SAML Enhanced Client
      or Proxy to contact, used by the default implementation of the IDP
      Finder.</p></dd></dl></div><div class="variablelist"><a name="sp-idp-proxy"></a><div class="variablelist-title">IDP Proxy</div><dl class="variablelist"><dt><span class="term">IDP Proxy</span></dt><dd><p>When enabled, allow proxied authentication for this service
      provider.</p></dd><dt><span class="term">Introduction</span></dt><dd><p>When enabled, use introductions to find the proxy identity
      provider.</p></dd><dt><span class="term">Proxy Count</span></dt><dd><p>Specifies the maximum number of proxy identity providers.</p></dd><dt><span class="term">IDP Proxy List</span></dt><dd><p>Specifies a list of URIs identifying preferred proxy identity
      providers.</p></dd></dl></div><div class="variablelist"><a name="sp-session-synchronization"></a><div class="variablelist-title">Session Synchronization</div><dl class="variablelist"><dt><span class="term">Enabled</span></dt><dd><p>When enabled, the service provider notifies identity providers
      to log the user out when a session expires.</p></dd></dl></div><div class="variablelist"><a name="sp-relay-state-url-list"></a><div class="variablelist-title">Relay State URL List</div><dl class="variablelist"><dt><span class="term">Relay State URL List</span></dt><dd><p>List of URLs to which to redirect users after the request has
      been handled. Used if not specified in the service provider extended
      metadata.</p></dd></dl></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="configure-cot"></a>11.5.&nbsp;Configuring Circles of Trust</h2></div></div></div><a class="indexterm" name="d16037e25632"></a><p>Once you have set up a circle of trust, you can configure it
  through the OpenAM console under Federation &gt; Circle of Trust &gt;
  <em class="replaceable"><code>Circle of Trust Name</code></em>.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Name</span></dt><dd><p>String to refer to the circle of trust.</p></dd><dt><span class="term">Description</span></dt><dd><p>Short description of the circle of trust.</p></dd><dt><span class="term">IDFF Writer Service URL</span></dt><dd><p>Liberty Identity Federation Framework service that writes identity
     provider entity identifiers to Common Domain cookies after successful
     authentication, used in identity provider discovery. Example:
     <code class="literal">http://www.disco.example:8080/openam/idffwriter</code>.</p></dd><dt><span class="term">IDFF Reader Service URL</span></dt><dd><p>Liberty Identity Federation Framework service that reads identity
     provider entity identifiers from Common Domain cookies, used in identity
     provider discovery. Example:
     <code class="literal">http://www.disco.example:8080/openam/transfer</code>.</p></dd><dt><span class="term">SAML2 Writer Service URL</span></dt><dd><p>SAML 2.0 service that writes identity provider entity identifiers
     to Common Domain cookies after successful authentication, used in identity
     provider discovery. Example:
     <code class="literal">http://www.disco.example:8080/openam/saml2writer</code>.</p></dd><dt><span class="term">SAML2 Reader Service URL</span></dt><dd><p>SAML 2.0 service that reads identity provider entity identifiers
     from Common Domain cookies, used in identity provider discovery. Example:
     <code class="literal">http://www.disco.example:8080/openam/saml2reader</code>.</p></dd><dt><span class="term">Status</span></dt><dd><p>Whether this circle of trust is operational.</p></dd><dt><span class="term">Realm</span></dt><dd><p>Name of the realm participating in this circle of trust.</p></dd><dt><span class="term">Entity Providers</span></dt><dd><p>Known hosted and remote identity and service providers participating
     in this circle of trust.</p></dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="saml2-failover"></a>11.6.&nbsp;Configuring Providers for Failover</h2></div></div></div><p>
   OpenAM servers can function in a site configuration behind a load balancer,
   as described in the <em class="citetitle">Installation Guide</em> chapter,
   <a href="../install-guide/index.html#chap-session-failover" class="link"><em class="citetitle">Setting Up OpenAM Session Failover</em></a>.
  </p><p>
   When you set up the same SAML 2.0 Provider on multiple servers
   behind a load balancer, however, you must ensure the metadata
   points to the load balancer rather than the individual servers.
  </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
     Before configuring the provider, follow the instructions
     in the <em class="citetitle">Installation Guide</em> mentioned above,
     and make sure that failover works through the load balancer
     for normal OpenAM sessions.
    </p></li><li class="listitem"><p>
     Configure the provider on one of the servers
     using the load balancer URL as the entity ID.
    </p></li><li class="listitem"><p>
     Export the metadata and extended metadata for the provider.
     You can export metadata either by using the <span class="command"><strong>ssoadm</strong></span> command,
     or by using the <code class="filename">ssoadm.jsp</code> page in OpenAM console
     after setting <code class="literal">ssoadm.disabled</code> to <code class="literal">false</code>
     under Servers and Sites &gt; <em class="replaceable"><code>Server Name</code></em> &gt; Advanced.
    </p><p>
     With the <span class="command"><strong>ssoadm</strong></span> command, you can export the metadata
     as shown in the following example for an Identity Provider,
     where the entity ID is <code class="literal">http://lb.example.com:80/openam</code>.
    </p><div class="screen"><pre>
$ <strong>ssoadm \
 export-entity \
 --entityid "http://lb.example.com:80/openam" \
 --adminid amadmin \
 --password-file /tmp/pwd.txt \
 --meta-data-file idp.xml \
 --extended-data-file idp-extended.xml</strong>
    </pre></div></li><li class="listitem"><p>
     Edit both the metadata and the extended metadata,
     changing all URLs in both files to use the load balancer URL.
    </p></li><li class="listitem"><p>
     Delete the provider configuration in OpenAM Console.
    </p></li><li class="listitem"><p>
     Import the edited provider configuration in OpenAM Console.
    </p></li><li class="listitem"><p>
     Enable SAMLv2 failover in OpenAM Console.
    </p><p>
     Under Configuration &gt; Global, click SAMLv2 Service Configuration.
    </p><p>
     Select Enabled next to Enable SAMLv2 failover,
     and then click Save.
    </p></li></ol></div><p>
   At this point failover is operational for the provider you configured.
  </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="google-apps-as-sp"></a>11.7.&nbsp;Configuring Google Apps as a Remote Service Provider</h2></div></div></div><a class="indexterm" name="d16037e25785"></a><a class="indexterm" name="d16037e25788"></a><p>OpenAM can serve as the identity provider when you use <a class="link" href="http://www.google.com/apps/" target="_blank">Google
  Apps</a> as a service provider, allowing users to have single sign-on
  with their Google Apps account.</p><p>In order to use this service, you must have a Google Apps account for
  at least one of your domains, such as <code class="literal">example.com</code>.</p><div class="procedure"><a name="integrate-google-apps"></a><div class="procedure-title">Procedure&nbsp;11.10.&nbsp;To Integrate With Google Apps</div><ol class="procedure" type="1"><li class="step"><p>If you have not yet done so, set up OpenAM as described in
    <a class="xref" href="#create-hosted-idp" title="Procedure&nbsp;11.1.&nbsp;To Create a Hosted Identity Provider">Procedure&nbsp;11.1, &#8220;To Create a Hosted Identity Provider&#8221;</a>, using a signing certificate
    that is needed by Google Apps.</p><p>See the procedure <a href="../admin-guide/index.html#change-signing-key" class="link"><em class="citetitle">To Change the
    Signing Key for Federation</em></a> for details regarding the
    signing certificate.</p></li><li class="step"><p>On the OpenAM console Common Tasks page, click Configure Google
    Apps.</p></li><li class="step"><p>On the first Configure Google Apps for Single Sign-On page, add your
    domain name(s) such as <code class="literal">example.com</code> to the list, and then
    click Create.</p></li><li class="step"><p>On the second Configure Google Apps for Single Sign-On page, save
    the OpenAM verification certificate to a text file, such as
    <code class="filename">OpenAM.pem</code>.</p></li><li class="step"><p>Follow the instructions under To Enable Access to the Google Apps API
    before clicking Finish.</p><ol type="a" class="substeps"><li class="step"><p>Access the Google Apps administration page for the first of your
      domains in a new browser tab or window.</p></li><li class="step"><p>Login as Google Apps administrator.</p></li><li class="step"><p>Select Enable Single Sign-On.</p></li><li class="step"><p>Copy the URLs from the OpenAM page into the Google Apps setup
      screen.</p></li><li class="step"><p>Upload the certificate file you saved such as
      <code class="filename">OpenAM.pem</code> as the Google Apps Verification
      Certificate.</p></li><li class="step"><p>Select Use a domain specific issuer.</p></li><li class="step"><p>Save changes in Google Apps setup.</p></li><li class="step"><p>Repeat the steps above for each domain you have configured.</p></li><li class="step"><p>Click Finish to complete the process.</p></li></ol></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="salesforce-as-sp"></a>11.8.&nbsp;Configuring Salesforce CRM as a Remote Service Provider</h2></div></div></div><a class="indexterm" name="d16037e25869"></a><a class="indexterm" name="d16037e25872"></a><p>OpenAM can serve as the identity provider when you use <a class="link" href="http://www.salesforce.com/" target="_blank">Salesforce CRM</a>
  as a service provider, allowing users to have single sign-on with their
  Salesforce CRM account.</p><p>In order to use this service, you must have Salesforce CRM accounts
  for your organization.</p><div class="procedure"><a name="integrate-salesforce"></a><div class="procedure-title">Procedure&nbsp;11.11.&nbsp;To Integrate With Salesforce CRM</div><ol class="procedure" type="1"><li class="step"><p>If you have not yet done so, set up OpenAM as described in
    <a class="xref" href="#create-hosted-idp" title="Procedure&nbsp;11.1.&nbsp;To Create a Hosted Identity Provider">Procedure&nbsp;11.1, &#8220;To Create a Hosted Identity Provider&#8221;</a>, using a signing certificate
    that is needed by Salesforce CRM.</p><p>See the procedure <a href="../admin-guide/index.html#change-signing-key" class="link"><em class="citetitle">To Change the
    Signing Key for Federation</em></a> for details regarding the
    signing certificate.</p></li><li class="step"><p>On the OpenAM console Common Tasks page, click Configure Salesforce
    CRM.</p></li><li class="step"><p>Enter the EntityID for your Salesforce service provider.</p><p>This ID is used as the persistent EntityDescriptor metadata
              element so that users can have multiple service provider instances.
              This field is used for the EntityDescriptor on the next page.</p></li><li class="step"><p>On the first Salesforce CRM Single Sign-On Configuration page,
    configure attribute mapping to associate the appropriate attribute
    from Salesforce CRM with the user profile attribute on your IDP.</p><p>For example, add a mapping for <code class="literal">IDPEmail</code> to
    <code class="literal">mail</code>, and then click Create. Make sure the attribute mapper 
    is sending the correct attribute to be used for the federated identity.</p></li><li class="step"><p>On the second Salesforce CRM Single Sign-On Configuration page, follow
    the instructions below before clicking Finish.</p><ol type="a" class="substeps"><li class="step"><p>In a new browser tab or window, login to <a class="link" href="https://login.salesforce.com/" target="_blank">Salesforce CRM</a> with
      your administrator credentials.</p><p>Create an administrator account if none exists, yet.</p></li><li class="step"><p>If your users go directly to Salesforce to access services, then
      their single sign-on is SP-initiated from the Salesforce side. Salesforce
      provides a "My Domain" feature to facilitate SP-initiated single sign-on
      for desktop and device users.</p><p>When you have completed configuring Salesforce as a service
      provider, users can then browse to your domain at Salesforce, such as
      <code class="literal">https://openam.my.salesforce.com</code>, and be redirected to
      OpenAM to authenticate before being redirected to Salesforce.</p><ol type="i" class="substeps"><li class="step"><p>Select Administration Setup &gt; Company Profile &gt; My
        Domain.</p></li><li class="step"><p>Choose the domain name, and then register the domain.</p></li><li class="step"><p>Wait until the domain is ready for testing to proceed.</p></li></ol></li><li class="step"><p>In Salesforce CRM, browse to Setup &gt; Administration Setup &gt;
      Security Controls &gt; Single Sign-On Settings, and then click Edit for
      Single Sign-On Settings.</p></li><li class="step"><p>Select SAML Enabled.</p></li><li class="step"><p>Set the SAML Version to 2.0.</p></li><li class="step"><p>Copy the issuer name from the OpenAM page to the Issuer field on the
      Salesforce CRM page.</p></li><li class="step"><p>Copy or download the OpenAM verification certificate to a text file, such 
      as <code class="filename">OpenAMCert.pem</code> or <code class="filename">OpenAMCert.txt</code>.</p></li><li class="step"><p>Upload the certificate file as Identity Provider Certificate on the
      Salesforce CRM page.</p></li><li class="step"><p>For SAML Identity Type in Salesforce CRM, choose Assertion contains
      the Federation ID from the User object.</p></li><li class="step"><p>For SAML Identity Location in Salesforce CRM, choose Identity is in an
      Attribute element.</p></li><li class="step"><p>If you require specific login or logout pages, enter them in the next
      two fields.</p></li><li class="step"><p>Enter the URL of your page specific error page if you have a page where
      you would like users redirected to when they encounter an error.</p></li><li class="step"><a name="sf-as-sp-copy-attr-name"></a><p>Copy the attribute name such as <code class="literal">IDPEmail</code> from
      the OpenAM page to the Attribute Name field on the Salesforce CRM
      page.</p></li><li class="step"><p>
       Salesforce uses an unspecified <code class="literal">nameid-format</code> value;
       therefore, your IdP configuration in OpenAM should reflect this. In the
       NameID Value Map setting, enter the following NameID Format user attribute
       mapping, and then click <span class="guibutton">Add</span>.
       </p><div class="screen"><pre>
urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified=<em><strong>attribute</strong></em>
       </pre></div><p>
      </p><p>Here the <em class="replaceable"><code>attribute</code></em> is the attribute you
       copied in <a class="xref" href="#sf-as-sp-copy-attr-name" title="Step 5.m">Step 5.m</a>.
      </p></li><li class="step"><p>Select the Entity ID corresponding to the "My Domain" that you set
      up.</p></li><li class="step"><p>Save your work in Salesforce CRM.</p></li><li class="step"><p>Salesforce CRM displays a Salesforce Login URL.</p><p>Copy the Salesforce Login URL to the field provided on the OpenAM
      page.</p></li><li class="step"><p>Salesforce CRM returns to the Single Sign-On Settings form.</p></li><li class="step"><p>Click Download Metadata to download the Salesforce CRM SP
      metadata.</p><p>After you complete the configuration, you must import the
      SP metadata you download in this step.</p></li><li class="step"><p>In Salesforce CRM, browse to Administration Setup &gt; Manage Users,
      and then click Users.</p></li><li class="step"><p>Add users as necessary, making sure the attribute chosen as the
      Federation ID matches the local attribute you mapped to the remote
      attribute in the previous page in OpenAM.</p></li><li class="step"><p>Click Finish to complete the process.</p></li></ol></li><li class="step"><p>After you finish, import the metadata for Salesforce CRM as SP.</p><ol type="a" class="substeps"><li class="step"><p>Browse in OpenAM console to the Federation tab.</p></li><li class="step"><p>If the remote SP entity for Salesforce CRM is already in the Entity
      Providers list, delete the existing configuration.</p></li><li class="step"><p>Click Import Entity..., and then use the Import Entity Provider
      page to import the Salesforce CRM metadata.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Update the <code class="literal">Realm Name</code> to the appropriate realm.</p></li><li class="listitem"><p>Select the location where the metadata file is.</p></li><li class="listitem"><p>Enter the path for the metadata file.</p></li><li class="listitem"><p>If you have an extended data file, select the location where the file
        is.</p></li><li class="listitem"><p>If you have an extended data file, enter the path for the metadata 
        file.</p></li></ul></div></li></ol><p>At this point, when a user browses to the Salesforce domain you set
    up, they should be redirected to OpenAM for authentication. Upon successful
    authentication, they should be logged in to Salesforce.</p></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="using-saml2-sso-slo"></a>11.9.&nbsp;Using SAML 2.0 Single Sign-On &amp; Single Logout</h2></div></div></div><a class="indexterm" name="d16037e26076"></a><a class="indexterm" name="d16037e26081"></a><p>OpenAM SAML 2.0 Federation provides JSPs where you can direct
  users to do single sign-on (SSO) and single logout (SLO) across providers
  in a circle of trust. OpenAM has two JSPs for SSO and two JSPs for
  SLO, allowing you to initiate both processes either from the identity
  provider side, or from the service provider side.</p><p>SSO lets users sign in once and remain authenticated as they access
  services in the circle of trust.</p><p>SLO attempts to log a user out of all providers in the circle of
  trust.</p><div class="variablelist"><p>The JSP pages are found under the context root where you deployed
   OpenAM, in <code class="filename">saml2/jsp/</code>.</p><dl class="variablelist"><dt><span class="term"><code class="filename">spSSOInit.jsp</code></span></dt><dd><p>Used to initiate SSO from the service provider side, so call this
     on the service provider not the identity provider. This is also mapped
     to the endpoint <code class="literal">spssoinit</code> under the
     context root.</p><p>Examples:
     <code class="literal">http://www.sp.example:8080/openam/saml2/jsp/spSSOInit.jsp</code>,
     <code class="literal">http://www.sp.example:8080/openam/spssoinit</code></p></dd><dt><span class="term"><code class="filename">idpSSOInit.jsp</code></span></dt><dd><p>Used to initiate SSO from the identity provider side, so call this
     on the identity provider not the service provider. This is also mapped to
     the endpoint <code class="literal">idpssoinit</code> under the
     context root.</p><p>Examples:
     <code class="literal">http://www.idp.example:8080/openam/saml2/jsp/idpSSOInit.jsp</code>,
     <code class="literal">http://www.idp.example:8080/openam/idpssoinit</code></p></dd><dt><span class="term"><code class="filename">spSingleLogoutInit.jsp</code></span></dt><dd><p>Used to initiate SLO from the service provider side, so call this
     on the service provider not the identity provider.</p><p>Example:
     <code class="literal">http://www.sp.example:8080/openam/saml2/jsp/spSingleLogoutInit.jsp</code>,
     <code class="literal">http://www.sp.example:8080/openam/SPSloInit</code></p></dd><dt><span class="term"><code class="filename">idpSingleLogoutInit.jsp</code></span></dt><dd><p>Used to initiate SLO from the identity provider side, so call this
     on the identity provider not the service provider.</p><p>Example:
     <code class="literal">http://www.idp.example:8080/openam/saml2/jsp/idpSingleLogoutInit.jsp</code>,
     <code class="literal">http://www.idp.example:8080/openam/IDPSloInit</code></p></dd></dl></div><p>When you invoke these JSPs, there are several parameters to
   specify. Which parameters you can use depends on the JSP.</p><div class="variablelist"><a name="idpssoinit-parameters"></a><div class="variablelist-title"><code class="filename">idpSSOInit.jsp</code> Parameters</div><dl class="variablelist"><dt><span class="term"><code class="literal">metaAlias</code></span></dt><dd><p>(Required) Use this parameter to specify the local alias for the
     provider, such as <code class="literal">metaAlias=/myRealm/idp</code>. This
     parameter takes the format
     <code class="literal">/<em class="replaceable"><code>realm-name</code></em>/<em class="replaceable"><code>provider-name</code></em></code> as described in <a class="xref" href="#idp-meta-alias" title="MetaAlias">MetaAlias</a>. You do not repeat the slash for
     the top level realm, for example <code class="literal">metaAlias=/idp</code>.</p></dd><dt><span class="term"><code class="literal">spEntityID</code></span></dt><dd><p>(Required) Use this parameter to indicate the remote service
     provider. Make sure you URL encode the value. For example, specify
     <code class="literal">spEntityID=http://www.sp.example:8080/openam</code> as
     <code class="literal">spEntityID=http%3A%2F%2Fwww.sp.example%3A8080%2Fopenam</code>.</p></dd><dt><span class="term"><code class="literal">affiliationID</code></span></dt><dd><p>(Optional) Use this parameter to specify a SAML affiliation
     identifier.</p></dd><dt><span class="term"><code class="literal">binding</code></span></dt><dd><p>(Optional) Use this parameter to indicate what binding to use for the
     operation. For example, specify <code class="literal">binding=HTTP-POST</code> to
     use HTTP POST binding with a self-submitting form. In addition to
     <code class="literal">binding=HTTP-POST</code>, you can also use
     <code class="literal">binding=HTTP-Artifact</code>.</p></dd><dt><span class="term"><code class="literal">NameIDFormat</code></span></dt><dd><p>(Optional) Use this parameter to specify a SAML Name Identifier
     format identifier such as
     <code class="literal">urn:oasis:names:tc:SAML:2.0:nameid-format:persistent</code>, or
     <code class="literal">urn:oasis:names:tc:SAML:2.0:nameid-format:transient</code>.</p></dd><dt><span class="term"><code class="literal">RelayState</code></span></dt><dd><p>(Optional) Use this parameter to specify where to redirect the user
     when the process is complete. Make sure you URL encode the value. For
     example, <code class="literal">RelayState=http%3A%2F%2Fforgerock.com</code>
     takes the user to <code class="literal">http://forgerock.com</code>.</p></dd><dt><span class="term"><code class="literal">RelayStateAlias</code></span></dt><dd><p>(Optional) Use this parameter to specify the parameter to use as the
     <code class="literal">RelayState</code>. For example, if your query string has
     <code class="literal">target=http%3A%2F%2Fforgerock.com&amp;RelayStateAlias=target</code>,
     this is like setting
     <code class="literal">RelayState=http%3A%2F%2Fforgerock.com</code>.</p></dd></dl></div><div class="variablelist"><a name="spssoinit-parameters"></a><div class="variablelist-title"><code class="filename">spSSOInit.jsp</code> Parameters</div><dl class="variablelist"><dt><span class="term"><code class="literal">idpEntityID</code></span></dt><dd><p>(Required) Use this parameter to indicate the remote identity
     provider. Make sure you URL encode the value. For example, specify
     <code class="literal">idpEntityID=http://www.idp.example:8080/openam</code> as
     <code class="literal">idpEntityID=http%3A%2F%2Fwww.idp.example%3A8080%2Fopenam</code>.</p></dd><dt><span class="term"><code class="literal">metaAlias</code></span></dt><dd><p>(Required) Use this parameter to specify the local alias for the
     provider, such as <code class="literal">metaAlias=/myRealm/sp</code>. This parameter
     takes the format <code class="literal">/<em class="replaceable"><code>realm-name</code></em>/<em class="replaceable"><code>provider-name</code></em></code> as described in <a class="xref" href="#sp-meta-alias" title="MetaAlias">MetaAlias</a>. You do not repeat the slash for the
     top level realm, <code class="literal">metaAlias=/sp</code>.</p></dd><dt><span class="term"><code class="literal">affiliationID</code></span></dt><dd><p>(Optional) Use this parameter to specify a SAML affiliation
     identifier.</p></dd><dt><span class="term"><code class="literal">AllowCreate</code></span></dt><dd><p>(Optional) Use this parameter to indicate whether the identity
     provider can create a new identifier for the principal if none exists
     (<code class="literal">true</code>) or not (<code class="literal">false</code>).</p></dd><dt><span class="term"><code class="literal">AssertionConsumerServiceIndex</code></span></dt><dd><p>(Optional) Use this parameter to specify an integer that indicates
     the location to which the Response message should be returned to the
     requester.</p></dd><dt><span class="term"><code class="literal">AuthComparison</code></span></dt><dd><p>(Optional) Use this parameter to specify a comparison method to
     evaluate the requested context classes or statements. OpenAM accepts the
     following values: <code class="literal">better</code>, <code class="literal">exact</code>,
     <code class="literal">maximum</code>, and <code class="literal">minimum</code>.</p></dd><dt><span class="term"><code class="literal">AuthnContextClassRef</code></span></dt><dd><p>(Optional) Use this parameter to specify authentication context
     class references. Separate multiple values with pipe characters
     (<code class="literal">|</code>).</p></dd><dt><span class="term"><code class="literal">AuthnContextDeclRef</code></span></dt><dd><p>(Optional) Use this parameter to specify authentication context
     declaration references. Separate multiple values with pipe characters
     (<code class="literal">|</code>).</p></dd><dt><span class="term"><code class="literal">AuthLevel</code></span></dt><dd><p>(Optional) Use this parameter to specify the authentication level
     of the authentication context that OpenAM should use to authenticate the
     user.</p></dd><dt><span class="term"><code class="literal">binding</code></span></dt><dd><p>(Optional) Use this parameter to indicate what binding to use for the
     operation. For example, specify <code class="literal">binding=HTTP-POST</code> to
     use HTTP POST binding with a self-submitting form. In addition to
     <code class="literal">binding=HTTP-POST</code>, you can also use
     <code class="literal">binding=HTTP-Artifact</code>.</p></dd><dt><span class="term"><code class="literal">Destination</code></span></dt><dd><p>(Optional) Use this parameter to specify a URI Reference indicating
     the address to which the request is sent.</p></dd><dt><span class="term"><code class="literal">ForceAuthn</code></span></dt><dd><p>(Optional) Use this parameter to indicate whether the identity
     provider should force authentication (<code class="literal">true</code>) or can
     reuse existing security contexts (<code class="literal">false</code>).</p></dd><dt><span class="term"><code class="literal">isPassive</code></span></dt><dd><p>(Optional) Use this parameter to indicate whether the identity
     provider should authenticate passively (<code class="literal">true</code>) or not
     (<code class="literal">false</code>).</p></dd><dt><span class="term"><code class="literal">NameIDFormat</code></span></dt><dd><p>(Optional) Use this parameter to specify a SAML Name Identifier
     format identifier such as
     <code class="literal">urn:oasis:names:tc:SAML:2.0:nameid-format:persistent</code>,
     or <code class="literal">urn:oasis:names:tc:SAML:2.0:nameid-format:transient</code>.</p></dd><dt><span class="term"><code class="literal">RelayState</code></span></dt><dd><p>(Optional) Use this parameter to specify where to redirect the user
     when the process is complete. Make sure you URL encode the value. For
     example, <code class="literal">RelayState=http%3A%2F%2Fforgerock.com</code>
     takes the user to <code class="literal">http://forgerock.com</code>.</p></dd><dt><span class="term"><code class="literal">RelayStateAlias</code></span></dt><dd><p>(Optional) Use this parameter to specify the parameter to use as the
     <code class="literal">RelayState</code>. For example, if your query string has
     <code class="literal">target=http%3A%2F%2Fforgerock.com&amp;RelayStateAlias=target</code>,
     this is like setting
     <code class="literal">RelayState=http%3A%2F%2Fforgerock.com</code>.</p></dd><dt><span class="term"><code class="literal">reqBinding</code></span></dt><dd><p>(Optional) Use this parameter to indicate what binding to use for the
     authentication request. Valid values in include
     <code class="literal">urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect</code>
     (default) and
     <code class="literal">urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST</code>.</p></dd><dt><span class="term"><code class="literal">sunamcompositeadvice</code></span></dt><dd><p>(Optional) Use this parameter to specify a URL encoded XML blob that
     specifies the authentication level advice. For example, the following XML
     indicates a requested authentication level of 1. Notice the required
     <code class="literal">:</code> before the 1.</p><pre class="brush: xml;">&lt;Advice&gt;
 &lt;AttributeValuePair&gt;
  &lt;Attribute name="AuthLevelConditionAdvice"/&gt;
  &lt;Value&gt;/:1&lt;/Value&gt;
 &lt;/AttributeValuePair&gt;
&lt;/Advice&gt;</pre></dd></dl></div><div class="variablelist"><a name="idpsloinit-parameters"></a><div class="variablelist-title"><code class="filename">idpSingleLogoutInit.jsp</code> Parameters</div><dl class="variablelist"><dt><span class="term"><code class="literal">binding</code></span></dt><dd><p>(Required) Use this parameter to indicate what binding to use for the
     operation. The full, long name format is required for this parameter to work.</p><div class="itemizedlist"><p>The value must be one of the following.</p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect</code> (default)</p></li><li class="listitem"><p><code class="literal">urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST</code></p></li><li class="listitem"><p><code class="literal">urn:oasis:names:tc:SAML:2.0:bindings:SOAP</code></p></li></ul></div></dd><dt><span class="term"><code class="literal">Consent</code></span></dt><dd><p>(Optional) Use this parameter to specify a URI that is a SAML Consent
     Identifier.</p></dd><dt><span class="term"><code class="literal">Destination</code></span></dt><dd><p>(Optional) Use this parameter to specify a URI Reference indicating
     the address to which the request is sent.</p></dd><dt><span class="term"><code class="literal">Extension</code></span></dt><dd><p>(Optional) Use this parameter to specify a list of Extensions as
     string objects.</p></dd><dt><span class="term"><code class="literal">goto</code></span></dt><dd><p>(Optional) Use this parameter to specify where to redirect the user
     when the process is complete. <code class="literal">RelayState</code> takes
     precedence over this parameter.</p></dd><dt><span class="term"><code class="literal">logoutAll</code></span></dt><dd><p>(Optional) Use this parameter to specify that the identity provider
     should send single logout requests to service providers without indicating
     a session index.</p></dd><dt><span class="term"><code class="literal">RelayState</code></span></dt><dd><p>(Optional) Use this parameter to specify where to redirect the user
     when the process is complete. Make sure you URL encode the value. For
     example, <code class="literal">RelayState=http%3A%2F%2Fforgerock.com</code>
     takes the user to <code class="literal">http://forgerock.com</code>.</p></dd></dl></div><div class="variablelist"><a name="spsloinit-parameters"></a><div class="variablelist-title"><code class="filename">spSingleLogoutInit.jsp</code> Parameters</div><dl class="variablelist"><dt><span class="term"><code class="literal">binding</code></span></dt><dd><p>(Required) Use this parameter to indicate what binding to use for the
     operation. The full, long name format is required for this parameter to work.
     For example, specify <code class="literal">binding=urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST</code> 
     to use HTTP POST binding with a self-submitting form rather than the default
     HTTP redirect binding. In addition, you can use 
     <code class="literal">binding=urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Artifact</code>.</p></dd><dt><span class="term"><code class="literal">idpEntityID</code></span></dt><dd><p>(Required for Fedlets) Use this parameter to indicate the remote
     identity provider. If the <code class="literal">binding</code> is not set, then
     OpenAM uses this parameter to find the default binding. Make sure you URL
     encode the value. For example, specify
     <code class="literal">idpEntityID=http://www.sp.example:8080/openam</code> as
     <code class="literal">idpEntityID=http%3A%2F%2Fwww.idp.example%3A8080%2Fopenam</code>.</p></dd><dt><span class="term"><code class="literal">NameIDValue</code></span></dt><dd><p>(Required for Fedlets) Use this parameter to indicate the SAML Name
     Identifier for the user.</p></dd><dt><span class="term"><code class="literal">SessionIndex</code></span></dt><dd><p>(Required for Fedlets) Use this parameter to indicate the
     <code class="literal">sessionIndex</code> of the user session to terminate.</p></dd><dt><span class="term"><code class="literal">Consent</code></span></dt><dd><p>(Optional) Use this parameter to specify a URI that is a SAML Consent
     Identifier.</p></dd><dt><span class="term"><code class="literal">Destination</code></span></dt><dd><p>(Optional) Use this parameter to specify a URI Reference indicating
     the address to which the request is sent.</p></dd><dt><span class="term"><code class="literal">Extension</code></span></dt><dd><p>(Optional) Use this parameter to specify a list of Extensions as
     string objects.</p></dd><dt><span class="term"><code class="literal">goto</code></span></dt><dd><p>(Optional) Use this parameter to specify where to redirect the user
     when the process is complete. <code class="literal">RelayState</code> takes
     precedence over this parameter.</p></dd><dt><span class="term"><code class="literal">RelayState</code></span></dt><dd><p>(Optional) Use this parameter to specify where to redirect the user
     when the process is complete. Make sure you URL encode the value. For
     example, <code class="literal">RelayState=http%3A%2F%2Fforgerock.com</code>
     takes the user to <code class="literal">http://forgerock.com</code>.</p></dd><dt><span class="term"><code class="literal">spEntityID</code></span></dt><dd><p>(Optional, for Fedlets) Use this parameter to indicate the Fedlet
     entity ID. When missing, OpenAM uses the first entity ID in the
     metadata.</p></dd></dl></div><div class="example"><a name="example-saml2-sso-slo"></a><div class="example-title">Example&nbsp;11.1.&nbsp;SSO &amp; SLO From the Service Provider</div><div class="example-contents"><p>The following URL takes the user from the service provider side to
   authenticate at the identity provider and then come back to the end user
   profile page at the service provider after successful SSO. Lines are folded
   to show you the query string parameters.</p><pre class="brush: plain;">http://www.sp.example:8080/openam/saml2/jsp/spSSOInit.jsp?metaAlias=/sp
&amp;idpEntityID=http%3A%2F%2Fwww.idp.example%3A8080%2Fopenam
&amp;RelayState=http%3A%2F%2Fwww.sp.example%3A8080%2Fopenam%2Fidm%2FEndUser</pre><p>The following URL initiates SLO from the service provider side,
   leaving the user at <code class="literal">http://forgerock.com</code>.</p><pre class="brush: plain;">http://www.sp.example:8080/openam/saml2/jsp/spSingleLogoutInit.jsp?
&amp;idpEntityID=http%3A%2F%2Fwww.idp.example%3A8080%2Fopenam
&amp;RelayState=http%3A%2F%2Fforgerock.com</pre></div></div><br class="example-break"><div class="procedure"><a name="show-saml2-sso-login-progress"></a><div class="procedure-title">Procedure&nbsp;11.12.&nbsp;To Indicate Progress During SSO</div><p>During SSO log in, OpenAM presents users with a self-submitting form
   when access has been validated. This page is otherwise blank. If you want to
   present users with something to indicate that the operation is in progress,
   then customize the necessary templates.</p><ol class="procedure" type="1"><li class="step"><p>Modify the templates to add a clue that SSO is in progress, such as
    an image.</p><p>
     Edit the source of the OpenAM Java Server Page,
     <code class="filename">saml2/jsp/autosubmitaccessrights.jsp</code>,
     under the file system directory where the OpenAM .war has been unpacked.
    </p><p>
     When you add an image or other presentation element,
     make sure that you retain the form and Java code as is.
    </p></li><li class="step"><p>Unpack OpenAM-12.0.0.war, and add your modified template files
    under <code class="filename">WEB-INF/classes/</code> where you unpacked the .war.</p><p>Also include any images you reference in the page.</p></li><li class="step"><p>Pack up your custom version of OpenAM, and then deploy it in your
    web container.</p></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="saml2-ecp-config"></a>11.10.&nbsp;Configuring OpenAM For the ECP Profile</h2></div></div></div><a class="indexterm" name="d16037e26725"></a><p>The SAML 2.0 Enhanced Client or Proxy (ECP) profile is intended for use
  when accessing services over devices like simple phones, medical devices, and
  set-top boxes that lack the capabilities needed to use the more widely used
  SAML 2.0 Web Browser SSO profile.</p><p>The ECP knows which identity provider to contact for the user, and is
  able to use the reverse SOAP (PAOS) SAML 2.0 binding for the authentication
  request and response. The PAOS binding uses HTTP and SOAP headers to pass
  information about processing SOAP requests and responses, starting with a
  PAOS HTTP header that the ECP sends in its initial request to the server.
  The PAOS messages continue with a SOAP authentication request in the server's
  HTTP response to the ECP's request for a resource, followed by a SOAP
  response in an HTTP request from the ECP.</p><p>An enhanced client, such as a browser with a plugin or an extension,
  can handle these communications on its own. An enhanced proxy is an HTTP
  server such as a WAP gateway that can support the ECP profile on behalf of
  client applications.</p><p>OpenAM supports the SAML 2.0 ECP profile on the server side for
  identity providers and service providers. You must build the ECP.</p><p>By default an OpenAM identity provider uses the
  <code class="literal">com.sun.identity.saml2.plugins.DefaultIDPECPSessionMapper</code>
  class to find a user session for requests to the IDP from the ECP. The
  default session mapper uses OpenAM cookies as it would for any other client
  application. If for some reason you must change the mapping after writing
  and installing your own session mapper, you can change the class under
  Federation &gt; Entity Providers &gt; <em class="replaceable"><code>idp-name</code></em>
  &gt; IDP &gt; Advanced &gt; ECP Configuration.</p><p>By default an OpenAM service provider uses the
  <code class="literal">com.sun.identity.saml2.plugins.ECPIDPFinder</code> class to
  return identity providers from the list under Federation &gt; Entity
  Providers &gt; <em class="replaceable"><code>sp-name</code></em> &gt; SP &gt; Advanced
  &gt; ECP Configuration &gt; Request IDP List. You must populate the list
  with identity provider entity IDs.</p><div class="variablelist"><p>The endpoint for the ECP to contact on the OpenAM service provider is
   <code class="literal">/SPECP</code> as in
   <code class="literal">http://www.sp.example:8080/openam/SPECP</code>. The ECP provides
   two query string parameters to identify the service provider and to specify
   the URL of the resource to access.</p><dl class="variablelist"><dt><span class="term"><code class="literal">metaAlias</code></span></dt><dd><p>This specifies the service provider, by default
     <code class="literal">metaAlias=/<em class="replaceable"><code>realm-name</code></em>/sp</code>,
     as described in <a class="xref" href="#sp-meta-alias" title="MetaAlias">MetaAlias</a>.</p></dd><dt><span class="term"><code class="literal">RelayState</code></span></dt><dd><p>This specifies the resource the client aims to access such as
     <code class="literal">RelayState=http%3A%2F%2Fforgerock.org%2Findex.html</code>.</p></dd></dl></div><p>For example, the URL to access the service provider and finally
  the resource at <code class="literal">http://forgerock.org/index.html</code>
  could be
  <code class="literal">http://www.sp.example:8080/openam/SPECP?metaAlias=/sp&amp;RelayState=http%3A%2F%2Fforgerock.org%2Findex.html</code>.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="federation-linking-accounts"></a>11.11.&nbsp;Managing Federated Accounts</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="#transient-federation">11.11.1. Using Transient Federation Identifiers</a></span></dt><dt><span class="section"><a href="#persistent-federation">11.11.2. Using Persistent Federation Identifiers</a></span></dt><dt><span class="section"><a href="#change-federation">11.11.3. Changing Federation of Persistently Linked Accounts</a></span></dt><dt><span class="section"><a href="#terminate-federation">11.11.4. Terminating Federation of Persistently Linked Accounts</a></span></dt><dt><span class="section"><a href="#auto-federation">11.11.5. Configuring How Remote Accounts Map To Local Accounts</a></span></dt><dt><span class="section"><a href="#bulk-federation">11.11.6. Linking Federated Accounts in Bulk</a></span></dt><dt><span class="section"><a href="#saml2-authentication">11.11.7. Authentication &amp; Linked Accounts</a></span></dt></dl></div><a class="indexterm" name="d16037e26799"></a><p>Identity providers and service providers must be able to communicate
  about users. Yet in some cases the identity provider can choose to communicate
  a minimum of information about an authenticated user, with no user account
  maintained on the service provider side. In other cases the identity provider
  and service provider can choose to link user accounts in a persistent way, in
  a more permanent way, or even in automatic fashion by using some shared value
  in the user's profiles such as an email address or by dynamically creating
  accounts on the service provider when necessary. OpenAM supports all these
  alternatives.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="transient-federation"></a>11.11.1.&nbsp;Using Transient Federation Identifiers</h3></div></div></div><p>OpenAM allows you to link accounts using transient name identifiers,
   where the identity provider shares a temporary identifier with the service
   provider for the duration of the user session. Nothing is written to the
   user profile.</p><p>Transient identifiers are useful where the service is anonymous, and
   all users have similar access on the service provider side.</p><p>To use transient name identifiers, specify the name ID format
   <code class="literal">urn:oasis:names:tc:SAML:2.0:nameid-format:transient</code> when
   initiating single sign on.</p><p>The examples below work in an environment where the identity provider
   is <code class="literal">www.idp.example</code> and the service provider is
   <code class="literal">www.sp.example</code>. Both providers have deployed OpenAM on port
   8080 under deployment URI <code class="literal">/openam</code>.</p><p>To initiate single sign on from the service provider, access the
   following URL with at least the query parameters shown.</p><pre class="literallayout">http://www.sp.example:8080/openam/saml2/jsp/spSSOInit.jsp?
 idpEntityID=http%3A%2F%2Fwww.idp.example%3A8080%2Fopenam
 &amp;metaAlias=/sp
 &amp;NameIDFormat=urn:oasis:names:tc:SAML:2.0:nameid-format:transient</pre><p>For a complete list of query parameters, see <a class="xref" href="#spssoinit-parameters" title="spSSOInit.jsp Parameters"><code class="filename">spSSOInit.jsp</code> Parameters</a>.</p><p>To initiate single sign on from the identity provider, access the
   following URL with at least the query parameters shown.</p><pre class="literallayout">http://www.idp.example:8080/openam/saml2/jsp/idpSSOInit.jsp?
 spEntityID=http%3A%2F%2Fwww.sp.example%3A8080%2Fopenam
 &amp;metaAlias=/idp
 &amp;NameIDFormat=urn:oasis:names:tc:SAML:2.0:nameid-format:transient</pre><p>For a complete list of query parameters, see <a class="xref" href="#idpssoinit-parameters" title="idpSSOInit.jsp Parameters"><code class="filename">idpSSOInit.jsp</code> Parameters</a>.</p><p>The accounts are only linked for the duration of the session. Once the
   user logs out for example the accounts are no longer linked.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="persistent-federation"></a>11.11.2.&nbsp;Using Persistent Federation Identifiers</h3></div></div></div><p>OpenAM lets you use persistent pseudonym identifiers to federate user
   identities, linking accounts on the identity provider and service provider
   with a SAML persistent identifier.</p><p>Persistent identifiers are useful for establishing links between
   otherwise unrelated accounts.</p><p>The examples below work in an environment where the identity provider
   is <code class="literal">www.idp.example</code> and the service provider is
   <code class="literal">www.sp.example</code>. Both providers have deployed OpenAM on port
   8080 under deployment URI <code class="literal">/openam</code>.</p><p>To initiate single sign on from the service provider, access the
   following URL with at least the query parameters shown.</p><pre class="literallayout">http://www.sp.example:8080/openam/saml2/jsp/spSSOInit.jsp?
 idpEntityID=http%3A%2F%2Fwww.idp.example%3A8080%2Fopenam
 &amp;metaAlias=/sp
 &amp;NameIDFormat=urn:oasis:names:tc:SAML:2.0:nameid-format:persistent</pre><p>For a complete list of query parameters, see <a class="xref" href="#spssoinit-parameters" title="spSSOInit.jsp Parameters"><code class="filename">spSSOInit.jsp</code> Parameters</a>.</p><p>To initiate single sign on from the identity provider, access the
   following URL with at least the query parameters shown.</p><pre class="literallayout">http://www.idp.example:8080/openam/saml2/jsp/idpSSOInit.jsp?
 spEntityID=http%3A%2F%2Fwww.sp.example%3A8080%2Fopenam
 &amp;metaAlias=/idp
 &amp;NameIDFormat=urn:oasis:names:tc:SAML:2.0:nameid-format:persistent</pre><p>For a complete list of query parameters, see <a class="xref" href="#idpssoinit-parameters" title="idpSSOInit.jsp Parameters"><code class="filename">idpSSOInit.jsp</code> Parameters</a>.</p><p>On successful login, the accounts are persistently linked, with
   persistent identifiers stored in the user's accounts on the identity provider
   and the service provider.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="change-federation"></a>11.11.3.&nbsp;Changing Federation of Persistently Linked Accounts</h3></div></div></div><p>OpenAM implements the SAML 2.0 Name Identifier Management profile,
   allowing you to change a persistent identifier that has been set to federate
   accounts, and also to terminate federation for an account.</p><p>When user accounts are stored in an LDAP directory server, name
   identifier information is stored on the
   <code class="literal">sun-fm-saml2-nameid-info</code> and
   <code class="literal">sun-fm-saml2-nameid-infokey</code> attributes of a user's
   entry.<a href="#ftn.d16037e26896" class="footnote" name="d16037e26896"><sup class="footnote">[8]</sup></a></p><p>
    You can retrieve the name identifier value on the IDP side
    by checking the value of <code class="literal">sun-fm-saml2-nameid-infokey</code>.
    For example, if the user's entry in the directory shows
    <code class="literal">sun-fm-saml2-nameid-infokey:
    http://www.idp.example:8080/openam|http://www.sp.example:8080/openam|
    XyfFEsr6Vixbnt0BSqIglLFMGjR2</code>,
    then the name identifier on the IDP side is
    <code class="literal">XyfFEsr6Vixbnt0BSqIglLFMGjR2</code>.
   </p><p>You can use this identifier to initiate a change request from the
   service provider as in the following example.</p><pre class="literallayout">http://www.sp.example:8080/openam/saml2/jsp/spMNIRequestInit.jsp?
 idpEntityID=http%3A%2F%2Fwww.idp.example%3A8080%2Fopenam
 &amp;metaAlias=/sp
 &amp;requestType=NewID
 &amp;IDPProvidedID=XyfFEsr6Vixbnt0BSqIglLFMGjR2</pre><p>If desired, you can substitute <code class="literal">openam/SPMniInit</code>
   for <code class="literal">openam/saml2/jsp/spMNIRequestInit.jsp</code></p><p>You can also initiate the change request from the identity provider
   as in the following example.</p><pre class="literallayout">http://www.idp.example:8080/openam/saml2/jsp/idpMNIRequestInit.jsp?
 spEntityID=http%3A%2F%2Fwww.sp.example%3A8080%2Fopenam
 &amp;metaAlias=/idp
 &amp;requestType=NewID
 &amp;IDPProvidedID=XyfFEsr6Vixbnt0BSqIglLFMGjR2</pre><p>If desired, you can substitute <code class="literal">openam/IDPMniInit</code>
   for <code class="literal">openam/saml2/jsp/idpMNIRequestInit.jsp</code></p><p>
    You can retrieve the name identifier value on the SP side
    by checking the value of <code class="literal">sun-fm-saml2-nameid-info</code>.
    For example, if the user's entry in the directory shows
    <code class="literal">sun-fm-saml2-nameid-info:
     http://www.sp.example:8080/openam|
     http://www.idp.example:8080/openam|
     ATo9TSA9Y2Ln7DDrAdO3HFfH5jKD|
     http://www.idp.example:8080/openam|
     urn:oasis:names:tc:SAML:2.0:nameid-format:persistent|
     9B1OPy3m0ejv3fZYhlqxXmiGD24c|
     http://www.sp.example:8080/openam|
     SPRole|
     false</code>,
    then the name identifier on the SP side is
    <code class="literal">9B1OPy3m0ejv3fZYhlqxXmiGD24c</code>.
   </p><div class="variablelist"><a name="idpmnirequestinit-parameters"></a><div class="variablelist-title"><code class="filename">idpMNIRequestInit.jsp</code> Parameters</div><dl class="variablelist"><dt><span class="term"><code class="literal">spEntityID</code></span></dt><dd><p>(Required) Use this parameter to indicate the remote service
      provider. Make sure you URL encode the value. For example, specify
      <code class="literal">spEntityID=http://www.sp.example:8080/openam</code> as
      <code class="literal">spEntityID=http%3A%2F%2Fwww.sp.example%3A8080%2Fopenam</code>.</p></dd><dt><span class="term"><code class="literal">metaAlias</code></span></dt><dd><p>(Required) Use this parameter to specify the local alias for the
      provider, such as <code class="literal">metaAlias=/myRealm/idp</code>. This
      parameter takes the format
      <code class="literal">/<em class="replaceable"><code>realm-name</code></em>/<em class="replaceable"><code>provider-name</code></em></code> as described in <a class="xref" href="#idp-meta-alias" title="MetaAlias">MetaAlias</a>. You do not repeat the slash for
      the top level realm, for example <code class="literal">metaAlias=/idp</code>.</p></dd><dt><span class="term"><code class="literal">requestType</code></span></dt><dd><p>(Required) Type of manage name ID request, either
      <code class="literal">NewID</code> to change the ID, or <code class="literal">Terminate</code>
      to remove the information that links the accounts on the identity provider
      and service provider.</p></dd><dt><span class="term"><code class="literal">SPProvidedID</code></span></dt><dd><p>(Required if <code class="literal">requestType=NewID</code>) Name identifier
      in use as described above.</p></dd><dt><span class="term"><code class="literal">affiliationID</code></span></dt><dd><p>(Optional) Use this parameter to specify a SAML affiliation
      identifier.</p></dd><dt><span class="term"><code class="literal">binding</code></span></dt><dd><p>(Optional) Use this parameter to indicate what binding to use for
      the operation. The full, long name format is required for this parameter
      to work.</p><div class="itemizedlist"><p>The value must be one of the following.</p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST</code></p></li><li class="listitem"><p><code class="literal">urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect</code></p></li><li class="listitem"><p><code class="literal">urn:oasis:names:tc:SAML:2.0:bindings:SOAP</code></p></li></ul></div></dd><dt><span class="term"><code class="literal">relayState</code></span></dt><dd><p>(Optional) Use this parameter to specify where to redirect the user
      when the process is complete. Make sure you URL encode the value. For
      example, <code class="literal">relayState=http%3A%2F%2Fforgerock.com</code>
      takes the user to <code class="literal">http://forgerock.com</code>.</p></dd></dl></div><div class="variablelist"><a name="spmnirequestinit-parameters"></a><div class="variablelist-title"><code class="filename">spMNIRequestInit.jsp</code> Parameters</div><dl class="variablelist"><dt><span class="term"><code class="literal">idpEntityID</code></span></dt><dd><p>(Required) Use this parameter to indicate the remote identity
      provider. Make sure you URL encode the value. For example, specify
      <code class="literal">idpEntityID=http://www.idp.example:8080/openam</code> as
      <code class="literal">idpEntityID=http%3A%2F%2Fwww.idp.example%3A8080%2Fopenam</code>.</p></dd><dt><span class="term"><code class="literal">metaAlias</code></span></dt><dd><p>(Required) Use this parameter to specify the local alias for the
      provider, such as <code class="literal">metaAlias=/myRealm/sp</code>. This parameter
      takes the format <code class="literal">/<em class="replaceable"><code>realm-name</code></em>/<em class="replaceable"><code>provider-name</code></em></code> as described in <a class="xref" href="#sp-meta-alias" title="MetaAlias">MetaAlias</a>. You do not repeat the slash for the
      top level realm, <code class="literal">metaAlias=/sp</code>.</p></dd><dt><span class="term"><code class="literal">requestType</code></span></dt><dd><p>(Required) Type of manage name ID request, either
      <code class="literal">NewID</code> to change the ID, or <code class="literal">Terminate</code>
      to remove the information that links the accounts on the identity provider
      and service provider.</p></dd><dt><span class="term"><code class="literal">IDPProvidedID</code></span></dt><dd><p>(Required if <code class="literal">requestType=NewID</code>) Name identifier
      in use as described above.</p></dd><dt><span class="term"><code class="literal">affiliationID</code></span></dt><dd><p>(Optional) Use this parameter to specify a SAML affiliation
      identifier.</p></dd><dt><span class="term"><code class="literal">binding</code></span></dt><dd><p>(Optional) Use this parameter to indicate what binding to use for
      the operation. The full, long name format is required for this parameter
      to work.</p><div class="itemizedlist"><p>The value must be one of the following.</p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST</code></p></li><li class="listitem"><p><code class="literal">urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect</code></p></li><li class="listitem"><p><code class="literal">urn:oasis:names:tc:SAML:2.0:bindings:SOAP</code></p></li></ul></div></dd><dt><span class="term"><code class="literal">relayState</code></span></dt><dd><p>(Optional) Use this parameter to specify where to redirect the user
      when the process is complete. Make sure you URL encode the value. For
      example, <code class="literal">relayState=http%3A%2F%2Fforgerock.com</code>
      takes the user to <code class="literal">http://forgerock.com</code>.</p></dd></dl></div><p>You can terminate federation as described in <a class="xref" href="#terminate-federation" title="11.11.4.&nbsp;Terminating Federation of Persistently Linked Accounts">Section&nbsp;11.11.4, &#8220;Terminating Federation of Persistently Linked Accounts&#8221;</a>.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="terminate-federation"></a>11.11.4.&nbsp;Terminating Federation of Persistently Linked Accounts</h3></div></div></div><p>OpenAM lets you terminate account federation, where the accounts have
   been linked with a persistent identifier as described in <a class="xref" href="#persistent-federation" title="11.11.2.&nbsp;Using Persistent Federation Identifiers">Section&nbsp;11.11.2, &#8220;Using Persistent Federation Identifiers&#8221;</a>.</p><p>The examples below work in an environment where the identity provider
   is <code class="literal">www.idp.example</code> and the service provider is
   <code class="literal">www.sp.example</code>. Both providers have deployed OpenAM on port
   8080 under deployment URI <code class="literal">/openam</code>.</p><p>To initiate the process of terminating account federation from the
   service provider, access the following URL with at least the query
   parameters shown.</p><pre class="literallayout">http://www.sp.example:8080/openam/saml2/jsp/spMNIRequestInit.jsp?
 idpEntityID=http%3A%2F%2Fwww.idp.example%3A8080%2Fopenam
 &amp;metaAlias=/sp
 &amp;requestType=Terminate</pre><p>To initiate the process of terminating account federation from the
   identity provider, access the following URL with at least the query
   parameters shown.</p><pre class="literallayout">http://www.idp.example:8080/openam/saml2/jsp/idpMNIRequestInit.jsp?
 spEntityID=http%3A%2F%2Fwww.sp.example%3A8080%2Fopenam
 &amp;metaAlias=/idp
 &amp;requestType=Terminate</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="auto-federation"></a>11.11.5.&nbsp;Configuring How Remote Accounts Map To Local Accounts</h3></div></div></div><p>OpenAM lets you configure the service provider to link an account
   based on an attribute value from the identity provider. When you know
   the user accounts on both the identity provider and the service provider
   share a common attribute value, such as an email address or other unique
   user identifier, you can use this method to link accounts without user
   interaction. See <a class="xref" href="#auto-federate-based-on-attribute" title="Procedure&nbsp;11.13.&nbsp;To Map Accounts Based on an Attribute Value">Procedure&nbsp;11.13, &#8220;To Map Accounts Based on an Attribute Value&#8221;</a>.</p><p>OpenAM also lets you map users on the identity provider temporarily to
   a single anonymous user account on the service provider, in order to
   exchange attributes about the user without a user-specific account on the
   service provider. This approach can be useful when the service provider
   either needs no user-specific account to provide a service, or when you
   do not want to retain a user profile on the service provider but instead
   you make authorization decisions based on attribute values from the identity
   provider. See <a class="xref" href="#auto-federate-using-anonymous" title="Procedure&nbsp;11.14.&nbsp;To Map Remote Accounts to a Single Service Provider Account">Procedure&nbsp;11.14, &#8220;To Map Remote Accounts to a Single Service Provider Account&#8221;</a>.</p><p>OpenAM further allows you to use attributes from the identity provider
   to create accounts dynamically on the service provider. When using this
   method, you should inform the user and obtain consent to create the account
   if necessary. See <a class="xref" href="#auto-federate-with-dynamic-creation" title="Procedure&nbsp;11.15.&nbsp;To Map Accounts With Dynamic Service Provider Account Creation">Procedure&nbsp;11.15, &#8220;To Map Accounts With Dynamic Service Provider Account Creation&#8221;</a>.</p><div class="procedure"><a name="auto-federate-based-on-attribute"></a><div class="procedure-title">Procedure&nbsp;11.13.&nbsp;To Map Accounts Based on an Attribute Value</div><p>The following steps demonstrate how to map accounts based
    on an attribute value that is the same in both accounts.</p><p>Perform the following steps on the hosted identity provider(s), and
    again on the hosted service provider(s).</p><ol class="procedure" type="1"><li class="step"><p>Login to the OpenAM console as administrator.</p></li><li class="step"><p>Browse to Federation &gt; <em class="replaceable"><code>hosted-provider-name</code></em> &gt; Assertion Processing.</p></li><li class="step"><p>
      If the attribute to use when linking accounts is not yet included
      in the attribute map, add the attribute mapping, and then Save your work.
     </p></li><li class="step"><p>On the hosted service provider, under Auto Federation, select
     Enabled and enter the local attribute name in the Attribute field, and
     then Save your work.</p></li></ol></div><div class="procedure"><a name="auto-federate-using-anonymous"></a><div class="procedure-title">Procedure&nbsp;11.14.&nbsp;To Map Remote Accounts to a Single Service Provider Account</div><p>The following steps demonstrate how to auto-federate using a single
    anonymous user account on the service provider.</p><p>Perform the following steps on the hosted identity provider(s), and
    again on the hosted service provider(s).</p><ol class="procedure" type="1"><li class="step"><p>Login to the OpenAM console as administrator.</p></li><li class="step"><p>Browse to Federation &gt; <em class="replaceable"><code>hosted-provider-name</code></em> &gt; Assertion Processing.</p></li><li class="step"><p>If you want to get attributes from the identity provider and the
     attributes are not yet in the attribute map, add the attribute mappings,
     and then Save your work.</p></li><li class="step"><p>On the hosted service provider, under Transient User, set the
     single account to which to map all users, such as
     <code class="literal">anonymous</code>, and then Save your work.</p></li><li class="step"><p>After completing configuration on the providers, use transient
     identifiers to federate as described in <a class="xref" href="#transient-federation" title="11.11.1.&nbsp;Using Transient Federation Identifiers">Section&nbsp;11.11.1, &#8220;Using Transient Federation Identifiers&#8221;</a>.</p></li></ol></div><div class="procedure"><a name="auto-federate-with-dynamic-creation"></a><div class="procedure-title">Procedure&nbsp;11.15.&nbsp;To Map Accounts With Dynamic Service Provider Account Creation</div><p>
     The following steps demonstrate how to map accounts
     with dynamic creation of missing accounts on the service provider side.
    </p><ol class="procedure" type="1"><li class="step"><p>Set up a mapping based on an attribute value as described in <a class="xref" href="#auto-federate-based-on-attribute" title="Procedure&nbsp;11.13.&nbsp;To Map Accounts Based on an Attribute Value">Procedure&nbsp;11.13, &#8220;To Map Accounts Based on an Attribute Value&#8221;</a>. The attributes you map
     from the identity provider are those that the service provider sets on
     the dynamically created accounts.</p></li><li class="step"><p>On the service provider console, browse to Access Control &gt;
     <em class="replaceable"><code>realm-name</code></em> &gt; Authentication &gt; All Core
     Settings..., and Dynamic or Dynamic with User Alias, which are described
     in <a href="../admin-guide/index.html#core-module-conf-hints" class="link"><em class="citetitle">Hints For the
     Core Authentication Module</em></a>, and then Save your
     work.</p></li><li class="step"><p>To test your work, create a user on the identity provider, log
     out of the console, and initiate SSO logging in as the user you
     created.</p><p>To initiate SSO, browse to one of the OpenAM SAML 2.0 JSPs with the
     appropriate query parameters. The following is an example URL for service
     provider initiated SSO.</p><pre class="literallayout">http://www.sp.example:8080/openam/saml2/jsp/spSSOInit.jsp?
 idpEntityID=http%3A%2F%2Fwww.idp.example%3A8080%2Fopenam
 &amp;metaAlias=/sp</pre><p>On success, check <code class="literal">http://www.sp.example:8080/openam/idm/EndUser</code> to see the new user
     account.</p></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="bulk-federation"></a>11.11.6.&nbsp;Linking Federated Accounts in Bulk</h3></div></div></div><p>If you manage both the identity provider and service provider, you
   can link accounts out-of-band, in bulk. You make permanent connections for a
   list of identity provider and service provider by using the
   <span class="command"><strong>ssoadm</strong></span> bulk federation commands.</p><p>Before you can run the bulk federation commands, first establish the
   relationship between accounts, set up the providers as described in
   <a class="xref" href="#set-up-federation" title="11.2.&nbsp;Setting Up SAML 2.0 SSO">Section&nbsp;11.2, &#8220;Setting Up SAML 2.0 SSO&#8221;</a>, and install the
   <span class="command"><strong>ssoadm</strong></span> command as described in <a href="../install-guide/index.html#install-openam-admin-tools" class="link"><em class="citetitle">To Set Up
   Administration Tools</em></a>.</p><p>To understand the relationships between accounts, consider an example
   where the identity provider is at <code class="literal">idp.example.org</code> and the
   service provider is at <code class="literal">sp.example.com</code>. A demo user
   account has the Universal ID,
   <code class="literal">id=demo,ou=user,dc=example,dc=org</code>, on the identity
   provider. That maps to the Universal ID,
   <code class="literal">id=demo,ou=user,dc=example,dc=com</code>, on the service
   provider.</p><p>The <span class="command"><strong>ssoadm</strong></span> command then needs a file that maps
   local user IDs to remote user IDs, one per line, separated by the vertical
   bar character <code class="literal">|</code>. Each line of the file appears as
   follows.</p><pre class="literallayout"><em class="replaceable"><code>local-user-ID</code></em>|<em class="replaceable"><code>remote-user-ID</code></em></pre><p>In the example, starting on the service provider side, the line for
   the demo user reads as follows.</p><pre class="literallayout">id=demo,ou=user,dc=example,dc=com|id=demo,ou=user,dc=example,dc=org</pre><p>All the users&#8217; accounts mapped in your file must exist at the identity
   provider and the service provider when you run the commands to link
   them.</p><div class="orderedlist"><p>Link the accounts using the <span class="command"><strong>ssoadm</strong></span> bulk federation
    commands.</p><ol class="orderedlist" type="1"><li class="listitem"><p>Prepare the data with the
     <span class="command"><strong>ssoadm do-bulk-federation</strong></span> command.</p><p>The following example starts on the service provider side.</p><div class="screen"><pre>
$ <strong>cat /tmp/user-map.txt</strong>
<em>id=demo,ou=user,dc=example,dc=com|id=demo,ou=user,dc=example,dc=org</em>
$ <strong>ssoadm  \
 do-bulk-federation \
 --metaalias /sp \
 --remoteentityid http://idp.example.org:8080/openam \
 --useridmapping /tmp/user-map.txt \
 --nameidmapping /tmp/name-map.txt \
 --adminid amadmin  \
 --password-file /tmp/pwd.txt \
 --spec saml2</strong>

<em>Bulk Federation for this host was completed. To complete the
federation, name Id mapping file should be loaded to remote
provider.</em>
     </pre></div></li><li class="listitem"><p>Copy the name ID mapping output file to the other provider.</p><div class="screen"><pre>
$ <strong>scp /tmp/name-map.txt openam@idp.example.org:/tmp/name-map.txt</strong>
<em>openam@idp.example.org's password:
name-map.txt                     100%  177     0.2KB/s   00:00</em>
     </pre></div></li><li class="listitem"><p>Import the name ID mapping file with the
     <span class="command"><strong>ssoadm import-bulk-fed-data</strong></span> command.</p><p>The following example is performed on the identity provider
     side.</p><div class="screen"><pre>
$ <strong>ssoadm \
 import-bulk-fed-data \
 --adminid amadmin \
 --password-file /tmp/pwd.txt \
 --metaalias /idp \
 --bulk-data-file /tmp/name-map.txt</strong>

<em>Bulk Federation for this host was completed.</em>
     </pre></div></li></ol></div><p>At this point the accounts are linked.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="saml2-authentication"></a>11.11.7.&nbsp;Authentication &amp; Linked Accounts</h3></div></div></div><p>
    In a SAML 2.0 federation where accounts are durably linked,
    authentication is required only on the identity provider side.
   </p><p>
    Authentication is also required however on the service provider side
    when the OpenAM account mapper on the service provider is not able to map
    the user identified in the SAML assertion from the identity provider
    to a local user account.
   </p><p>
    This can happen for example the first time accounts are linked
    as described in <a class="xref" href="#persistent-federation" title="11.11.2.&nbsp;Using Persistent Federation Identifiers">Section&nbsp;11.11.2, &#8220;Using Persistent Federation Identifiers&#8221;</a>,
    after which the persistent identifier establishes the mapping.
   </p><p>
    This also happens when transient identifiers are used to map accounts.
    When accounts are linked as described in
    <a class="xref" href="#transient-federation" title="11.11.1.&nbsp;Using Transient Federation Identifiers">Section&nbsp;11.11.1, &#8220;Using Transient Federation Identifiers&#8221;</a>,
    then the service provider must locally authenticate the user
    for every SAML assertion received.
    This is because the identifier used to link the accounts is transient:
    it does not provide a durable means to link the accounts.
   </p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="using-saml2-artifacts"></a>11.12.&nbsp;Using SAML 2.0 Artifacts</h2></div></div></div><p>By default OpenAM transmits SAML messages by value. This makes it
  possible to access the SAML messages in the user agent. You can instead
  request that OpenAM transmit SAML messages by reference using SAML artifacts,
  which are small values that reference a SAML message. Providers then
  communicate directly to resolve artifacts, rather than sending the messages
  through the user agent.</p><p>When initiating single sign-on using <code class="filename">idpSSOInit.jsp</code>
  or <code class="filename">spSSOInit.jsp</code> for example, add
  <code class="literal">binding=HTTP-Artifact</code> to the list of query parameters.
  The following example works in an environment where the identity provider is
  <code class="literal">www.idp.example</code> and the service provider is
  <code class="literal">www.sp.example</code>. Both providers have deployed OpenAM on port
  8080 under deployment URI <code class="literal">/openam</code>.</p><pre class="literallayout">http://www.sp.example:8080/openam/saml2/jsp/spSSOInit.jsp?
   idpEntityID=http%3A%2F%2Fwww.idp.example%3A8080%2Fopenam
   &amp;metaAlias=/sp
   &amp;binding=HTTP-Artifact</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="using-saml2-with-policy-agents"></a>11.13.&nbsp;SAML 2.0 &amp; Policy Agents</h2></div></div></div><p>
   You can use policy agents in a SAML 2.0 Federation deployment.
  </p><div class="procedure"><a name="policy-agent-with-saml2"></a><div class="procedure-title">Procedure&nbsp;11.16.&nbsp;To Use a Policy Agent with a SAML 2.0 Service Provider</div><p>
    The following procedure applies
    when OpenAM is configured as an IDP in one domain,
    and the desired policy agent protects resources
    on behalf of a second OpenAM server configured as an SP on a second domain.
   </p><ol class="procedure" type="1"><li class="step"><p>
     Install the policy agent.
    </p><p>
     The basic process for installing policy agents is available in the
     <a class="link" href="http://docs.forgerock.org/en/openam-pa/3.3.0/web-users-guide/#web-users-guide" target="_blank"><em class="citetitle">Web Policy Agent User's Guide</em></a>
     and the
     <a class="link" href="http://docs.forgerock.org/en/openam-pa/3.3.0/jee-users-guide/#jee-users-guide" target="_blank"><em class="citetitle">Java EE Policy Agent User's Guide</em></a>.
    </p></li><li class="step"><p>
     Replace the given OpenAM Login URL and OpenAM Logout URLs
     with SAML 2.0 URLs described in <a class="xref" href="#using-saml2-sso-slo" title="11.9.&nbsp;Using SAML 2.0 Single Sign-On &amp; Single Logout">Section&nbsp;11.9, &#8220;Using SAML 2.0 Single Sign-On &amp; Single Logout&#8221;</a>.
    </p><p>
     The following steps explain how to do this for web policy agents.
    </p><ul class="stepalternatives">
     <li class="step"><p>
       If you have configured the Web policy agents to store their properties
       centralized on an OpenAM server, navigate to the URL for the OpenAM console.
       Select Access Control &gt; <em class="replaceable"><code>Realm Name</code></em> &gt;
       Agents &gt; Web &gt; <em class="replaceable"><code>Agent Name</code></em> &gt; OpenAM Services.
      </p><p>
       For the Web Agent, under the OpenAM Services tab,
       in the Agent Logout URL section, set up a list of application logout URLs.
       In the Logout Redirect URL text box,
       enter an appropriate URL to redirect the user after logout.
      </p></li>

     <li class="step"><p>
       Alternatively, if the Web policy agents are set up to store properties
       on local systems,
       find the <code class="filename">OpenSSOAgentConfiguration.properties</code> file
       in the <code class="filename">/path/to/agent/config/</code> directory.
      </p><p>
       You can specify OpenAM Login and Logout URLs
       with the <code class="literal">com.sun.identity.agents.config.login.url</code>
       and <code class="literal">com.sun.identity.agents.config.logout.url</code>
       attributes, respectively.
      </p></li>
    </ul></li></ol></div></div><div class="footnotes"><br><hr class="footnote-hr"><div id="ftn.d16037e26896" class="footnote"><p><a href="#d16037e26896" class="para"><sup class="para">[8] </sup></a>These attribute types are configurable in the OpenAM
   console under Configuration &gt; Global &gt; SAMLv2 Service
   Configuration.</p></div></div></div><div lang="en" class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="chap-oauth2"></a>Chapter&nbsp;12.&nbsp;Managing OAuth 2.0 Authorization</h1></div></div></div><div class="toc"><div class="toc-title">Table of Contents</div><dl class="toc"><dt><span class="section"><a href="#about-oauth2-support">12.1. About OAuth 2.0 Support in OpenAM</a></span></dt><dt><span class="section"><a href="#configure-oauth2-authz">12.2. Configuring the OAuth 2.0 Authorization Service</a></span></dt><dt><span class="section"><a href="#register-oauth2-client">12.3. Registering OAuth 2.0 Clients with the Authorization Service</a></span></dt><dt><span class="section"><a href="#oauth2-manage-tokens">12.4. Managing OAuth 2.0 Tokens</a></span></dt><dt><span class="section"><a href="#oauth2-security-considerations">12.5. Security Considerations</a></span></dt></dl></div><a class="indexterm" name="d16037e27502"></a><a class="indexterm" name="d16037e27507"></a><p>This chapter covers OpenAM support for the OAuth 2.0 authorization
 framework. The chapter begins by showing where OpenAM fits into the OAuth 2.0
 authorization framework, and then shows how to configure the
 functionality.</p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="about-oauth2-support"></a>12.1.&nbsp;About OAuth 2.0 Support in OpenAM</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="#openam-oauth2-authz-server">12.1.1. OpenAM as OAuth 2.0 Authorization Server</a></span></dt><dt><span class="section"><a href="#openam-oauth2-client">12.1.2. OpenAM as OAuth 2.0 Client &amp; Resource Server Solution</a></span></dt><dt><span class="section"><a href="#oauth2-byo-client">12.1.3. Using Your Own Client &amp; Resource Server</a></span></dt></dl></div><a class="indexterm" name="d16037e27515"></a><p>RFC 6749, <a class="link" href="http://tools.ietf.org/html/rfc6749" target="_blank"><em class="citetitle">The OAuth 2.0 Authorization Framework</em></a>,
  provides a standard way for <em class="firstterm">resource owners</em> to grant
  <em class="firstterm">client</em> applications access to the owners' web-based
  resources. The canonical example involves a user (resource owner) granting
  access to a printing service (client) to print photos that the user has
  stored on a photo-sharing server.</p><p>The section describes how OpenAM supports the OAuth 2.0 authorization
  framework in terms of the roles that OpenAM plays.<a href="#ftn.d16037e27534" class="footnote" name="d16037e27534"><sup class="footnote">[9]</sup></a> The following sequence diagram indicates the primary roles
  OpenAM can play in the OAuth 2.0 protocol flow.</p><div class="mediaobject" align="center"><a name="figure-oauth2-flow"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/oauth2-flow.png" align="middle" height="360" alt="OpenAM in OAuth 2.0 protocol flow"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-oauth2-flow.html" target="longdesc">D</a>]</span></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="openam-oauth2-authz-server"></a>12.1.1.&nbsp;OpenAM as OAuth 2.0 Authorization Server</h3></div></div></div><a class="indexterm" name="d16037e27552"></a><p>OpenAM can function as an OAuth 2.0 <em class="firstterm">authorization
   server</em>. In this role, OpenAM authenticates resource owners and
   obtains their authorization in order to return access tokens to
   clients.</p><p>
    When using OpenAM as authorization server,
    you can register clients in OpenAM Console alongside policy agent profiles
    under the OAuth 2.0 Client tab.

    OpenAM supports both confidential and public clients.
   </p><p>OpenAM supports the four main grants for obtaining authorization
   described in RFC 6749: the authorization code grant, the implicit grant,
   the resource owner password credentials grant, and the client credentials
   grant. See RFC 6749 for details on the authorization grant process, and
   for details on how clients should make authorization requests and handle
   authorization responses. OpenAM also supports the <a class="link" href="http://tools.ietf.org/html/draft-ietf-oauth-saml2-bearer" target="_blank"><em class="citetitle">SAML 2.0 Bearer Assertion Profiles for OAuth 2.0</em></a>,
   described in the Internet-Draft.</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="oauth2-authz"></a>12.1.1.1.&nbsp;OAuth 2.0 Authorization Grant</h4></div></div></div><p>The authorization code grant starts with the client, such as a
    web-based service, redirecting the resource owner's user-agent to the OpenAM
    authorization service. After authenticating the resource owner and
    obtaining the resource owner's authorization, OpenAM redirects the resource
    owner's user-agent back to the client with an authorization code that the
    client uses to request the access token. The following sequence diagram
    outlines a successful process from initial client redirection through to the
    client accessing the protected resource.</p><div class="mediaobject" align="center"><a name="figure-oauth2-authz"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/oauth2-authz.png" align="middle" height="360" alt="OpenAM in OAuth 2.0 Authorization Code Grant process"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-oauth2-authz.html" target="longdesc">D</a>]</span></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="oauth2-implicit"></a>12.1.1.2.&nbsp;OAuth 2.0 Implicit Grant</h4></div></div></div><a class="indexterm" name="d16037e27586"></a><p>The implicit grant is designed for clients implemented to run inside
    the resource-owner user agent. Instead of providing an authorization code
    that the client must use to retrieve an access token, OpenAM returns the
    access token directly in the fragment portion of the redirect URI. The
    following sequence diagram outlines the successful process.</p><div class="mediaobject" align="center"><a name="figure-oauth2-implicit"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/oauth2-implicit.png" align="middle" height="360" alt="OpenAM in OAuth 2.0 Implicit Grant process"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-oauth2-implicit.html" target="longdesc">D</a>]</span></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="oauth2-ropc"></a>12.1.1.3.&nbsp;OAuth 2.0 Resource Owner Password Credentials Grant</h4></div></div></div><p>The resource owner password credentials grant lets the client use the
    resource owner's user name and password to get an access token directly.
    Although this grant might seem to conflict with an original OAuth goal of
    not having to share resource owner credentials with the client, it can
    makes sense in a secure context where other authorization grant types are
    not available, such as a client that is part of a device operating system
    using the resource owner credentials once and thereafter using refresh tokens
    to continue accessing resources. The following sequence diagram shows the
    successful process.</p><div class="mediaobject" align="center"><a name="figure-oauth2-ropc"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/oauth2-ropc.png" align="middle" height="360" alt="OpenAM in OAuth 2.0 Resource Owner Password Credentials Grant process"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-oauth2-ropc.html" target="longdesc">D</a>]</span></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="oauth2-client-cred"></a>12.1.1.4.&nbsp;OAuth 2.0 Client Credentials Grant</h4></div></div></div><a class="indexterm" name="d16037e27617"></a><p>The client credentials grant uses client credentials as an
    authorization grant. This grant makes sense when the client is also the
    resource owner, for example. The following sequence diagram shows the
    successful process.</p><div class="mediaobject" align="center"><a name="figure-oauth2-client-cred"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/oauth2-client-cred.png" align="middle" height="360" alt="OpenAM in OAuth 2.0 Client Credentials Grant process"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-oauth2-client-cred.html" target="longdesc">D</a>]</span></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="oauth2-jwt-bearer"></a>12.1.1.5.&nbsp;JWT Bearer Profile</h4></div></div></div><a class="indexterm" name="d16037e27635"></a><p>
     The Internet-Draft,
     <a class="link" href="http://self-issued.info/docs/draft-ietf-oauth-jwt-bearer.html" target="_blank"><em class="citetitle">JSON Web Token (JWT) Profile for OAuth 2.0 Client
      Authentication and Authorization Grants</em></a>
     describes a means to use a JWT for client authentication
     or to use a JWT to request an access token.
     When clients are also resource owners,
     the profile allows clients to issue JWTs to obtain access tokens
     rather than use the resource owner password credentials grant.
    </p><p>
     OpenAM implements both features of the profile.
     Both involve HTTP POST requests to the access token endpoint.
    </p><p>
     When the client bearing the JWT uses it for authentication,
     then in the POST data the client sets
     <code class="literal">client_assertion_type</code> to
     <code class="literal">urn:ietf:params:oauth:client-assertion-type:jwt-bearer</code>
     and <code class="literal">client_assertion</code> to the JWT string.
    </p><div class="mediaobject" align="center"><a name="figure-oauth2-jwt-bearer-authn"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/oauth2-jwt-bearer-authn.png" align="middle" height="360" alt="JWT Bearer Client Authentication"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-oauth2-jwt-bearer-authn.html" target="longdesc">D</a>]</span></div></div><p>
     The HTTP POST to OpenAM looks something like the following,
     where the assertion value is the JWT.
    </p><pre class="brush: http;">
POST /openam/oauth2/access_token HTTP/1.1
Host: openam.example.com
Content-Type: application/x-www-form-urlencoded

grant_type=authorization_code&amp;
code=362ad374-735c-4f69-aa8e-bf384f8602de&amp;
client_assertion_type=urn%3Aietf%3Aparams%3Aoauth%3A
 client-assertion-type%3Ajwt-bearer&amp;
client_assertion=eyAiYWxnIjogIlJTMjU2IiB9.eyAic3ViIjogImp3...
    </pre><p>
     When the client bearing the JWT uses it as an authorization grant,
     then in the POST data the client sets
     <code class="literal">grant_type</code> to
     <code class="literal">urn:ietf:params:oauth:grant-type:jwt-bearer</code>
     and <code class="literal">assertion</code> to the JWT string.
    </p><div class="mediaobject" align="center"><a name="figure-oauth2-jwt-bearer-authz"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/oauth2-jwt-bearer-authz.png" align="middle" height="360" alt="JWT Bearer as Authorization Grant"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-oauth2-jwt-bearer-authz.html" target="longdesc">D</a>]</span></div></div><p>
     The HTTP POST to OpenAM looks something like the following,
     where the assertion value is the JWT.
     This listing does not show the client credentials,
     which must be provided, for example
     as form parameters, a JWT token, or an authorization header.
    </p><pre class="brush: http;">
POST /openam/oauth2/access_token HTTP/1.1
Host: openam.example.com
Content-Type: application/x-www-form-urlencoded

grant_type=urn%3Aietf%3Aparams%3Aoauth%3Agrant-type%3Ajwt-bearer&amp;
assertion=eyAiYWxnIjogIlJTMjU2IiB9.eyAic3ViIjogImp3...
    </pre><p>
     In both profiles, OpenAM must be able to validate the JWT.
    </p><div class="itemizedlist"><p>
      For validation, the JWT must include the following claims:
     </p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
       "iss" (issuer) whose value identifies the JWT issuer
      </p></li><li class="listitem"><p>
       "sub" (subject) whose value identifies the principal
       who is the subject of the JWT
      </p><p>
       For client authentication, the "sub" value
       must be the same as the value of the "client_id".
      </p></li><li class="listitem"><p>
       "aud" (audience) whose value identifies the authorization server
       that is the intended audience of the JWT
      </p><p>
       When the JWT is used for authentication,
       this is the OpenAM access token endpoint.
      </p></li><li class="listitem"><p>
       "exp" (expiration) whose value specifies the time of expiration
      </p></li></ul></div><p>
     Also for validation, the issuer must digitally sign the JWT
     or apply a keyed message digest.
     When the issuer is also the client,
     the client can sign the JWT by using a private key,
     and include the public key in its profile registered with OpenAM.
    </p><p>
     A sample Java-based client is
     <a class="link" href="https://github.com/markcraig/jwt-bearer-client" target="_blank">available online</a>.
    </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="oauth2-saml2-bearer"></a>12.1.1.6.&nbsp;SAML 2.0 Bearer Assertion Profiles</h4></div></div></div><a class="indexterm" name="d16037e27725"></a><p>The Internet-Draft, <a class="link" href="http://tools.ietf.org/html/draft-ietf-oauth-saml2-bearer" target="_blank"><em class="citetitle">SAML 2.0 Bearer Assertion Profiles for OAuth 2.0</em></a>,
    describes a means to use SAML 2.0 assertions to request access tokens and
    to authenticate OAuth 2.0 clients.</p><p>At present OpenAM implements the profile to request access
    tokens.</p><p>In both profiles, the issuer must sign the assertion. The client
    communicates the assertion over a channel protected with transport
    layer security, by performing an HTTP POST to the OpenAM's access token
    endpoint. OpenAM as OAuth 2.0 authorization server uses the issuer ID to
    validate the signature on the assertion.</p><p>In the profile to request an access token, the OAuth 2.0 client
    bears a SAML 2.0 assertion that was issued to the resource owner on
    successful authentication. A valid assertion in this case is equivalent
    to an authorization grant by the resource owner to the client. OAuth 2.0
    clients must make it clear to the resource owner that by authenticating to
    the identity provider who issues the assertion, they are granting the client
    permission to access the protected resources.</p><div class="mediaobject" align="center"><a name="figure-oauth2-saml2-bearer"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/oauth2-saml2-bearer.png" align="middle" height="360" alt="SAML 2.0 Bearer Assertion Authorization Grant"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-oauth2-saml2-bearer.html" target="longdesc">D</a>]</span></div></div><p>The HTTP POST to OpenAM to request an access token looks something
    like this:</p><pre class="brush: http;">POST /openam/oauth2/access_token HTTP/1.1
    Host: openam.example.com
    Content-Type: application/x-www-form-urlencoded

    grant_type=urn%3Aietf%3Aparams%3Aoauth%3Agrant-type%3Asaml2-bearer&amp;
    assertion=PHNhbWxwOl...[base64url encoded assertion]...ZT4&amp;
    client_id=[ID registered with OpenAM]</pre><p>If OpenAM is already a SAML 2.0 service provider, you can configure
    OpenAM as OAuth 2.0 authorization server as well, and set an adapter class
    name in the service provider configuration that lets OpenAM POST the
    assertion from the service provider to the authorization server. See
    <a class="xref" href="#oauth2-sp-and-authz" title="12.4.2.&nbsp;Configuring OpenAM as a SAML Service Provider &amp; OAuth2 Authorization Server">Section&nbsp;12.4.2, &#8220;Configuring OpenAM as a SAML Service Provider &amp; OAuth2 Authorization Server&#8221;</a> for details.</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="oauth2-endpoints"></a>12.1.1.7.&nbsp;OpenAM OAuth 2.0 Endpoints</h4></div></div></div><a class="indexterm" name="d16037e27763"></a><div lang="en" class="variablelist"><p>In addition to the standard authorization and token endpoints
 described in RFC 6749, OpenAM also exposes a token information endpoint
 for resource servers to get information about access tokens so they can
 determine how to respond to requests for protected resources. OpenAM as
 authorization server exposes the following endpoints for clients and
 resource servers.</p><dl class="variablelist"><dt><span class="term"><code class="literal">/oauth2/authorize</code></span></dt><dd><p>Authorization endpoint defined in RFC 6749, used to obtain an
   authorization grant from the resource owner</p><p>Example: <code class="literal">https://openam.example.com:8443/openam/oauth2/authorize</code></p></dd><dt><span class="term"><code class="literal">/oauth2/access_token</code></span></dt><dd><p>Token endpoint defined in RFC 6749, used to obtain an access token
   from the authorization server</p><p>Example: <code class="literal">https://openam.example.com:8443/openam/oauth2/access_token</code></p></dd><dt><span class="term"><code class="literal">/oauth2/tokeninfo</code></span></dt><dd><p>Endpoint not defined in RFC 6749, used to validate tokens, and to
   retrieve information such as scopes</p><p>Given an access token, a resource server can perform an HTTP GET on
   <code class="literal">/oauth2/tokeninfo?access_token=<em class="replaceable"><code>token-id</code></em></code>
   to retrieve a JSON object indicating <code class="literal">token_type</code>,
   <code class="literal">expires_in</code>, <code class="literal">scope</code>, and the
   <code class="literal">access_token</code> ID.</p><p>Example: <code class="literal">https://openam.example.com:8443/openam/oauth2/tokeninfo</code></p></dd></dl></div><p>
     For examples, see the <em class="citetitle">Developer's Guide</em> section,
     <a href="../dev-guide/index.html#rest-api-oauth2" class="link"><em class="citetitle">OAuth 2.0
     Authorization</em></a>.

     This section of the <em class="citetitle">Developer's Guide</em> also covers
     OAuth 2.0 token administration and client administration endpoints
     that are specific to OpenAM.
    </p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="openam-oauth2-client"></a>12.1.2.&nbsp;OpenAM as OAuth 2.0 Client &amp; Resource Server Solution</h3></div></div></div><a class="indexterm" name="d16037e27839"></a><a class="indexterm" name="d16037e27844"></a><p>OpenAM can function as an OAuth 2.0 client for installations where the
   web resources are protected by OpenAM. To configure OpenAM as an OAuth 2.0
   client, you set up an OpenAM OAuth 2.0 / OpenID Connect authentication module
    instance, and then integrate the authentication module into your authentication chains as
   necessary.</p><p>When OpenAM functions as an OAuth 2.0 client, OpenAM provides an
   OpenAM SSO session after successfully authenticating the resource owner and
   obtaining authorization. This means the client can then access resources
   protected by policy agents. In this respect the OpenAM OAuth 2.0 client is
   just like any other authentication module, one that relies on an&nbsp;OAuth 2.0
   authorization server to authenticate the resource owner and&nbsp;obtain
   authorization. The following sequence diagram shows how the client gains
   access to protected resources in the scenario where OpenAM functions as both
   authorization server and client for example.</p><div class="mediaobject" align="center"><a name="figure-oauth2-openam-client"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/oauth2-openam-client.png" align="middle" height="360" alt="OpenAM as OAuth 2.0 client and authorization server"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-oauth2-openam-client.html" target="longdesc">D</a>]</span></div></div><p>As the OAuth 2.0 client functionality is implemented as an OpenAM
   authentication module, you do not need to deploy your own resource server
   implementation when using OpenAM as an OAuth 2.0 client. Instead, use policy
   agents or OpenIG to protect resources.</p><p>
    To configure OpenAM as an OAuth 2.0 client, see the section
    <a href="../admin-guide/index.html#oauth2-module-conf-hints" class="link"><em class="citetitle">Hints for the OAuth 2.0 /
     OpenID Connect Authentication Module</em></a>.
   </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="oauth2-byo-client"></a>12.1.3.&nbsp;Using Your Own Client &amp; Resource Server</h3></div></div></div><a class="indexterm" name="d16037e27872"></a><p>OpenAM returns bearer tokens as described in RFC 6750, <a class="link" href="http://tools.ietf.org/html/rfc6750" target="_blank"><em class="citetitle">The OAuth 2.0 Authorization Framework: Bearer Token
   Usage</em></a>. Notice in the following example JSON response to
   an access token request that OpenAM returns a refresh token with the access
   token. The client can use the refresh token to get a new access token as
   described in RFC 6749.</p><pre class="brush: javascript;">{
    "expires_in": 599,
    "token_type": "Bearer",
    "refresh_token": "f6dcf133-f00b-4943-a8d4-ee939fc1bf29",
    "access_token": "f9063e26-3a29-41ec-86de-1d0d68aa85e9"
}</pre><p>In addition to implementing your client, the resource server must also
   implement the logic for handling access tokens. The resource server can use
   the <code class="literal">/oauth2/tokeninfo</code> endpoint to determine whether the
   access token is still valid, and to retrieve the scopes associated with the
   access token.</p><p>The default OpenAM implementation of OAuth 2.0 scopes assumes that the
   space-separated (%20 when URL encoded) list of scopes in an access token
   request correspond to names of attributes in the resource owner's
   profile.</p><p>To take a concrete example, consider an access token request where
   <code class="literal">scope=mail%20cn</code> and where the resource owner is the
   default OpenAM demo user. (The demo user has no email address by default, but
   you can add one, such as <code class="literal">demo@example.com</code> to the demo
   user's profile.) When the resource server performs an HTTP GET on the token
   information endpoint, <code class="literal">/oauth2/tokeninfo?access_token=<em class="replaceable"><code>token-id</code></em></code>, OpenAM populates the
   <code class="literal">mail</code> and <code class="literal">cn</code> scopes with the email
   address (<code class="literal">demo@example.com</code>) and common name
   (<code class="literal">demo</code>) from the demo user's profile. The result is
   something like the following token information response.</p><pre class="brush: javascript;">{
    "mail": "demo@example.com",
    "scope": [
        "mail",
        "cn"
    ],
    "cn": "demo",
    "realm": "/",
    "token_type": "Bearer",
    "expires_in": 577,
    "access_token": "f9063e26-3a29-41ec-86de-1d0d68aa85e9"
}</pre><p>OpenAM is designed to allow you to plug in your own scopes
   implementation if the default implementation does not do what your
   deployment requires. See <a href="../dev-guide/index.html#chap-oauth2-scopes" class="link"><em class="citetitle">Customizing
   OAuth 2.0 Scope Handling</em></a> for an example.</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="configure-oauth2-authz"></a>12.2.&nbsp;Configuring the OAuth 2.0 Authorization Service</h2></div></div></div><p>
   You configure the OAuth 2.0 authorization service for a particular realm,
   starting from the Common Tasks page of the OpenAM console.
  </p><div class="procedure"><a name="common-task-oauth2-authz"></a><div class="procedure-title">Procedure&nbsp;12.1.&nbsp;To Set Up the OAuth 2.0 Authorization Service</div><a class="indexterm" name="d16037e27933"></a><p>
    Follow the steps in this procedure
    to set up the service with the Common Tasks wizard.
   </p><p>
    When you create the service with the Common Tasks wizard,
    the wizard also creates a standard policy in the top level realm (/)
    to protect the authorization endpoint.
    In this configuration OpenAM serves the resources to protect,
    and no separate application is involved.
    OpenAM therefore acts both as the policy decision point
    and also as the policy enforcement point
    that protects the OAuth 2.0 authorization endpoint.
   </p><p>
    There is no requirement to use the wizard
    or to create the policy in the top level realm.
    However if you create the OAuth 2.0 authorization service without the wizard,
    then you must set up the policy independently as well.
    The policy must appear in an application of type
    <code class="literal">iPlanetAMWebAgentService</code>,
    which is the default in the OpenAM policy editor.
    When configuring the policy allow all authenticated users
    to perform HTTP GET and POST requests on the authorization endpoint.
    The authorization endpoint is described
    in the <em class="citetitle">Developer's Guide</em> section,
    <a href="../dev-guide/index.html#rest-api-oauth2-client-endpoints" class="link"><em class="citetitle">OAuth 2.0 Client &amp; Resource Server Endpoints</em></a>.
    For details on creating policies, see the chapter on
    <a href="../admin-guide/index.html#chap-authz-policy" class="link"><em class="citetitle">Defining Authorization Policies</em></a>.
   </p><ol class="procedure" type="1"><li class="step"><p>In the OpenAM console, select Common Tasks &gt; Configure
    OAuth2.</p></li><li class="step"><p>On the Configure OAuth2 page, enter the Realm for the authorization
    service.</p></li><li class="step"><p>If necessary, adjust the lifetimes for authorization codes
    (10 minutes is the recommended setting in RFC 6749), access tokens, and
    refresh tokens.</p></li><li class="step"><p>Select Issue Refresh Tokens unless you do not want the authorization
    service to supply a refresh token when returning an access token.</p></li><li class="step"><p>Select Issue Refresh Tokens on Refreshing Access Tokens if you want
    the authorization service to supply a refresh token when refreshing an
    access token.</p></li><li class="step"><p>If you want to use the default scope implementation, whereby
    scopes are taken to be resource owner profile attribute names, then
    keep the default setting.</p><p>If you have a custom scope validator implementation,
     put it on the OpenAM classpath,
     and provide the class name as Scope Implementation Class.
     For an example, see the <em class="citetitle">Developer's Guide</em> chapter,
     <a href="../dev-guide/index.html#chap-oauth2-scopes" class="link"><em class="citetitle">Customizing OAuth 2.0 Scope Handling</em></a>.
    </p></li><li class="step"><p>Click Create to complete the process.</p><p>
     To access the authorization server configuration in OpenAM Console,
     browse to Access Control &gt; <em class="replaceable"><code>Realm Name</code></em> &gt; Services,
     and then click OAuth2 Provider.
    </p><p>
     As mentioned at the outset of this procedure,
     the wizard sets up a policy in the top level realm
     to protect the authorization endpoint.
     The policy appears in
     the <code class="literal">iPlanetAMWebAgentService</code> application.
     Its name is <code class="literal">OAuth2ProviderPolicy</code>.
    </p></li><li class="step"><p>
     If your provider has a custom response type plugin,
     put it on the OpenAM classpath,
     and then add the custom response types and the plugin class names
     to the list of Response Type Plugins.
    </p></li><li class="step"><p>
     If you use an external identity repository where
     resource owners log in not with their user ID,
     but instead with their mail address or some other profile attribute,
     then complete this step.
    </p><p>
     The following steps describe how to configure OpenAM authentication
     so OAuth 2.0 resource owners can log in using their email address,
     stored on the LDAP profile attribute, <code class="literal">mail</code>.
     Adapt the names if you use a different LDAP profile attribute,
     such as <code class="literal">cn</code>.
    </p><ol type="a" class="substeps"><li class="step"><p>
       When configuring the data store for the LDAP identity repository,
       make sure that you select Load schema when saved,
       and that you set the Authentication Naming Attribute
       to <code class="literal">mail</code>.
       You can find the data store configuration under
       Access Control &gt; <em class="replaceable"><code>Realm Name</code></em> &gt; Data Stores.
      </p></li><li class="step"><p>
       Add the <code class="literal">mail</code> profile attribute name to the list
       of attributes that can be used for authentication.
      </p><p>
       To make the change, browse to Access Control &gt; <em class="replaceable"><code>Realm
       Name</code></em> &gt; Services &gt; OAuth2 Provider, add the profile
       attributes to the list titled User Profile Attribute(s)
       the Resource Owner is Authenticated On, and then click Save.
      </p></li><li class="step"><p>
       Create an LDAP authentication module to use with the external directory.
      </p><ol type="i" class="substeps"><li class="step"><p>
         In OpenAM Console under Access Control &gt; <em class="replaceable"><code>Realm
         Name</code></em> &gt; Authentication &gt; Module Instances,
         create a module to access the LDAP identity repository,
         such as <code class="literal">LDAPAuthUsingMail</code>.
        </p></li><li class="step"><p>
         In the Attribute Used to Retrieve User Profile field,
         set the attribute to <code class="literal">mail</code>.
        </p></li><li class="step"><p>
         In the Attributes Used to Search for a User to be Authenticated list,
         remove the default <code class="literal">uid</code> attribute
         and add the <code class="literal">mail</code> attribute.
        </p></li><li class="step"><p>
         Click Save.
        </p></li></ol></li><li class="step"><p>
       Create an authentication chain to include the module
       such as <code class="literal">authUsingMail</code>.
      </p><ol type="i" class="substeps"><li class="step"><p>
         When creating the authentication chain,
         choose the <code class="literal">LDAPAuthUsingMail</code> module
         in the Instance drop-down list,
         and set the criteria to REQUIRED.
        </p></li><li class="step"><p>
         Click Save.
        </p></li></ol></li><li class="step"><p>
        Set Organization Authentication Configuration to use the new chain,
        <code class="literal">authUsingMail</code>, and then click Save.
       </p><p>
        At this point OAuth 2.0 resource owners can authenticate
        using their email address rather than their user ID.
       </p></li></ol></li><li class="step"><p>
     Set a multi-valued, string syntax profile attribute
     where OpenAM can store a resource owner's decisions to authorize clients
     without further interaction
     in the Saved Consent Attribute Name field.
    </p><p>
     You are not likely to find a standard profile attribute for this.
     For evaluation purposes only,
     you might try an unused existing profile attribute
     such as <code class="literal">description</code>.
    </p><p>
     When moving to production, however, use
     a dedicated, multi-valued, string syntax profile attribute
     that clearly is not used for other purposes. For example,
     you might call the attribute <code class="literal">oAuth2SavedConsent</code>.
    </p><p>
     Adding a profile attribute involves
     updating the identity repository to support use of the attribute,
     updating the AMUser Service for the attribute,
     and optionally allowing users to edit the attribute.
     The process is described in the <em class="citetitle">Developer's Guide</em>
     chapter, <a href="../dev-guide/index.html#chap-custom-attr" class="link"><em class="citetitle">Customizing Profile Attributes</em></a>,
     which demonstrates adding a custom attribute
     when using OpenDJ directory services to store user profiles.
    </p></li><li class="step"><p>Save your changes.</p></li></ol></div><p>You can further adjust the authorization server configuration after you
  create it in the OpenAM console under Access Control &gt; <em class="replaceable"><code>Realm
  Name</code></em> &gt; Services &gt; OAuth2 Provider.</p><p>You can adjust global defaults in the OpenAM console under Configuration
  &gt; Global &gt; OAuth2 Provider.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="register-oauth2-client"></a>12.3.&nbsp;Registering OAuth 2.0 Clients with the Authorization Service</h2></div></div></div><a class="indexterm" name="d16037e28129"></a><p>You register an OAuth 2.0 client with the OpenAM OAuth 2.0 authorization
  service by creating and configuring an OAuth 2.0 Client agent profile.</p><p>At minimum you must have the client identifier and client password
  in order to register your OAuth 2.0 client.</p><div class="procedure"><a name="create-oauth2-client-profile"></a><div class="procedure-title">Procedure&nbsp;12.2.&nbsp;To Create an OAuth 2.0 Client Agent Profile</div><a class="indexterm" name="d16037e28143"></a><ul class="procedure"><li class="step"><p>Use either of these two facilities.</p><ul class="stepalternatives">
     <li class="step"><p>In the OpenAM console, access the client registration endpoint
      at <code class="literal">/oauth2/registerClient.jsp</code>.</p><p>The full URL depends on where you deployed OpenAM. For example,
      <code class="literal">https://openam.example.com:8443/openam/oauth2/registerClient.jsp</code>.</p><p>The Register a Client page lets you quickly create and configure
      an OAuth 2.0 client in a simple web page without inline help.</p></li>
     <li class="step"><p>In the OpenAM console under Access Control &gt; <em class="replaceable"><code>Realm
      Name</code></em> &gt; Agents &gt; OAuth 2.0 Client &gt; Agent, click
      New, then provide the client identifier and client password, and
      finally click Create to create the profile.</p><p>This page requires that you perform additional configuration
      separately.</p></li>
    </ul></li></ul></div><div class="procedure"><a name="configure-oauth2-client-profile"></a><div class="procedure-title">Procedure&nbsp;12.3.&nbsp;To Configure an OAuth 2.0 Client Agent Profile</div><a class="indexterm" name="d16037e28181"></a><p>After initially registering or creating a client agent profile as
   necessary.</p><ol class="procedure" type="1"><li class="step"><p>In the OpenAM console, browse to Access Control &gt;
    <em class="replaceable"><code>Realm Name</code></em> &gt; Agents &gt; OAuth 2.0 Client
    &gt; Agent &gt; <em class="replaceable"><code>Client Name</code></em> to open the Edit
    <em class="replaceable"><code>Client Name</code></em> page.</p></li><li class="step"><p>Adjust the configuration as needed using the inline help for hints,
    and also the documentation section <a href="../admin-guide/index.html#configure-oauth2-client" class="link"><em class="citetitle">Configuring
    OAuth 2.0 &amp; OpenID Connect 1.0 Clients</em></a>.</p><p>Examine the client type option. An important decision to make at this
    point is whether your client is a confidential client or a public client.
    This depends on whether your client can keep its credentials confidential,
    or whether its credentials can be exposed to the resource owner or other parties.
    If your client is a web-based application running on a server, such as the OpenAM
    OAuth 2.0 client, then you can keep its credentials confidential. If your client is
    a user-agent based client, such as a JavaScript client running in a browser,
    or a native application installed on a device used by the resource owner,
    then yours is a public client.</p></li><li class="step"><p>When finished, Save your work.</p></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="oauth2-manage-tokens"></a>12.4.&nbsp;Managing OAuth 2.0 Tokens</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="#oauth2-client-plus-authz">12.4.1. Configuring OpenAM as Authorization Server &amp; Client</a></span></dt><dt><span class="section"><a href="#oauth2-sp-and-authz">12.4.2. Configuring OpenAM as a SAML Service Provider &amp; OAuth2 Authorization Server</a></span></dt><dt><span class="section"><a href="#oauth2-user-consent">12.4.3. User Consent Management</a></span></dt></dl></div><a class="indexterm" name="d16037e28217"></a><p>OpenAM exposes a RESTful API that lets administrators read, list, and
  delete OAuth 2.0 tokens. OAuth 2.0 clients can also manage their own tokens.
  See the <em class="citetitle">Developer's Guide</em> section on the <a href="../dev-guide/index.html#rest-api-oauth2-token-admin-endpoint" class="link"><em class="citetitle">OAuth 2.0 Token
  Administration Endpoint</em></a> for details.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="oauth2-client-plus-authz"></a>12.4.1.&nbsp;Configuring OpenAM as Authorization Server &amp; Client</h3></div></div></div><a class="indexterm" name="d16037e28237"></a><p>
   This section takes a high-level look at how to set up OpenAM
   both as an OAuth 2.0 authorization server and also as an OAuth 2.0 client
   in order to protect resources on a resource server
   by using an OpenAM policy agent.
  </p><div class="mediaobject" align="center"><a name="figure-oauth2-end-to-end-example"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/oauth2-end-to-end-example.png" align="middle" height="360" alt="OpenAM authorization server, OpenAM client, resource server"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-oauth2-end-to-end-example.html" target="longdesc">D</a>]</span></div></div><p>
   The example in this section uses three servers,
   <code class="literal">http://authz.example.com:8080/openam</code> as the
   OAuth 2.0 authorization server,
   <code class="literal">http://client.example.com:8080/openam</code> as the
   OAuth 2.0 client, which also handles policy,
   <code class="literal">http://www.example.com:8080/</code> as the
   OAuth 2.0 resource server protected with an OpenAM policy agent
   where the resources to protect are deployed in Apache Tomcat.
   The two OpenAM servers communicate using OAuth 2.0.
   The policy agent on the resource server communicates with OpenAM
   as policy agents normally do, using OpenAM specific requests.
   The resource server in this example does not need to support OAuth 2.0.
  </p><p>
   The high-level configuration steps are as follows.
  </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
     On the OpenAM server that you will configure to act as an OAuth 2.0 client,
     configure a policy agent profile,
     and the policy used to protect the resources.</p><p>
     On the web server or application container
     that will act as an OAuth 2.0 resource server,
     install and configure the OpenAM policy agent.
    </p><p>
     Make sure that you can access the resources when you log in
     through an authentication module that you know to be working,
     such as the default DataStore authentication module.
    </p><p>
     In this example, you would try to access
     <code class="literal">http://www.example.com:8080/examples/</code>.
     The policy agent should redirect you to the OpenAM login page.
     After you log in successfully as a user with access rights to the resource,
     OpenAM should redirect you back to
     <code class="literal">http://www.example.com:8080/examples/</code>,
     and the policy agent should allow access.
    </p><p>
     Fix any problems you have in accessing the resources
     before you try to set up access through the OAuth 2.0 / OpenID Connect
     authentication module.
    </p></li><li class="listitem"><p>
     Configure one OpenAM server as an OAuth 2.0 authorization service,
     which is described in <a class="xref" href="#configure-oauth2-authz" title="12.2.&nbsp;Configuring the OAuth 2.0 Authorization Service">Section&nbsp;12.2, &#8220;Configuring the OAuth 2.0 Authorization Service&#8221;</a>.
    </p></li><li class="listitem"><p>
     Configure the other OpenAM server with the policy agent profile and policy
     as an OAuth 2.0 client, by setting up an OAuth 2.0 / OpenID Connect
     authentication module according to the section
     <a href="../admin-guide/index.html#oauth2-module-conf-hints" class="link"><em class="citetitle">Hints for the OAuth 2.0 /
     OpenID Connect Authentication Module</em></a>.
    </p></li><li class="listitem"><p>
     On the authorization server, register the OAuth 2.0 / OpenID Connect
     authentication module as an OAuth 2.0 client, which is described in
     <a class="xref" href="#register-oauth2-client" title="12.3.&nbsp;Registering OAuth 2.0 Clients with the Authorization Service">Section&nbsp;12.3, &#8220;Registering OAuth 2.0 Clients with the Authorization Service&#8221;</a>.
    </p></li><li class="listitem"><p>
     Log out and access the protected resources to see the process in action.
    </p></li></ol></div><div class="example"><a name="protect-web-site-with-oauth2"></a><div class="example-title">Example&nbsp;12.1.&nbsp;Web Site Protected With OAuth 2.0</div><div class="example-contents"><p>
    This example pulls everything together (except security considerations),
    using OpenAM servers both as the OAuth 2.0 authorization server,
    and also as the OAuth 2.0 client,
    with an OpenAM policy agent on the resource server
    requesting policy decisions from OpenAM as OAuth 2.0 client.
    In this way any server protected by a policy agent
    that is connected to an OpenAM OAuth 2.0 client
    can act as an OAuth 2.0 resource server.
   </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
      On the OpenAM server that will be configured as an OAuth 2.0 client,
      set up an OpenAM policy agent and policy in the top-level realm,
      <code class="literal">/</code>, to protect resources.
     </p><p>
      See the
      <a class="link" href="http://docs.forgerock.org/en/openam-pa/3.3.0/web-users-guide/#web-users-guide" target="_blank"><em class="citetitle">Web Policy Agent User's Guide</em></a>
      or the
      <a class="link" href="http://docs.forgerock.org/en/openam-pa/3.3.0/jee-users-guide/#jee-users-guide" target="_blank"><em class="citetitle">Java EE Policy Agent User's Guide</em></a>
     for instructions on installing a policy agent. This example relies on the
     Apache Tomcat Java EE policy agent, configured to protect resources in
     Apache Tomcat at <code class="literal">http://www.example.com:8080/</code>.</p><p>The policies for this example protect the Apache Tomcat examples
     under <code class="literal">http://www.example.com:8080/examples/</code>, allowing
     GET and POST operations by all authenticated users. For more information
     on creating policies, see <span class="olink"><em class="citetitle">Configuring
     Policies</em></span>.</p><p>After setting up the policy agent and the policy, you can make sure
     everything is working by attempting to access a protected resource, in this
     case <code class="literal">http://www.example.com:8080/examples/</code>. The policy
     agent should redirect you to OpenAM to authenticate with the default
     authentication module, where you can login as user <code class="literal">demo</code>
     password <code class="literal">changeit</code>. After successful authentication,
     OpenAM redirects your browser back to the protected resource and the
     policy agent lets you get the protected resource, in this case the Tomcat
     examples top page.</p><div class="mediaobject" align="center"><a name="figure-oauth2-examples"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/oauth2-examples.png" align="middle" height="360" alt="Successfully accessing the Apache Tomcat examples"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-oauth2-examples.html" target="longdesc">D</a>]</span></div></div></li><li class="listitem"><p>
      On the OpenAM server to be configured as an OAuth 2.0 authorization server,
      configure OpenAM's OAuth 2.0 authorization service
      as described in <a class="xref" href="#configure-oauth2-authz" title="12.2.&nbsp;Configuring the OAuth 2.0 Authorization Service">Section&nbsp;12.2, &#8220;Configuring the OAuth 2.0 Authorization Service&#8221;</a>.
     </p><p>The authorization endpoint to protect in this example is at
     <code class="literal">http://authz.example.com:8080/openam/oauth2/authorize</code>.</p></li><li class="listitem"><p>
      On the OpenAM server to be configured as an OAuth 2.0 client,
      configure an OpenAM OAuth 2.0 / OpenID Connect authentication module
      instance for the top-level realm.
     </p><p>Under Access Control &gt; / (Top-Level Realm) &gt; Authentication
     &gt; Module Instances, click New. Name the module
     <code class="literal">OAuth2</code>, and select the OAuth 2.0 type, then click
     OK to save your work.</p><p>Then click Authentication &gt; Module Instances &gt; OAuth2 to open
     the OAuth 2.0 client configuration page. This page offers numerous options.
     The key settings for this example are the following.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Client Id</span></dt><dd><p>This is the client identifier used to register your client with
        OpenAM's authorization server, and then used when your client must
        authenticate to OpenAM.</p><p>Set this to <code class="literal">myClientID</code> for this example.</p></dd><dt><span class="term">Client Secret</span></dt><dd><p>This is the client password used to register your client with
        OpenAM's authorization server, and then used when your client must
        authenticate to OpenAM.</p><p>Set this to <code class="literal">password</code> for this example. Make
        sure you use strong passwords when you actually deploy OAuth 2.0.</p></dd><dt><span class="term">Authentication Endpoint URL</span></dt><dd><p>In this example,
        <code class="literal">http://authz.example.com:8080/openam/oauth2/authorize</code>.</p><p>This OpenAM endpoint can take additional parameters. In
        particular you must specify the realm if the OpenAM OAuth 2.0
        provider is configured for a subrealm rather than / (Top-Level
        Realm).</p><p>For example, if the OAuth 2.0 provider is configured for the
        realm <code class="literal">/customers</code>, then use the following URL:
        <code class="literal">http://authz.example.com:8080/openam/oauth2/authorize?realm=/customers</code></p><p>The <code class="literal">/oauth2/authorize</code> endpoint can also take
        <code class="literal">module</code> and <code class="literal">service</code> parameters. Use
        either as described in <a href="../admin-guide/index.html#authn-from-browser" class="link"><em class="citetitle">Authenticating To OpenAM</em></a>, where
        <code class="literal">module</code> specifies the authentication module instance
        to use or <code class="literal">service</code> specifies the authentication chain
        to use when authenticating the resource owner.</p></dd><dt><span class="term">Access Token Endpoint URL</span></dt><dd><p>In this example,
        <code class="literal">http://authz.example.com:8080/openam/oauth2/access_token</code>.</p><p>This OpenAM endpoint can take additional parameters. In
        particular you must specify the realm if the OpenAM OAuth 2.0
        provider is configured for a subrealm rather than / (Top-Level
        Realm).</p><p>For example, if the OAuth 2.0 provider is configured for the
        realm <code class="literal">/customers</code>, then use the following URL:
        <code class="literal">http://authz.example.com:8080/openam/oauth2/access_token?realm=/customers</code></p></dd><dt><span class="term">User Profile Service URL</span></dt><dd><p>In this example,
        <code class="literal">http://authz.example.com:8080/openam/oauth2/tokeninfo</code>.</p></dd><dt><span class="term">Scope</span></dt><dd><p>In this example, <code class="literal">cn</code>.</p><p>The demo user has common name <code class="literal">demo</code> by default,
        so by setting this to <code class="literal">cn|Read your user name</code>, OpenAM
        can get the value of the attribute without the need to create
        additional subjects, or to update existing subjects. The description,
        <code class="literal">Read your user name</code>, is shown to the resource owner
        in the consent page.</p></dd><dt><span class="term">OAuth2 Access Token Profile Service Parameter name</span></dt><dd><p>Identifies the parameter that contains the access token value, which
              in this example is <code class="literal">access_token</code>.</p></dd><dt><span class="term">Proxy URL</span></dt><dd><p>The client redirect URL, which in this example is
        <code class="literal">http://client.example.com:8080/openam/oauth2c/OAuthProxy.jsp</code>.</p></dd><dt><span class="term">Account Mapper</span></dt><dd><p>In this example, 
        <code class="literal">org.forgerock.openam.authentication.modules.oauth2.DefaultAccountMapper</code>.</p></dd><dt><span class="term">Account Mapper Configuration</span></dt><dd><p>In this example, <code class="literal">cn=cn</code>.</p></dd><dt><span class="term">Attribute Mapper</span></dt><dd><p>In this example,
        <code class="literal">org.forgerock.openam.authentication.modules.oauth2.DefaultAttributeMapper</code>.</p></dd><dt><span class="term">Attribute Mapper Configuration</span></dt><dd><p>In this example, <code class="literal">cn=cn</code>.</p></dd><dt><span class="term">Create account if it does not exist</span></dt><dd><p>In this example, disable this functionality.</p><p>OpenAM can create local accounts based on the account information
        returned by the authorization server.</p></dd></dl></div></li><li class="listitem"><p>
      On the OpenAM server configured to act as an OAuth 2.0 authorization server,
      register the OAuth 2.0 / OpenID Connect authentication module
      as an OAuth 2.0 confidential client, which is described in
      <a class="xref" href="#register-oauth2-client" title="12.3.&nbsp;Registering OAuth 2.0 Clients with the Authorization Service">Section&nbsp;12.3, &#8220;Registering OAuth 2.0 Clients with the Authorization Service&#8221;</a>.
     </p><p>Under Access Control &gt; / (Top-Level Realm) &gt; Agents &gt;
     OAuth 2.0 Client &gt; Agents &gt; <code class="literal">myClientID</code>, adjust
     the following settings.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Client type</span></dt><dd><p>In this example, <code class="literal">confidential</code>. OpenAM protects
        its credentials as an OAuth 2.0 client.</p></dd><dt><span class="term">Redirection URIs</span></dt><dd><p>In this example,
        <code class="literal">http://client.example.com:8080/openam/oauth2c/OAuthProxy.jsp</code>.</p></dd><dt><span class="term">Scopes</span></dt><dd><p>In this example, <code class="literal">cn</code>.</p></dd></dl></div></li><li class="listitem"><p>
      Before you try it out,
      on the OpenAM server configured to act as an OAuth 2.0 client,
      you must make the following additional change to the configuration.
     </p><p>Your OpenAM OAuth 2.0 client authentication module is not part
     of the default chain, and therefore OpenAM does not call it unless
     you specifically request the OAuth 2.0 client authentication
     module.</p><p>To cause the policy agent to request your OAuth 2.0 client
     authentication module explicitly, browse in OpenAM console to your
     <span class="emphasis"><em>policy agent profile configuration</em></span>, in this case
     Access Control &gt; / (Top-Level Realm) &gt; Agents &gt; J2EE &gt;
     Agents &gt; <em class="replaceable"><code>Agent Name</code></em> &gt; OpenAM Services &gt; OpenAM
     Login URL, and add
     <code class="literal">http://client.example.com:8080/openam/UI/Login?module=OAuth2</code>,
     moving it to the top of the list.</p><p>Save your work.</p><p>This ensures that the policy agent directs the resource owner
     to OpenAM with the instruction to authenticate using the
     <code class="literal">OAuth2</code> authentication module.</p></li><li class="listitem"><p>Try it out.</p><p>First make sure you are logged out of OpenAM, for example by
     browsing to the logout URL, in this case
     <code class="literal">http://client.example.com:8080/openam/UI/Logout</code>.</p><p>Next attempt to access the protected resource, in this case
     <code class="literal">http://www.example.com:8080/examples/</code>.</p><p>If everything is set up properly, the policy agent redirects your
     browser to the login page of OpenAM with <code class="literal">module=OAuth2</code>
     among other query string parameters. After you authenticate, for example
     as user <code class="literal">demo</code>, password <code class="literal">changeit</code>,
     OpenAM presents you with an authorization decision page.</p><div class="mediaobject" align="center"><a name="figure-oauth2-authz-page"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/oauth2-authz-page.png" align="middle" height="360" alt="OpenAM presenting authorization decision page to resource owner"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-oauth2-authz-page.html" target="longdesc">D</a>]</span></div></div><p>When you click Allow, the authorization service creates an SSO
     session, and redirects the client back to the resource, thus allowing
     the client to access the protected resource. If you configured an attribute
     on which to store the saved consent decision, and you choose to save the
     consent decision for this authorization, then OpenAM can use that saved
     decision to avoid prompting you for authorization next time the client
     accesses the resource, but only ensure that you have authenticated and
     have a valid session.</p><div class="mediaobject" align="center"><a name="figure-oauth2-examples-again"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/oauth2-examples.png" align="middle" height="360" alt="Successfully accessing the Apache Tomcat examples"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-oauth2-examples-again.html" target="longdesc">D</a>]</span></div></div></li></ol></div></div></div><br class="example-break"></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="oauth2-sp-and-authz"></a>12.4.2.&nbsp;Configuring OpenAM as a SAML Service Provider &amp; OAuth2 Authorization Server</h3></div></div></div><a class="indexterm" name="d16037e28655"></a><a class="indexterm" name="d16037e28662"></a><p>As described in <a class="xref" href="#oauth2-saml2-bearer" title="12.1.1.6.&nbsp;SAML 2.0 Bearer Assertion Profiles">Section&nbsp;12.1.1.6, &#8220;SAML 2.0 Bearer Assertion Profiles&#8221;</a>, OpenAM as
  OAuth 2.0 authorization server can handle the profile where a SAML 2.0
  assertion borne by the client functions as an authorization grant to get
  an access token. This lets a client get an access token when a resource owner
  completes SAML 2.0 Web Single Sign-On.</p><p>You can configure OpenAM as both SAML 2.0 service provider and OAuth
  2.0 authorization server, using an built-in adapter class to POST assertions
  returned to the service provider to the access token endpoint of the
  authorization server. This allows clients to send a resource owner to the
  identity provider for SAML 2.0 web SSO, get an assertion at the service
  provider, and retrieve an access token from the authorization server. In other
  words, once this scenario is configured, the client must only direct the
  resource owner to start web SSO as described in <a href="../admin-guide/index.html#using-saml2-sso-slo" class="link"><em class="citetitle">Using SAML 2.0
  Single Sign-On &amp; Single Logout</em></a>, and then retrieve the
  access token on success or handle the error condition on failure.</p><div class="procedure"><a name="configure-oauth2-sp-and-authz"></a><div class="procedure-title">Procedure&nbsp;12.4.&nbsp;To Get an Access Token From SAML 2.0 Web SSO</div><a class="indexterm" name="d16037e28682"></a><div class="itemizedlist"><p>For this scenario to work, the following conditions must be met.</p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>The client must make the resource owner understand that by
     authenticating to the SAML 2.0 identity provider the resource owner grants
     the client access to the protected resources. OpenAM does not present the
     resource owner with an authorization decision.</p></li><li class="listitem"><p>The SAML 2.0 identity provider issuing the assertion must sign the
     assertion, and must correctly handle the name ID for the subject.</p></li><li class="listitem"><p>OpenAM as relying party must request that assertions are signed, must
     verify the signatures on assertions, must correctly handle name IDs
     from the issuer, and must use the built-in
     <code class="literal">org.forgerock.openam.oauth2.saml2.core.OAuth2Saml2GrantSPAdapter</code>
     adapter class in the service provider configuration to POST assertions
     to the OAuth 2.0 authorization service.</p></li><li class="listitem"><p>The OAuth 2.0 authorization service and SAML 2.0 service provider
     must be configured together on the same OpenAM server.</p></li><li class="listitem"><p>An OAuth 2.0 client configuration on OpenAM with the same name as
     the service provider entity ID must be set up on OpenAM.</p></li><li class="listitem"><p>The OAuth 2.0 client initiating the process must be able to consume
     the access token and to handle errors if necessary.</p></li></ul></div><p>Follow these steps. The test configuration hints in this procedure let
   you prepare configuration to test with the demo user created in OpenAM by
   default.</p><ol class="procedure" type="1"><li class="step"><p>Make sure the SAML 2.0 identity provider signs assertions and that
    name IDs are correctly configured to map resource owner accounts.</p><p>When configuring OpenAM as a hosted identity provider follow these
    steps.</p><ol type="a" class="substeps"><li class="step"><p>Make sure the Signing Key is properly configured on setup.</p><p>For a test configuration, select the <code class="literal">test</code>
      certificate shown in the Common Tasks &gt; Create Hosted Service Provider
      wizard.</p></li><li class="step"><p>Make sure name IDs are properly configured.</p><p>For a test configuration, in the OpenAM console under Federation
      &gt; Entity Providers &gt; <em class="replaceable"><code>IDP name</code></em> &gt;
      NameID Value Map, add
      <code class="literal">urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified=cn</code>
      and then Save your work.</p></li></ol><p>For more detail on configuring OpenAM as a SAML 2.0 identity provider,
    see <a href="../admin-guide/index.html#configure-idp" class="link"><em class="citetitle">Configuring
    Identity Providers</em></a>.</p></li><li class="step"><p>Configure OpenAM as service provider.</p><ol type="a" class="substeps"><li class="step"><p>Set up a hosted service provider in OpenAM console under
      Common Tasks &gt; Create Hosted Service Provider, keeping track of
      the name, such as <code class="literal">https://www.sp.example:8443/openam</code>,
      and selecting Use default attribute mapping from Identity Provider.</p><p>For details on configuring OpenAM as a SAML 2.0 service provider,
      see <a href="../admin-guide/index.html#configure-sp" class="link"><em class="citetitle">Configuring
      Service Providers</em></a>.</p></li><li class="step"><p>Under Federation &gt; Entity Providers &gt; <em class="replaceable"><code>SP
      name</code></em> &gt; Assertion Content &gt; Request/Response Signing,
      check Assertions Signed.</p></li><li class="step"><p>For a test configuration, in Federation &gt; Entity Providers &gt;
      <em class="replaceable"><code>SP name</code></em> &gt; Assertion Content &gt; NameID
      Format List, remove all but
      <code class="literal">urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified</code>,
      and then Save your work.</p></li><li class="step"><p>In Federation &gt; Entity Providers &gt; <em class="replaceable"><code>SP
      name</code></em> &gt; Assertion Processing &gt; Adapter, add
      <code class="literal">org.forgerock.openam.oauth2.saml2.core.OAuth2Saml2GrantSPAdapter</code>,
      and then Save your work.</p><p>This is the adapter class that POSTs the SAML 2.0 assertion to
      the OAuth 2.0 access token endpoint.</p></li><li class="step"><p>Use the wizard under Common Tasks &gt; Register Remote Identity
      Provider to import the identity provider metadata.</p></li></ol></li><li class="step"><p>Make sure the identity provider imports the metadata for your
    service provider.</p><p>If your service provider is at
    <code class="literal">https://www.sp.example:8443/openam</code>, then the metadata
    can be accessed at
    <code class="literal">https://www.sp.example:8443/openam/saml2/jsp/exportmetadata.jsp</code>.</p></li><li class="step"><p>On the service provider OpenAM server, set up the OAuth 2.0
    authorization server as described in
    <a class="xref" href="#configure-oauth2-authz" title="12.2.&nbsp;Configuring the OAuth 2.0 Authorization Service">Section&nbsp;12.2, &#8220;Configuring the OAuth 2.0 Authorization Service&#8221;</a>.</p><p>For a test configuration, set the realm to <code class="literal">/</code>, and
    accept the defaults.</p></li><li class="step"><p>On the service provider and authorization server OpenAM server, set
    up an OAuth 2.0 client profile with the same name as the service
    provider under Access Control &gt; <em class="replaceable"><code>realm</code></em> &gt;
    Agents &gt; OAuth 2.0 Client &gt; New...</p><p>For example, if the service provider name is
    <code class="literal">https://www.sp.example:8443/openam</code>, then that is also
    the name of the OAuth 2.0 client profile.</p><p>You can make additional changes to the client profile if necessary.
    See <a class="xref" href="#register-oauth2-client" title="12.3.&nbsp;Registering OAuth 2.0 Clients with the Authorization Service">Section&nbsp;12.3, &#8220;Registering OAuth 2.0 Clients with the Authorization Service&#8221;</a> for details.</p></li><li class="step"><p>Test your configuration.</p><ol type="a" class="substeps"><li class="step"><p>Logout of all OpenAM servers.</p></li><li class="step"><p>Initiate SAML 2.0 Web SSO.</p><p>For example, if your identity provider is at
      <code class="literal">https://www.idp.example:8443/openam</code> with meta alias
      <code class="literal">/idp</code> and your service provider is at
      <code class="literal">https://www.sp.example:8443/openam</code>, then browse to the
      following URL (without line breaks or spaces).</p><pre class="brush: plain;">http://www.idp.example:8443/openam/saml2/jsp/idpSSOInit.jsp
 ?metaAlias=/idp&amp;spEntityID=http://www.sp.example:8443/openam</pre><p>For other configurations, see <a href="../admin-guide/index.html#using-saml2-sso-slo" class="link"><em class="citetitle">Using SAML 2.0
      Single Sign-On &amp; Single Logout</em></a>.</p></li><li class="step"><p>Login to the identity provider.</p><p>For OpenAM, login with user name <code class="literal">demo</code> and
      password <code class="literal">changeit</code>.</p></li><li class="step"><p>Login to the service provider.</p><p>For OpenAM, login with user name <code class="literal">demo</code> and
      password <code class="literal">changeit</code>.</p></li><li class="step"><p>See the resulting access token on successful login.</p><p>The result looks something like this, all on one line.</p><pre class="brush: javascript;">{
    "expires_in": 59,
    "token_type": "Bearer",
    "access_token": "f0f731e0-6013-47e3-9c07-da598157a85f"
}</pre></li></ol></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="oauth2-user-consent"></a>12.4.3.&nbsp;User Consent Management</h3></div></div></div><a class="indexterm" name="d16037e28888"></a><p>
    Users of OAuth 2.0 clients can now manage their OAuth 2.0 tokens
    on their user pages via the OpenAM console.
    For example, the user logs in to the OpenAM
    console as <code class="literal">demo</code>, and then clicks the Dashboard link on the
    Profile page.
    In the Authorized Apps section, the users can view their OAuth 2.0 tokens or
    remove them by clicking the Revoke Access link, effectively removing their
    consent to the application.
   </p><div class="figure"><a name="figure-xui-oauth2-self-service"></a><div class="figure-title">Figure&nbsp;12.1.&nbsp;OAuth2 Self-Service</div><div class="figure-contents"><div class="mediaobject" align="center"><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/xui-oauth2-self-service.png" align="middle" height="360" alt="OAuth2 Self-Service"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="ld-d16037e28902.html" target="longdesc">D</a>]</span></div></div></div></div><br class="figure-break"></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="oauth2-security-considerations"></a>12.5.&nbsp;Security Considerations</h2></div></div></div><a class="indexterm" name="d16037e28913"></a><p>OAuth 2.0 messages involve credentials and access tokens that allow
  the bearer to retrieve protected resources. Therefore, do not let an attacker
  capture requests or responses. Protect the messages going across the
  network.</p><p>RFC 6749 includes a number of <a class="link" href="http://tools.ietf.org/html/rfc6749#section-10" target="_blank">Security
  Considerations</a>, and also requires Transport Layer Security (TLS)
  to protect sensitive messages. Make sure you read the section covering
  <em class="citetitle">Security Considerations</em>, and that you can implement
  them in your deployment.</p><p>Also, especially when deploying a mix of other clients and resource
  servers, take into account the points covered in the Internet-Draft, <a class="link" href="http://tools.ietf.org/html/draft-ietf-oauth-v2-threatmodel" target="_blank"><em class="citetitle">OAuth 2.0 Threat Model and Security
  Considerations</em></a>, before putting your service into
  production.</p></div><div class="footnotes"><br><hr class="footnote-hr"><div id="ftn.d16037e27534" class="footnote"><p><a href="#d16037e27534" class="para"><sup class="para">[9] </sup></a>Read
  <a class="link" href="http://tools.ietf.org/html/rfc6749" target="_blank">RFC 6749</a> to understand the authorization framework itself.</p></div></div></div><div lang="en" class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="chap-openid-connect"></a>Chapter&nbsp;13.&nbsp;Managing OpenID Connect 1.0 Authorization</h1></div></div></div><div class="toc"><div class="toc-title">Table of Contents</div><dl class="toc"><dt><span class="section"><a href="#about-openid-connect-support">13.1. About OpenID Connect 1.0 Support in OpenAM</a></span></dt><dt><span class="section"><a href="#configure-openid-connect-provider">13.2. Configuring OpenAM As OpenID Provider</a></span></dt><dt><span class="section"><a href="#configure-openid-connect-discovery">13.3. Configuring OpenAM For OpenID Connect Discovery</a></span></dt><dt><span class="section"><a href="#register-openid-connect-clients">13.4. Registering OpenID Connect Relying Parties</a></span></dt><dt><span class="section"><a href="#manage-sessions-openid-connect">13.5. Managing User Sessions</a></span></dt><dt><span class="section"><a href="#openid-connect-examples">13.6. Relying Party Examples</a></span></dt><dt><span class="section"><a href="#openid-connect-security-considerations">13.7. Security Considerations</a></span></dt><dt><span class="section"><a href="#mobile-connect">13.8. Using OpenAM with Mobile Connect</a></span></dt></dl></div><a class="indexterm" name="d16037e28938"></a><a class="indexterm" name="d16037e28943"></a><p>
  This chapter covers OpenAM support for OpenID Connect 1.0.
  <a class="link" href="http://openid.net/connect/" target="_blank">OpenID Connect</a> 1.0 is an authentication layer built on OAuth 2.0.
  OpenID Connect 1.0 is a specific implementation of OAuth 2.0
  where the identity provider that runs the authorization server
  also holds the protected resource
  that the third-party application aims to access.
  This resource is the <span class="emphasis"><em>UserInfo</em></span>,
  information about the authenticated end user expressed in a standard format.
  In this way OpenID Connect 1.0 allows relying parties
  both to verify the identity of the end user
  and also to obtain user information using REST.
  This contrasts with OAuth 2.0, which only defines the authorization mechanism.
 </p><div class="itemizedlist"><p>
   The names used in OpenID Connect 1.0 differ from those used in OAuth 2.0.
   In OpenID Connect 1.0, the key entities are the following.
  </p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
    The <em class="firstterm">end user</em> (OAuth 2.0 resource owner)
    whose user information the application needs to access.
   </p><p>
    The end user wants to use an application
    through existing identity provider account
    without signing up to and creating credentials for yet another web service.
   </p></li><li class="listitem"><p>
    The <em class="firstterm">Relying Party</em> (RP) (OAuth 2.0 client)
    needs access to the end user's protected user information.
   </p><p>
    For example, an online mail application needs to know which end user
    is accessing the application in order to present the correct inbox.
   </p><p>
    As another example, an online shopping site needs to know which end user
    is accessing the site in order to present
    the right offerings, account, and shopping cart.
   </p></li><li class="listitem"><p>
    The <em class="firstterm">OpenID Provider</em> (OP)
    (OAuth 2.0 authorization server and also resource server)
    that holds the user information and grants access.
   </p><p>
    OpenAM can play this role in an OpenID Connect deployment.
   </p><p>
    The OP effectively has the end user's consent to providing the RP
    with access to some of its user information.
    As OpenID Connect 1.0 defines unique identification for an account
    (subject identifier + issuer identifier),
    the RP can use this as a key to its own user profile.
   </p><p>
    In the case of the online mail application,
    this key could be used to access the mailboxes
    and related account information.
    In the case of the online shopping site,
    this key could be used to access
    the offerings, account, shopping cart and so forth.
    The key makes it possible to serve users as if they had local accounts.
   </p></li></ul></div><p>
  In OpenID Connect the relying party can verify claims
  about the identity of the end user,
  and log the user out at the end of a session.
  OpenID Connect also makes it possible
  to discover the OpenID Provider for an end user,
  and to register relying party client applications dynamically.
  OpenID connect services are built on
  OAuth 2.0, JSON Web Token (JWT), WebFinger and Well-Known URIs.
 </p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="about-openid-connect-support"></a>13.1.&nbsp;About OpenID Connect 1.0 Support in OpenAM</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="#openam-openid-basic-client-profile">13.1.1. OpenID Connect Authorization Code Flow</a></span></dt><dt><span class="section"><a href="#openam-openid-implicit-client-profile">13.1.2. OpenID Connect Implicit Flow</a></span></dt><dt><span class="section"><a href="#openam-openid-discovery">13.1.3. OpenID Connect Discovery</a></span></dt><dt><span class="section"><a href="#openam-openid-client-registration">13.1.4. OpenID Connect Relying Party Registration</a></span></dt><dt><span class="section"><a href="#openam-openid-session-management">13.1.5. OpenID Connect Session Management</a></span></dt></dl></div><p>
   In its role as OpenID Provider, OpenAM
   lets OpenID Connect relying parties (clients) discover its capabilities,
   handles both dynamic and static registration of OpenID Connect relying parties,
   responds to relying party requests with authorization codes, access tokens,
   and user information
   according to the Authorization Code and Implicit flows of OpenID Connect,
   and manages sessions.
  </p><p>
   This section describes how OpenAM fits into the OpenID Connect picture
   in terms of the roles that it plays
   in the authorization code and implicit flows,
   provider discovery, client registration, and session management.
  </p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="openam-openid-basic-client-profile"></a>13.1.1.&nbsp;OpenID Connect Authorization Code Flow</h3></div></div></div><p>
    The OpenID Connect Authorization Code Flow specifies
    how the relying party interacts with the OpenID Provider,
    in this case OpenAM,
    based on use of the OAuth 2.0 authorization grant.
    The following sequence diagram shows successful processing
    from the authorization request,
    through grant of the authorization code, access token, and ID token,
    and optional use of the access token to get information about the end user.
   </p><div class="mediaobject" align="center"><a name="figure-openid-connect-basic"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/openid-connect-basic.png" align="middle" height="360" alt="OpenAM in OpenID Connect Authorization Code Flow"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-openid-connect-basic.html" target="longdesc">D</a>]</span></div></div><p>
    In addition to what OAuth 2.0 specifies,
    OpenID Connect uses an ID token
    so the relying party can validate claims about the end user.
    It also defines how to get user information
    such as profile, email, address, and phone details
    from the UserInfo endpoint with a valid access token.
   </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="openam-openid-implicit-client-profile"></a>13.1.2.&nbsp;OpenID Connect Implicit Flow</h3></div></div></div><p>
    The OpenID Connect Implicit Flow specifies
    how the relying party interacts with the OpenID Provider,
    in this case OpenAM,
    based on use of the OAuth 2.0 implicit grant.
    The following sequence diagram shows successful processing
    from the authorization request,
    through grant of the access and ID tokens,
    and optional use of the access token to get information about the end user.
   </p><div class="mediaobject" align="center"><a name="figure-openid-connect-implicit"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/openid-connect-implicit.png" align="middle" height="360" alt="OpenAM in OpenID Connect Implicit Flow"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-openid-connect-implicit.html" target="longdesc">D</a>]</span></div></div><p>
    As for the Authorization Code Flow, the Implicit Flow specifies
    an ID token so that the relying party can validate claims about the end user.
    It also defines how to get user information
    such as profile, email, address, and phone details
    from the UserInfo endpoint with a valid access token.
   </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="openam-openid-discovery"></a>13.1.3.&nbsp;OpenID Connect Discovery</h3></div></div></div><p>OpenID Connect defines how a relying party can discover the
   OpenID Provider and corresponding OpenID Connect configuration for
   an end user. The discovery mechanism relies on WebFinger to get the
   information based on the end user's identifier. The server returns the
   information in JSON Resource Descriptor (JRD) format.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="openam-openid-client-registration"></a>13.1.4.&nbsp;OpenID Connect Relying Party Registration</h3></div></div></div><p>
    OpenID Connect relying parties register OAuth 2.0 client profiles with OpenAM.
    Relying parties can register with OpenAM as a provider both statically,
    as for other OAuth 2.0 clients,
    and also dynamically as specified by OpenID Connect Discovery.
    To allow dynamic registration, you register an initial OAuth 2.0 client
    that other relying parties can use to get access tokens for registration.
   </p><p>
    You can also enable OpenID Connect relying parties to register dynamically
    without having to provide an access token.
    For details, see the documentation on the advanced server property,
    <code class="literal">org.forgerock.openam.openidconnect.allow.open.dynamic.registration</code>,
    in the <em class="citetitle">OpenAM Reference</em> section,
    <a href="../reference/index.html#servers-advanced-configuration" class="link"><em class="citetitle">Servers &gt; Advanced</em></a>.
    Take care to limit or throttle dynamic registration
    if you enable this capability on production systems.
   </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="openam-openid-session-management"></a>13.1.5.&nbsp;OpenID Connect Session Management</h3></div></div></div><p>OpenID Connect lets the relying party track whether the end user is logged in
   at the provider, and also initiate end user logout at the provider. The
   specification has the relying party monitor session state using an
   invisible iframe and communicate status using the HTML 5 postMessage
   API.</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="configure-openid-connect-provider"></a>13.2.&nbsp;Configuring OpenAM As OpenID Provider</h2></div></div></div><p>
   You can configure OpenAM's OAuth 2.0 authorization service
   to double as an OpenID Provider.
  </p><p>
   First, follow the instructions for
   <a href="../admin-guide/index.html#configure-oauth2-authz" class="link"><em class="citetitle">Configuring the OAuth 2.0 Authorization Service</em></a>,
   making sure that the Response Type Plugins list includes
   at least the default plugin classes.
  </p><div class="itemizedlist"><p>
    Next, configure the OpenID Connect specific options.
   </p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
     The optional Remote JSON Web Key URL field allows you to set a URL to a
     <a class="link" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-key" target="_blank">JSON Web Key set</a>
     with the public key(s) for the provider.
    </p><p>
     If this setting is not configured, then OpenAM provides a local URL
     to access the public key of the private key used to sign ID tokens.
    </p></li><li class="listitem"><p>
     The Subject Types supported map allows you to support pairwise subject types
     as described in the OpenID Connect core specification section concerning
     <a class="link" href="http://openid.net/specs/openid-connect-core-1_0.html#SubjectIDTypes" target="_blank">Subject Identifier Types</a>.
    </p></li><li class="listitem"><p>
     The ID Token Signing Algorithms supported list allows you
     to change the list of algorithms used sign ID Tokens.
    </p></li><li class="listitem"><p>
     The Supported Claims list allows you
     to restrict the claims supported by OpenAM's userinfo endpoint.
    </p></li><li class="listitem"><p>
     The Alias of ID Token Signing Key alias allows you
     to set the key pair alias for the key used to sign ID Tokens
     when using a signing algorithm that involves asymmetric keys.
    </p><p>
     For instructions on changing the key pair, see
     <a href="../admin-guide/index.html#change-signing-key" class="link"><em class="citetitle">To Change the Signing Key for Federation</em></a>.
    </p></li><li class="listitem"><p>
     The Allow Open Dynamic Client Registration checkbox enables relying parties
     to register without using an access token.
    </p></li><li class="listitem"><p>
     The Generate Registration Access Tokens checkbox has OpenAM generate
     Registration Access Tokens for dynamic client registration when
     Allow Open Dynamic Client Registration is enabled.
     This allows the client to view and update its registration.
    </p></li></ul></div><p>
   Finally, if your provider is part of a GSMA Mobile Connect deployment, see
   <a class="xref" href="#mobile-connect-configure" title="Procedure&nbsp;13.3.&nbsp;Configuring OpenAM as an OP for Mobile Connect">Procedure&nbsp;13.3, &#8220;Configuring OpenAM as an OP for Mobile Connect&#8221;</a>.
  </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="configure-openid-connect-discovery"></a>13.3.&nbsp;Configuring OpenAM For OpenID Connect Discovery</h2></div></div></div><p>
   In order to allow relying parties to discover
   the OpenID Provider for an end user,
   OpenAM supports OpenID Connect Discovery 1.0.
   In addition to discovering the OpenID Provider for an end user,
   the relying party can also request the OpenID Provider configuration.
  </p><p>OpenAM as OpenID Provider exposes two endpoints for
  discovery:</p><table border="0" summary="Simple list" class="simplelist"><tr><td><code class="literal">/.well-known/webfinger</code></td></tr><tr><td><code class="literal">/.well-known/openid-configuration</code></td></tr></table><p>
   A relying party needs to be able to discover the OpenID provider for an end user.
   In this case you should consider redirecting requests to URIs at the server root,
   such as <code class="literal">http://www.example.com/.well-known/webfinger</code>
   and <code class="literal">http://www.example.com/.well-known/openid-configuration</code>,
   to these Well-Known URIs in OpenAM's space.
  </p><p>Discovery relies on <a class="link" href="http://tools.ietf.org/html/draft-ietf-appsawg-webfinger" target="_blank">WebFinger</a>, a protocol to discover information about people and other
  entities using standard HTTP methods. WebFinger uses <a class="link" href="http://tools.ietf.org/html/rfc5785" target="_blank">Well-Known URIs</a>,
  which defines the path prefix <code class="literal">/.well-known/</code> for the
  URLs defined by OpenID Connect Discovery.</p><p>Unless you deploy OpenAM in the root context of a container listening
  on port 80 on the primary host for your domain, relying parties need to find
  the right <em class="replaceable"><code>host:port/deployment-uri</code></em> combination
  to locate the well-known endpoints. Therefore you must manage the redirection
  to OpenAM. If you are using WebFinger for something else than OpenID Connect
  Discovery, then you probably also need proxy logic to route the requests.</p><p>
   To retrieve the OpenID Provider for an end user,
   the relying party needs the following.
  </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">host</code></span></dt><dd><p>The server where the relying party can access the WebFinger service.</p><p>Notice that this is a host name rather than a URL to the endpoint,
     which is why you might need to redirect relying parties appropriately as described
     above.</p></dd><dt><span class="term"><code class="literal">resource</code></span></dt><dd><p>Identifies the end user that is the subject of the request.</p><p>The relying party must percent-encode the resource value when using it in
     the query string of the request, so when using the "acct" URI scheme and
     the resource is <code class="literal">acct:user@example.com</code>, then the value
     to use is <code class="literal">acct%3Auser%40example.com</code>.</p></dd><dt><span class="term"><code class="literal">rel</code></span></dt><dd><p>URI identifying the type of service whose location is requested.</p><p>In this case <code class="literal">http://openid.net/specs/connect/1.0/issuer</code>,
     which is <code class="literal">http%3A%2F%2Fopenid.net%2Fspecs%2Fconnect%2F1.0%2Fissuer</code>.</p></dd></dl></div><p>Ignoring the question of redirection, you can test the endpoint for the
  demo user account (output lines folded to make them easier to read).</p><div class="screen"><pre>
$ <strong>curl \
 "https://openam.example.com:8443/openam/.well-known/webfinger\
?resource=acct%3Ademo%40example.com\
&amp;rel=http%3A%2F%2Fopenid.net%2Fspecs%2Fconnect%2F1.0%2Fissuer"</strong>
<em>{
  "subject": "acct:demo@example.com",
  "links": [
    {
      "rel": "http://openid.net/specs/connect/1.0/issuer",
      "href": "https://openam.example.com:8443/openam"
    }
  ]
}</em>
  </pre></div><p>This shows that the OpenID Provider for the OpenAM demo user is
  indeed the OpenAM server.</p><p>
   The relying party can also discover the OpenID provider configuration.
   Ignoring the question of redirection, you can test this
   (output lines folded to make them easier to read).
  </p><div class="informalexample"><div class="screen"><pre>
$ <strong>curl https://openam.example.com:8443/openam/.well-known/openid-configuration</strong>
<em>{
    "response_types_supported": [
        "token id_token",
        "code token",
        "code token id_token",
        "token",
        "code id_token",
        "code",
        "id_token"
    ],
    "registration_endpoint": "https://openam.example.com:8443/openam/oauth2/connect/register",
    "token_endpoint": "https://openam.example.com:8443/openam/oauth2/access_token",
    "end_session_endpoint": "https://openam.example.com:8443/openam/oauth2/connect/endSession",
    "version": "3.0",
    "userinfo_endpoint": "https://openam.example.com:8443/openam/oauth2/userinfo",
    "subject_types_supported": [
        "public"
    ],
    "issuer": "https://openam.example.com:8443/openam",
    "jwks_uri": "https://openam.example.com:8443/openam/oauth2/connect/jwk_uri?realm=/",
    "id_token_signing_alg_values_supported": [
        "HS256",
        "HS512",
        "RS256",
        "HS384"
    ],
    "check_session_iframe": "https://openam.example.com:8443/openam/oauth2/connect/checkSession",
    "claims_supported": [
        "phone",
        "email",
        "address",
        "openid",
        "profile"
    ],
    "authorization_endpoint": "https://openam.example.com:8443/openam/oauth2/authorize"
}</em>
  </pre></div></div><p>
   When the OpenID Provider is configured in a subrealm,
   then relying parties can get the configuration
   by passing the realm as a query string parameter, as in
   <code class="literal">https://openam.example.com:8443/openam/.well-known/openid-configuration?realm=<em class="replaceable"><code>realm-name</code></em></code>.
  </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="register-openid-connect-clients"></a>13.4.&nbsp;Registering OpenID Connect Relying Parties</h2></div></div></div><p>
   OpenID Connect relying parties can register with OpenAM
   both statically through OpenAM console for example,
   and also dynamically using OpenID Connect 1.0 Dynamic Registration.
  </p><div class="procedure"><a name="register-openid-connect-client-static"></a><div class="procedure-title">Procedure&nbsp;13.1.&nbsp;To Register a Relying Party With OpenAM Console</div><p>Registering a relying party by using the OpenAM console consists of first
   creating an OAuth 2.0 Client agent profile, and then editing the profile
   for the settings pertinent to OpenID Connect 1.0.</p><ol class="procedure" type="1"><li class="step"><p>In the OpenAM console under Access Control &gt; <em class="replaceable"><code>Realm
    Name</code></em> &gt; Agents &gt; OAuth 2.0 Client &gt; Agent, click
    New..., then provide the client identifier and client password, and
    finally click Create to create the profile.</p></li><li class="step"><p>Follow the hints in the section, <a href="../admin-guide/index.html#configure-oauth2-client" class="link"><em class="citetitle">Configuring
    OAuth 2.0 &amp; OpenID Connect 1.0 Clients</em></a> to edit
    the profile to match the relying party configuration.</p><p>In order to read and edit the relying party profile dynamically later
    without using OpenAM console, be sure to set an access token in the Access
    Token field.</p></li></ol></div><div class="procedure"><a name="register-openid-connect-client-dynamic"></a><div class="procedure-title">Procedure&nbsp;13.2.&nbsp;To Register a Relying Party Dynamically</div><p>For dynamic registration you need the relying party profile data,
   and an access token to write the configuration to OpenAM by HTTP POST. To
   obtain the access token, register an initial client statically after creating
   the provider, as described in
   <a class="xref" href="#register-openid-connect-client-static" title="Procedure&nbsp;13.1.&nbsp;To Register a Relying Party With OpenAM Console">Procedure&nbsp;13.1, &#8220;To Register a Relying Party With OpenAM Console&#8221;</a>. Relying parties can
   then use that client to obtain the access token needed to perform dynamic
   registration.</p><div class="tip"><h3 class="title">Tip</h3><p>
     As described in <a class="xref" href="#openam-openid-client-registration" title="13.1.4.&nbsp;OpenID Connect Relying Party Registration">Section&nbsp;13.1.4, &#8220;OpenID Connect Relying Party Registration&#8221;</a>,
     You can allow relying parties to register without having an access token
     by setting the advanced server property,
     <code class="literal">org.forgerock.openam.openidconnect.allow.open.dynamic.registration</code>,
     to <code class="literal">true</code>.
     When using that setting in production systems,
     take care to limit or throttle dynamic registration.
    </p></div><p>On successful registration, OpenAM responds with information including
   an access token to allow the relying party subsequently to read and edit its
   profile.</p><ol class="procedure" type="1"><li class="step"><p>Register an initial OAuth 2.0 client statically with a client ID
    such as <code class="literal">masterClient</code> and client secret such as
    <code class="literal">password</code>.</p></li><li class="step"><p>Obtain an access token using the client you registered.</p><p>For example, if you created the client as described in the previous
    step, and OpenAM administrator <code class="literal">amadmin</code> has password
    <code class="literal">password</code>, you can use the OAuth 2.0 resource owner
    password grant as in the following example.</p><div class="screen"><pre>
$ <strong>curl \
 --request POST \
 --user "masterClient:password" \
 --data "grant_type=password&amp;username=amadmin&amp;password=password" \
 https://openam.example.com:8443/openam/oauth2/access_token</strong>
<em>{
    "expires_in": 59,
    "token_type": "Bearer",
    "refresh_token": "26938cd0-6870-4e31-ade9-df31afc37ee1",
    "access_token": "515d6551-4512-4279-98b6-c0ef3f03a722"
}</em>
    </pre></div></li><li class="step"><p>HTTP POST the relying party registration profile to the
    <code class="literal">/oauth2/connect/register</code> endpoint, using bearer token
    authorization with the access token you obtained from OpenAM.</p><p>For an example written in JavaScript, see the registration page in
    the examples <a class="link" href="https://github.com/markcraig/openid/" target="_blank">available online</a>.
    Successful registration shows a response that includes the client ID and
    client secret. Lines are folded in the following example.</p><pre class="brush: javascript;">
{
  "issued_at": 1392364349,
  "expires_at": 0,
  "client_secret": "7f446ca9-3f1f-48fb-bf8c-150b9e643f29",
  "redirect_uris": [
    "https://openam.example.com:8443/openid/cb-basic.html",
    "https://openam.example.com:8443/openid/cb-implicit.html"
  ],
  "registration_access_token": "515d6551-4512-4279-98b6-c0ef3f03a722",
  "client_id": "6e4abd50-3f03-41dc-b807-c6705c3e45d7",
  "registration_client_uri":
     "https://openam.example.com:8443/openam/oauth2/connect/register
     ?client_id=6e4abd50-3f03-41dc-b807-c6705c3e45d7"
}
    </pre></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="manage-sessions-openid-connect"></a>13.5.&nbsp;Managing User Sessions</h2></div></div></div><p>OpenID Connect Session Management 1.0 allows the relying party to manage
  OpenID Connect sessions, making it possible to know when the end user should
  be logged out.</p><p>As described in the <a class="link" href="http://openid.net/specs/openid-connect-session-1_0.html" target="_blank">OpenID Connect Session Management 1.0</a> specification,
  OpenAM's OpenID Provider exposes both a "check_session_iframe" URL
  that allows the relying party to receive notifications when the end user's session
  state changes at the provider, and also an "end_session_endpoint" URL to
  which to redirect an end user for logout.</p><p>When registering your relying party that uses session management, you set the
  OAuth 2.0 client agent profile properties Post Logout Redirect URI and
  Client Session URI, described in <a href="../admin-guide/index.html#configure-oauth2-client" class="link"><em class="citetitle">Configuring
  OAuth 2.0 &amp; OpenID Connect 1.0 Clients</em></a>. The Post
  Logout Redirect URI is used to redirect the end user user-agent after logout.
  The Client Session URI is the relying party URI where OpenAM sends notifications
  when the end user's session state changes.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="openid-connect-examples"></a>13.6.&nbsp;Relying Party Examples</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="#openid-basic-profile-example">13.6.1. Authorization Code Flow Example</a></span></dt><dt><span class="section"><a href="#openid-implicit-profile-example">13.6.2. Implicit Flow Example</a></span></dt></dl></div><p>
   OpenID Connect Authorization Code Flow and Implicit Flow
   define how clients interact with the provider
   to obtain end user authorization and profile information.
   Although you can run the simple example relying parties
   that are mentioned in this section
   without setting up Transport Layer Security,
   do not deploy relying parties in production without securing the transport.
  </p><p>
   Code for the relying party examples shown here is
   <a class="link" href="https://github.com/markcraig/openid/" target="_blank">available online</a>.
   Clone the example project to deploy it in the same web container as OpenAM.
   Edit the configuration at the outset of the .js files in the project,
   register a corresponding profile for the example relying party
   as described in <a class="xref" href="#register-openid-connect-clients" title="13.4.&nbsp;Registering OpenID Connect Relying Parties">Section&nbsp;13.4, &#8220;Registering OpenID Connect Relying Parties&#8221;</a>,
   and browse the deployment URL to see the initial page.
  </p><div class="mediaobject" align="center"><a name="figure-openid-connect-example-start-page"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/openid-connect-example-start-page.png" align="middle" height="360" alt="OpenID Connect Client Profiles Start Page"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-openid-connect-example-start-page.html" target="longdesc">D</a>]</span></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="openid-basic-profile-example"></a>13.6.1.&nbsp;Authorization Code Flow Example</h3></div></div></div><p>
    OpenID Connect Authorization Code Flow is designed
    for web-based relying parties
    that use the OAuth 2.0 Authorization Code grant type.
    This grant type makes it possible for the relying party
    to get the access code by using the authorization code directly,
    without passing through the end user's browser.
    To protect its client secret (password),
    part of the relying party must run on a server.
   </p><p>
    In the example, the Basic Client Profile Start Page
    describes the prerequisite configuration,
    which must be part of the relying party profile
    that is stored in the OpenAM realm where you set up the OpenID Provider.
    In OpenAM console,
    check that the OAuth 2.0 client profile matches the settings described.
   </p><div class="mediaobject" align="center"><a name="figure-openid-connect-basic-start-page"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/openid-connect-basic-start-page.png" align="middle" height="360" alt="OpenID Connect Basic Client Profile Start Page"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-openid-connect-basic-start-page.html" target="longdesc">D</a>]</span></div></div><p>
    Logout of OpenAM,
    and click the link at the bottom of the page to request authorization.
    The link sends an HTTP GET request
    asking for <code class="literal">openid profile</code> scopes
    to the OpenID Provider authorization URI.
   </p><p>
    If everything is configured correctly,
    OpenAM's OpenID Provider has you authenticate as an end user,
    such as the demo user
    with username <code class="literal">demo</code> and password <code class="literal">changeit</code>,
    and grant (Allow) the relying party access to your profile.
   </p><p>
    If you successfully authenticate
    and allow the example relying party access to your profile,
    OpenAM returns an authorization code to the example relying party.
    The example relying party then uses the authorization code
    to request an access token and an ID token.
    It shows the response to that request.
    It also validates the ID token signature using the default (HS256) algorithm,
    and decodes the ID token to validate its content and show it in the output.
    Finally it uses the access token
    to request information about the end user who authenticated,
    and displays the result.
   </p><div class="mediaobject" align="center"><a name="figure-openid-connect-basic-response-page"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/openid-connect-basic-response-page.png" align="middle" height="360" alt="OpenID Connect Basic Client Profile Response Page"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-openid-connect-basic-response-page.html" target="longdesc">D</a>]</span></div></div><p>
    Notice that in addition to the standard payload,
    the ID token indicates the end user's OpenAM realm,
    in this case <code class="literal">"realm": "/"</code>.
   </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="openid-implicit-profile-example"></a>13.6.2.&nbsp;Implicit Flow Example</h3></div></div></div><p>
    OpenID Connect Implicit Flow is designed
    for relying parties that use the OAuth 2.0 Implicit grant type.
    This grant type is designed for relying parties implemented in a browser.
    Rather than protect a client secret, the client profile must
    register a protected redirect URI in advance with the OpenID Provider.
   </p><p>
    In the example,
    the Implicit Client Profile Start Page describes the prerequisite configuration,
    which must be part of the relying party profile
    that is stored in the OpenAM realm where you set up the OpenID Provider.
    In OpenAM console,
    check that the OAuth 2.0 client profile matches the settings described.
    If you have already configured the agent profile
    for the Authorization Code Flow example
    then you still need to add the redirect URI for the Implicit Flow.
   </p><div class="mediaobject" align="center"><a name="figure-openid-connect-implicit-start-page"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/openid-connect-implicit-start-page.png" align="middle" height="360" alt="OpenID Connect Implicit Client Profile Start Page"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-openid-connect-implicit-start-page.html" target="longdesc">D</a>]</span></div></div><p>
    Logout of OpenAM,
    and click the link at the bottom of the page to request authorization.
    The link sends an HTTP GET request asking
    for <code class="literal">id_token token</code> response types
    and <code class="literal">openid profile</code> scopes
    to the OpenID Provider authorization URI.
   </p><p>
    If everything is configured correctly,
    OpenAM's OpenID Provider has you authenticate as an end user,
    such as the demo user
    with username <code class="literal">demo</code> and password <code class="literal">changeit</code>,
    and grant (Allow) the relying party access to your profile.
   </p><p>
    If you successfully authenticate
    and allow the example relying party access to your profile,
    OpenAM returns the access token and ID token
    directly in the fragment (after <code class="literal">#</code>) of the redirect URI.
    The relying party does not get an authorization code.
    The relying party shows the response to the request.
    It also validates the ID token signature using the default (HS256) algorithm,
    and decodes the ID token to validate its content and show it in the output.
    Finally the relying party uses the access token
    to request information about the end user who authenticated,
    and displays the result.
   </p><div class="mediaobject" align="center"><a name="figure-openid-connect-implicit-response-page"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/openid-connect-implicit-response-page.png" align="middle" height="360" alt="OpenID Connect Implicit Client Profile Response Page"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-openid-connect-implicit-response-page.html" target="longdesc">D</a>]</span></div></div><p>
    As for the Authorization Code Flow example,
    the ID Token indicates the end user's
    OpenAM realm and OpenAM token ID in addition to the standard information.
   </p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="openid-connect-security-considerations"></a>13.7.&nbsp;Security Considerations</h2></div></div></div><p>As for other OAuth 2.0 applications, you must protect messages going
  across the network. OpenID Connect 1.0 requires Transport Layer Security
  (TLS). The chapter on <a href="../admin-guide/index.html#chap-certs-keystores" class="link"><em class="citetitle">Managing
  Certificates</em></a> includes some discussion of protecting
  traffic in the container where OpenAM runs. Also see the documentation for
  your web application container.</p><p>Also take into account the points developed in the section on <a class="link" href="http://openid.net/specs/openid-connect-messages-1_0.html#security-considerations" target="_blank"><em class="citetitle">Security Considerations</em></a> in
  the OpenID Connect Messages draft specification.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="mobile-connect"></a>13.8.&nbsp;Using OpenAM with Mobile Connect</h2></div></div></div><p>
   <a class="link" href="http://gsmamobileeconomy.com/gsmamc/" target="_blank">GSMA Mobile Connect</a> is an application of OpenID Connect (OIDC).
   Mobile Connect builds on OIDC
   to facilitate use of mobile phones as authentication devices
   independently of the service provided
   and independently of the device used to consume the service.
   Mobile Connect thus offers a standard way for Mobile Network Operators
   to act as general-purpose identity providers,
   providing a range of levels of assurance and profile data
   to Mobile Connect-compliant Service Providers.
  </p><div class="itemizedlist"><p>
    This section includes an overview, as well as the following.
   </p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
     <a class="xref" href="#mobile-connect-table-auth-request-params" title="Table&nbsp;13.1.&nbsp;Authorization Request Parameters">Table&nbsp;13.1, &#8220;Authorization Request Parameters&#8221;</a>
    </p></li><li class="listitem"><p>
     <a class="xref" href="#mobile-connect-table-id-token-properties" title="Table&nbsp;13.2.&nbsp;ID Token Properties">Table&nbsp;13.2, &#8220;ID Token Properties&#8221;</a>
    </p></li><li class="listitem"><p>
     <a class="xref" href="#mobile-connect-configure" title="Procedure&nbsp;13.3.&nbsp;Configuring OpenAM as an OP for Mobile Connect">Procedure&nbsp;13.3, &#8220;Configuring OpenAM as an OP for Mobile Connect&#8221;</a>
    </p></li></ul></div><p>
   In a Mobile Connect deployment OpenAM can play the OpenID Provider role,
   implementing the Mobile Connect Profile
   as part of the Service Provider - Identity Gateway interface.
  </p><p>
   OpenAM can also play the Authenticator role
   as part of the Identity Gateway - Authenticators interface.
   In this role, OpenAM serves to authenticate users
   at the appropriate Level of Assurance (LoA).
   In Mobile Connect, LoAs represent the authentication level achieved.
   A Service Provider can request LoAs without regard to the implementation,
   and the Identity Gateway includes a claim in the ID Token
   that indicates the LoA achieved.
  </p><p>
   In OpenAM, Mobile Connect LoAs map to an authentication mechanism.
   Service Providers acting as OpenID Relying Parties (RP) request an LoA
   by using the "acr_values" field in an OIDC authentication request.
   In OIDC, "acr_values" specifies Authentication Context Class Reference values.
   The RP sets "acr_values" as part of the OIDC Authentication Request.
   OpenAM returns the corresponding "acr" claim in the Authentication Response
   as the value of the ID Token "acr" field.
  </p><p>
   OpenAM as OP supports LoAs 1 (low - little or no confidence),
   2 (medium - some confidence, as in single-factor authentication),
   and 3 (high - high confidence, as in multi-factor authentication),
   though out of the box it does not include support for 4,
   which involves digital signatures.
  </p><p>
   As Mobile Connect OP, OpenAM supports mandatory request parameters,
   and a number of optional request parameters.
  </p><div class="table"><a name="mobile-connect-table-auth-request-params"></a><div class="table-title">Table&nbsp;13.1.&nbsp;Authorization Request Parameters</div><div class="table-contents"><table summary="Authorization Request Parameters" border="0"><colgroup><col width="33%"><col width="16%"><col width="51%"></colgroup><thead><tr><th>Request Parameter</th><th>Support</th><th>Description</th></tr></thead><tbody><tr><td>
       <p>
        <code class="literal">response_type</code>
       </p>
      </td><td>
       <p>
        Supported
       </p>
      </td><td>
       <p>
        OAuth 2.0 grant type to use.
        Set this to <code class="literal">code</code> for the authorization grant.
       </p>
      </td></tr><tr><td>
       <p>
        <code class="literal">client_id</code>
       </p>
      </td><td>
       <p>
        Supported
       </p>
      </td><td>
       <p>
        Set this to the client identifier.
       </p>
      </td></tr><tr><td>
       <p>
        <code class="literal">scope</code>
       </p>
      </td><td>
       <p>
        Supported
       </p>
      </td><td>
       <p>
        Space delimited OAuth 2.0 scope values.
       </p>

       <p>
        Required: <code class="literal">openid</code>
       </p>

       <p>
        Optional: <code class="literal">profile</code>, <code class="literal">email</code>,
        <code class="literal">address</code>, <code class="literal">phone</code>,
        <code class="literal">offline_access</code>
       </p>
      </td></tr><tr><td>
       <p>
        <code class="literal">redirect_uri</code>
       </p>
      </td><td>
       <p>
        Supported
       </p>
      </td><td>
       <p>
        OAuth 2.0 URI where the authorization request callback should go.
        Must match the <code class="literal">redirect_uri</code> in the client profile
        that you registered with OpenAM.
       </p>
      </td></tr><tr><td>
       <code class="literal">state</code>
      </td><td>
       <p>
        Supported
       </p>
      </td><td>
       <p>
        Value to maintain state between the request and the callback.
        Required for Mobile Connect.
       </p>
      </td></tr><tr><td>
       <code class="literal">nonce</code>
      </td><td>
       <p>
        Supported
       </p>
      </td><td>
       <p>
        String value to associate the client session with the ID Token.
        Optional in OIDC, but required for Mobile Connect.
       </p>
      </td></tr><tr><td>
       <code class="literal">display</code>
      </td><td>
       <p>
        Supported
       </p>
      </td><td>
       <p>
        String value to specify the user interface display.
       </p>
      </td></tr><tr><td>
       <code class="literal">login_hint</code>
      </td><td>
       <p>
        Supported
       </p>
      </td><td>
       <p>
        String value indicating the the ID to use for login.
       </p>

       <p>
        When provided as part of the OIDC Authentication Request,
        the <code class="literal">login_hint</code> is set
        as the value of a cookie named oidcLoginHint,
        which is an HttpOnly cookie (only sent over HTTPS).
        Authentication modules can then retrieve the cookie's value.
       </p>
      </td></tr><tr><td>
       <code class="literal">acr_values</code>
      </td><td>
       <p>
        Supported
       </p>
      </td><td>
       <p>
        Authentication Context class Reference values
        used to communicate acceptable LoAs.
       </p>

       <p>
        When the OIDC relying party on the server provider
        supplies <code class="literal">acr_values</code> in the authorization request,
        OpenAM uses the OP configuration to map the values
        to authentication chains.
        It runs through the list of <code class="literal">acr_values</code> in order,
        attempting to use the first authentication chain that matches.
        OpenAM then returns the authentication chain used
        as the value of the ID token "acr" claims property.
        In this way the relying part on the service provider
        can determine the LoA achieved during authentication.
       </p>
      </td></tr><tr><td>
       <code class="literal">dtbs</code>
      </td><td>
       <p>
        Not supported
       </p>
      </td><td>
       <p>
        Data To Be Signed
       </p>

       <p>
        At present OpenAM does not support LoA 4.
       </p>
      </td></tr></tbody></table></div></div><br class="table-break"><p>
   As Mobile Connect OP, OpenAM responds to a successful authorization request
   with a response containing all the required fields,
   and also the optional "expires_in" field.
   OpenAM supports the mandatory ID Token properties,
   though the relying party is expected to use the "expires_in" value,
   rather than specifying <code class="literal">max_age</code> as a request parameter.
  </p><div class="table"><a name="mobile-connect-table-id-token-properties"></a><div class="table-title">Table&nbsp;13.2.&nbsp;ID Token Properties</div><div class="table-contents"><table summary="ID Token Properties" border="0"><colgroup><col width="33%"><col width="16%"><col width="51%"></colgroup><thead><tr><th>Request Parameter</th><th>Support</th><th>Description</th></tr></thead><tbody><tr><td>
       <p>
        <code class="literal">iss</code>
       </p>
      </td><td>
       <p>
        Supported
       </p>
      </td><td>
       <p>
        Issuer identifier
       </p>
      </td></tr><tr><td>
       <p>
        <code class="literal">sub</code>
       </p>
      </td><td>
       <p>
        Supported
       </p>
      </td><td>
       <p>
        Subject identifier
       </p>

       <p>
        By default OpenAM returns the identifier from the user profile.
       </p>
      </td></tr><tr><td>
       <p>
        <code class="literal">aud</code>
       </p>
      </td><td>
       <p>
        Supported
       </p>
      </td><td>
       <p>
        Audience, an array including the <code class="literal">client_id</code>
       </p>
      </td></tr><tr><td>
       <p>
        <code class="literal">exp</code>
       </p>
      </td><td>
       <p>
        Supported
       </p>
      </td><td>
       <p>
        Expiration time in seconds since the epoch
       </p>
      </td></tr><tr><td>
       <p>
        <code class="literal">iat</code>
       </p>
      </td><td>
       <p>
        Supported
       </p>
      </td><td>
       <p>
        Issued at time in seconds since the epoch
       </p>
      </td></tr><tr><td>
       <code class="literal">nonce</code>
      </td><td>
       <p>
        Supported
       </p>
      </td><td>
       <p>
        The nonce supplied in the request
       </p>
      </td></tr><tr><td>
       <p>
        <code class="literal">at_hash</code>
       </p>
      </td><td>
       <p>
        Supported
       </p>
      </td><td>
       <p>
        Base64url encoding of the SHA-256 hash of the "access_token" value
       </p>
      </td></tr><tr><td>
       <p>
        <code class="literal">acr</code>
       </p>
      </td><td>
       <p>
        Supported
       </p>
      </td><td>
       <p>
        Authentication Context class Reference for the LoA achieved
       </p>

       <p>
        For example, if the request specifies
        <code class="literal">acr_values=loa-3 loa-2</code>
        and OpenAM achieves LoA 2, then the ID token includes
        <code class="literal">"acr": "loa-2"</code>.
       </p>
      </td></tr><tr><td>
       <p>
        <code class="literal">amr</code>
       </p>
      </td><td>
       <p>
        Supported
       </p>
      </td><td>
       <p>
        Authentication Methods Reference to indicate the authentication method
       </p>

       <p>
        OpenAM maps these to authentication modules.
       </p>

       <p>
        Suggested values include the following:
        <code class="literal">OK, DEV_PIN, SIM_PIN, UID_PWD, BIOM, HDR, OTP</code>
       </p>
      </td></tr><tr><td>
       <p>
        <code class="literal">azp</code>
       </p>
      </td><td>
       <p>
        Supported
       </p>
      </td><td>
       <p>
        Authorized party identifier, which is the <code class="literal">client_id</code>
       </p>
      </td></tr></tbody></table></div></div><br class="table-break"><p>
   In addition to the standard OIDC user information returned with userinfo,
   OpenAM as OP for Mobile Connect returns the "updated_at" property,
   representing the time last updated as seconds since the epoch.
  </p><div class="procedure"><a name="mobile-connect-configure"></a><div class="procedure-title">Procedure&nbsp;13.3.&nbsp;Configuring OpenAM as an OP for Mobile Connect</div><p>
    You configure OpenAM as an OpenID Provider for Mobile Connect
    by changing the OAuth2 Provider configuration.
   </p><p>
    In OpenAM console, the OAuth2 Provider configuration is
    under Access Control &gt; <em class="replaceable"><code>Realm Name</code></em>
    &gt; Services &gt; OAuth2 Provider for the configuration in a specific realm,
    and under Configuration &gt; Global &gt; OAuth2 Provider
    for the inherited global settings.
   </p><ol class="procedure" type="1"><li class="step"><p>
     Configure OpenAM as an OpenID Provider as described in
     <a class="xref" href="#configure-openid-connect-provider" title="13.2.&nbsp;Configuring OpenAM As OpenID Provider">Section&nbsp;13.2, &#8220;Configuring OpenAM As OpenID Provider&#8221;</a>.
    </p></li><li class="step"><p>
     For the OpenID Connect acr_values to Auth Chain Mapping,
     configure the mapping between <code class="literal">acr_values</code>
     in the authorization request and OpenAM authentication chains.
    </p><p>
     For example, if the relying party request includes
     <code class="literal">acr_values=loa-3 loa-2</code>
     and the map includes <code class="literal">[loa-2]=ldapService</code>,
     and <code class="literal">[loa-3]=msisdnAndHotpChain</code>,
     then the authentication chain for the request
     is <code class="literal">msisdnPlusHotpChain</code>.
    </p><p>
     The <span class="command"><strong>ssoadm</strong></span> attribute is
     <code class="literal">forgerock-oauth2-provider-loa-mapping</code>.
    </p></li><li class="step"><p>
     For the OpenID Connect default acr claim,
     set the "acr" claim value to return in the ID Token
     when falling back to the default authentication chain.
    </p><p>
     The <span class="command"><strong>ssoadm</strong></span> attribute is
     <code class="literal">forgerock-oauth2-provider-default-acr</code>.
    </p></li><li class="step"><p>
     For the OpenID Connect id_token amr values to Auth Module mappings,
     set the "amr" values to return in the ID Token
     after successfully authenticating with specified authentication modules.
    </p><p>
     For example, you could set <code class="literal">[UID_PWD]=LDAP</code> to return
     <code class="literal">"amr": [ "UID_PWD" ]</code> in the ID Token
     after authenticating with the LDAP module.
    </p><p>
     The <span class="command"><strong>ssoadm</strong></span> attribute is
     <code class="literal">forgerock-oauth2-provider-amr-mappings</code>.
    </p></li><li class="step"><p>
     Configure the identity Data Store attributes used to return
     "updated_at" values in the ID Token.
    </p><p>
     For Mobile Connect clients,
     the user info endpoint returns "updated_at" values in the ID Token.
     If the user profile has never been updated "updated_at"
     reflects creation time.
    </p><p>
     The "updated_at" values are read from the profile attributes you specify.
     When using OpenDJ directory server as an identity Data Store,
     the value is read from the <code class="literal">modifyTimestamp</code> attribute,
     or the <code class="literal">createTimestamp</code> attribute
     for a profile that has never been modified.
    </p><p>
     The <span class="command"><strong>ssoadm</strong></span> attribute
     for Modified Timestamp attribute name is
     <code class="literal">forgerock-oauth2-provider-modified-attribute-name</code>.
    </p><p>
     The <span class="command"><strong>ssoadm</strong></span> attribute is
     for Created Timestamp attribute name is
     <code class="literal">forgerock-oauth2-provider-created-attribute-name</code>.
    </p><p>
     In addition, you must also add these attributes to the list
     of LDAP User Attributes for the data store.
     Otherwise the attributes are not returned when OpenAM reads the user profile.
     To edit the list in OpenAM console, browse to
     Access Control &gt; <em class="replaceable"><code>Realm Name</code></em>
     &gt; Data Stores &gt; <em class="replaceable"><code>Data Store Name</code></em>
     &gt; LDAP User Attributes.
    </p></li></ol></div><p>
   A simple, non-secure GSMA Mobile Connect relying party example is
   <a class="link" href="https://github.com/markcraig/openid" target="_blank">available online</a>.
  </p></div></div><div lang="en" class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="chap-saml-1"></a>Chapter&nbsp;14.&nbsp;Managing SAML 1.x Single Sign-On</h1></div></div></div><div class="toc"><div class="toc-title">Table of Contents</div><dl class="toc"><dt><span class="section"><a href="#saml-1-about">14.1. About SAML 1.x</a></span></dt><dt><span class="section"><a href="#saml-1-gather-info">14.2. Gathering Configuration Information</a></span></dt><dt><span class="section"><a href="#saml-1-security">14.3. Preparing To Secure SAML 1.x Communications</a></span></dt><dt><span class="section"><a href="#saml-1-configure-local-site">14.4. Configuring SAML 1.x For Your Site</a></span></dt><dt><span class="section"><a href="#saml-1-configure-trusted-partners">14.5. Configuring SAML 1.x Trusted Partners</a></span></dt><dt><span class="section"><a href="#saml-1-test-web-sso">14.6. Testing SAML 1.x Web SSO</a></span></dt></dl></div><a class="indexterm" name="d16037e30070"></a><a class="indexterm" name="d16037e30075"></a><p>
  SAML 1.x describes an XML and SOAP based framework that allows
  online trusted partners to exchange security information.
  In particular, SAML 1.x defines mechanisms for
  browser based web single sign-on (SSO) across independent organizations
  that work together to permit SSO for access to resources.
 </p><div class="important"><h3 class="title">Important</h3><p>
   Although not strictly compatible with SAML 1.x,
   SAML 2.0 extends SAML 1.x to several additional use cases
   and also clarifies how partners share metadata with each other.
   Unless you are integrating with an existing SAML 1.x deployment
   consider using SAML 2.0,
   or an alternative such as OAuth 2.0 or OpenID Connect 1.0, instead.
  </p><p>
   See the following chapters for more information:
   <a href="../admin-guide/index.html#chap-federation" class="link"><em class="citetitle">Managing SAML 2.0 Federation</em></a>,
   <a href="../admin-guide/index.html#chap-oauth2" class="link"><em class="citetitle">Managing OAuth 2.0 Authorization</em></a>, and
   <a href="../admin-guide/index.html#chap-openid-connect" class="link"><em class="citetitle">Managing OpenID Connect 1.0 Authorization</em></a>.
  </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="saml-1-about"></a>14.1.&nbsp;About SAML 1.x</h2></div></div></div><p>
   SAML 1.x was defined in response to several technical problems.
  </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
     Web SSO solutions often use SSO session cookies.
     Browsers do not return cookies across domains.
     For instance, browsers do not return cookies
     set by servers in the example.com domain
     to servers in the example.net domain.
     SAML 1.x works around this limitation of HTTP cookies.
    </p></li><li class="listitem"><p>
     Before SAML 1.x was defined, there were already proprietary SSO solutions,
     but the solutions did not interoperate well across domains.
    </p><p>
     SAML 1.x specifies a standard, cross-domain, interoperable SSO mechanism
     that works together with proprietary SSO services in a particular domain.
    </p></li><li class="listitem"><p>
     Before SAML 1.x was defined, there was not an easy way to communicate
     security attributes across organization boundaries.
    </p><p>
     SAML 1.x simplifies the communication of security attributes
     between different organizations.
    </p></li></ul></div><p>
   In SAML 1.x, business partners can play two roles.
   The <em class="firstterm">asserting party</em>,
   also known as the SAML authority
   and whose domain is the Source site,
   authenticates users and asserts information about them.
   The <em class="firstterm">relying party</em>,
   whose domain is known as the Destination site,
   consumes assertions and uses information from the assertion
   to decide whether to allows access to resources.
  </p><p>
   In the Web Browser SSO Profiles for SAML 1.x, the user generally starts
   by authenticating with the asserting party
   and then selecting a relying party link to browse.
   Alternatively, the "Destination-Site-First" scenario can start
   with the user browsing to the relying party's site
   and being redirected to the asserting party's site to authenticate.
  </p><p>
   The SAML 1.x <em class="firstterm">Inter-site Transfer Service</em>
   is a service that redirects the authenticated user
   from the asserting party's site to the appropriate service
   on the relying party's site.
   The Inter-site Transfer Service also handles artifact and redirect generation.
   How this service transfers the user to the relying party's site depends on
   how the asserting party and the relying party exchange messages.
  </p><p>
   The asserting party and relying party can exchange messages either
   by reference, where the asserting party sends
   an <em class="firstterm">artifact</em>
   (a base64 encoded reference to the assertion)
   as a query string parameter value,
   or by value, where the asserting party directs the user's browser
   to HTTP POST the assertion to the relying party.
  </p><p>
   When the asserting party and relying party use artifacts,
   the Inter-site Transfer Service redirects
   the user's browser to the relying party's Artifact Receiver Service
   with the artifact as the value of a query string parameter.
   The relying party retrieves the artifact from the query string,
   and then sends a SAML Request
   to the Responder Service at the asserting party.
   The asserting party replies
   with a SAML Response containing one or more assertions.
  </p><div class="figure"><a name="figure-saml-1-browser-artifact-profile"></a><div class="figure-title">Figure&nbsp;14.1.&nbsp;SAML 1.x Web SSO Browser Artifact Profile</div><div class="figure-contents"><div class="mediaobject" align="center"><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/saml-1-browser-artifact-profile.png" align="middle" height="360" alt="Sequence diagram of the web SSO browser artifact profile"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="ld-d16037e30141.html" target="longdesc">D</a>]</span></div></div></div></div><br class="figure-break"><p>
   See section 4.1.1 of the <a class="link" href="https://www.oasis-open.org/committees/download.php/6837/sstc-saml-tech-overview-1.1-cd.pdf" target="_blank">SAML 1.1 technical overview</a> for more detail.
  </p><p>
   When the assertion is sent using the Browser/POST Profile,
   the Inter-site Transfer Service responds to the user's browser
   with an auto-submitting form containing the SAML response.
   The browser then submits the SAML response as form data by HTTP POST
   to the relying party's Assertion Consumer Service.
   The relying party's Assertion Consumer Service then processes the assertion.
  </p><div class="figure"><a name="figure-saml-1-browser-post-profile"></a><div class="figure-title">Figure&nbsp;14.2.&nbsp;SAML 1.x Web SSO Browser POST Profile</div><div class="figure-contents"><div class="mediaobject" align="center"><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/saml-1-browser-post-profile.png" align="middle" height="360" alt="Sequence diagram of the web SSO browser POST profile"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="ld-d16037e30159.html" target="longdesc">D</a>]</span></div></div></div></div><br class="figure-break"><p>
   See section 4.2.1 of the <a class="link" href="https://www.oasis-open.org/committees/download.php/6837/sstc-saml-tech-overview-1.1-cd.pdf" target="_blank">SAML 1.1 technical overview</a> for more detail.
  </p><p>
   The Assertion Consumer Service at the relying party
   validates the digital signature on the SAML response,
   and redirects the browser to the target URL of the resource
   that the user is attempting to access.
   The server providing that resource uses
   the relying party's authorization decision capabilities to
   establish whether the user can access the resource.
   If so, the resource is returned to the user's browser.
   If the relying party is using OpenAM for example,
   then the relying party sets an OpenAM SSO token based on the SAML response,
   and this token is used to track the user's session for authorization.
  </p><p>
   Organizations working together to achieve SAML 1.x web SSO
   are called <em class="firstterm">trusted partners</em> in this context.
   Trusted partners agree on which services they provide,
   which web SSO profiles they implement,
   and how information is exchanged in the assertions,
   including profile attribute values.
   Once the trusted partners have reached agreement on how they interact,
   you can collect information about your partners' configurations
   and configure OpenAM to match your organization's part of the agreement.
  </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="saml-1-gather-info"></a>14.2.&nbsp;Gathering Configuration Information</h2></div></div></div><p>
   Before you can configure OpenAM to allow web SSO with trusted partners,
   you must first gather information about the agreement itself,
   as well as information for your site and for your partners sites.
  </p><p>
   This section lists the data that you must collect.
  </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
     SAML protocol version to use (1.1 or 1.0; default: 1.1)
    </p></li><li class="listitem"><p>
     Assertion version to use (1.1 or 1.0; default: 1.1)
    </p></li><li class="listitem"><p>
     Which trusted partners play which roles (asserting party, relying party)
    </p></li><li class="listitem"><p>
     Domain names of partner sites
     (such as <code class="literal">example.com</code>, <code class="literal">example.net</code>)
    </p></li><li class="listitem"><p>
     Whether assertions are exchanged by SAML artifact or by HTTP POST
    </p><div class="itemizedlist"><p>
      If assertions are exchanged by artifact, also gather this information:
     </p><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
       SAML artifact parameter name (default: <code class="literal">SAMLart</code>)
      </p></li><li class="listitem"><p>
       Artifact timeout
      </p></li><li class="listitem"><p>
       URL to the relying party endpoint that receives the artifact
       (such as <code class="literal">https://rp.example.com/openam/SAMLAwareServlet</code>)
      </p></li><li class="listitem"><p>
       Relying party hosts that consume artifacts
       (by IP addresses, DNS names, or certificate aliases)
      </p></li><li class="listitem"><p>
       URL to the asserting party endpoint that responds to SAML requests
       (such as <code class="literal">https://ap.example.net/openam/SAMLSOAPReceiver</code>)
      </p></li><li class="listitem"><p>
       Authentication credentials to connect to the asserting party endpoint,
       if any (such as the username and password for HTTP Basic authentication)
      </p></li><li class="listitem"><p>
       Asserting party signing certificate alias
      </p></li></ul></div><div class="itemizedlist"><p>
      If assertions are exchanged by HTTP POST, also gather this information:
     </p><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
       URL to the relying party endpoint
       that consumes the form data in the POST assertion
       (such as <code class="literal">https://rp.example.com/openam/SAMLPOSTProfileServlet</code>)
      </p></li><li class="listitem"><p>
       Asserting party host:port issuing assertions
      </p></li><li class="listitem"><p>
       Asserting party signing certificate alias
      </p></li></ul></div></li><li class="listitem"><p>
     Whether the relying party sends SOAP query requests to the asserting party,
     for example to get authorization decisions
    </p><div class="itemizedlist"><p>
      If the relying party queries the asserting party,
      also gather this information:
     </p><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
       Relying party hosts that consume artifacts
       (by IP addresses, DNS names, or certificate aliases)
      </p></li><li class="listitem"><p>
       How to get SSO information,
       and to map partner actions to authorization decisions
      </p></li><li class="listitem"><p>
       Asserting party host:port issuing assertions
      </p></li><li class="listitem"><p>
       Asserting party signing certificate alias
      </p></li></ul></div></li><li class="listitem"><p>
     Target specifier parameter name (default: <code class="literal">TARGET</code>)
    </p></li><li class="listitem"><p>
     Assertion timeout
    </p></li><li class="listitem"><p>
     Whether to digitally sign assertions, requests, responses
    </p></li><li class="listitem"><p>
     Partners' public key certificates used for HTTPS
    </p></li><li class="listitem"><p>
     Partners' public key certificates used for message signing
     (unless included on the <code class="literal">KeyInfo</code> element of signed messages)
    </p></li><li class="listitem"><p>
     Partners' Site IDs
     (base64-encoded ID, such as <code class="literal">XARFfsIAXeLX8BEWNIJg9Q8r0PE=</code>)
    </p></li><li class="listitem"><p>
     What NameID formats are used to exchange names
     (such as <code class="literal">urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress</code>)
    </p></li><li class="listitem"><p>
     How attributes map from an assertion to an OpenAM profile
     (for example,
     <code class="literal">urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress|EmailAddress=mail</code>)
    </p></li></ul></div><p>
   For more information about your own public key certificates,
   see <a class="xref" href="#saml-1-security" title="14.3.&nbsp;Preparing To Secure SAML 1.x Communications">Section&nbsp;14.3, &#8220;Preparing To Secure SAML 1.x Communications&#8221;</a>.
  </p><p>
   For your own Site ID, see the following procedure.
  </p><div class="procedure"><a name="saml-1-own-site-id"></a><div class="procedure-title">Procedure&nbsp;14.1.&nbsp;To Generate a Site Identifier For an OpenAM Site</div><p>
    Trusted partners should ask you for a Site ID.
    OpenAM generates a SAML 1.x Site ID value at configuration time.
    This Site ID value corresponds to the server.
    To find this in OpenAM Console, see Federation
    &gt; SAML 1.x Configuration &gt; Local Site Properties &gt; Site Identifiers,
    and then click your server URL.
   </p><p>
    If you have multiple servers in an OpenAM Site set up behind a load balancer,
    you can generate a Site ID, and then use it for all the servers in your site.
   </p><ul class="procedure"><li class="step"><p>
     Generate a Site ID for your site, using the primary site URL.
    </p><p>
     This example is for an asserting party
     where the site load balancer host is <code class="literal">ap.example.net</code>.
     The command is bundled with OpenAM server,
     shown with lines folded to fit on the printed page.
    </p><div class="screen"><pre>
$ <strong>cd /path/to/tomcat/webapps/openam/WEB-INF/lib/</strong>
$ <strong>java \
 -cp forgerock-util-1.3.5.jar:openam-shared-12.0.0.jar:\
    openam-federation-library-12.0.0.jar com.sun.identity.saml.common.SAMLSiteID \
    https://ap.example.net/openam</strong>
<em>9BAg4UmVS6IbjccsSj9gAFYGO9Y=</em>
    </pre></div></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="saml-1-security"></a>14.3.&nbsp;Preparing To Secure SAML 1.x Communications</h2></div></div></div><p>
   SAML communications are secured using Public Key Infrastructure (PKI).
   Communications should be protected over the network by HTTPS,
   and relying parties requesting assertions should use
   SSL or TLS mutual authentication to identify each other,
   meaning they should be able to trust each others' certificates.
   Furthermore, when an asserting party works through the user's browser
   to post an assertion to the relying party,
   then the asserting party must digitally sign the SAML response.
  </p><p>
   A certificate can be trusted when the signer's certificate is trusted,
   or when the certificate itself is trusted.
   Trusted partners must either use public key certificates
   signed by a well-known Certificate Authority (CA),
   or share their self-signed or private CA signing certificates.
  </p><div class="procedure"><a name="saml-1-configure-keys"></a><div class="procedure-title">Procedure&nbsp;14.2.&nbsp;To Configure Keys For Protecting SAML 1.x Communications</div><ol class="procedure" type="1"><li class="step"><p>
     See the chapter
     <a href="../admin-guide/index.html#chap-certs-keystores" class="link"><em class="citetitle">Managing Certificates</em></a>
     for instructions on handling your own key pairs.
    </p><p>
     For specific instructions on changing signing keys, see the procedure
     <a href="../admin-guide/index.html#change-signing-key" class="link"><em class="citetitle">To Change the Signing Key for Federation</em></a>.
    </p></li><li class="step"><p>
     If necessary, share signing certificates with trusted partners.
    </p></li><li class="step"><p>
     Import public key certificates shared by trusted partners
     into your OpenAM key store.
    </p></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="saml-1-configure-local-site"></a>14.4.&nbsp;Configuring SAML 1.x For Your Site</h2></div></div></div><p>
   After you have gathered configuration information
   and prepared to secure SAML 1.x communications
   you can configure SAML 1.x for your site.
  </p><div class="tip"><h3 class="title">Tip</h3><p>
    When you enter SAML 1.x configuration data,
    OpenAM Console escapes these special characters by default:
    <code class="literal">&amp; &lt; &gt; " ' /</code>.
    If instead you have already escaped these characters
    in the data that you plan to enter in OpenAM Console,
    then set the advanced configuration property
    <code class="literal">com.sun.identity.saml.escapeattributevalue</code>
    to <code class="literal">false</code>
    under Configuration &gt; Servers and Sites &gt; Default Server Settings &gt; Advanced,
    and then restart OpenAM or the container in which it runs
    to prevent OpenAM Console from escaping the characters for you.
   </p></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="#saml-1-configure-local-ap" title="Procedure&nbsp;14.3.&nbsp;To Configure Asserting Party Local Site Properties">Procedure&nbsp;14.3, &#8220;To Configure Asserting Party Local Site Properties&#8221;</a></p></li><li class="listitem"><p><a class="xref" href="#saml-1-configure-local-rp" title="Procedure&nbsp;14.4.&nbsp;To Configure Relying Party Local Site Properties">Procedure&nbsp;14.4, &#8220;To Configure Relying Party Local Site Properties&#8221;</a></p></li></ul></div><div class="procedure"><a name="saml-1-configure-local-ap"></a><div class="procedure-title">Procedure&nbsp;14.3.&nbsp;To Configure Asserting Party Local Site Properties</div><p>
    Using the configuration information you have gathered
    complete the following steps.
   </p><ol class="procedure" type="1"><li class="step"><p>
     Login to OpenAM Console as administrator, amadmin,
     browse to Federation &gt; SAML 1.x Configuration,
     and then click Local Site Properties.
    </p></li><li class="step"><p>
     If the target specifier query string parameter
     is something other than the standard default TARGET,
     set it in the Target Specifier field.
    </p></li><li class="step"><p>
     If instead of the default server Site Identifier,
     you use a Site Identifier for the OpenAM Site,
     click New in the Site Identifiers table,
     and then add the information for the OpenAM Site,
     including the Site ID that you generated.
    </p></li><li class="step"><p>
     Target URLs let you configure URLs for which HTTP POST is always used.
    </p><p>
     When the TARGET specified matches a URL in the Target URLs list,
     then the asserting party sends the response to the relying party
     by HTTP POST of an auto-submitting form returned to the browser.
    </p></li><li class="step"><p>
     If necessary, set the Default Protocol Version.
    </p></li><li class="step"><p>
     In the Assertion section, change the values if necessary.
    </p><p>
     Remove Assertion: Yes means that assertions are deleted from memory
     after they are used, rather than deleted only when they expire.
    </p></li><li class="step"><p>
     In the Artifact section, change the values if necessary.
    </p></li><li class="step"><p>
     In the Signing section,
     for an asserting party using the HTTP POST profile,
     check at least Sign SAML Assertion.
    </p><p>
     By default OpenAM signs messages using the certificate with alias test.
    </p><p>
     Check other options as required by your trusted partners.
    </p></li><li class="step"><p>
     In the Attribute Query section, if relying parties issue attribute queries,
     then set the default list of profile attributes to return.
    </p></li><li class="step"><p>
     In the NameID Format section,
     map SAML NameID formats to local OpenAM user profile attributes.
    </p><p>
     This allows OpenAM to map a remote user to a local user profile.
    </p></li><li class="step"><p>
     In the Attribute Map section, if the parties exchange attributes,
     then map the SAML attributes requested by relying parties
     to local OpenAM user profile attributes.
    </p></li><li class="step"><p>
     Save your work.
    </p></li></ol></div><div class="procedure"><a name="saml-1-configure-local-rp"></a><div class="procedure-title">Procedure&nbsp;14.4.&nbsp;To Configure Relying Party Local Site Properties</div><p>
    Using the configuration information you have gathered
    complete the following steps.
   </p><ol class="procedure" type="1"><li class="step"><p>
     Login to OpenAM Console as administrator, amadmin,
     browse to Federation &gt; SAML 1.x Configuration,
     and then click Local Site Properties.
    </p></li><li class="step"><p>
     If the target specifier query string parameter
     is something other than the standard default TARGET,
     set it in the Target Specifier field.
    </p></li><li class="step"><p>
     If instead of the default server Site Identifier,
     you use a Site Identifier for the OpenAM Site,
     click New in the Site Identifiers table,
     and then add the information for the OpenAM Site,
     including the Site ID that you generated.
    </p></li><li class="step"><p>
     Ignore the Target URLs table for a relying party.
    </p></li><li class="step"><p>
     If necessary, set the Default Protocol Version.
    </p></li><li class="step"><p>
     In the Assertion section, change the values if necessary.
    </p></li><li class="step"><p>
     In the Artifact section, change the values if necessary.
    </p></li><li class="step"><p>
     Ignore the Signing section for relying parties,
     unless trusted partners require that your site signs SAML requests.
    </p><p>
     By default OpenAM signs messages using the certificate
     with alias <code class="literal">test</code>.
    </p></li><li class="step"><p>
     Ignore the Attribute Query section for relying parties.
    </p></li><li class="step"><p>
     In the NameID Format section,
     map SAML NameID formats to local OpenAM user profile attributes.
    </p><p>
     This allows OpenAM to map a remote user to a local user profile
     when not all the partners are using OpenAM user IDs.
    </p></li><li class="step"><p>
     In the Attribute Map section, if the parties exchange attributes,
     then map the SAML attributes requested by relying parties
     to local OpenAM user profile attributes.
    </p></li><li class="step"><p>
     Save your work.
    </p></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="saml-1-configure-trusted-partners"></a>14.5.&nbsp;Configuring SAML 1.x Trusted Partners</h2></div></div></div><p>
   After you have gathered configuration information
   and if necessary imported public key certificates from trusted partners
   you can configure SAML 1.x information for the partners.
  </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="#saml-1-configure-trusted-rp" title="Procedure&nbsp;14.5.&nbsp;To Configure a Trusted Relying Party">Procedure&nbsp;14.5, &#8220;To Configure a Trusted Relying Party&#8221;</a></p></li><li class="listitem"><p><a class="xref" href="#saml-1-configure-trusted-ap" title="Procedure&nbsp;14.6.&nbsp;To Configure a Trusted Asserting Party">Procedure&nbsp;14.6, &#8220;To Configure a Trusted Asserting Party&#8221;</a></p></li></ul></div><div class="procedure"><a name="saml-1-configure-trusted-rp"></a><div class="procedure-title">Procedure&nbsp;14.5.&nbsp;To Configure a Trusted Relying Party</div><p>
    OpenAM Console refers to the relying party as the Destination,
    because the relying party's site is the destination site.
   </p><ol class="procedure" type="1"><li class="step"><p>
     Login to OpenAM Console as administrator, amadmin,
     browse to Federation &gt; SAML 1.x Configuration,
     and then click New in the Trusted Partners table.
    </p></li><li class="step"><p>
     Under Destination, select the SAML profiles used with the relying party.
    </p></li><li class="step"><p>
     In the Common Settings section,
     set at least a name for the partner configuration,
     enter the partner's Site ID as the Source ID,
     and specify the fully qualified domain, optionally with the port number,
     of the relying party in the Target field.
     The value in the target field is matched to TARGET parameter values,
     so it should correspond to the real domain (and optionally port number)
     in the URLs of resources to access at the relying party's site.
    </p><p>
     Optionally set a custom site attribute mapper,
     a custom name identifier mapper,
     and the SAML Version to use with the partner.
    </p><p>
     You must also set one or more values in the host list for the partner
     to identify all hosts from the partner site that can send requests.
     OpenAM rejects SAML requests from hosts not specified in this list.
    </p></li><li class="step"><p>
     In the Destination section,
     if the SAML Artifact profile is used with the relying party,
     set the SAML URL to the relying party's endpoint
     that receives the artifact and contacts your asserting party.
    </p><p>
     If the SAML POST profile is used with the relying party,
     set the Post URL to the relying party's endpoint
     that consumes the assertion in the HTTP POST form data
     and redirects the user's browser to the target
     at the relying party's site.
    </p><p>
     If the relying party makes SAML SOAP query requests,
     optionally set custom attribute or action mappers.
    </p><p>
     If the relying party signs requests,
     then either requests include the certificate for the signing key
     in the KeyInfo element,
     or OpenAM must find the signing certificate elsewhere.
     If the relying party provides the signing certificate separately,
     import the signing certificate
     into OpenAM's <code class="filename">keystore.jks</code> file,
     and set the alias for the signing certificate here in the configuration.
    </p><p>
     Set the issuer to a host:port combination
     corresponding to the relying party server issuing the requests.
    </p></li><li class="step"><p>
     Save your work.
    </p></li></ol></div><div class="procedure"><a name="saml-1-configure-trusted-ap"></a><div class="procedure-title">Procedure&nbsp;14.6.&nbsp;To Configure a Trusted Asserting Party</div><p>
    OpenAM Console refers to the asserting party as the Source,
    because the asserting party's site is the source site.
   </p><ol class="procedure" type="1"><li class="step"><p>
     Login to OpenAM Console as administrator, amadmin,
     browse to Federation &gt; SAML 1.x Configuration,
     and then click New in the Trusted Partners table.
    </p></li><li class="step"><p>
     Under Source, select the SAML profiles used with the asserting party.
    </p></li><li class="step"><p>
     In the Common Settings section,
     set at least a name for the partner configuration
     and enter the partner's Site ID as the Source ID.
    </p><p>
     Optionally set a custom account mapper.
     By default OpenAM maps accounts
     based on the NameID format configuration for your site.
    </p><p>
     If the asserting party signs assertions (or other messages)
     and you have imported the signing certificate
     into OpenAM's key store (also used as a trust store),
     then enter the signing certificate alias.
     If instead the asserting party includes the signing certificate
     in the KeyInfo element of signed messages,
     then you can leave the alias blank.
    </p></li><li class="step"><p>
     In the Source section,
     if the SAML Artifact profile is used with the asserting party,
     set the SOAP URL to the asserting party endpoint that responds to requests
     such as <code class="literal">https://ap.example.net/openam/SAMLSOAPReceiver</code>.
    </p><p>
     If the asserting party requires authentication to the SOAP URL,
     then configure the settings appropriately.
    </p><p>
     If the SOAP URL is accessed over HTTP, choose None or Basic.
     If the SOAP URL is accessed over HTTPS, choose SSL/TLS or SSL/TLS with Basic.
    </p><p>
     Basic means HTTP Basic authentication (with username and password).
     For HTTP Basic authentication,
     the authentication at this level is performed
     by the application server container, not OpenAM.
     Therefore if the asserting party runs OpenAM
     and wants to enforce HTTP Basic authentication,
     the asserting party administrator must set up the container
     to handle HTTP Basic authentication for the SOAP URL.
    </p><p>
     Set the SAML Version as necessary.
    </p><p>
     If the SAML POST profile is used with the asserting party,
     set the Issuer to the issuer name, such as a host:port combination.
    </p></li><li class="step"><p>
     Save your work.
    </p></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="saml-1-test-web-sso"></a>14.6.&nbsp;Testing SAML 1.x Web SSO</h2></div></div></div><p>
   You can try SAML 1.x Web SSO using OpenAM
   by following the procedures in this section.
  </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="#saml-1-test-prepare-servers" title="Procedure&nbsp;14.7.&nbsp;To Prepare the OpenAM Servers">Procedure&nbsp;14.7, &#8220;To Prepare the OpenAM Servers&#8221;</a></p></li><li class="listitem"><p><a class="xref" href="#saml-1-test-ap" title="Procedure&nbsp;14.8.&nbsp;To Prepare to Test the Asserting Party">Procedure&nbsp;14.8, &#8220;To Prepare to Test the Asserting Party&#8221;</a></p></li><li class="listitem"><p><a class="xref" href="#saml-1-test-rp" title="Procedure&nbsp;14.9.&nbsp;To Prepare to Test the Relying Party">Procedure&nbsp;14.9, &#8220;To Prepare to Test the Relying Party&#8221;</a></p></li><li class="listitem"><p><a class="xref" href="#saml-1-try-it-out" title="Procedure&nbsp;14.10.&nbsp;To Try SAML 1.x Web SSO">Procedure&nbsp;14.10, &#8220;To Try SAML 1.x Web SSO&#8221;</a></p></li></ul></div><div class="procedure"><a name="saml-1-test-prepare-servers"></a><div class="procedure-title">Procedure&nbsp;14.7.&nbsp;To Prepare the OpenAM Servers</div><ol class="procedure" type="1"><li class="step"><p>
     Install two separate OpenAM servers,
     one to act as asserting party,
     the other to act as relying party.
    </p><p>
     How you do this in practice is up to you.
    </p><p>
     You can for example set up two separate OpenAM servers on a single host
     by adding aliases for the hosts in your hosts file,
     and by using separate containers that listen on different ports.
    </p><p>
     For example if your host is a laptop,
     you can add the aliases to the loopback address
     as in the following example line
     from an <code class="filename">/etc/hosts</code> file.
    </p><pre class="literallayout">127.0.0.1    localhost ap.example.net rp.example.com</pre><p>
     Then run one application server to listen on port 8080,
     and another to listen on port 9080.
    </p><p>
     Deploy and configure OpenAM server with the default configuration
     at <code class="literal">http://ap.example.net:8080/ap</code> for the asserting party
     and at <code class="literal">http://rp.example.com:9080/rp</code> for the relying party.
     This allows you to use the default configuration for both servers.
    </p><p>
     See the
     <a href="../install-guide/index.html#install-guide" class="link"><em class="citetitle">Installation Guide</em></a> for instructions.
    </p><p>
     The procedures in this section use those example URLs
     to represent the OpenAM servers acting as asserting and relying parties.
    </p></li><li class="step"><p>
     On the asserting party server,
     login to OpenAM Console as administrator,
     browse to Federation &gt; SAML 1.x Configuration,
     and then click Local Site Properties.
    </p><p>
     Click the server's instance ID in the Site Identifiers table.
    </p><p>
     Record the asserting party Site ID for later use.
    </p></li><li class="step"><p>
     On the relying party server,
     login to OpenAM Console as administrator,
     browse to Federation &gt; SAML 1.x Configuration,
     and then click Local Site Properties.
    </p><p>
     Click the server's instance ID in the Site Identifiers table.
    </p><p>
     Record the asserting party Site ID for later use.
    </p></li></ol></div><div class="procedure"><a name="saml-1-test-ap"></a><div class="procedure-title">Procedure&nbsp;14.8.&nbsp;To Prepare to Test the Asserting Party</div><p>
    Follow these steps to configure the asserting party OpenAM server.
   </p><ol class="procedure" type="1"><li class="step"><p>
     Login to OpenAM Console as administrator,
     browse to Federation &gt; SAML 1.x Configuration,
     and then click Local Site Properties.
    </p></li><li class="step"><p>
     On the Local Site Properties page
     for the asserting party server,
     select Sign SAML Response.
    </p><p>
     The asserting party thus signs SAML responses
     with the private key for the default test certificate.
    </p></li><li class="step"><p>
     Save your work,
     and then click Back to Federation.
    </p></li><li class="step"><p>
     Click New in the Trusted Partners table
     to add the relying party as a trusted partner.
    </p></li><li class="step"><p>
     In the Destination area of the Select trusted partner type and profile page,
     select Artifact and Post (not SOAP Query), and then click Next.
    </p></li><li class="step"><p>
     Apply the following settings, adjusted for the host names you use.
    </p><p>
     If a field is not mentioned, accept the defaults.
    </p><p>
     Under Common Settings, use these settings:
    </p><table border="0" summary="Simple list" class="simplelist"><tr><td>Name: rp.example.com:9080</td></tr><tr><td>Source ID: relying party Site ID that you recorded</td></tr><tr><td>Target: rp.example.com:9080</td></tr></table><p>
     Under Destination &gt; Artifact, use these settings:
    </p><table border="0" summary="Simple list" class="simplelist"><tr><td>SOAP URL: http://rp.example.com:9080/rp/SAMLAwareServlet</td></tr><tr><td>Host List: rp.example.com</td></tr></table><p>
     Under Source &gt; Post,
     set Post URL: http://rp.example.com:9080/rp/SAMLPOSTProfileServlet
    </p></li><li class="step"><p>
     Click Finish to save your work.
    </p></li></ol></div><div class="procedure"><a name="saml-1-test-rp"></a><div class="procedure-title">Procedure&nbsp;14.9.&nbsp;To Prepare to Test the Relying Party</div><p>
    Follow these steps to configure the relying party OpenAM server.
   </p><ol class="procedure" type="1"><li class="step"><p>
     Login to OpenAM Console as administrator,
     browse to Federation &gt; SAML 1.x Configuration,
     and then click New in the Trusted Partners table
     to add the asserting party as a trusted partner.
    </p></li><li class="step"><p>
     In the Source area of the Select trusted partner type and profile page,
     select Artifact and Post, and then click Next.
    </p></li><li class="step"><p>
     Apply the following settings, adjusted for the host names you use.
    </p><p>
     If a field is not mentioned, accept the defaults.
    </p><p>
     Under Common Settings, use these settings:
    </p><table border="0" summary="Simple list" class="simplelist"><tr><td>Name: ap.example.net:8080</td></tr><tr><td>Source ID: asserting party Site ID that you recorded</td></tr><tr><td>Signing Certificate Alias: test</td></tr></table><p>
     Under Source &gt; Artifact,
     set SOAP URL: http://ap.example.net:8080/ap/SAMLSOAPReceiver
    </p><p>
     Under Source &gt; Post, set Issuer: ap.example.net:8080
    </p><p>
     Click Finish to save your work.
    </p></li></ol></div><div class="procedure"><a name="saml-1-try-it-out"></a><div class="procedure-title">Procedure&nbsp;14.10.&nbsp;To Try SAML 1.x Web SSO</div><p>
    Once you have successfully configured both parties, try SAML 1.x Web SSO.
   </p><ol class="procedure" type="1"><li class="step"><p>
     Log out of OpenAM Console on both servers.
    </p></li><li class="step"><p>
     Try Web SSO using the SAML Artifact profile.
    </p><ol type="a" class="substeps"><li class="step"><p>
       Simulate the OpenAM administrator browsing the asserting party's site,
       and selecting a link to the OpenAM Console on the relying party's site.
      </p><p>
       The URL to simulate this action is something like
       <code class="literal">http://ap.example.net:8080/ap/SAMLAwareServlet?TARGET=http://rp.example.com:9080/rp</code>.
      </p><p>
       OpenAM requires that you authenticate.
      </p></li><li class="step"><p>
       Login as OpenAM demo user,
       <code class="literal">demo</code> with default password <code class="literal">changeit</code>,
       on the asserting party server.
      </p></li><li class="step"><p>
       Notice that you are redirected to OpenAM Console on the relying party server,
       and that you are successfully logged in as the demo user.
      </p></li><li class="step"><p>
       Log out of OpenAM Console on both servers.
      </p></li></ol></li><li class="step"><p>
     Try Web SSO using the SAML HTTP POST profile.
    </p><ol type="a" class="substeps"><li class="step"><p>
       Simulate the OpenAM administrator browsing the asserting party's site,
       and selecting a link to the OpenAM Console on the relying party's site.
      </p><p>
       The URL to simulate this action is something like
       <code class="literal">http://ap.example.net:8080/ap/SAMLPOSTProfileServlet?TARGET=http://rp.example.com:9080/rp</code>.
      </p><p>
       OpenAM requires that you authenticate.
      </p></li><li class="step"><p>
       Login as OpenAM administrator, <code class="literal">amadmin</code>,
       on the asserting party server.
      </p></li><li class="step"><p>
       Notice that you are redirected to OpenAM Console on the relying party server,
       and that you are successfully logged in as <code class="literal">amadmin</code>.
      </p></li></ol></li></ol></div></div></div><div lang="en" class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="chap-rest-sts"></a>Chapter&nbsp;15.&nbsp;The RESTful Security Token Service</h1></div></div></div><div class="toc"><div class="toc-title">Table of Contents</div><dl class="toc"><dt><span class="section"><a href="#sts-about">15.1. About the REST-STS</a></span></dt><dt><span class="section"><a href="#sts-configure">15.2. Configuring the Security Token Service</a></span></dt></dl></div><p>
    This chapter specifies the configuration requirements associated with the
    RESTful Security Token Service (REST-STS). Like previous implementations of
    STS, this implementation secures identity tokens and messages.
  </p><p>
   The REST-STS is inspired by the WS-Trust STS. The REST-STS supports one
   basic operation: token transformation. This chapter describes how you can
   configure REST-STS token transformations through the OpenAM UI.
  </p><p>
   Different Identity Relationship Management (IRM) services require different
   token types. Given the variety of token types in use today, it can be
   helpful to have a service that you can configure to transform tokens.
  </p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sts-about"></a>15.1.&nbsp;About the REST-STS</h2></div></div></div><div class="note"><h3 class="title">Note</h3><p>
       Do not use the WSP and WSC agent UI tools described in <a class="link" href="admin-guide#chap-agents" target="_blank"><em class="citetitle">Configuring Policy Agent
       Profiles</em>.</a>
      </p></div><p>
      The OpenAM implementation of REST-STS supports a variety of
      token transformations, as well as different attributes from SAML2
      assertions, along with different encryption contexts.
     </p><p>
      The REST-STS UI currently includes transformations from three types of
      tokens:
     </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
        <code class="literal">UNT</code>: Username Token. May be associated with
        usernames and/or associated passwords.
       </p></li><li class="listitem"><p>
        <code class="literal">OpenID Connect</code>: OpenID Connect token.
       </p></li><li class="listitem"><p>
        <code class="literal">OpenAM</code>: OpenAM session token.
       </p></li></ul></div><p>
      At this time, the ForgeRock REST-STS supports conversions from these
      types of tokens to a SAML2 token. For the conversion, you can
      configure OpenAM to invalidate the interim OpenAM session.
     </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sts-configure"></a>15.2.&nbsp;Configuring the Security Token Service</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="#rest-sts-general">15.2.1. REST STS General Configuration</a></span></dt><dt><span class="section"><a href="#rest-sts-deployment">15.2.2. REST STS Deployment Configuration</a></span></dt><dt><span class="section"><a href="#rest-sts-keystore">15.2.3. REST STS Keystore Configuration</a></span></dt><dt><span class="section"><a href="#rest-sts-saml2">15.2.4. REST STS SAML2 Token Configuration</a></span></dt></dl></div><p>
     To access the REST-STS configuration menu for your realm, navigate to
     Access Control &gt; <em class="replaceable"><code>Realm Name</code></em> &gt; STS. When
     you see the <em class="replaceable"><code>Realm Name</code></em> - REST STS Instances
     menu, click Add. You should see an excerpt of the REST Security Token
     Service menu in the following screen shot.
    </p><div class="mediaobject" align="center"><a name="rest-sts-access-menu"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/rest-sts-access-menu.png" align="middle" height="360" alt="The REST Security Token Service UI"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="rest-sts-access-menu.html" target="longdesc">D</a>]</span></div></div><p>
     The REST STS configuration menu is subdivided into four sections:
    </p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="rest-sts-general"></a>15.2.1.&nbsp;REST STS General Configuration</h3></div></div></div><p>
      At the top of the REST STS configuration menu, you can set up the
      General Configuration for the system.
     </p><p>
      You will first add a name for the REST-STS token issuer. You can pick any
      name; the REST-STS includes that name with the <code class="literal">issuer</code>
      label for each token.
     </p><p>
      You can then select from one of the noted types of token transformations.
      Be aware, you should not select both "invalidate" and "don't invalidate"
      options for the same token transformation.
     </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="rest-sts-deployment"></a>15.2.2.&nbsp;REST STS Deployment Configuration</h3></div></div></div><p>
      In the Deployment Configuration section, you can assign a specific
      endpoint for the REST STS, and set up the mapping for each token
      transformation.
     </p><p>
      OpenAM includes what you enter in the
      <code class="literal">Deployment Url Element</code> text box in the REST-STS
      endpoint, as well as the name of the REST-STS instance. As an example,
      assume that you've set the <code class="literal">Deployment Url Element</code> to
      <code class="literal">instance1</code>, on a realm named <code class="literal">NewRealm</code>.
     </p><p>
      In that case, the STS Endpoint URI would be
      <code class="literal">rest-sts/NewRealm/instance1</code>, and the REST STS Instance
      would be <code class="literal">NewRealm/instance1</code>.
     </p><p>
      Under Authentication Target Mappings, you can configure two or three
      pieces of information related to each input token. The default options
      shown in this field are known as a <code class="literal">tuple</code>, an ordered
      list of elements. Each element is separated with a pipe character:
      "<code class="literal">|</code>".
     </p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Authentication target type</span></dt><dd><p>
         Whether the target is a module or service
        </p></dd><dt><span class="term">Name of the authentication module or service</span></dt><dd><p>
         Two default options are included: the <code class="literal">ldapService</code>
         service for usernames, and <code class="literal">OPENIDCONNECT</code> module to
         identify elements of the OpenAM RESTful authentication context that
         should be consumed to validate that OpenID Connect token.
        </p><p>
         The <code class="literal">OPENIDCONNECT</code> module supports the transformation
         of a token from OpenID Connect to SAML2.
        </p></dd><dt><span class="term">Authentication context information (optional)</span></dt><dd><p>
         Defines STS authentication context information about the token to be
         consumed. In the case shown in the default, the name of the token to
         be consumed is <code class="literal">oidc_id_token</code>.
        </p></dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="rest-sts-keystore"></a>15.2.3.&nbsp;REST STS Keystore Configuration</h3></div></div></div><p>
      The REST STS can use the same keystore as is used for OpenAM. While the
      version of Java that you use includes its own version of the
      <span class="command"><strong>keytool</strong></span> command, the location where you set up the
      keystore file may vary.
     </p><p>
      For example, you may use the procedure <a class="link" href="http://docbook.org/roles/xlink/role/olink       xlink:href=admin-guide#openam-with-https-on-tomcat" target="_blank"><em class="citetitle">To Set Up
      OpenAM With HTTPS on Tomcat</em></a>, if you use Tomcat as
      the container for OpenAM.
     </p><p>
      The following describes the purpose of each entry under 
      <code class="literal">Keystore Configuration</code>:
     </p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Keystore Path</span></dt><dd><p>
         You can set this to the location of the keystore file of your choice.
         For reference, the default OpenAM keystore file is
         <code class="filename">keystore.jks</code>, and you can find it in the OpenAM
         configuration directory, as described in the following installation
         procedure: <a class="link" href="install-guide#deploy-openam" target="_blank"><em class="citetitle">
          To Deploy OpenAM</em></a>
        </p></dd><dt><span class="term">Keystore Password</span></dt><dd><p>
         Enter the password for the keystore file, normally
         <code class="filename">keystore.jks</code>. The default password for that file
         packaged with OpenAM is <code class="literal">changeit</code>.
        </p></dd><dt><span class="term">Encryption Key Alias</span></dt><dd><p>
         Alias used for the encryption key; you may use that alias with the
         <span class="command"><strong>keytool</strong></span> command.
        </p></dd><dt><span class="term">Encryption Key Password</span></dt><dd><p>
         Enter the password for the encryption key.
        </p></dd><dt><span class="term">Signature Key Alias</span></dt><dd><p>
         The REST-STS uses a signature key to verify X.509 tokens. Enter the 
         desired alias for that signature key.
        </p></dd><dt><span class="term">Signature Key Password</span></dt><dd><p>
         Enter the password for the signature key.
        </p></dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="rest-sts-saml2"></a>15.2.4.&nbsp;REST STS SAML2 Token Configuration</h3></div></div></div><p>
      This REST-STS configuration UI supports token transformations from
      username, Open ID Connect, and OpenAM tokens to SAML2 format. Configure
      the options shown in this part of the REST-STS UI menu to customize
      how OpenAM will create those SAML2 tokens.
     </p><p>
      Several options require you to include the specific classes, either in a
      custom <code class="literal">.jar</code> file or classes configured in files in the
      <code class="literal">WEB-INF/classes</code> directory.
     </p><div class="variablelist"><dl class="variablelist"><dt><span class="term">NameIdFormat</span></dt><dd><p>
         Specify the name identifier format for the SAML2 token that you want
         REST-STS to generate.
        </p></dd><dt><span class="term">Token Lifetime (Seconds)</span></dt><dd><p>
         Enter the desired lifetime for the SAML2 token that you want REST-STS
         to generate. The default is 10 minutes.
        </p></dd><dt><span class="term">Custom Conditions Provider Class Name (optional)</span></dt><dd><p>
         If you need to customize the conditions for the issued SAML2 token,
         specify the class name of the implementation in the associated text
         box.
        </p><p>
         Implement the specified class name with the<code class="literal">
         org.forgerock.openam.sts.tokengeneration.saml2.statements.ConditionsProvider
        </code>interface.
        </p></dd><dt><span class="term">Custom Subject Provider Class Name (optional)</span></dt><dd><p>
         If you need to define a custom provider for the SAML2 token, enter
         the class name of the provider here.
        </p><p>
         Implement the specified class name with the<code class="literal">
         org.forgerock.openam.sts.tokengeneration.saml2.statements.SubjectProvider
         </code>interface.
        </p></dd><dt><span class="term">Custom Authentication Statements Class Name (optional)</span></dt><dd><p>
         If you need to create a custom authentication statement for the SAML2
         token, enter the class name of the statement here.
        </p><p>
         Implement the specified class name with the<code class="literal">
         org.forgerock.openam.sts.tokengeneration.saml2.statements.AuthenticationStatementsProvider
         </code>interface.
        </p></dd><dt><span class="term">Custom Attribute Statements Class Name (optional)</span></dt><dd><p>
         If you need to define a custom attribute statement for the SAML2
         token, enter the class name of the statement here.
        </p><p>
         Implement the specified class name with the<code class="literal">
         org.forgerock.openam.sts.tokengeneration.saml2.statements.AttributeStatementsProvider
        </code>interface.
        </p></dd><dt><span class="term">Custom Authorization Decision Statements Class Name (optional)</span></dt><dd><p>
         If you need to set up a custom authorization decision statement for
         the SAML2 token, enter the class name of the statement here.
        </p><p>
         Implement the specified class name with the<code class="literal">
         org.forgerock.openam.sts.tokengeneration.saml2.statements.AuthzDecisionStatementsProvider
        </code>interface.
        </p></dd><dt><span class="term">Custom Attribute Mapper Class Name (optional)</span></dt><dd><p>
         If you need to define a custom attribute mapper for the SAML2 token,
         enter the class name of the mapper here.
        </p><p>
         Implement the specified class name with the<code class="literal">
         org.forgerock.openam.sts.tokengeneration.saml2.statements.AttributeMapper
        </code>interface.
        </p></dd><dt><span class="term">Custom Authentication Context Class Name (optional)</span></dt><dd><p>
         If you need to note a custom AuthContext mapper for the SAML2 token,
         enter the class name of the context here.
        </p><p>
         If you need to include an <code class="literal">AuthnContext</code> mapping,
         implemented by the<code class="literal">
         org.forgerock.openam.sts.token.provider.AuthnContextMapperImpl
         </code> class, enter the class name of the following
         interface:<code class="literal">
          org.forgerock.openam.sts.tokengeneration.saml2.statements.AuthnContextMapper
        </code>.
        </p></dd><dt><span class="term">Canonicalization Algorithm</span></dt><dd><p>
         For more information on the two options shown see the W3C
         Recommendation document entitled: <a class="link" href="http://www.w3.org/TR/2002/REC-xml-exc-c14n-20020718/" target="_blank">
         <em class="citetitle">Exclusive XML Canonicalization</em>.
         </a>
        </p></dd><dt><span class="term">Sign Assertion</span></dt><dd><p>
         If checked, this implementation of the REST-STS will sign the
         assertion of the associated token.
        </p></dd><dt><span class="term">Assertion audiences</span></dt><dd><p>
         If you need to restrict the audience for the newly created SAML2
         tokens, enter appropriate assertion audiences here. Values so entered
         will be used to populate the <code class="literal">Audience</code> based on the
         <code class="literal">AudienceRestriction</code> element, as defined in section
         4.1.4.2 of the OASIS document entitled: <a class="link" href="http://docs.oasis-open.org/security/saml/v2.0/saml-profiles-2.0-os.pdf" target="_blank">
         <em class="citetitle">Profiles for the OASIS Security Assertion Markup Language
         (SAML) v2.0</em>.
         </a>
        </p></dd><dt><span class="term">Attribute Mappings</span></dt><dd><p>
         You should configure mappings between SAML2 attribute names (Map keys)
         and local OpenAM attributes (Map values).
        </p><p>
         The <code class="literal">DefaultAttributeMapper</code> looks at profile
         attributes in configured data stores, or in session properties.
        </p><p>
         The map keys will define the names of the attributes included in
         <code class="literal">Assertion Attribute</code> statements.
        </p><p>
         The data pulled from the subject's directory entry or session state
         corresponding to the map value will define the value corresponding
         to the name of the attribute.
        </p><p>
         Map keys can be set up in the following format:
         <code class="literal">[NameFormatURI]|SAML_ATTRIBUTE_NAME</code>.
        </p><p>
         If the attribute value is enclosed in quotes, that quoted value will
         be included in the attribute without mapping. Binary attributes should
         be followed by <code class="literal">';binary'</code>
        </p><p>
         Beyond that, examples for appropriate mappings include:
        </p><div class="screen"><pre>EmailAddress=mail</pre></div><div class="screen"><pre>Address=postaladdress</pre></div><div class="screen"><pre>urn:oasis:names:tc:SAML:2.0:attrname-format:uri|urn:mace:dir:attribute-def:cn=cn</pre></div><div class="screen"><pre>partnerID="staticPartnerIDValue"</pre></div><div class="screen"><pre>urn:oasis:names:tc:SAML:2.0:attrname-format:uri|nameID="staticNameIDValue"</pre></div><div class="screen"><pre>photo=photo;binary</pre></div><div class="screen"><pre>urn:oasis:names:tc:SAML:2.0:attrname-format:uri|photo=photo;binary</pre></div></dd></dl></div></div></div></div><div lang="en" class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="chap-dashboard"></a>Chapter&nbsp;16.&nbsp;Configuring the Dashboard Service</h1></div></div></div><div class="toc"><div class="toc-title">Table of Contents</div><dl class="toc"><dt><span class="section"><a href="#about-the-dashboard">16.1. About the Dashboard Service</a></span></dt><dt><span class="section"><a href="#dashboard-setup">16.2. Setting Up the Dashboard Service</a></span></dt><dt><span class="section"><a href="#dashboard-realms">16.3. Configuring Dashboard Service for a Realm</a></span></dt><dt><span class="section"><a href="#dashboard-users">16.4. Adding Applications to a User's Dashboard</a></span></dt></dl></div><a class="indexterm" name="d16037e31203"></a><p>This chapter shows how to configure the OpenAM Dashboard service.</p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="about-the-dashboard"></a>16.1.&nbsp;About the Dashboard Service</h2></div></div></div><p>The Dashboard service provides the end user with an interface to access
   applications secured by OpenAM, both cloud-based applications like SalesForce
   and internal applications protected by policy agents. The Dashboard service uses SSO to 
   login to the applications when the user clicks on the application icon. For some apps, 
   like SalesForce, you will want to limit access to only a few users. Other apps, 
   like Google Mail or Drive, you will probably want to make available to all users.</p><div class="mediaobject" align="center"><a name="figure-user-dashboard"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/user-dashboard.png" align="middle" height="360" alt="User Dashboard screen"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-user-dashboard.html" target="longdesc">D</a>]</span></div></div><p>The Dashboard service is meant to give users a single place to access their
   applications. Keep in mind that this does not limit user access, only what appears
   on the user Dashboard.</p><div class="itemizedlist"><p>There are three stages to setting up the Dashboard service.</p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Setup the Dashboard service and add applications.</p></li><li class="listitem"><p>Add the service to the realms.</p></li><li class="listitem"><p>Assign users applications so that they appear on the users' Dashboards. 
     This can be done manually or through a provisioning solution.</p></li></ul></div><p>
   User Dashboard pages require the XUI,
   which can be enabled by logging in to OpenAM Console as administrator
   and making sure that XUI is enabled
   under Configuration &gt; Authentication &gt; Core &gt; XUI Interface &gt; Enabled.
  </p><p>
   Once the Dashboard service is configured for a user,
   the user can access their Dashboard after logging in through the XUI
   under <code class="literal">/XUI/#dashboard/</code>.
   For example, the full URL depending on the deployment might be
   at <code class="literal">https://openam.example.com:8443/openam/XUI/#dashboard/</code>.
  </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="dashboard-setup"></a>16.2.&nbsp;Setting Up the Dashboard Service</h2></div></div></div><p>Making some applications universally available ensures that all users have the same
   basic applications. However, some of your applications should be protected from the
   majority of your users. You will need to single out which users will include the 
   application on their Dashboard.</p><p>There are three default applications in the Dashboard service: Google, SalesForce,
   and ZenDesk.</p><div class="procedure"><a name="dashboard-add"></a><div class="procedure-title">Procedure&nbsp;16.1.&nbsp;To Add Applications from the Dashboard</div><p>You can add applications to the Dashboard service with the following steps.
    All fields except the Dashboard Class name and ICF Identifier are required for 
    the application to work properly from the Dashboard.</p><ol class="procedure" type="1"><li class="step"><p>Login to the OpenAM console as OpenAM Administrator,
     <code class="literal">amadmin</code>.</p></li><li class="step"><p>On the Configuration tab &gt; Global &gt; Dashboard click New
     to add a new application to the Dashboard service and to provide the information
     needed to connect to the app. </p></li><li class="step"><p>Provide a unique name for the application.</p></li><li class="step"><p>Add a Dashboard Class Name that identifies how the end user
     will access the app, such as <code class="literal">SAML2ApplicationClass</code>
     for a SAML 2.0 application.</p></li><li class="step"><p>Add a Dashboard Name for the application.</p></li><li class="step"><p>Add a Dashboard Display Name. This name is what the end user
     will see, such as Google.</p></li><li class="step"><p>Add the Dashboard Icon you would like the end user to see for the application. 
     Either use a fully-qualified URL or an appropriate relative URL so that the
     icon is rendered properly on the user Dashboard.</p></li><li class="step"><p>Add the Dashboard Login URL to point to the location the end user
     will go to once they click on the icon.</p></li><li class="step"><p>Leave the ICF Identifier blank.</p></li><li class="step"><p>Click Add when you are done.</p></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="dashboard-realms"></a>16.3.&nbsp;Configuring Dashboard Service for a Realm</h2></div></div></div><div class="procedure"><a name="dashboard-single-realm"></a><div class="procedure-title">Procedure&nbsp;16.2.&nbsp;To Add the Application Dashboard Service to a Realm</div><p>You must add the Dashboard service to a realm before it will be available. 
    The following instructions show you how to add an application to a single realm.
    Before you begin, make sure you have the name of the application as it appears
    on the Secondary Configuration Instance table under Configuration &gt; Global 
    &gt; Dashboard.</p><ol class="procedure" type="1"><li class="step"><p>On the Access Control &gt; <em class="replaceable"><code>Realm Name</code></em>
     &gt; Services, click Add....</p></li><li class="step"><p>Select the Dashboard service, then click Next.</p></li><li class="step"><p>Add or remove the applications you would like to appear on the Dashboard
     service for the realm.</p></li><li class="step"><p>Click Finish when you are done.</p></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="dashboard-users"></a>16.4.&nbsp;Adding Applications to a User's Dashboard</h2></div></div></div><div class="procedure"><a name="assign-app-to-user"></a><div class="procedure-title">Procedure&nbsp;16.3.&nbsp;To Add an Application to a User's Dashboard</div><a class="indexterm" name="d16037e31322"></a><p>Use the following steps to add an application to a user's Dashboard.</p><ol class="procedure" type="1"><li class="step"><p>On the Access Control &gt; <em class="replaceable"><code>Realm Name</code></em>
      &gt; Subjects, click the user identifier to edit the user's profile.</p></li><li class="step"><p>Under Services, click Dashboard.</p></li><li class="step"><p>Add the application beside the user name under the user's Assigned
      Dashboard list.</p></li><li class="step"><p>Click Save.</p></li></ol></div><div class="procedure"><a name="dashboard-remove-user-access"></a><div class="procedure-title">Procedure&nbsp;16.4.&nbsp;Removing User Access to an Application</div><a class="indexterm" name="d16037e31345"></a><p>You may need to remove an application from user's Dashboard, but
     you don't want to entirely delete the user. The following steps walk you through
     removing an application from a user's Dashboard.</p><ol class="procedure" type="1"><li class="step"><p>On the Access Control &gt; <em class="replaceable"><code>Realm Name</code></em>
      &gt; Subjects, click the user identifier to edit the user's profile.</p></li><li class="step"><p>Under Services, click Dashboard.</p></li><li class="step"><p>Delete the application beside the user name under the user's Assigned
      Dashboard list.</p></li><li class="step"><p>Click Save.</p></li></ol></div></div></div><div lang="en" class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="chap-rest"></a>Chapter&nbsp;17.&nbsp;Configuring REST APIs</h1></div></div></div><a class="indexterm" name="d16037e31369"></a><p>You can configure the default behavior OpenAM will take when a REST
   call does not specify explicit version information using either of the
   following procedures.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="#configure-versioning-ui" title="Procedure&nbsp;17.1.&nbsp;Configure Versioning Behavior by using the Web-based Console">Procedure&nbsp;17.1, &#8220;Configure Versioning Behavior by using the Web-based Console&#8221;</a></p></li><li class="listitem"><p><a class="xref" href="#configure-versioning-ssoadm" title="Procedure&nbsp;17.2.&nbsp;Configure Versioning Behavior by using SSOADM">Procedure&nbsp;17.2, &#8220;Configure Versioning Behavior by using SSOADM&#8221;</a></p></li></ul></div><p>The available options for default behavior are as follows.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><span class="emphasis"><em>Latest</em></span></span></dt><dd><p>The latest available supported version of the API is used.</p><p>This is the preset default for new installations of OpenAM.</p></dd><dt><span class="term"><span class="emphasis"><em>Oldest</em></span></span></dt><dd><p>The oldest available supported version of the API is used.</p><p>This is the preset default for upgraded OpenAM instances.</p><div class="note"><h3 class="title">Note</h3><p>The oldest supported version may not be the first that was
      released, as APIs versions become <a href="../release-notes/index.html#deprecated" class="link">
       <em class="citetitle">deprecated </em></a>or unsupported.</p></div></dd><dt><span class="term"><span class="emphasis"><em>None</em></span></span></dt><dd><p>No version will be used. When a REST client application calls a REST
      API without specifying the version, OpenAM returns an error and the
      request fails.</p></dd></dl></div><div class="procedure"><a name="configure-versioning-ui"></a><div class="procedure-title">Procedure&nbsp;17.1.&nbsp;Configure Versioning Behavior by using the Web-based Console</div><ol class="procedure" type="1"><li class="step"><p>Login as OpenAM administrator, <code class="literal">amadmin</code>.</p></li><li class="step"><p>Click Configuration &gt; Global &gt; REST APIs.</p></li><li class="step"><p>In 'Default Version', select the required response to a REST
     API request that does not specify an explicit version; 'Latest', 'Oldest',
     or 'None'.</p><div class="mediaobject" align="center"><a name="figure-rest-api-default-version-config"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/rest-api-default-version-config.png" align="middle" height="360" alt="REST API Default Version Configuration page."></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-rest-api-default-version-config.html" target="longdesc">D</a>]</span></div></div></li><li class="step"><p>Optionally, enable 'Warning Header' to include warning messages in the
     headers of responses to requests.</p></li><li class="step"><p>Save your work.</p></li></ol></div><div class="procedure"><a name="configure-versioning-ssoadm"></a><div class="procedure-title">Procedure&nbsp;17.2.&nbsp;Configure Versioning Behavior by using SSOADM</div><ul class="procedure"><li class="step"><p>Use the <code class="literal">ssoadm set-attr-defs</code> command, with
     the <code class="literal">openam-rest-apis-default-version</code> attribute set
     to either <code class="literal">LATEST</code>, <code class="literal">OLDEST</code> or
     <code class="literal">NONE</code>, as in the following example.</p><div class="screen"><pre>
     $ <strong>ssh openam.example.com</strong>
     $ <strong>cd /path/to/openam-tools/admin/openam/bin</strong>
     $ <strong>./ssoadm \
     set-attr-defs \
     --adminid amadmin \
     --password-file /tmp/pwd.txt \
     --servicename RestApisService \
     --schematype Global \
     --attributevalues openam-rest-apis-default-version=NONE</strong>

     <em>Schema attribute defaults were set.</em>
    </pre></div></li></ul></div></div><div lang="en" class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="chap-backup-restore"></a>Chapter&nbsp;18.&nbsp;Backing Up and Restoring OpenAM Configurations</h1></div></div></div><p>
  OpenAM stores configuration data in an LDAP directory server and in files.
  The directory service replicates configuration data between directory servers,
  allowing OpenAM to share configuration data across servers in a Site.
  During normal production operations, you rely on directory replication
  to maintain multiple, current copies of OpenAM service configuration.
  To recover from the loss of a server or from a serious administrative error,
  back up directory data and configuration files.
 </p><p>
  This chapter shows how to backup and restore OpenAM configuration data
  by backing up and restoring local configuration files
  and local (embedded) configuration directory server data.
  If your deployment uses an external configuration directory server,
  then refer to the documentation for your external directory server
  or work with your directory server administrator to back up and restore
  configuration data stored in the external directory service.
 </p><p>
  For OpenDJ directory server you can find more information in the chapter on
  <a class="link" href="http://docs.forgerock.org/en/opendj/2.6.0/admin-guide/#chap-backup-restore" target="_blank"><em class="citetitle">Backing Up &amp; Restoring Data</em></a>.
 </p><div class="itemizedlist"><p>
   In OpenAM deployments where configuration directory data is replicated,
   you must take the following points into consideration.
  </p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
    Directory replication mechanically applies new changes to ensure
    that replicated data is the same everywhere.
    When you restore older backup data,
    directory replication applies newer changes to the older data.
   </p><p>
    This includes new changes that the administrator sees as mistakes.
    To recover from administrative error, you must work around this behavior
    either by performing a change to be replicated that repairs the error
    or by restoring all replicas to a state prior to the error.
   </p></li><li class="listitem"><p>
    When preparing directory server backup and restore operations,
    also know that data replication purge operations affect
    the useful lifetime of any data that you back up.
   </p><p>
    Replication relies on historical data to resolve any conflicts that arise.
    If directory servers did not eventually purge this historical data,
    the data would continue to grow until it filled all available space.
    Directory servers therefore purge older historical data.
    OpenDJ purges historical data older than 3 days by default.
   </p><p>
    When the directory server encounters a gap in historical data
    it cannot correctly complete replication operations.
    You must make sure, therefore, that any data you restore from backup
    is not older than the replication purge delay.
    Otherwise your restoration operation could break replication
    with the likely result that you must restore all servers from backup,
    losing any changes that occurred in the meantime.
   </p></li></ul></div><div class="orderedlist"><p>
   This chapter aims to cover the following uses of backup data.
  </p><ol class="orderedlist" type="1"><li class="listitem"><p>
    Recovery from server failure.
   </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
      <a class="xref" href="#backup-for-disaster" title="Procedure&nbsp;18.1.&nbsp;To Back Up All Server Configuration Data">Procedure&nbsp;18.1, &#8220;To Back Up All Server Configuration Data&#8221;</a>
     </p></li><li class="listitem"><p>
      <a class="xref" href="#restore-after-disaster" title="Procedure&nbsp;18.2.&nbsp;To Restore All Server Configuration Data">Procedure&nbsp;18.2, &#8220;To Restore All Server Configuration Data&#8221;</a>
     </p></li></ul></div></li><li class="listitem"><p>
    Recovery from serious administrative error.
   </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
      <a class="xref" href="#export-configuration-data" title="Procedure&nbsp;18.3.&nbsp;To Export Only Configuration Data">Procedure&nbsp;18.3, &#8220;To Export Only Configuration Data&#8221;</a>
     </p></li><li class="listitem"><p>
      <a class="xref" href="#recover-from-serious-error" title="Procedure&nbsp;18.4.&nbsp;To Restore Configuration Data After Serious Error">Procedure&nbsp;18.4, &#8220;To Restore Configuration Data After Serious Error&#8221;</a>
     </p></li></ul></div></li></ol></div><div class="procedure"><a name="backup-for-disaster"></a><div class="procedure-title">Procedure&nbsp;18.1.&nbsp;To Back Up All Server Configuration Data</div><p>
   This procedure backs up all the configuration data stored with the server.
   This backup is to be restored when rebuilding a failed server.
  </p><div class="itemizedlist"><p>
    Use this procedure when the following statements are true.
   </p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
     OpenAM stores configuration data in the embedded OpenDJ directory server.
    </p><p>
     The embedded OpenDJ directory server files are co-located
     with other OpenAM configuration files.
    </p></li><li class="listitem"><p>
     If OpenAM stores CTS data in the embedded OpenDJ directory server,
     then the restore operation overwrites current CTS data with older data.
     After you restore from backup, users authenticate again as necessary.
    </p><p>
     For deployments with long-lived sessions,
     you can limit the extent of re-authentication by using session failover.
     For details, see the <em class="citetitle">Installation Guide</em> chapter,
     <a href="../install-guide/index.html#chap-session-failover" class="link"><em class="citetitle">Setting Up OpenAM Session Failover</em></a>.
    </p></li></ul></div><p>
   If your deployment uses an external configuration directory server,
   then refer to the documentation for your external directory server
   or work with your directory server administrator to back up and restore
   configuration data stored in the external directory service.
   For OpenDJ directory server you can find more information in the chapter on
   <a class="link" href="http://docs.forgerock.org/en/opendj/2.6.0/admin-guide/#chap-backup-restore" target="_blank"><em class="citetitle">Backing Up &amp; Restoring Data</em></a>.
  </p><a class="indexterm" name="d16037e31572"></a><div class="important"><h3 class="title">Important</h3><p>
    Understand the explanation in the introductory paragraphs of this chapter
    before you proceed.
    Directory backup validity depends on replication purge delay,
    which by default for OpenDJ directory server is 3 days.
   </p><p>
    Also do not restore configuration data from a backup of
    a different release of OpenAM.
    The structure of configuration data can change from release to release.
   </p></div><p>
   Follow these steps for each OpenAM server that you want to back up.
  </p><ol class="procedure" type="1"><li class="step"><p>
    Stop OpenAM or the container in which it runs.
   </p></li><li class="step"><p>
    Backup OpenAM configuration files
    including those of the configuration directory server
    but skipping log and lock files.
   </p><p>
    The following example uses the default configuration location.
    $HOME is the home directory of the user
    who runs the web container where OpenAM is deployed,
    and OpenAM is deployed in Apache Tomcat under <code class="literal">openam</code>.
   </p><div class="screen"><pre>
$ <strong>cd $HOME</strong>
$ <strong>zip \
 --recurse-paths \
 /path/to/backup-`date -u +i5%F-%m-%S`.zip \
 openam .openamcfg/AMConfig_path_to_tomcat_webapps_openam_ \
 --exclude openam/openam/debug/* openam/openam/log/* openam/openam/stats* \
  openam/opends/logs/* openam/opends/locks/*</strong>
...
$ <strong>ls /path/to/backup-2014-12-01-12-00.zip</strong>
<em>/path/to/backup-2014-12-01-12-00.zip</em>
   </pre></div><p>
    The backup is valid until the end of the purge delay.
   </p></li><li class="step"><p>
    Start OpenAM or the container in which it runs.
   </p></li></ol></div><div class="procedure"><a name="restore-after-disaster"></a><div class="procedure-title">Procedure&nbsp;18.2.&nbsp;To Restore All Server Configuration Data</div><p>
   This procedure restores all the configuration data for a server,
   where the configuration data has been backed up as described in
   <a class="xref" href="#backup-for-disaster" title="Procedure&nbsp;18.1.&nbsp;To Back Up All Server Configuration Data">Procedure&nbsp;18.1, &#8220;To Back Up All Server Configuration Data&#8221;</a>.
   This procedure applies when rebuilding a failed server.
  </p><div class="itemizedlist"><p>
    Use this procedure when the following statements are true.
   </p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
     OpenAM stores configuration data in the embedded OpenDJ directory server.
    </p><p>
     The embedded OpenDJ directory server files are co-located
     with other OpenAM configuration files.
    </p></li><li class="listitem"><p>
     If OpenAM stores CTS data in the embedded OpenDJ directory server,
     then the restore operation overwrites current CTS data with older data.
     After you restore from backup, users authenticate again as necessary.
    </p><p>
     For deployments with long-lived sessions,
     you can limit the extent of re-authentication by using session failover.
     For details, see the <em class="citetitle">Installation Guide</em> chapter,
     <a href="../install-guide/index.html#chap-session-failover" class="link"><em class="citetitle">Setting Up OpenAM Session Failover</em></a>.
    </p></li></ul></div><p>
   If your deployment uses an external configuration directory server,
   then refer to the documentation for your external directory server
   or work with your directory server administrator to back up and restore
   configuration data stored in the external directory service.
   For OpenDJ directory server you can find more information in the chapter on
   <a class="link" href="http://docs.forgerock.org/en/opendj/2.6.0/admin-guide/#chap-backup-restore" target="_blank"><em class="citetitle">Backing Up &amp; Restoring Data</em></a>.
  </p><a class="indexterm" name="d16037e31645"></a><div class="important"><h3 class="title">Important</h3><p>
    Understand the explanation in the introductory paragraphs of this chapter
    before you proceed.
    Directory backup validity depends on replication purge delay,
    which by default for OpenDJ directory server is 3 days.
   </p><p>
    Also do not restore configuration data from a backup of
    a different release of OpenAM.
    The structure of configuration data can change from release to release.
   </p></div><p>
   Follow these steps for each OpenAM server to restore.
   If you are restoring OpenAM after a failure,
   make sure you make a copy of any configuration and log files
   that you need to investigate the problem before restoring OpenAM from backup.
  </p><ol class="procedure" type="1"><li class="step"><p>
    Stop OpenAM or the container in which it runs.
   </p></li><li class="step"><p>
    Restore files in the configuration directory as necessary,
    making sure that you restore from a valid backup,
    one that is newer than the replication purge delay.
   </p><div class="screen"><pre>
$ <strong>cd $HOME</strong>
$ <strong>unzip /path/to/backup-2014-12-01-12-00.zip</strong>
<em>Archive:  /path/to/backup-2014-12-01-12-00.zip
replace openam/.configParam? [y]es, [n]o, [A]ll, [N]one, [r]ename: </em><strong>A</strong>
...
   </pre></div></li><li class="step"><p>
    Start OpenAM or the container in which it runs.
   </p></li></ol></div><div class="procedure"><a name="export-configuration-data"></a><div class="procedure-title">Procedure&nbsp;18.3.&nbsp;To Export Only Configuration Data</div><p>
   LDAP Data Interchange Format (LDIF) is a standard, text-based format
   for storing LDAP directory data.
   You can use LDIF excerpts to make changes to directory data.
  </p><p>
   This procedure takes an LDIF backup of OpenAM configuration data only.
   Use this LDIF data when recovering from a serious configuration error.
  </p><a class="indexterm" name="d16037e31684"></a><ol class="procedure" type="1"><li class="step"><p>
    Make sure that OpenAM's configuration is in correct working order
    before exporting configuration data.
   </p></li><li class="step"><p>
    Use the OpenDJ <span class="command"><strong>export-ldif</strong></span> command to run a task
    that exports only configuration data, not CTS data.
   </p><p>
    You can run this command without stopping OpenAM.
   </p><p>
    Find OpenDJ commands under the file system directory
    that contains OpenAM configuration files.
   </p><p>
    The bind password for Directory Manager is the same
    as the password for the OpenAM global administrator (amadmin).
   </p><div class="screen"><pre>
$ <strong>$HOME/openam/opends/bin/export-ldif \
 --port 4444 \
 --hostname openam.example.com \
 --bindDN "cn=Directory Manager" \
 --bindPassword password \
 --backendID userRoot \
 --includeBranch dc=openam,dc=forgerock,dc=org \
 --excludeBranch ou=tokens,dc=openam,dc=forgerock,dc=org \
 --ldifFile /path/to/backup-`date -u +%F-%m-%s`.ldif \
 --start 0 \
 --trustAll</strong>
<em>Export task 20141208113331302 scheduled to start Dec 8, 2014 11:33:31 AM CET</em>
   </pre></div><p>
    When the task completes, the LDIF file is at the expected location.
   </p><div class="screen"><pre>
$ <strong>ls /path/to/*.ldif</strong>
<em>/path/to/backup-2014-12-08-12-1418034808.ldif</em>
   </pre></div></li></ol></div><div class="procedure"><a name="recover-from-serious-error"></a><div class="procedure-title">Procedure&nbsp;18.4.&nbsp;To Restore Configuration Data After Serious Error</div><p>
   A serious configuration error is an error that you cannot easily repair
   by using OpenAM configuration tools such as OpenAM console
   or the <span class="command"><strong>ssoadm</strong></span> command.
  </p><p>
   Use this procedure to recover from a serious configuration error
   by manually restoring configuration data to an earlier state.
   This procedure depends on LDIF data that you exported as described in
   <a class="xref" href="#export-configuration-data" title="Procedure&nbsp;18.3.&nbsp;To Export Only Configuration Data">Procedure&nbsp;18.3, &#8220;To Export Only Configuration Data&#8221;</a>.
  </p><a class="indexterm" name="d16037e31732"></a><ol class="procedure" type="1"><li class="step"><p>
    Read the OpenDJ change log to determine the LDAP changes
    that caused the configuration problem.
   </p><p>
    The OpenDJ change log provides an external change log mechanism
    that allows you to read changes made to directory data
    for replicated directory servers.
   </p><p>
    For instructions on reading the change log,
    see the OpenDJ <em class="citetitle">Administration Guide</em> section on
    <a class="link" href="http://docs.forgerock.org/en/opendj/2.6.0/admin-guide/#repl-change-notification" target="_blank"><em class="citetitle">Change Notification For Your Applications</em></a>.
   </p></li><li class="step"><p>
    Based on the data in the change log,
    determine what changes would reverse the configuration error.
   </p><p>
    For changes that resulted in one attribute value being replaced by another,
    you can recover the information from the change log alone.
   </p></li><li class="step"><p>
    For deleted content not contained in the change log,
    use the LDIF resulting from <a class="xref" href="#export-configuration-data" title="Procedure&nbsp;18.3.&nbsp;To Export Only Configuration Data">Procedure&nbsp;18.3, &#8220;To Export Only Configuration Data&#8221;</a>
    to determine a prior, working state of the configuration entry
    before the configuration error.
   </p></li><li class="step"><p>
    Prepare LDIF to modify configuration data in a way that repairs the error
    by restoring the state of directory entries before the administrative error.
   </p></li><li class="step"><p>
    Use the OpenDJ <span class="command"><strong>ldapmodify</strong></span> command
    to apply the modification.
   </p><p>
    For instructions on making changes to directory data
    see the OpenDJ <em class="citetitle">Administration Guide</em> section on
    <a class="link" href="http://docs.forgerock.org/en/opendj/2.6.0/admin-guide/#write-ldap" target="_blank"><em class="citetitle">Updating the Directory</em></a>.
   </p></li></ol></div></div><div lang="en" class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="chap-certs-keystores"></a>Chapter&nbsp;19.&nbsp;Managing Certificates</h1></div></div></div><a class="indexterm" name="d16037e31781"></a><a class="indexterm" name="d16037e31784"></a><p>This chapter shows you how to handle certificates used to protect
 network communication and for authentication.</p><p>In theory, you should not have to concern yourself with certificates
 when working with OpenAM. OpenAM core services and Java EE policy agents depend
 on the certificates installed for use with the web application container in
 which they run. OpenAM web policy agents depend on the certificates installed
 for use with the web server. Theoretically, each certificate has been signed
 by a well-known Certificate Authority (CA), whose certificate is already
 installed in the Java CA certificates trust store
 (<code class="filename">$JAVA_HOME/jre/lib/security/cacerts</code>, default password
 <code class="literal">changeit</code>) and in browsers, and so is recognized by other
 software used without you having to configure anything.</p><p>In practice, you might not have the budget for CA signed certificates
 in your lab or test environment, where you might constantly be installing
 new configurations, using and throwing away certificates for experiments and
 repeated tests. In the lab, therefore, you set up OpenAM to use self-signed
 certificates that you generate at no cost, but that are not recognized, and
 therefore not trusted out of the box.</p><div class="itemizedlist"><p>How you configure the containers where OpenAM and your applications run
  to use self-signed certificates depends on your web application server or web
  server software. Yet, the basic principles apply.</p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>First, your container requires its own certificate for setting up
   secure connections.</p></li><li class="listitem"><p>Second, the clients connecting must be able to trust the container
   certificate. Generally this means that clients must recognize the container
   certificate because they have a copy of the public certificate stored
   somewhere the client trusts.</p></li><li class="listitem"><p>Third, if you use certificate authentication in OpenAM, OpenAM must
   also be able to find a copy of the client's public certificate to trust the
   client, most likely by finding a match with the certificate stored in the
   client profile from the identity repository. How you include client
   certificates in their identity repository entries depends on your identity
   repository more than it depends on OpenAM.</p></li></ul></div><p>Some client applications let you trust certificates blindly. This can
 be helpful when working in your lab or test environment with self-signed
 certificates. For example, you might want to use HTTPS with the OpenAM
 RESTful API without having the client recognize the self-signed server
 certificate.</p><div class="screen"><pre>
$ <strong>curl \
 "https://openam.example.com:8443/openam/identity/authenticate?username=bjensen&amp;password=hifalutin"</strong>
<em>curl: (60) Peer certificate cannot be authenticated with known CA certificates
More details here: http://curl.haxx.se/docs/sslcerts.html

curl performs SSL certificate verification by default, using a "bundle"
 of Certificate Authority (CA) public keys (CA certs). If the default
 bundle file isn't adequate, you can specify an alternate file
 using the --cacert option.
If this HTTPS server uses a certificate signed by a CA represented in
 the bundle, the certificate verification probably failed due to a
 problem with the certificate (it might be expired, or the name might
 not match the domain name in the URL).
If you'd like to turn off curl's verification of the certificate, use
 the -k (or --insecure) option.</em>
$ <strong>curl \
 --insecure \
 "https://openam.example.com:8443/openam/identity/authenticate?username=bjensen&amp;password=hifalutin"</strong>
<em>token.id=AQIC5wM2LY4SfczMax8jegpSiaigB96NOWylLilsd0PUMjY.*AAJTSQACMDE.*</em>
 </pre></div><div class="procedure"><a name="openam-with-https-on-tomcat"></a><div class="procedure-title">Procedure&nbsp;19.1.&nbsp;To Set Up OpenAM With HTTPS on Tomcat</div><p>The container where you install OpenAM requires a certificate in order
  to set up secure connections. The following steps demonstrate one way to set
  up Tomcat with an HTTPS connector, using the Java <span class="command"><strong>keytool</strong></span>
  command to manage the certificate and key stores. Once Tomcat can do HTTPS,
  you deploy OpenAM as you normally would, over HTTPS.</p><ol class="procedure" type="1"><li class="step"><p>Stop Tomcat.</p></li><li class="step"><p>Create a certificate and store it in a new key store.</p><div class="screen"><pre>
$ <strong>cd /path/to/tomcat/conf/</strong>
$ <strong>keytool -genkey -alias openam.example.com -keyalg RSA -keystore keystore.jks</strong>
<em>Enter keystore password:
What is your first and last name?
  [Unknown]:</em>  <strong>openam.example.com</strong>
<em>What is the name of your organizational unit?
  [Unknown]:</em>  <strong>Eng</strong>
<em>What is the name of your organization?
  [Unknown]:</em>  <strong>ForgeRock.com</strong>
<em>What is the name of your City or Locality?
  [Unknown]:</em>  <strong>Grenoble</strong>
<em>What is the name of your State or Province?
  [Unknown]:</em>  <strong>Isere</strong>
<em>What is the two-letter country code for this unit?
  [Unknown]:</em>  <strong>FR</strong>
<em>Is CN=openam.example.com, OU=Eng, O=ForgeRock.com, L=Grenoble, ST=Isere,
 C=FR correct?
  [no]:</em>  <strong>yes</strong>

<em>Enter key password for &lt;openam.example.com&gt;
 (RETURN if same as keystore password):</em>
   </pre></div></li><li class="step"><p>Uncomment the SSL connector configuration in Tomcat's
   <code class="filename">conf/server.xml</code>, specifying your key store file
   and password.</p><pre class="brush: xml;">
&lt;!-- Define a SSL HTTP/1.1 Connector on port 8443
     This connector uses the JSSE configuration, when using APR, the 
     connector should be using the OpenSSL style configuration
     described in the APR documentation --&gt;
&lt;!--
--&gt;
&lt;Connector port="8443" protocol="HTTP/1.1" SSLEnabled="true"
           maxThreads="150" scheme="https" secure="true"
           keystoreFile="/path/to/tomcat/conf/keystore.jks"
           keystorePass="changeit"
           clientAuth="false" sslProtocol="TLS" /&gt;
   </pre></li><li class="step"><p>Start Tomcat.</p></li><li class="step"><p>Verify that you can connect to Tomcat on port 8443 over HTTPS.</p><p>Your browser does not trust the certificate, because the certificate
   is self-signed, not signed by any of the CAs your browser knows.</p><div class="mediaobject" align="center"><a name="figure-browser-unknown-cert"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/browser-unknown-cert.png" align="middle" height="360" alt="Your browser does not trust your self-signed certificate."></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-browser-unknown-cert.html" target="longdesc">D</a>]</span></div></div><p>You recognize the Subject and Issuer of your certificate, and so
   can choose to trust the certificate, effectively saving it into your
   browser's trust store.</p></li><li class="step"><p>Deploy and configure OpenAM as you normally would.</p></li></ol></div><div class="procedure"><a name="share-self-signed-certs"></a><div class="procedure-title">Procedure&nbsp;19.2.&nbsp;To Share Self-Signed Certificates</div><p>When you use a self-signed certificate for your container, clients
  connecting must be able to trust the container certificate. Your browser
  makes this an easy, but manual process. For other client applications, you
  must import the certificate into the trust store used by the client. By
  default, Java applications can use the
  <code class="filename">$JAVA_HOME/jre/lib/security/cacerts</code> store. The default
  password is <code class="literal">changeit</code>.<a href="#ftn.d16037e31937" class="footnote" name="d16037e31937"><sup class="footnote">[10]</sup></a> The
  steps that follow demonstrate how to import a self-signed certificate into
  the Java <code class="filename">cacerts</code> store.</p><ol class="procedure" type="1"><li class="step"><p>Export the certificate from the key store.</p><div class="screen"><pre>
$ <strong>cd /path/to/tomcat/conf/</strong>
$ <strong>keytool \
 -exportcert \
 -alias openam.example.com \
 -file openam.crt \
 -keystore keystore.jks</strong>
<em>Enter keystore password:
Certificate stored in file &lt;openam.crt&gt;</em>
   </pre></div></li><li class="step"><p>Import the certificate into the trust store.</p><div class="screen"><pre>
$ <strong>keytool \
 -importcert \
 -alias openam.example.com \
 -file openam.crt
 -trustcacerts \
 -keystore $JAVA_HOME/jre/lib/security/cacerts</strong>
<em>Enter keystore password:
Owner: CN=openam.example.com, OU=Eng, O=ForgeRock.com, L=Grenoble, ST=Isere,
 C=FR
Issuer: CN=openam.example.com, OU=Eng, O=ForgeRock.com, L=Grenoble, ST=Isere,
 C=FR
Serial number: 4e789e40
Valid from: Tue Sep 20 16:08:00 CEST 2011 until: Mon Dec 19 15:08:00 CET 2011
Certificate fingerprints:
  MD5:  31:08:11:3B:15:75:87:C2:12:08:E9:66:00:81:61:8D
  SHA1: AA:90:2F:42:0A:F4:A9:A5:0C:90:A9:FC:69:FD:64:65:D9:78:BA:1D
  Signature algorithm name: SHA1withRSA
  Version: 3
Trust this certificate? [no]:</em>  <strong>yes</strong>
<em>Certificate was added to keystore</em>
   </pre></div></li></ol></div><div class="procedure"><a name="change-signing-key"></a><div class="procedure-title">Procedure&nbsp;19.3.&nbsp;To Change the Signing Key for Federation</div><a class="indexterm" name="d16037e31981"></a><p>
   Digital signatures are constructed as follows.
  </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
     The signer computes a hash of the data to sign,
     and encrypts the hash using a private key
     to get the signature.
    </p></li><li class="listitem"><p>
     The signer then attaches the signature to the data,
     and exchanges the message with the recipient.
    </p></li><li class="listitem"><p>
     To validate the digital signature on the message,
     the recipient decrypts the signature
     using the public key certificate
     that corresponds to the private key of the signer.
    </p></li><li class="listitem"><p>
     The recipient computes the hash of the data,
     and then checks that the decrypted signature,
     in other words the decrypted hash,
     matches the computed hash.
    </p></li><li class="listitem"><p>
     Parties signing requests, responses, or assertions
     must therefore share the public key certificates for signing keys.
     The certificates can either be shared in advance
     and imported into the trusted partners' trust stores,
     then referenced in the configuration by their trust store aliases,
     or can be shared in each signed message.
    </p></li></ul></div><p>The following steps cover how to change the signing key for an identity
  provider. This procedure involves creating a self-signed certificate in a new
  key store file, and also preparing encrypted password files so that OpenAM can
  access the key store and the private key.</p><ol class="procedure" type="1"><li class="step"><p>If you do not already have the new signing key in your key store,
   generate a new key and key store.</p><p>The following example starts an interactive <span class="command"><strong>keytool</strong></span>
   session that requests information needed to generate a new key valid for two
   years, and puts it in a key store named <code class="filename">keystore.jks</code>.
   You can perform this step in a temporary location, and then move the files
   generated once you have completed your work.</p><p>Keep track of the passwords you enter here, as you use them in the next
   step.</p><div class="screen"><pre>
$ <strong>cd /tmp</strong>
$ <strong>keytool \
 -genkeypair \
 -alias newkey \
 -keyalg RSA \
 -keysize 1024 \
 -validity 730 \
 -storetype JKS \
 -keystore keystore.jks</strong>
<em>Enter keystore password:
Re-enter new password: 
What is your first and last name?
  [Unknown]:</em>  <strong>openam.example.com</strong>
<em>What is the name of your organizational unit?
  [Unknown]:</em>  <strong>Eng</strong>
<em>What is the name of your organization?
  [Unknown]:</em>  <strong>ForgeRock.com</strong>
<em>What is the name of your City or Locality?
  [Unknown]:</em>  <strong>Grenoble</strong>
<em>What is the name of your State or Province?
  [Unknown]:</em>  <strong>Isere</strong>
<em>What is the two-letter country code for this unit?
  [Unknown]:</em>  <strong>FR</strong>
<em>Is CN=openam.example.com, OU=Eng, O=ForgeRock.com, L=Grenoble, ST=Isere,
 C=FR correct?
  [no]:</em>  <strong>yes</strong>

<em>Enter key password for &lt;newkey&gt;
 (RETURN if same as keystore password):
Re-enter new password:</em>
   </pre></div><p>Self-signed keys are not automatically recognized by other entities.
   You must also share the self-signed key as described in
   <a class="xref" href="#share-self-signed-certs" title="Procedure&nbsp;19.2.&nbsp;To Share Self-Signed Certificates">Procedure&nbsp;19.2, &#8220;To Share Self-Signed Certificates&#8221;</a>.</p></li><li class="step"><p>Using the passwords you entered in the previous step, prepare the
   password files to encrypt.</p><div class="itemizedlist"><p>Create two files, each containing only a password in clear text. You
    can create the files in the same directory as the key store.</p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="filename">keypass.cleartext</code> contains the clear text
     key password for the private key you generated.</p></li><li class="listitem"><p><code class="filename">storepass.cleartext</code> contains the clear text
     key store password.</p></li></ul></div></li><li class="step"><p>If you have not already done so, install the administration tools as
   described in <a href="../install-guide/index.html#install-openam-admin-tools" class="link"><em class="citetitle">To Set Up
   Administration Tools</em></a>.</p></li><li class="step"><p>Prepare encrypted password files for use by OpenAM.</p><div class="screen"><pre>
$ <strong>./ampassword --encrypt keypass.cleartext &gt; .keypass</strong>
$ <strong>./ampassword --encrypt storepass.cleartext &gt; .storepass</strong>
   </pre></div><p>Remove the <code class="filename">*.cleartext</code> files after preparing
   the encrypted versions.</p></li><li class="step"><p>Replace the default OpenAM key store and password files with the
   ones that you have created.</p><p>The following example works with an installation of OpenAM where
   the deployment URI is <code class="literal">/openam</code>.</p><div class="screen"><pre>
$ <strong>cp keystore.jks .keypass .storepass ~/openam/openam/</strong>
   </pre></div></li><li class="step"><p>Restart OpenAM, or the container where it runs, so that OpenAM can
   use the new key store and encrypted password files.</p></li><li class="step"><p>Login to OpenAM console as administrator, and then set the new signing
   key in one of two ways.</p><ol type="a" class="substeps"><li class="step"><p>If you have not yet configured your identity provider, select
     Common Tasks &gt; Create Hosted Identity Provider, and then follow the
     instructions, selecting your key from the Signing Key drop-down
     list.</p></li><li class="step"><p>If you have already configured your identity provider, browse to
     Federation &gt; <em class="replaceable"><code>provider-name</code></em> &gt; Assertion
     Content &gt; Signing and Encryption, and then edit the signing key
     certificate alias.</p><p>Save your work.</p></li></ol></li><li class="step"><p>Share updated metadata with other entities in your circle of trust
   as described in <a href="../admin-guide/index.html#set-up-federation" class="link"><em class="citetitle">Setting Up SAML
   2.0 SSO</em></a>.</p></li></ol></div><div class="footnotes"><br><hr class="footnote-hr"><div id="ftn.d16037e31937" class="footnote"><p><a href="#d16037e31937" class="para"><sup class="para">[10] </sup></a>Alternatively,
  you can specify the trust store for a Java application, such as
  <code class="literal">-Djavax.net.ssl.trustStore=/path/to/truststore.jks
  -Djavax.net.ssl.trustStorePassword=changeit</code>.</p></div></div></div><div lang="en" class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="chap-monitoring"></a>Chapter&nbsp;20.&nbsp;Monitoring OpenAM Services</h1></div></div></div><div class="toc"><div class="toc-title">Table of Contents</div><dl class="toc"><dt><span class="section"><a href="#monitoring-interfaces">20.1. Monitoring Interfaces</a></span></dt><dt><span class="section"><a href="#cts-monitoring">20.2. Monitoring CTS Tokens</a></span></dt><dt><span class="section"><a href="#is-openam-alive">20.3. Is OpenAM Running?</a></span></dt><dt><span class="section"><a href="#debug-logging">20.4. Debug Logging</a></span></dt><dt><span class="section"><a href="#session-mgmt">20.5. Session Management</a></span></dt></dl></div><p>This chapter covers how to monitor OpenAM services to ensure
 appropriate performance and service availability.</p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="monitoring-interfaces"></a>20.1.&nbsp;Monitoring Interfaces</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="#monitoring-web-pages">20.1.1. Web Based Monitoring</a></span></dt><dt><span class="section"><a href="#monitoring-jmx">20.1.2. JMX Monitoring</a></span></dt><dt><span class="section"><a href="#monitoring-snmp">20.1.3. SNMP Monitoring</a></span></dt></dl></div><a class="indexterm" name="d16037e32162"></a><p>OpenAM lets you monitor OpenAM over protocol through web pages,
  Java Management Extensions (JMX), or Simple Network Management Protocol
  (SNMP). The services are based on JMX.</p><p>To configure monitoring services, login to OpenAM console as OpenAM
  administrator, and browse to Configuration &gt; System &gt; Monitoring.
  Alternatively you can use the <span class="command"><strong>ssoadm set-attr-defs</strong></span>
  command.</p><div class="screen"><pre>
$ <strong>ssoadm \
 set-attr-defs \
 --servicename iPlanetAMMonitoringService \
 --schematype Global \
 --adminid amadmin \
 --password-file /tmp/pwd.txt \
 --attributevalues iplanet-am-monitoring-enabled=true</strong>
  </pre></div><p>Restart OpenAM for the changes to take effect. You must also restart
  OpenAM if you disable monitoring.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="monitoring-web-pages"></a>20.1.1.&nbsp;Web Based Monitoring</h3></div></div></div><p>You can configure OpenAM to allow you to access a web based view of
   OpenAM MBeans on port 8082 where the core server runs, such as
   <code class="literal">http://openam-ter.example.com:8082/</code>. Either use the
   console, or use the <span class="command"><strong>ssoadm</strong></span> command.</p><div class="screen"><pre>
$ <strong>ssoadm \
 set-attr-defs \
 --servicename iPlanetAMMonitoringService \
 --schematype Global \
 --adminid amadmin \
 --password-file /tmp/pwd.txt \
 --attributevalues iplanet-am-monitoring-http-enabled=true</strong>
   </pre></div><p>The default authentication file allows you to authenticate over HTTP
   as user <code class="literal">demo</code>, password <code class="literal">changeit</code>. The
   user name and password are kept in the file specified, with the password
   encrypted.</p><div class="screen"><pre>
$ <strong>cat openam/openam/openam_mon_auth</strong>
<em>demo AQICMBCKlwx6G3vzK3TYYRbtTpNYAagVIPNP</em>
   </pre></div><p>Or:</p><div class="screen"><pre>
$ <strong>cat openam/openam/opensso_mon_auth</strong>
<em>demo AQICvSe+tXEg8TUUT8ekzHb8IRzVSvm1Lc2u</em>
   </pre></div><p>You can encrypt a new password using the <span class="command"><strong>ampassword</strong></span>
   command. After changing the authentication file, you must restart OpenAM
   for the changes to take effect.</p><div class="mediaobject" align="center"><a name="figure-web-based-monitoring"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/web-based-monitoring.png" align="middle" height="360" alt="OpenAM MBeans in a browser"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-web-based-monitoring.html" target="longdesc">D</a>]</span></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="monitoring-jmx"></a>20.1.2.&nbsp;JMX Monitoring</h3></div></div></div><a class="indexterm" name="d16037e32237"></a><p>You can configure OpenAM to allow you to listen for Java Management
   eXtension (JMX) clients, by default on port 9999. Either use the OpenAM
   console page under Configuration &gt; System &gt; Monitoring and make sure
   both Monitoring Status and Monitoring RMI interface status are both set to
   Enabled, or use the <span class="command"><strong>ssoadm</strong></span> command.</p><div class="screen"><pre>
$ <strong>ssoadm \
 set-attr-defs \
 --servicename iPlanetAMMonitoringService \
 --schematype Global \
 --adminid amadmin \
 --password-file /tmp/pwd.txt \
 --attributevalues iplanet-am-monitoring-enabled=true \
  iplanet-am-monitoring-rmi-enabled=true</strong>
   </pre></div><p>A number of tools support JMX, including <span class="command"><strong>jvisualvm</strong></span>
   and <span class="command"><strong>jconsole</strong></span>. When you use <span class="command"><strong>jconsole</strong></span>
   to browse OpenAM MBeans for example, the default URL for the OpenAM running
   on the local system is
   <code class="literal">service:jmx:rmi:///jndi/rmi://localhost:9999/server</code>.</p><div class="screen"><pre>
$ <strong>jconsole service:jmx:rmi:///jndi/rmi://localhost:9999/server &amp;</strong>
   </pre></div><p>You can also browse the MBeans by connecting to your web application
   container, and browsing to the OpenAM MBeans. By default, JMX monitoring for
   your container is likely to be accessible only locally, using the process
   ID.</p><div class="mediaobject" align="center"><a name="figure-jconsole-to-openam"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/jconsole-to-openam.png" align="middle" height="360" alt="Jconsole browsing OpenAM MBeans"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-jconsole-to-openam.html" target="longdesc">D</a>]</span></div></div><p>Also see <a class="link" href="http://docs.oracle.com/javase/1.5.0/docs/guide/management/agent.html" target="_blank">Monitoring and Management Using JMX</a> for instructions on how to
   connect remotely, how to use SSL, and so forth.</p><div class="important"><h3 class="title">Important</h3><p>JMX has a limitation in that
   some Operations and CTS tables cannot be properly serialized from OpenAM to JMX.
   As a result, only a portion of OpenAM's monitoring information is available through JMX.
   SNMP is a preferred monitoring option over JMX and exposes all OpenAM tables,
   especially for CTS, with no serialization limitations.</p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="monitoring-snmp"></a>20.1.3.&nbsp;SNMP Monitoring</h3></div></div></div><a class="indexterm" name="d16037e32292"></a><p>You can configure OpenAM to allow you to listen on port 8085 for SNMP
   monitoring. Either use the console, or use the <span class="command"><strong>ssoadm</strong></span>
   command.</p><div class="screen"><pre>
$ <strong>ssoadm \
 set-attr-defs \
 --servicename iPlanetAMMonitoringService \
 --schematype Global \
 --adminid amadmin \
 --password-file /tmp/pwd.txt \
 --attributevalues iplanet-am-monitoring-snmp-enabled=true</strong>
   </pre></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="cts-monitoring"></a>20.2.&nbsp;Monitoring CTS Tokens</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="#cts-monitor-commands">20.2.1. CTS SNMP Monitoring</a></span></dt><dt><span class="section"><a href="#snmp-policy-evaluation">20.2.2. SNMP Monitoring For Policy Evaluation</a></span></dt><dt><span class="section"><a href="#snmp-sessions">20.2.3. SNMP Monitoring For Sessions</a></span></dt></dl></div><a class="indexterm" name="d16037e32310"></a><p>
   The <a href="../install-guide/index.html#chap-cts" class="link">OpenAM Core
   Token Service</a> (CTS) provides persistent and highly available
   token storage for a several components within OpenAM, including
   user sessions, OAuth 2.0 and SAML 2.0 tokens.
  </p><p>
   Depending on system load and usage, the CTS can produce a
   large quantity of tokens, which can be short lived. This style of
   usage is significantly different form typical LDAP usage. As such,
   systems administrators may be interested in monitoring this usage
   as part of LDAP directory maintenance.
  </p><p>
   The CTS functions only with one external LDAP service, OpenDJ.
  </p><p>
   To that end, the current state of CTS tokens on a system
   can be monitored over SNMP. The current state of different types
   of CTS tokens are associated with different Object Identifiers (OIDs)
   in a Management Information Base (MIB).
  </p><p>
   To enable SNMP, see <a href="../admin-guide/index.html#monitoring-snmp" class="link">
   <em class="citetitle">SNMP Monitoring</em>.</a>
  </p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="cts-monitor-commands"></a>20.2.1.&nbsp;CTS SNMP Monitoring</h3></div></div></div><p>
    Once activated, SNMP monitoring works over UDP by default. You may
    want to install one of many available network monitoring tools. For
    the purpose of this section, basic SNMP service and monitoring tools
    have been installed on a GNU/Linux system. The same commands should
    work on a Mac OS X system.
   </p><p>SNMP depends on labels known as Object Identifiers (OIDs). These
    are uniquely defined labels, organized in tree format. For OpenAM, they
    are configured in a Management Information Base file named
    <a class="link" href="https://svn.forgerock.org/openam/trunk/openam/openam-schema/openam-mib-schema/src/main/resources/mib/FORGEROCK-OPENAM-CTS.mib" target="_blank">
    <code class="filename">FORGEROCK-OPENAM-CTS.mib</code></a>.
   </p><p>
    For detailed information on configured OIDs, see the OpenAM Reference
    chapter on the <a href="../reference/index.html#chap-cts-oids" class="link">
    <em class="citetitle">Core Token Service (CTS) Object Identifiers (OIDs)</em>.
    </a>
   </p><p>
    With the OIDs in hand, you can set up an SNMP server to collect
    the data. You would also need SNMP utility commands with associated
    OIDs to measure the current state of a component. First, to verify
    the operation of SNMP on a GNU/Linux system, over port 8085,
    using SNMP version 2c, run the following command:</p><div class="screen"><pre>
# <strong>snmpstatus -c public -v 2c localhost</strong>
   </pre></div><p>The output should normally specify communications over UDP. If you
   get a <code class="literal">timeout</code> message, the SNMP service may not be
   running.</p><p>You can get the value for a specific OID. For example, the
    following command would retrieve the cumulative count for CTS
    create operations, over port 8085:</p><div class="screen"><pre>
# <strong>snmpget -c public -v 2c :8085 enterprises.36733.1.2.3.3.1.1.1</strong>
   </pre></div><p>
    For one view of the tree of OIDs, you can use the
    <span class="command"><strong>snmpwalk</strong></span> command. For example, the following command
    lists all OIDs related to CTS:
   </p><div class="screen"><pre>
# <strong>snmpwalk -c public -v 2c :8085 enterprises.36733.1.2.3</strong>
   </pre></div><p>
    A number of CTS OIDs are listed with a <code class="literal">Counter64</code> value.
    As defined in <a class="link" href="http://tools.ietf.org/search/rfc2578#section-7.1.10" target="_blank">
    <em class="citetitle">RFC 2578</em>,</a> an OID so configured has a maximum
    value of <code class="literal">2^64 - 1</code>.
   </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="snmp-policy-evaluation"></a>20.2.2.&nbsp;SNMP Monitoring For Policy Evaluation</h3></div></div></div><a class="indexterm" name="d16037e32401"></a><p>
    You can monitor policy evaluation performance over SNMP.
    OpenAM records statistics for up to
    a number of recent policy evaluation requests.
    (You can configure the number in OpenAM Console
    under Configuration &gt; System &gt; Monitoring.
    For details, see the system configuration reference section,
    <a href="../reference/index.html#system-monitoring" class="link"><em class="citetitle">Monitoring</em></a>.)
   </p><p>
    Interface Stability:
    <a href="../admin-guide/index.html#interface-stability" class="link">Evolving</a>
   </p><p>
    As described in <a class="xref" href="#cts-monitor-commands" title="20.2.1.&nbsp;CTS SNMP Monitoring">Section&nbsp;20.2.1, &#8220;CTS SNMP Monitoring&#8221;</a>,
    SNMP uses OIDs defined in a Management Information Base (MIB) file
    that specifies the statistics OpenAM keeps for policy evaluation operations,
    <a class="link" href="https://svn.forgerock.org/openam/trunk/openam/openam-schema/openam-mib-schema/src/main/resources/mib/FORGEROCK-OPENAM-POLICY.mib" target="_blank"><code class="filename">FORGEROCK-OPENAM-POLICY.mib</code></a>.
    Adapt the examples in <a class="xref" href="#cts-monitor-commands" title="20.2.1.&nbsp;CTS SNMP Monitoring">Section&nbsp;20.2.1, &#8220;CTS SNMP Monitoring&#8221;</a>
    to read monitoring statistics about policy evaluation on the command line.
   </p><p>
    When monitoring is active, OpenAM records statistics about
    both the numbers and rates of policy evaluations performed,
    and also the times taken to process policy evaluations.
   </p><p>
    The statistics are all read-only.
    The base OID for policy evaluation statistics is
    <code class="literal">enterprises.36733.1.2.2.1</code>.
    The following table describes the values that you can read.
   </p><div class="table"><a name="snmp-policy-evaluation-oids"></a><div class="table-title">Table&nbsp;20.1.&nbsp;OIDs Used in SNMP Monitoring For Policy Evaluation</div><div class="table-contents"><table summary="OIDs Used in SNMP Monitoring For Policy Evaluation" border="0"><colgroup><col width="40%"><col width="40%"><col width="20%"></colgroup><thead><tr><th>OID</th><th>Description</th><th>Syntax</th></tr></thead><tbody><tr><td>
        <p>
         <code class="literal">enterprises.36733.1.2.2.1.1.1</code>
        </p>
       </td><td>
        <p>
         Cumulative number of policy evaluations for specific resources (self)
        </p>
       </td><td>
        <p>
         <code class="literal">Counter64</code>
        </p>
       </td></tr><tr><td>
        <p>
         <code class="literal">enterprises.36733.1.2.2.1.1.2</code>
        </p>
       </td><td>
        <p>
         Average rate of policy evaluations for specific resources (self)
        </p>
       </td><td>
        <p>
         <code class="literal">Counter64</code>
        </p>
       </td></tr><tr><td>
        <p>
         <code class="literal">enterprises.36733.1.2.2.1.1.3</code>
        </p>
       </td><td>
        <p>
         Minimum rate of policy evaluations for specific resources (self)
        </p>
       </td><td>
        <p>
         <code class="literal">Counter64</code>
        </p>
       </td></tr><tr><td>
        <p>
         <code class="literal">enterprises.36733.1.2.2.1.1.4</code>
        </p>
       </td><td>
        <p>
         Maximum rate of policy evaluations for specific resources (self)
        </p>
       </td><td>
        <p>
         <code class="literal">Counter64</code>
        </p>
       </td></tr><tr><td>
        <p>
         <code class="literal">enterprises.36733.1.2.2.1.2.1</code>
        </p>
       </td><td>
        <p>
         Cumulative number of policy evaluations for a tree of resources (subtree)
        </p>
       </td><td>
        <p>
         <code class="literal">Counter64</code>
        </p>
       </td></tr><tr><td>
        <p>
         <code class="literal">enterprises.36733.1.2.2.1.2.2</code>
        </p>
       </td><td>
        <p>
         Average rate of policy evaluations for a tree of resources (subtree)
        </p>
       </td><td>
        <p>
         <code class="literal">Counter64</code>
        </p>
       </td></tr><tr><td>
        <p>
         <code class="literal">enterprises.36733.1.2.2.1.2.3</code>
        </p>
       </td><td>
        <p>
         Minimum rate of policy evaluations for a tree of resources (subtree)
        </p>
       </td><td>
        <p>
         <code class="literal">Counter64</code>
        </p>
       </td></tr><tr><td>
        <p>
         <code class="literal">enterprises.36733.1.2.2.1.2.4</code>
        </p>
       </td><td>
        <p>
         Maximum rate of policy evaluations for a tree of resources (subtree)
        </p>
       </td><td>
        <p>
         <code class="literal">Counter64</code>
        </p>
       </td></tr><tr><td>
        <p>
         <code class="literal">enterprises.36733.1.2.2.1.2.1.1</code>
        </p>
       </td><td>
        <p>
         Average length of time to evaluate a policy for a specific resource (self)
        </p>
       </td><td>
        <p>
         <code class="literal">Counter64</code>
        </p>
       </td></tr><tr><td>
        <p>
         <code class="literal">enterprises.36733.1.2.2.1.2.1.2</code>
        </p>
       </td><td>
        <p>
         Slowest evaluation time for a specific resource (self)
        </p>
       </td><td>
        <p>
         <code class="literal">SnmpAdminString</code>
        </p>
       </td></tr><tr><td>
        <p>
         <code class="literal">enterprises.36733.1.2.2.1.2.2.1</code>
        </p>
       </td><td>
        <p>
         Average length of time to evaluate a policy for a tree of resources (subtree)
        </p>
       </td><td>
        <p>
         <code class="literal">Counter64</code>
        </p>
       </td></tr><tr><td>
        <p>
         <code class="literal">enterprises.36733.1.2.2.1.2.2.2</code>
        </p>
       </td><td>
        <p>
         Slowest evaluation time for a tree of resources (subtree)
        </p>
       </td><td>
        <p>
         <code class="literal">SnmpAdminString</code>
        </p>
       </td></tr><tr><td>
        <p>
         <code class="literal">enterprises.36733.1.2.2.1.3.1</code>
        </p>
       </td><td>
        <p>
         Slowest individual policy evaluation time overall
        </p>
       </td><td>
        <p>
         <code class="literal">SnmpAdminString</code>
        </p>
       </td></tr></tbody></table></div></div><br class="table-break"></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="snmp-sessions"></a>20.2.3.&nbsp;SNMP Monitoring For Sessions</h3></div></div></div><a class="indexterm" name="d16037e32739"></a><p>
    You can monitor session statistics over SNMP.
    OpenAM records statistics for up to
    a configurable number of recent sessions.
    (You can configure the number in OpenAM Console
    under Configuration &gt; System &gt; Monitoring.
    For details, see the system configuration reference section,
    <a href="../reference/index.html#system-monitoring" class="link"><em class="citetitle">Monitoring</em></a>.)
   </p><p>
    Interface Stability:
    <a href="../admin-guide/index.html#interface-stability" class="link">Evolving</a>
   </p><p>
    As described in <a class="xref" href="#cts-monitor-commands" title="20.2.1.&nbsp;CTS SNMP Monitoring">Section&nbsp;20.2.1, &#8220;CTS SNMP Monitoring&#8221;</a>,
    SNMP uses OIDs defined in a Management Information Base (MIB) file
    that specifies the statistics OpenAM keeps for policy evaluation operations,
    <a class="link" href="https://svn.forgerock.org/openam/trunk/openam/openam-schema/openam-mib-schema/src/main/resources/mib/FORGEROCK-OPENAM-SESSION.mib" target="_blank"><code class="filename">FORGEROCK-OPENAM-SESSION.mib</code></a>.
    Adapt the examples in <a class="xref" href="#cts-monitor-commands" title="20.2.1.&nbsp;CTS SNMP Monitoring">Section&nbsp;20.2.1, &#8220;CTS SNMP Monitoring&#8221;</a>
    to read monitoring statistics about sessions on the command line.
   </p><p>
    When monitoring is active, OpenAM records statistics about
    both the numbers of internal, remote, and CTS sessions,
    and also the times taken to process sessions.
   </p><p>
    The statistics are all read-only.
    The base OID for session statistics is
    <code class="literal">enterprises.36733.1.2.1</code>.
    Times are expressed in nanoseconds rather than milliseconds,
    as many operations take less than one millisecond.
    The following table describes the values that you can read.
   </p><div class="table"><a name="snmp-sessions-oids"></a><div class="table-title">Table&nbsp;20.2.&nbsp;OIDs Used in SNMP Monitoring For Sessions</div><div class="table-contents"><table summary="OIDs Used in SNMP Monitoring For Sessions" border="0"><colgroup><col width="40%"><col width="40%"><col width="20%"></colgroup><thead><tr><th>OID</th><th>Description</th><th>Syntax</th></tr></thead><tbody><tr><td>
        <p>
         <code class="literal">enterprises.36733.1.2.1.1.1</code>
        </p>
       </td><td>
        <p>
         Total number of current internal sessions
        </p>
       </td><td>
        <p>
         <code class="literal">Counter64</code>
        </p>
       </td></tr><tr><td>
        <p>
         <code class="literal">enterprises.36733.1.2.1.1.2</code>
        </p>
       </td><td>
        <p>
         Average time it takes to refresh an internal session
        </p>
       </td><td>
        <p>
         <code class="literal">Counter64</code>
        </p>
       </td></tr><tr><td>
        <p>
         <code class="literal">enterprises.36733.1.2.1.1.3</code>
        </p>
       </td><td>
        <p>
         Average time it takes to logout an internal session
        </p>
       </td><td>
        <p>
         <code class="literal">Counter64</code>
        </p>
       </td></tr><tr><td>
        <p>
         <code class="literal">enterprises.36733.1.2.1.1.4</code>
        </p>
       </td><td>
        <p>
         Average time it takes to destroy an internal session
        </p>
       </td><td>
        <p>
         <code class="literal">Counter64</code>
        </p>
       </td></tr><tr><td>
        <p>
         <code class="literal">enterprises.36733.1.2.1.1.5</code>
        </p>
       </td><td>
        <p>
         Average time it takes to set a property on an internal session
        </p>
       </td><td>
        <p>
         <code class="literal">Counter64</code>
        </p>
       </td></tr><tr><td>
        <p>
         <code class="literal">enterprises.36733.1.2.1.2.1</code>
        </p>
       </td><td>
        <p>
         Total number of current remote sessions
        </p>
       </td><td>
        <p>
         <code class="literal">Counter64</code>
        </p>
       </td></tr><tr><td>
        <p>
         <code class="literal">enterprises.36733.1.2.1.2.2</code>
        </p>
       </td><td>
        <p>
         Average time it takes to refresh a remote session
        </p>
       </td><td>
        <p>
         <code class="literal">Counter64</code>
        </p>
       </td></tr><tr><td>
        <p>
         <code class="literal">enterprises.36733.1.2.1.2.3</code>
        </p>
       </td><td>
        <p>
         Average time it takes to logout a remote session
        </p>
       </td><td>
        <p>
         <code class="literal">Counter64</code>
        </p>
       </td></tr><tr><td>
        <p>
         <code class="literal">enterprises.36733.1.2.1.2.4</code>
        </p>
       </td><td>
        <p>
         Average time it takes to destroy a remote session
        </p>
       </td><td>
        <p>
         <code class="literal">Counter64</code>
        </p>
       </td></tr><tr><td>
        <p>
         <code class="literal">enterprises.36733.1.2.1.2.5</code>
        </p>
       </td><td>
        <p>
         Average time it takes to set a property on a remote session
        </p>
       </td><td>
        <p>
         <code class="literal">Counter64</code>
        </p>
       </td></tr><tr><td>
        <p>
         <code class="literal">enterprises.36733.1.2.1.3.1</code>
        </p>
       </td><td>
        <p>
         Total number of sessions currently in the Core Token Service (CTS)
        </p>
       </td><td>
        <p>
         <code class="literal">Counter64</code>
        </p>
       </td></tr><tr><td>
        <p>
         <code class="literal">enterprises.36733.1.2.1.3.2</code>
        </p>
       </td><td>
        <p>
         Average time it takes to refresh a CTS session
        </p>
       </td><td>
        <p>
         <code class="literal">Counter64</code>
        </p>
       </td></tr><tr><td>
        <p>
         <code class="literal">enterprises.36733.1.2.1.3.3</code>
        </p>
       </td><td>
        <p>
         Average time it takes to logout a CTS session
        </p>
       </td><td>
        <p>
         <code class="literal">Counter64</code>
        </p>
       </td></tr><tr><td>
        <p>
         <code class="literal">enterprises.36733.1.2.1.3.4</code>
        </p>
       </td><td>
        <p>
         Average time it takes to destroy a CTS session
        </p>
       </td><td>
        <p>
         <code class="literal">Counter64</code>
        </p>
       </td></tr><tr><td>
        <p>
         <code class="literal">enterprises.36733.1.2.1.3.5</code>
        </p>
       </td><td>
        <p>
         Average time it takes to set a property on a CTS session
        </p>
       </td><td>
        <p>
         <code class="literal">Counter64</code>
        </p>
       </td></tr></tbody></table></div></div><br class="table-break"></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="is-openam-alive"></a>20.3.&nbsp;Is OpenAM Running?</h2></div></div></div><a class="indexterm" name="d16037e33121"></a><p>You can check over HTTP whether OpenAM is up, using
  <code class="filename">isAlive.jsp</code>. Point your application to the file
  under the OpenAM URL, such as
  <code class="literal">http://openam.example.com:8080/openam/isAlive.jsp</code>.</p><p>If you get a success code (with <code class="literal">Server is ALIVE:</code> in
  the body of the page returned), then OpenAM is in operation.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="debug-logging"></a>20.4.&nbsp;Debug Logging</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="#log-debug-levels">20.4.1. Setting Debug Logging Levels</a></span></dt><dt><span class="section"><a href="#log-debug-single-file">20.4.2. Debug Logging to a Single File</a></span></dt><dt><span class="section"><a href="#log-debug-selective-capture">20.4.3. Debug Logging by Service</a></span></dt><dt><span class="section"><a href="#log-rotate-debug">20.4.4. Rotating Debug Logs</a></span></dt></dl></div><a class="indexterm" name="d16037e33142"></a><p>
   OpenAM services capture a variety of information in debug logs.
   Unlike audit log records, debug log records are unstructured.
   Debug logs contain a variety of types of information that is useful
   when troubleshooting OpenAM, including stack traces.
   The level of debug log record output is configurable.
   Debug log records are always written to flat files.
  </p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="log-debug-levels"></a>20.4.1.&nbsp;Setting Debug Logging Levels</h3></div></div></div><a class="indexterm" name="d16037e33152"></a><p>
    To adjust the debug level while OpenAM is running, login to the OpenAM
    console as OpenAM administrator, and browse to Configuration &gt; Servers
    and Sites &gt; <em class="replaceable"><code>Server Name</code></em> &gt; General, and then
    scroll down to Debugging. The default level for debug logging is Error.
    This level is appropriate for normal production operations, in which case
    no debug log messages are expected.
   </p><p>
    Setting the debug log level to Warning increases the volume of messages.
    Setting the debug log level to Message dumps detailed trace messages. Unless
    told to do so by qualified support personnel, do not use Warning and Message
    levels in production.
   </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="log-debug-single-file"></a>20.4.2.&nbsp;Debug Logging to a Single File</h3></div></div></div><a class="indexterm" name="d16037e33167"></a><p>
    During development, you might find it useful to log all debug messages
    to a single file. In order to do so, set Merge Debug Files to
    <code class="literal">on</code>.
   </p><p>
    After changing this setting, restart OpenAM or the container in which
    it runs for the change to take effect.
   </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="log-debug-selective-capture"></a>20.4.3.&nbsp;Debug Logging by Service</h3></div></div></div><a class="indexterm" name="d16037e33182"></a><p>OpenAM lets you capture debug log messages selectively for a specific
   service. This can be useful when you must turn on debugging in a production
   system where you want to avoid excessive logging, but must gather messages
   when you reproduce a problem.</p><div class="orderedlist"><p>Perform these steps to capture debug messages for a specific
    service.</p><ol class="orderedlist" type="1"><li class="listitem"><p>Login to OpenAM console as administrator,
     <code class="literal">amadmin</code>.</p></li><li class="listitem"><p>Browse to <code class="filename">Debug.jsp</code>, for example
     <code class="literal">http://openam.example.com:8080/openam/Debug.jsp</code>.</p><p>No links to this page are provided in the console.</p></li><li class="listitem"><p>Select the service to debug and also the level required given the
     hints provided in the <code class="filename">Debug.jsp</code> page.</p><p>The change takes effect immediately.</p></li><li class="listitem"><p>Promptly reproduce the problem you are investigating.</p></li><li class="listitem"><p>After reproducing the problem, immediately return to the
     <code class="filename">Debug.jsp</code> page, and revert to normal log levels
     to avoid filling up the disk where debug logs are stored.</p></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="log-rotate-debug"></a>20.4.4.&nbsp;Rotating Debug Logs</h3></div></div></div><a class="indexterm" name="d16037e33229"></a><p>By default OpenAM does not rotate debug logs. To rotate debug logs,
   edit <code class="filename">WEB-INF/classes/debugconfig.properties</code> where
   OpenAM is deployed.</p><div class="variablelist"><p>The <code class="filename">debugconfig.properties</code> file includes
    the following properties.</p><dl class="variablelist"><dt><span class="term"><code class="literal">org.forgerock.openam.debug.prefix</code></span></dt><dd><p>This property specifies the debug log file prefix applied when
      OpenAM rotates a debug log file. The property has no default. It takes
      a string as the property value.</p></dd><dt><span class="term"><code class="literal">org.forgerock.openam.debug.suffix</code></span></dt><dd><p>This property specifies the debug log file suffix applied when
      OpenAM rotates a debug log file. The property takes a
      <code class="literal">SimpleDateFormat</code> string. The default is
      <code class="literal">-MM.dd.yyyy-kk.mm</code>.</p></dd><dt><span class="term"><code class="literal">org.forgerock.openam.debug.rotation</code></span></dt><dd><p>This property specifies an interval in minutes between debug
      log rotations. Set this to a value greater than zero to enable debug
      log rotation.</p></dd></dl></div><p>After you edit the <code class="filename">debugconfig.properties</code> file,
   you must restart OpenAM or the web container where it runs for the changes
   to take effect.</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="session-mgmt"></a>20.5.&nbsp;Session Management</h2></div></div></div><a class="indexterm" name="d16037e33280"></a><p>OpenAM console lets the administrator view and manage current
  user sessions under the Sessions tab page.</p><div class="mediaobject" align="center"><a name="figure-session-management"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/session-management.png" align="middle" height="360" alt="Session management tab page"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-session-management.html" target="longdesc">D</a>]</span></div></div><p>To end a user session manually, select the user's session, and then
  click the Invalidate Session button. As a result, the user has to
  authenticate again.</p><div class="note"><h3 class="title">Note</h3><p>Deleting a user does not automatically remove any of the user's sessions.
      After deleting a user, check for any sessions for the user and remove them under the Console's Sessions tab.
      </p></div></div></div><div lang="en" class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="chap-tuning"></a>Chapter&nbsp;21.&nbsp;Tuning OpenAM</h1></div></div></div><div class="toc"><div class="toc-title">Table of Contents</div><dl class="toc"><dt><span class="section"><a href="#tuning-openam-server">21.1. OpenAM Server Settings</a></span></dt><dt><span class="section"><a href="#tuning-jvm-for-openam">21.2. Java Virtual Machine Settings</a></span></dt><dt><span class="section"><a href="#caching">21.3. Caching in OpenAM</a></span></dt></dl></div><a class="indexterm" name="d16037e33302"></a><p>This chapter covers key OpenAM tunings to ensure smoothly performing
 access and federation management services, and to maximize throughput while
 minimizing response times.</p><div class="note"><h3 class="title">Note</h3><p>The recommendations provided here are guidelines for your testing
  rather than hard and fast rules for every situation. Said another way, the
  fact that a given setting is configurable implies that no one setting is
  right in all circumstances.</p><p>The extent to which performance tuning advice applies depends to a large
  extent on your requirements, on your workload, and on what resources you have
  available. Test suggestions before rolling them out into production.</p></div><p>As a rule of thumb, an OpenAM server in production with a 3 GB heap can
 handle 100,000 sessions. Although you might be tempted to use a larger heap
 with a 64-bit JVM, smaller heaps are easier to manage. Thus, rather than
 scaling single servers up to increase the total number of simultaneous
 sessions, consider scaling out by adding more servers instead. The suggestions
 that follow pertain to production servers.</p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="tuning-openam-server"></a>21.1.&nbsp;OpenAM Server Settings</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="#tuning-general-settings">21.1.1. General Settings</a></span></dt><dt><span class="section"><a href="#tuning-ldap-settings">21.1.2. LDAP Settings</a></span></dt><dt><span class="section"><a href="#tuning-notification-settings">21.1.3. Notification Settings</a></span></dt><dt><span class="section"><a href="#tuning-session-settings">21.1.4. Session Settings</a></span></dt></dl></div><p>OpenAM has a number of settings that can be tuned to increase
  performance.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="tuning-general-settings"></a>21.1.1.&nbsp;General Settings</h3></div></div></div><p>The following general points apply.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Set debug level to <code class="literal">error</code>.</p></li><li class="listitem"><p>Disable session failover debugging.</p></li><li class="listitem"><p>Set container-level logging to a low level such as
     <code class="literal">error</code> or <code class="literal">severe</code>.</p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="tuning-ldap-settings"></a>21.1.2.&nbsp;LDAP Settings</h3></div></div></div><p>
    Tune your LDAP data stores, your LDAP authentication modules,
    and connection pools for CTS and configuration stores.
   </p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="tuning-ldap-settings-data-stores"></a>21.1.2.1.&nbsp;Tuning LDAP Data Store Settings</h4></div></div></div><p>To change LDAP data store settings, browse to Access Control &gt;
    <em class="replaceable"><code>Realm Name</code></em> &gt; Data Stores &gt;
    <em class="replaceable"><code>Data Store Name</code></em> in the OpenAM console.
    Each data store has its own connection pool and therefore each data store
    needs its own tuning.</p><div class="table"><a name="tuning-ldap-data-store-settings"></a><div class="table-title">Table&nbsp;21.1.&nbsp;LDAP Data Store Settings</div><div class="table-contents"><table summary="LDAP Data Store Settings" width="100%" border="0"><colgroup><col width="33%"><col width="16%"><col width="51%"></colgroup><thead><tr><th>Property</th><th>Default Value</th><th>Suggestions</th></tr></thead><tbody><tr><td>LDAP Connection Pool Minimum Size</td><td>1</td><td>
         <p>The minimum LDAP connection pool size; a good tuning value
         for this property is 10.</p>
         <p>(<code class="literal">sun-idrepo-ldapv3-config-connection_pool_min_size</code>)</p>
        </td></tr><tr><td>LDAP Connection Pool Maximum Size</td><td>10</td><td>
         <p>The maximum LDAP connection pool size; a high tuning value
         for this property is 65, though you might well be able to reduce this
         for your deployment. Ensure your LDAP server can cope with the maximum
         number of clients across all the OpenAM servers.</p>
         <p>(<code class="literal">sun-idrepo-ldapv3-config-connection_pool_max_size</code>)</p>
        </td></tr></tbody></table></div></div><br class="table-break"></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="tuning-ldap-settings-auth-modules"></a>21.1.2.2.&nbsp;Tuning LDAP Authentication Module Settings</h4></div></div></div><p>To change connection pool settings for the LDAP authentication module,
    browse to Configuration &gt; Authentication &gt; Core in the OpenAM
    console.</p><div class="table"><a name="tuning-ldap-authentication-module-settings"></a><div class="table-title">Table&nbsp;21.2.&nbsp;LDAP Authentication Module Setting</div><div class="table-contents"><table summary="LDAP Authentication Module Setting" width="100%" border="0"><colgroup><col width="33%"><col width="16%"><col width="51%"></colgroup><thead><tr><th>Property</th><th>Default Value</th><th>Suggestions</th></tr></thead><tbody><tr><td>Default LDAP Connection Pool Size</td><td>1:10</td><td>
         <p>The minimum and maximum LDAP connection pool used by the
         LDAP authentication module. This should be tuned to 10:65 for
         production.</p>
         <p>(<code class="literal">iplanet-am-auth-ldap-connection-pool-default-size</code>)</p>
        </td></tr></tbody></table></div></div><br class="table-break"></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="tuning-ldap-settings-cts"></a>21.1.2.3.&nbsp;Tuning LDAP CTS &amp; Configuration Store Settings</h4></div></div></div><p>
     When tuning LDAP connection pool settings for the Core Token Service (CTS),
     what you change depends on whether the directory service backing the CTS
     is the same directory service backing OpenAM configuration.
    </p><p>
     When the same directory service backs
     both the CTS and also OpenAM configuration (the default),
     then the same connection pool is shared for any LDAP operations requested
     by the CTS or by a service accessing the OpenAM configuration.
     In this case, one connection is reserved for cleanup of expired CTS tokens.
     Roughly half of the connections are allocated for CTS operations,
     to the nearest power of two.<a href="#ftn.d16037e33453" class="footnote" name="d16037e33453"><sup class="footnote">[11]</sup></a>
     The remaining connections are allocated
     to services accessing the OpenAM configuration.
     For a default configuration,
     where the maximum number of connections in the pool is 10,
     1 connection is allocated for cleanup of expired CTS tokens,
     4 connections are allocated for other CTS operations,
     and 5 connections are allocated for services accessing the configuration.
     If the Maximum Connection Pool size is 20,
     1 connection is allocated for cleanup of expired CTS tokens,
     8 connections are allocated for other CTS operations,
     and 11 connections are allocated for services accessing the configuration.
     If the pool size is 65, then the numbers are 1, 32, and 32, and so on.
    </p><p>
     The minimum number of connections is 6.
    </p><p>
     When the directory service backing the CTS is external
     (differs from the directory service backing the OpenAM configuration)
     then the connection pool used to access the directory service for the CTS
     is separate from the pool used to access the directory service
     for the OpenAM configuration.
     One connection is reserved for cleanup of expired CTS tokens.
     Remaining connections are allocated for CTS operations
     such that the number of connections allocated is equal to a power of two.
     In this case, set the maximum number of connections to 2^n+1,
     as in 9, 17, 33, 65, and so forth.
    </p><p>
     If the same directory service backs
     both the CTS and also OpenAM configuration,
     then set pool sizes under
     Configuration &gt; Servers and Sites &gt; <em class="replaceable"><code>server name</code></em>
     &gt; Directory Configuration.
    </p><p>
     If the directory service backing the CTS is external
     (differs from the directory service backing the OpenAM configuration),
     then set the maximum connection pool size under
     Configuration &gt; Servers and Sites &gt; <em class="replaceable"><code>server name</code></em>
     &gt; CTS &gt; External Store Configuration.
    </p><p>
     In both cases, if you must change the default connection timeouts,
     set the advanced properties described below under
     Configuration &gt; Servers and Sites &gt; <em class="replaceable"><code>server name</code></em>
     &gt; Advanced.
    </p><div class="table"><a name="tuning-ldap-cts-settings"></a><div class="table-title">Table&nbsp;21.3.&nbsp;CTS Store LDAP Connection Pool Settings</div><div class="table-contents"><table summary="CTS Store LDAP Connection Pool Settings" width="100%" border="0"><colgroup><col width="33%"><col width="16%"><col width="51%"></colgroup><thead><tr><th>Property</th><th>Default Value</th><th>Suggestions</th></tr></thead><tbody><tr><td>Maximum Connection Pool</td><td>10</td><td>
         <p>
          Find this setting in OpenAM console under
          Configuration &gt; Servers and Sites &gt; <em class="replaceable"><code>server name</code></em>
          &gt; Directory Configuration.
         </p>

         

         <p>
          When the same directory service backs
          both the CTS and also OpenAM configuration,
          consider increasing this to at least 19
          to allow 9 connections for the CTS,
          and 10 connections for access to the OpenAM configuration
          (including for example looking up policies).
         </p>
        </td></tr><tr><td>Max Connections</td><td>10</td><td>
         <p>
          Find this setting in OpenAM console under
          Configuration &gt; Servers and Sites &gt; <em class="replaceable"><code>server name</code></em>
          &gt; CTS &gt; External Store Configuration.
         </p>

         <p>
          When the directory service backing the CTS is external
          and the load on the CTS is high,
          consider setting this to 2^n+1, where n = 4, 5, 6, and so on.
          In other words, try setting this to 17, 33, 65, and so on
          when testing performance under load.
         </p>

         <p>
          (<code class="literal">org-forgerock-services-cts-store-max-connections</code>)
         </p>
        </td></tr><tr><td>CTS connection timeout (advanced property)</td><td>10 (seconds)</td><td>
         <p>
          Most CTS requests to the directory server are handled quickly,
          so the default timeout is fine for most cases.
         </p>

         <p>
          If you choose to vary this setting for performance testing,
          set the advanced property,
          <code class="literal">org.forgerock.services.datalayer.connection.timeout.cts.async</code>,
          under Configuration &gt; Servers and Sites &gt; <em class="replaceable"><code>server name</code></em>
          &gt; Advanced.
         </p>

         <p>
          You must restart OpenAM or the container in which it runs
          for changes to take effect.
         </p>
        </td></tr><tr><td>CTS reaper timeout (advanced property)</td><td>None</td><td>
         <p>
          The CTS token cleanup connection generally should not time out
          as it is used to request long-running queries
          that can return many results.
         </p>

         <p>
          If you choose to vary this setting for performance testing,
          set the advanced property,
          <code class="literal">org.forgerock.services.datalayer.connection.timeout.cts.reaper</code>,
          to the number of seconds desired
          under Configuration &gt; Servers and Sites &gt; <em class="replaceable"><code>server name</code></em>
          &gt; Advanced.
         </p>

         <p>
          You must restart OpenAM or the container in which it runs
          for changes to take effect.
         </p>
        </td></tr><tr><td>Configuration management connection timeout (advanced property)</td><td>10 (seconds)</td><td>
         <p>
          Most configuration management requests to the directory server
          are handled quickly, so the default timeout is fine for most cases.
         </p>

         <p>
          If you choose to vary this setting for performance testing,
          set the advanced property,
          <code class="literal">org.forgerock.services.datalayer.connection.timeout</code>,
          under Configuration &gt; Servers and Sites &gt; <em class="replaceable"><code>server name</code></em>
          &gt; Advanced.
         </p>

         <p>
          You must restart OpenAM or the container in which it runs
          for changes to take effect.
         </p>
        </td></tr></tbody></table></div></div><br class="table-break"></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="tuning-notification-settings"></a>21.1.3.&nbsp;Notification Settings</h3></div></div></div><p>OpenAM has two thread pools used to send notifications to clients. The
   Service Management Service thread pool can be tuned in OpenAM console under
   Configuration &gt; Servers and Sites &gt; Default Server Settings &gt;
   SDK.</p><div class="table"><a name="tuning-sms-notifications"></a><div class="table-title">Table&nbsp;21.4.&nbsp;SMS Notification Setting</div><div class="table-contents"><table summary="SMS Notification Setting" width="100%" border="0"><colgroup><col width="33%"><col width="16%"><col width="51%"></colgroup><thead><tr><th>Property</th><th>Default Value</th><th>Suggestions</th></tr></thead><tbody><tr><td>Notification Pool Size</td><td>10</td><td>
        <p>This is the size of the thread pool used to send notifications.
        In production this value should be fine unless lots of
        clients are registering for SMS notifications.</p>
        <p>(<code class="literal">com.sun.identity.sm.notification.threadpool.size</code>)</p>
       </td></tr></tbody></table></div></div><br class="table-break"><p>The session service has its own thread pool to send notifications.
   This is configured under Configuration &gt; Servers and Sites &gt; Default
   Server Settings &gt; Session.</p><div class="table"><a name="tuning-session-service-notifications"></a><div class="table-title">Table&nbsp;21.5.&nbsp;Session Service Notification Settings</div><div class="table-contents"><table summary="Session Service Notification Settings" width="100%" border="0"><colgroup><col width="33%"><col width="16%"><col width="51%"></colgroup><thead><tr><th>Property</th><th>Default Value</th><th>Suggestions</th></tr></thead><tbody><tr><td>Notification Pool Size</td><td>10</td><td>
        <p>This is the size of the thread pool used to send notifications.
        In production this should be around 25-30.</p>
        <p>(<code class="literal">com.iplanet.am.notification.threadpool.size</code>)</p>
       </td></tr><tr><td>Notification Thread Pool Threshold</td><td>5000</td><td>
        <p>This is the maximum number of notifications in the queue waiting
        to be sent. The default value should be fine in the majority of
        installations.</p>
        <p>(<code class="literal">com.iplanet.am.notification.threadpool.threshold</code>)</p>
       </td></tr></tbody></table></div></div><br class="table-break"></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="tuning-session-settings"></a>21.1.4.&nbsp;Session Settings</h3></div></div></div><p>The session service has additional properties to tune, which are
   configured under Configuration &gt; Servers and Sites &gt; Default
   Server Settings &gt; Session.</p><div class="table"><a name="tuning-session-service-settings"></a><div class="table-title">Table&nbsp;21.6.&nbsp;Session Settings</div><div class="table-contents"><table summary="Session Settings" width="100%" border="0"><colgroup><col width="33%"><col width="16%"><col width="51%"></colgroup><thead><tr><th>Property</th><th>Default Value</th><th>Suggestions</th></tr></thead><tbody><tr><td>Maximum Sessions</td><td>5000</td><td>
        <p>In production this value can safely be set into the 100,000s.
        The maximum session limit is really controlled by the maximum size of
        the JVM heap which must be tuned appropriately to match the expected
        number of concurrent sessions.</p>
        <p>(<code class="literal">com.iplanet.am.session.maxSessions</code>)</p>
       </td></tr><tr><td>Sessions Purge Delay</td><td>0</td><td>
        <p>This should be zero to ensure sessions are purged immediately.</p>
        <p>(<code class="literal">com.iplanet.am.session.purgedelay</code>)</p>
       </td></tr></tbody></table></div></div><br class="table-break"></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="tuning-jvm-for-openam"></a>21.2.&nbsp;Java Virtual Machine Settings</h2></div></div></div><p>This section gives some initial guidance on configuring the JVM for
  running OpenAM. These settings provide a strong foundation to the JVM before
  a more detailed garbage collection tuning exercise, or as best practice
  configuration for production.</p><div class="table"><a name="tuning-heap-size"></a><div class="table-title">Table&nbsp;21.7.&nbsp;Heap Size Settings</div><div class="table-contents"><table summary="Heap Size Settings" width="100%" border="0"><colgroup><col width="42%"><col width="29%"><col width="29%"></colgroup><thead><tr><th>JVM Parameters</th><th>Suggested Value</th><th>Description</th></tr></thead><tbody><tr><td><p><code class="literal">-Xms</code> &amp;
      <code class="literal">-Xmx</code></p></td><td><p>At least 1024m (2048m with embedded OpenDJ), in production
      environments at least 2048m to 3072m. This setting depends on the available
      physical memory, and on whether a 32 or 64-bit JVM is used.</p></td><td><p>-</p></td></tr><tr><td><p><code class="literal">-server</code></p></td><td><p>-</p></td><td><p>Ensures the server JVM is used</p></td></tr><tr><td><p><code class="literal">-XX:PermSize</code> &amp;
      <code class="literal">-XX:MaxPermSize</code></p></td><td><p>Set both to 256m</p></td><td><p>Controls the size of the permanent generation in the
      JVM</p></td></tr><tr><td><p><code class="literal">-Dsun.net.client.defaultReadTimeout</code></p></td><td><p>60000</p></td><td><p>Controls the read timeout in the Java HTTP client
      implementation</p>
      <p>This applies only to the Sun/Oracle HotSpot JVM.</p></td></tr><tr><td><p><code class="literal">-Dsun.net.client.defaultConnectTimeout</code></p></td><td>High setting: <p>30000</p> (30 seconds)</td><td><p>Controls the connect timeout in the Java HTTP client
      implementation</p>
      <p>When you have hundreds of incoming requests per second, reduce this
      value to avoid a huge connection queue.</p>
      <p>This applies only to the Sun/Oracle HotSpot JVM.</p></td></tr></tbody></table></div></div><br class="table-break"><div class="table"><a name="tuning-garbage-collection"></a><div class="table-title">Table&nbsp;21.8.&nbsp;Garbage Collection Settings</div><div class="table-contents"><table summary="Garbage Collection Settings" width="100%" border="0"><colgroup><col width="42%"><col width="29%"><col width="29%"></colgroup><thead><tr><th>JVM Parameters</th><th>Suggested Value</th><th>Description</th></tr></thead><tbody><tr><td><p><code class="literal">-verbose:gc</code></p></td><td><p>-</p></td><td><p>Verbose garbage collection reporting</p></td></tr><tr><td><p><code class="literal">-Xloggc:</code></p></td><td><p><code class="filename">$CATALINA_HOME/logs/gc.log</code></p></td><td><p>Location of the verbose garbage collection log
      file</p></td></tr><tr><td><p><code class="literal">-XX:+PrintClassHistogram</code></p></td><td><p>-</p></td><td><p>Prints a heap histogram when a SIGTERM signal is received
      by the JVM</p></td></tr><tr><td><p><code class="literal">-XX:+PrintGCDetails</code></p></td><td><p>-</p></td><td><p>Prints detailed information about garbage collection</p></td></tr><tr><td><p><code class="literal">-XX:+PrintGCTimeStamps</code></p></td><td><p>-</p></td><td><p>Prints detailed garbage collection timings</p></td></tr><tr><td><p><code class="literal">-XX:+HeapDumpOnOutOfMemoryError</code></p></td><td><p>-</p></td><td><p>Out of Memory errors generate a heap dump
      automatically</p></td></tr><tr><td><p><code class="literal">-XX:HeapDumpPath</code></p></td><td><p><code class="filename">$CATALINA_HOME/logs/heapdump.hprof</code></p></td><td><p>Location of the heap dump</p></td></tr><tr><td><p><code class="literal">-XX:+UseConcMarkSweepGC</code></p></td><td><p>-</p></td><td><p>Use the concurrent mark sweep garbage collector</p></td></tr><tr><td><p><code class="literal">-XX:+UseCMSCompactAtFullCollection</code></p></td><td><p>-</p></td><td><p>Aggressive compaction at full collection</p></td></tr><tr><td><p><code class="literal">-XX:+CMSClassUnloadingEnabled</code></p></td><td><p>-</p></td><td><p>Allow class unloading during CMS sweeps</p></td></tr></tbody></table></div></div><br class="table-break"></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="caching"></a>21.3.&nbsp;Caching in OpenAM</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="#caching-server-settings">21.3.1. Overall Server Cache Settings</a></span></dt><dt><span class="section"><a href="#java-ee-policy-agent-and-sdk-caching">21.3.2. Caching Properties For Java EE Policy Agents &amp; SDK Clients</a></span></dt><dt><span class="section"><a href="#caching-properties">21.3.3. Cache Settings</a></span></dt></dl></div><a class="indexterm" name="d16037e33963"></a><p>OpenAM caches data to avoid having to query user and configuration
  data stores each time it needs the information. By default, OpenAM makes use
  of LDAP persistent search to receive notification of changes to cached data.
  For this reason, caching works best when data are stored in a directory
  server that supports LDAP persistent search.</p><p>OpenAM has two kinds of cache on the server side that you can configure,
  one for configuration data and the other for user data. Generally use the
  default settings for configuration data cache. This section mainly covers the
  configuration choices you have for caching user data.</p><p>OpenAM implements the global user data cache for its user data
   stores.
   Prior to OpenAM 11.0, OpenAM supported a secondary Time-to-Live (TTL)
   data store caching layer, which has since been removed in OpenAM 11.0 and later
   versions.
  </p><p>The user data store also supports a DN Cache, used to cache DN lookups
   that tend to occur in bursts during authentication.
   The DN Cache can become out of date when a user is moved or renamed in the
   underlying LDAP store, events that are not always reflected in a persistent search result.
   You can enable the DN cache when the underlying LDAP store supports persistent
   search and <code class="literal">mod DN</code> operations (that is, move or rename DN).</p><p>The following diagram depicts the two kinds of cache, and also the
   two types of caching available for user data.</p><div class="mediaobject" align="center"><a name="figure-openam-caches"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/openam-caches.png" align="middle" height="360" alt="Caches in OpenAM server"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-openam-caches.html" target="longdesc">D</a>]</span></div></div><p>The rest of this section concerns mainly settings for global user data
  cache and for SDK clients. For a look at data store cache settings, see
  <a class="xref" href="#tuning-ldap-data-store-settings" title="Table&nbsp;21.1.&nbsp;LDAP Data Store Settings">Table&nbsp;21.1, &#8220;LDAP Data Store Settings&#8221;</a>.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="caching-server-settings"></a>21.3.1.&nbsp;Overall Server Cache Settings</h3></div></div></div><p>By default OpenAM has caching enabled both for configuration data and
   also for user data. This setting is governed by the server property
   <code class="literal">com.iplanet.am.sdk.caching.enabled</code>, which by default is
   <code class="literal">true</code>. When you set this advanced property to
   <code class="literal">false</code>, then you can enable caching independently for
   configuration data and for user data.</p><div class="procedure"><a name="turn-off-global-user-data-caching"></a><div class="procedure-title">Procedure&nbsp;21.1.&nbsp;To Turn Off Global User Data Caching</div><p><span class="strong"><strong>Disabling caching can have a severe negative
    impact on performance. This is because, when caching is disabled, OpenAM
    must query a data store each time it needs data.</strong></span></p><p>If, however, you have at least one user data store that does not
    support LDAP persistent search, such as a relational database or an LDAP
    directory server that does not support persistent search, then you must
    disable the <span class="emphasis"><em>global</em></span> cache for user data. Otherwise user
    data caches cannot stay in sync with changes to user data entries.</p><ol class="procedure" type="1"><li class="step"><p>In the OpenAM console, browse to Configuration &gt; Servers and Sites
     &gt; <em class="replaceable"><code>Server Name</code></em> &gt; Advanced.</p></li><li class="step"><p>Set <code class="literal">com.iplanet.am.sdk.caching.enabled</code> to
     <code class="literal">false</code> to disable caching overall.</p></li><li class="step"><p>Set <code class="literal">com.sun.identity.sm.cache.enabled</code> to
     <code class="literal">true</code> to enable configuration data caching.</p><p>All supported configuration data stores support LDAP persistent
     search, so it is safe to enable configuration data caching.</p><p>You must explicitly set this property to <code class="literal">true</code>,
     because setting <code class="literal">com.iplanet.am.sdk.caching.enabled</code> to
     <code class="literal">false</code> in the previous step disables both user and
     configuration data caching.</p></li><li class="step"><p>Save your work.</p></li></ol></div><div class="procedure"><a name="change-max-cache-size"></a><div class="procedure-title">Procedure&nbsp;21.2.&nbsp;To Change the Maximum Size of Global User Data Cache</div><p>With a large user data store and active user base, the number of user
    entries in cache can grow large.</p><ol class="procedure" type="1"><li class="step"><p>In the OpenAM console, browse to Configuration &gt; Servers and Sites
     &gt; Default Server Settings &gt; SDK.</p></li><li class="step"><p>Change the value of SDK Caching Max. Size, and then Save your
     work.</p><p>There is no corresponding setting for configuration data, as the
     number of configuration entries in a large deployment is not likely to
     grow nearly as large as the number of user entries.</p></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="java-ee-policy-agent-and-sdk-caching"></a>21.3.2.&nbsp;Caching Properties For Java EE Policy Agents &amp; SDK Clients</h3></div></div></div><p>Policy agents and other OpenAM SDK clients can also cache user data,
   using most of the same properties as OpenAM server as described in
   <a class="xref" href="#table-cache-properties" title="Table&nbsp;21.9.&nbsp;OpenAM Cache Properties">Table&nbsp;21.9, &#8220;OpenAM Cache Properties&#8221;</a> . Clients however can receive
   updates by notification from OpenAM or, if notification fails, by
   polling OpenAM for changes.</p><div class="procedure"><a name="notify-sdk-cache-updates"></a><div class="procedure-title">Procedure&nbsp;21.3.&nbsp;To Enable Notification &amp; Polling For Client Cache Updates</div><p>This procedure describes how to enable change notification and polling
    for policy agent user data cache updates. When configuring a custom OpenAM
    SDK client using a .properties file, use the same properties as for the
    policy agent configuration.</p><ol class="procedure" type="1"><li class="step"><p>In OpenAM console, browse to Access Control &gt; <em class="replaceable"><code>Realm
     Name</code></em> &gt; Agents &gt; <em class="replaceable"><code>Agent Type</code></em>
     &gt; <em class="replaceable"><code>Agent Name</code></em> to view and edit the policy
     agent profile.</p></li><li class="step"><p>On the Global tab page, check that the Agent Notification URL is
     set.</p><p>When notification is enabled, the agent registers a notification
     listener with OpenAM for this URL.</p><p>The corresponding property is
     <code class="literal">com.sun.identity.client.notification.url</code>.</p></li><li class="step"><p>For any changes you make, Save your work.</p><p>You must restart the policy agent for the changes to take
     effect.</p></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="caching-properties"></a>21.3.3.&nbsp;Cache Settings</h3></div></div></div><p>The table below provides a quick reference, primarily for user data
   cache settings.</p><p>Notice that many properties for configuration data cache have
   <code class="literal">sm</code> (for Service Management) in their names, whereas those
   for user data have <code class="literal">idm</code> (for Identity Management) in their
   names.</p><div class="table"><a name="table-cache-properties"></a><div class="table-title">Table&nbsp;21.9.&nbsp;OpenAM Cache Properties</div><div class="table-contents"><table summary="OpenAM Cache Properties" width="100%" border="0"><colgroup><col width="37%"><col width="38%"><col width="12%"><col width="13%"></colgroup><thead><tr><th>Property</th><th>Description</th><th>Default</th><th>Applies To</th></tr></thead><tbody><tr><td><p><code class="literal">com.iplanet.am.sdk.cache.maxSize</code></p></td><td><p>Maximum number of user entries cached</p></td><td><p>10000</p></td><td><p>Server &amp; SDK</p></td></tr><tr><td><p><code class="literal">com.iplanet.am.sdk.caching.enabled</code></p></td><td>
        <p>Whether to enable caching for both configuration data and also
        for user data.</p>

        <p>If <code class="literal">true</code>, this setting overrides
        <code class="literal">com.sun.identity.idm.cache.enabled</code> and
        <code class="literal">com.sun.identity.sm.cache.enabled</code>.</p>

        <p>If <code class="literal">false</code>, you can enable caching independently
        for configuration data and for user data using the aforementioned
        properties.</p>
       </td><td><p><code class="literal">true</code></p></td><td><p>Server &amp; SDK</p></td></tr><tr><td><p><code class="literal">com.iplanet.am.sdk.remote.pollingTime</code></p></td><td>
        <p>How often in minutes the SDK client such as a policy agent should
        poll OpenAM for modified user data entries.</p>

        <p>The SDK also uses this value to determine the age of the oldest
        changes requested. The oldest changes requested are 2 minutes older than
        this setting. In other words, by default the SDK polls for entries
        changed in the last 3 minutes.</p>

        <p>Set this to 0 or a negative integer to disable polling.</p>
       </td><td><p>1 (minute)</p></td><td><p>SDK</p></td></tr><tr><td><p><code class="literal">com.sun.am.event.notification.expire.time</code></p></td><td>
        <p>How long OpenAM stores a given change to a cached entry, so that
        clients polling for changes do not miss the change.</p>
       </td><td><p>30 (minutes)</p></td><td><p>Server only</p></td></tr><tr><td><p><code class="literal">com.sun.identity.idm.cache.enabled</code></p></td><td>
        <p>If <code class="literal">com.iplanet.am.sdk.caching.enabled</code> is
        <code class="literal">true</code>, this property is ignored.</p>

        <p>Otherwise, set this to <code class="literal">true</code> to enable caching
        of user data.</p>
       </td><td><p><code class="literal">false</code></p></td><td><p>Server &amp; SDK</p></td></tr><tr><td><p><code class="literal">com.sun.identity.idm.cache.entry.default.expire.time</code></p></td><td>
        <p>How many minutes to store a user data entry in the global user
        data cache</p>
       </td><td><p>30 (minutes)</p></td><td><p>Server &amp; SDK</p></td></tr><tr><td><p><code class="literal">com.sun.identity.idm.cache.entry.expire.enabled</code></p></td><td>
        <p>Whether user data entries in the global user data cache should
        expire over time</p>
       </td><td><p><code class="literal">false</code></p></td><td><p>Server &amp; SDK</p></td></tr><tr><td><p><code class="literal">com.sun.identity.idm.remote.notification.enabled</code></p></td><td>
        <p>Whether the SDK client such as a policy agent should register
        a notification listener for user data changes with the OpenAM
        server.</p>

        <p>The SDK client uses the URL specified by
        <code class="literal">com.sun.identity.client.notification.url</code> to register
        the listener so that OpenAM knows where to send notifications.</p>

        <p>If notifications cannot be enabled for some reason, then the SDK
        client falls back to polling for changes.</p>
       </td><td><p><code class="literal">true</code></p></td><td><p>SDK</p></td></tr><tr><td><p><code class="literal">com.sun.identity.sm.cache.enabled</code></p></td><td>
        <p>If <code class="literal">com.iplanet.am.sdk.caching.enabled</code> is
        <code class="literal">true</code>, this property is ignored.</p>

        <p>Otherwise, set this to <code class="literal">true</code> to enable caching
        of configuration data. It is recommended that you always set this to
        <code class="literal">true</code>.</p>
       </td><td><p><code class="literal">false</code></p></td><td><p>Server &amp; SDK</p></td></tr><tr><td><p><code class="literal">sun-idrepo-ldapv3-dncache-enabled</code></p></td><td>
        <p>Set this to <code class="literal">true</code> to enable DN caching
         of user data.</p>
       </td><td><p><code class="literal">false</code></p></td><td><p>Server &amp; SDK</p></td></tr><tr><td><p><code class="literal">sun-idrepo-ldapv3-dncache-size</code></p></td><td>
        <p>Sets the cache size.</p>
       </td><td><p><code class="literal">1500</code></p></td><td><p>Server &amp; SDK</p></td></tr></tbody></table></div></div><br class="table-break"></div></div><div class="footnotes"><br><hr class="footnote-hr"><div id="ftn.d16037e33453" class="footnote"><p><a href="#d16037e33453" class="para"><sup class="para">[11] </sup></a>
       To be precise, the number of connections allocated for CTS operations
       is equal to the power of two that is nearest to
       half the maximum number of connections in the pool.
      </p></div></div></div><div lang="en" class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="chap-change-hosts"></a>Chapter&nbsp;22.&nbsp;Changing Host Names</h1></div></div></div><p>
  When you change the OpenAM host name,
  you must make manual changes to the configuration.
  This chapter describes what to do.
  If you must also
  move an embedded configuration directory from one host to another,
  see the OpenDJ <em class="citetitle">Administration Guide</em> chapter,
  <a class="link" href="http://docs.forgerock.org/en/opendj/2.6.0/admin-guide/#chap-mv-servers" target="_blank"><em class="citetitle">Moving Servers</em></a>.
 </p><div class="itemizedlist"><p>Changing OpenAM host names involves the following high level
  steps.</p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Adding the new host name to the Realm/DNS Aliases list</p></li><li class="listitem"><p>Exporting, editing, then importing the configuration</p><p>
    This step relies on the <span class="command"><strong>ssoadm</strong></span> command,
    which you install separately from OpenAM as described in the procedure,
    <a href="../install-guide/index.html#install-openam-admin-tools" class="link"><em class="citetitle">To Set Up
    Administration Tools</em></a>.
   </p></li><li class="listitem"><p>Stopping OpenAM and editing configuration files</p></li><li class="listitem"><p>Removing the old host name from the Realm/DNS Aliases list</p></li></ul></div><p>
  Before you start,
  make sure you have a current backup of your current installation.
  See <a href="../admin-guide/index.html#chap-backup-restore" class="link"><em class="citetitle">Backing Up and Restoring OpenAM Configurations</em></a>
  for instructions.
 </p><div class="procedure"><a name="add-new-alias"></a><div class="procedure-title">Procedure&nbsp;22.1.&nbsp;To Add the New Host Name As an Alias</div><ol class="procedure" type="1"><li class="step"><p>Login to OpenAM console as administrator,
   <code class="literal">amadmin</code>.</p></li><li class="step"><p>Under Access Control &gt; / (Top Level Realm), add the new host name
   to the Realm/DNS Aliases list, and then save your work.</p></li></ol></div><div class="procedure"><a name="change-host-in-service-config"></a><div class="procedure-title">Procedure&nbsp;22.2.&nbsp;To Export, Edit, &amp; Import the Service Configuration</div><ol class="procedure" type="1"><li class="step"><p>Export the service configuration.</p><div class="screen"><pre>
$ <strong>ssoadm \
 export-svc-cfg \
 --adminid amadmin \
 --encryptsecret myEncryptSecretString1234 \
 --password-file /tmp/pwd.txt \
 --outfile config.xml</strong>

<em>Service Configuration was exported.</em>
   </pre></div><p>OpenAM uses the value entered in <code class="option">--encryptsecret</code> to
    encrypt passwords stored in the backup file. It can be any value,
    and is required when restoring a configuration.</p></li><li class="step"><p>Edit the service configuration file.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Change the fully qualified domain name, such as
     <code class="literal">openam.example.com</code>, throughout the file.</p></li><li class="listitem"><p>
      If you are changing the context path, such as <code class="literal">/openam</code>,
      then make the following changes.
     </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
        Change the value of
        <code class="literal">com.iplanet.am.services.deploymentDescriptor</code>.
       </p></li><li class="listitem"><p>
        Change <em class="replaceable"><code>contextPath</code></em> in the value of the
        <code class="literal">propertiesViewBeanURL="<em class="replaceable"><code>contextPath</code></em>/auth/ACServiceInstanceList"</code>.
       </p></li><li class="listitem"><p>
        Change <em class="replaceable"><code>contextPath</code></em> in the value of
        <code class="literal">propertiesViewBeanURL="<em class="replaceable"><code>contextPath</code></em>/auth/ACModuleList"</code>.
       </p></li><li class="listitem"><p>
        Change the context path in a &lt;Value&gt; element
        that is a child of an &lt;AttributeValuePair&gt; element.
       </p></li><li class="listitem"><p>
        Change the context path where it occurs throughout the file
        in the full URL to OpenAM, such as
        <code class="literal">http:&amp;#47;&amp;#47;openam.example.com:8080&amp;#47;<em class="replaceable"><code>contextPath</code></em></code>.
       </p></li></ul></div></li><li class="listitem"><p>If you are changing the port number, then change the value of
     <code class="literal">com.iplanet.am.server.port</code>.</p><p>Also change the port number in <code class="literal"><em class="replaceable"><code>host</code></em>:<em class="replaceable"><code>port</code></em></code> combinations throughout the
     file.</p></li><li class="listitem"><p>If you are changing the domain name, then change the cookie domain
     such as <code class="literal">&lt;Value&gt;.example.com&lt;/Value&gt;</code>
     throughout the file.</p></li></ul></div></li><li class="step"><p>Import the updated service configuration.</p><div class="screen"><pre>
$ <strong>ssoadm \
 import-svc-cfg \
 --adminid amadmin \
 --encryptsecret myEncryptSecretString1234 \
 --password-file /tmp/pwd.txt \
 --xmlfile config.xml</strong>

<em>Directory Service contains existing data. Do you want to delete it? [y|N]</em> <strong>y</strong>
<em>Please wait while we import the service configuration...
Service Configuration was imported.</em>
   </pre></div></li></ol></div><div class="procedure"><a name="edit-config-files"></a><div class="procedure-title">Procedure&nbsp;22.3.&nbsp;To Edit OpenAM Configuration Files For the New Host Name</div><ol class="procedure" type="1"><li class="step"><p>
    Stop OpenAM or the web container where it runs.
   </p></li><li class="step"><p>
    Edit the bootstrap file, such as <code class="filename">/home/user/openam/bootstrap</code>,
    changing the FQDN, port, and context path for OpenAM as necessary.
   </p></li><li class="step"><p>
    If you are changing the context path,
    then move the folder containing OpenAM configuration,
    such as <code class="filename">/home/user/openam/</code>,
    to match the new context path,
    such as <code class="filename">/home/user/openam2/</code>.
   </p></li><li class="step"><p>
    If you are changing the location or context path,
    change the name of the file
    in the <code class="filename">/home/user/.openamcfg</code> folder,
    such as <code class="filename">AMConfig_path_to_tomcat_webapps_openam_</code>,
    to match the new location and context path.
   </p><p>
    Also edit the path name in the file
    to match the change you made when moving the folder.
   </p></li><li class="step"><p>
    Restart OpenAM or the web container where it runs.
   </p></li></ol></div><div class="procedure"><a name="remove-old-alias"></a><div class="procedure-title">Procedure&nbsp;22.4.&nbsp;To Remove the Old Host Name As an Alias</div><ol class="procedure" type="1"><li class="step"><p>Login to OpenAM console as administrator,
   <code class="literal">amadmin</code>.</p></li><li class="step"><p>Under Access Control &gt; / (Top Level Realm), remove the old host
   name from the Realm/DNS Aliases list, and then save your work.</p></li></ol></div></div><div lang="en" class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="chap-securing"></a>Chapter&nbsp;23.&nbsp;Securing OpenAM</h1></div></div></div><div class="toc"><div class="toc-title">Table of Contents</div><dl class="toc"><dt><span class="section"><a href="#avoid-obvious-defaults">23.1. Avoiding Obvious Defaults</a></span></dt><dt><span class="section"><a href="#protect-network-access">23.2. Protecting Network Access</a></span></dt><dt><span class="section"><a href="#secure-openam-administration">23.3. Securing OpenAM Administration</a></span></dt><dt><span class="section"><a href="#secure-communications">23.4. Securing Communications</a></span></dt><dt><span class="section"><a href="#amadmin-changes">23.5. Administering the amadmin Account</a></span></dt></dl></div><a class="indexterm" name="d16037e34606"></a><p>This chapter identifies best practices for securing your OpenAM
 deployment.</p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="avoid-obvious-defaults"></a>23.1.&nbsp;Avoiding Obvious Defaults</h2></div></div></div><div class="itemizedlist"><p>OpenAM includes default settings to make it easier for you to
   evaluate the software. Avoid these default settings in production
   deployments.</p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>When connecting to LDAP, bind with a specific administrative account
    rather than a root DN account if possible.</p></li><li class="listitem"><p>Change the default <code class="literal">iPlanetDirectoryPro</code> cookie name
    both in OpenAM (<code class="literal">com.iplanet.am.cookie.name</code>) and in your
    policy agent profiles (<code class="literal">com.sun.identity.agents.config.cookie.name</code>).</p></li><li class="listitem"><p>When installing OpenAM, do not use <code class="literal">/openam</code> or
    <code class="literal">/opensso</code> as the deployment URI.</p></li><li class="listitem"><p>Set valid goto URL domains for OpenAM in the core authentication
    module configuration. The parameter is described in the section providing
    <a href="../admin-guide/index.html#core-module-conf-hints" class="link"><em class="citetitle">Hints For the
    Core Authentication Module</em></a> (<code class="literal">iplanet-am-auth-valid-goto-domains</code>).</p></li><li class="listitem"><p>Create an administrator in the top-level realm with a different ID
    than the default <code class="literal">amadmin</code>.</p></li><li class="listitem"><p>Create specific administrator users to track better who makes
    configuration changes.</p></li><li class="listitem"><p>Set the OpenAM advanced property
    <code class="literal">openam.auth.soap.rest.generic.authentication.exception</code>
    to <code class="literal">true</code>. This causes OpenAM to return the same exception
    both when the user does not exist, and also when the password is not
    valid.</p></li><li class="listitem"><p>Remove the demo user account. For example, if you configure the embedded
     OpenDJ directory server as a configuration and CTS store, the default demo user
     account gets created during the installation process. You should
     remove the user using the OpenAM console under Access Control &gt; / (Top Realm)
     &gt; Subjects &gt; User.
    </p></li><li class="listitem"><p>Set the list of Valid <code class="literal">goto</code> URL Resources.
     By default, OpenAM redirects the user to the URL specified in the
     <code class="literal">goto</code> and <code class="literal">gotoOnFail</code> query string parameters
     supplied to the authentication interface in the login URL.
    </p><p>
     To increase security against possible phishing attacks through open redirect,
     you can specify a list of valid URL resources against which OpenAM
     validates these URLs.
     OpenAM only redirects a user if the <code class="literal">goto</code> and
     <code class="literal">gotoOnFail</code> URL matches any of the resources specified in
     this setting.
     If no setting is present, it is assumed that the <code class="literal">goto</code> or
     <code class="literal">gotoOnFail</code> URL is valid.
    </p><p>To set the Valid <code class="literal">goto</code> URL Resources, use the OpenAM
     console, and navigate to Access Control &gt; <em class="replaceable"><code>Realm Name </code></em>
     &gt; Services. Click Add, select Validation Service, and then add one or more
     valid <code class="literal">goto</code> URLs.
    </p><p>
      When setting valid <code class="literal">goto</code> URLs,
      you can use the "*" wildcard,
      where "*" matches all characters except "?".
      For more specific patterns,
      use resource names with wildcards as described in the procedure,
       <a href="../admin-guide/index.html#configure-valid-goto-url-resources" class="link"><em class="citetitle">Configuring Valid goto URL Resources</em></a>.
     </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="protect-network-access"></a>23.2.&nbsp;Protecting Network Access</h2></div></div></div><p>Anytime users interact with a web service, there are risks. With OpenAM, you can
   reduce those risks by deploying different parts of OpenAM in appropriate parts of an
   enterprise network.</p><p>To minimize risks, deploy only the core OpenAM server on systems directly connected
        through a firewall. As a start, deploy only the core server (and the protected web application)
        on Internet-facing servers. For instructions, see the following section from the
        OpenAM Installation Guide, <a href="../install-guide/index.html#which-war-to-deploy" class="link"><em class="citetitle">Determine Which
        War File to Deploy</em></a>.</p><p>You can further limit what is exposed through the firewall by using one of two strategies:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Set up a distributed authentication user interface (UI) in a DMZ between firewalls.</p><p>The distributed authentication UI is essentially a small subset of the OpenAM server with
            just enough login logic to receive user authentication requests. Those requests are forwarded
            to the core OpenAM servers.</p><p>See <a href="../install-guide/index.html#chap-install-das" class="link"><em class="citetitle">Installing
                    OpenAM Distributed Authentication</em></a> for installation
                instructions. The following figure shows the recommended architecture.</p><div class="mediaobject" align="center"><a name="figure-securing-openam-daui"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/securing-openam-daui.png" align="middle" height="360" alt="Exposing only the Distributed Authentication UI to the Internet"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-securing-openam-daui.html" target="longdesc">D</a>]</span></div></div></li><li class="listitem"><p>Alternatively, use a reverse proxy in front of OpenAM to allow
             access only to the necessary URLs.
             The distributed authentication user interface
             only exposes the authentication UI, while a reverse proxy can expose
             those endpoints needed for an application. For example, if you
             need to expose the OAuth2/OpenID Connect endpoints and REST interface
             in addition to the authentication UI,
             then you should implement a reverse proxy. If you only need to expose
             a login page, then use the DAUI.
            </p><p>
             Also note that the DAUI does not support SAML 2.0, so in applications
             that require access to SAML 2.0 endpoints, you must implement
             a reverse proxy.
            </p><p>
            The following figure shows the recommended architecture with a
            reverse proxy.</p><div class="mediaobject" align="center"><a name="figure-securing-openam-rp"></a><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="images/securing-openam-rp.png" align="middle" height="360" alt="Exposing only a reverse proxy to the Internet"></td></tr></table><div class="longdesc-link" align="right"><br clear="all"><span class="longdesc-link">[<a href="figure-securing-openam-rp.html" target="longdesc">D</a>]</span></div></div><p>For access to the console, deploy the full OpenAM application<a href="#ftn.d16037e34768" class="footnote" name="d16037e34768"><sup class="footnote">[12]</sup></a> on
                a separate system that is reachable only from internal systems. Do not
                include the full OpenAM server in the load-balanced pool of OpenAM servers
                serving applications.</p></li><li class="listitem"><p>Leave <code class="literal">ssoadm.jsp</code> disabled in production. (Advanced
                property: <code class="literal">ssoadm.disabled=true</code>)</p></li><li class="listitem"><p>If possible in your deployment, control access to OpenAM console by
                network address, such that administrators can only connect from well-known
                systems and networks.</p></li><li class="listitem"><p>Restrict access to URIs that you do not use, and prevent internal
                endpoints such as <code class="literal">/sessionservice</code> from being reachable
                over the Internet.</p><p>For a full list of endpoints, see the <em class="citetitle">Reference</em>
            chapter on <a href="../reference/index.html#chap-endpoints" class="link">
            <em class="citetitle">Service Endpoints</em></a>.</p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="secure-openam-administration"></a>23.3.&nbsp;Securing OpenAM Administration</h2></div></div></div><div class="itemizedlist"><p>Keep administration of access management services separate from
   management of the services themselves.</p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Create realms for your organization(s) and separate administrative
    users from end users. For instructions, see <a href="../admin-guide/index.html#chap-realms" class="link"><em class="citetitle">Configuring
    Realms</em></a>. You must then either:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>Use the <code class="literal">realm=<em class="replaceable"><code>realm-name</code></em></code>
      query string parameter when redirecting users to OpenAM, which gives you
      a way to isolate the URLs used by an application.</p></li><li class="listitem"><p>Create fully qualified domain name realm/DNS aliases, and use
      them to control access to the realms.</p></li></ul></div></li><li class="listitem"><p>When customizing <code class="filename">config/auth/default*/Login.jsp</code>,
    make sure that you do not introduce any security vulnerabilities such as
    cross-site scripting due to unvalidated input.</p></li><li class="listitem"><p>Create a policy agent profile for each policy agent. See <a href="../admin-guide/index.html#chap-agents" class="link"><em class="citetitle">Configuring
    Policy Agent Profiles</em></a> for instructions.</p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="secure-communications"></a>23.4.&nbsp;Securing Communications</h2></div></div></div><div class="itemizedlist"><p>Keep communications secure by using encryption, properly configured
   cookies, and request and response signatures.</p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Protect network traffic by using HTTPS and LDAPS where
    possible.</p></li><li class="listitem"><p>
     When using HTTPS, use secure cookies,
     which are transmitted only over secured connections.
    </p><p>
     You can configure OpenAM server to use secure cookies
     by browsing in OpenAM console to
     Configuration &gt; Servers and Sites &gt; Default Server Settings &gt; Security &gt; Cookie,
     selecting Yes in the Secure Cookie field,
     and then clicking Save to keep your work.
    </p><p>
     HttpOnly cookies are meant to be transmitted only over HTTP and HTTPS,
     and not through non-HTTP methods such as JavaScript functions.
    </p><p>
     You can configure OpenAM server to use HttpOnly cookies
     by browsing in OpenAM console to
     Configuration &gt; Servers and Sites &gt; Default Server Settings &gt; Advanced,
     adding the advanced property
     with name <code class="literal">com.sun.identity.cookie.httponly</code>
     and value <code class="literal">true</code>,
     and then clicking Save to keep your work.
    </p></li><li class="listitem"><p>Where possible, use subdomain cookies, and control subdomains in
    a specific DNS master.</p></li><li class="listitem"><p>Use cookie hijacking protection with restricted tokens, where each
    policy agent uses different SSO tokens for the same user. See <a href="../admin-guide/index.html#enable-cdsso-cookie-hijacking-protection" class="link"><em class="citetitle">To Protect
    Against CDSSO Cookie Hijacking</em></a> for instructions.</p></li><li class="listitem"><p>When using SAML 2.0:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>Sign authentication requests, authentication responses, and single
      logout requests.</p></li><li class="listitem"><p>If the other entities in your circle of trust can handle encryption,
      then use encryption as well.</p></li><li class="listitem"><p>Use your own key, not the <code class="literal">test</code> key provided with
      OpenAM.</p></li></ul></div></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="amadmin-changes"></a>23.5.&nbsp;Administering the amadmin Account</h2></div></div></div><p>You can make changes to the password and user name for the main OpenAM administrative account.</p><p>You can change the user name of the <code class="literal">amadmin</code> administrative account
            to something more obscure, such as superroot. However, the capabilities of that alternative administrative
            account would not be complete, due to some hard-coding of <code class="literal">amadmin</code> in the source files.
            When changing the password for the main OpenAM administrative account, you must make a corresponding change
            to the authentication datastore. That datastore could be OpenDJ. The steps you would take to change
            the OpenAM top-level administrative password and account name are shown in the following sections.</p><div class="procedure"><a name="change-amadmin-password"></a><div class="procedure-title">Procedure&nbsp;23.1.&nbsp;To Change the Password for the Top-Level Administrator (normally <code class="literal">amadmin</code>)</div><ol class="procedure" type="1"><li class="step"><p>Login to the OpenAM console as the administrator, normally
                    <code class="literal">amadmin</code>.</p></li><li class="step"><p>Under Access Control &gt; / (Top Level Realm) &gt; Subjects &gt; User, select the name of the
                    current top-level administrative user.</p></li><li class="step"><p>In the page that appears, navigate to the Password row and click Edit.</p></li><li class="step"><p>In the window that appears, enter the desired new password in the New Password and
                    Re-Enter Password text boxes.</p></li><li class="step"><p>Click OK to implement the change. If you want to cancel, click Close or just close the window.</p></li><li class="step"><p>You'll also need to change the password for the administrator on the directory server. If you are
                    using OpenDJ, refer to the <a class="link" href="http://docs.forgerock.org/en/opendj/2.6.0/admin-guide/#troubleshoot-reset-admin-passwords" target="_blank"><em class="citetitle">OpenDJ Administration Guide</em> section on Resetting Administrator
                    Passwords</a>. If you are using a different directory server, you will have to refer to the
                documentation for that server.</p></li></ol></div><p>In the following steps, you will identify the new administrative user by assigning it to the <code class="literal">
            com.sun.identity.authentication.super.user</code> directive. You may also need to create an
            OpenAM account for the new administrative user. Don't forget to make sure that new administrative
            account is configured in the corresponding directory server such as OpenDJ.
        </p><div class="procedure"><a name="change-amadmin-uid"></a><div class="procedure-title">Procedure&nbsp;23.2.&nbsp;To Change the Account Name for the Top-Level Administrator (normally <code class="literal">amadmin</code>)</div><ol class="procedure" type="1"><li class="step"><p>Login to the OpenAM console as the administrator, normally
                    <code class="literal">amadmin</code>.</p></li><li class="step"><p>Navigate to the page where you can set the properties for different classes. Select
                    Configuration &gt; Servers and Sites &gt; <em class="replaceable"><code>Server Name</code></em> &gt; Advanced.</p></li><li class="step"><p>In the Advanced Properties window that appears, click Add.</p></li><li class="step"><p>You'll see blank entries in the end of the list of Property Names and Property Values. In the
                    empty Property Name text box, enter <code class="literal">com.sun.identity.authentication.super.user</code>.</p></li><li class="step"><p>In the corresponding Property Values test box, enter appropriate values for the new administrative
                    user in LDAP Data Interchange Format (LDIF). For example, the following entry would set up an
                    administrative user named <code class="literal">superroot</code>, in the organizational unit named <code class="literal">
                        people</code>people, associated with the example.com domain:
                    <code class="literal">uid=superroot,ou=people,dc=example,dc=com</code>.</p></li><li class="step"><p>Click Save to save the changes that you've made. </p></li><li class="step"><p>If the account doesn't already exist in OpenAM or on a connected directory server, you'll need to
               create it. To do so, select Access Control &gt; / (Top Level Realm) &gt; Subject &gt; User &gt; New.
               In the New User window that appears, create the new user. Make sure to enter an appropriate password
               and make that user Active. The ID for that new user is the user name.</p></li><li class="step"><p>As noted earlier, you'll also need to make sure that the corresponding account on the directory server
                has at least CN=Directory Manager  privileges. If you're using OpenDJ, refer to the chapter on
                    <em class="citetitle">Configuring Privileges &amp; Access Control</em> in the
                    <a class="link" href="http://docs.forgerock.org/en/opendj/2.6.0/admin-guide/#chap-privileges-acis" target="_blank">
                    <em class="citetitle">OpenDJ Administration Guide</em></a>.</p></li></ol></div><p>If you do change the account name of the top-level administrative account, you should be aware that the
        original <code class="literal">amadmin</code> account is "hard-coded" in the source code of several files.
            The code in these files may affect the functionality of a top-level administrative user
            with a name other than <code class="literal">amadmin</code>.</p><p>One of the improvements that we plan to make to OpenAM is to eliminate these instances of hard-coding.
        Until we make such improvements, the amadmin user would retain privileges related to the LoginState and some
        IDM-related classes.</p></div><div class="footnotes"><br><hr class="footnote-hr"><div id="ftn.d16037e34768" class="footnote"><p><a href="#d16037e34768" class="para"><sup class="para">[12] </sup></a>Console only deployment is no longer supported.</p></div></div></div><div lang="en" class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="chap-troubleshooting"></a>Chapter&nbsp;24.&nbsp;Troubleshooting</h1></div></div></div><a class="indexterm" name="d16037e35008"></a><p>This chapter covers how to get debugging information and troubleshoot
 issues in OpenAM deployments.</p><div class="qandaset"><h2 class="title"><a name="solutions-to-common-issues"></a>Solutions to Common Issues</h2><p>This section offers solutions to common problems when working with
  OpenAM.</p><table border="0" style="width: 100%;"><colgroup><col align="left" width="1%"><col></colgroup><tbody><tr class="qandadiv"><td align="left" valign="top" colspan="2"><h3 class="title"><a name="troubleshooting-openam-installation"></a>24.1. OpenAM Installation</h3></td></tr><tr class="question"><td align="left" valign="top"><a name="cannot-write-to-config-directory"></a><a name="d16037e35022"></a><p><b>Q:</b></p></td><td align="left" valign="top"><p>OpenAM configuration could not write to the configuration directory.
     Where must I change permissions, and what permissions are required?</p></td></tr><tr class="answer"><td align="left" valign="top"><p><b>A:</b></p></td><td align="left" valign="top"><p>If the user running the web container has a $HOME directory, then
     the configuration directory is stored there, and you probably do not have
     this problem. If you do not know the user running the web container, use
     the <span class="command"><strong>ps</strong></span> command to check. In the following example, the
     user is <code class="literal">mark</code>, the web container
     <code class="literal">tomcat</code>.</p><div class="screen"><pre>
$ <strong>ps -ef | grep tomcat</strong>
<em>mark      1739     1  0 14:47...</em>
     </pre></div><p>For a container installed from native packages with a dedicated
     user, $HOME may not be where you think it is. Look at the user's entry in
     <code class="filename">/etc/passwd</code> to locate the home directory.
     The user running the web container where you install OpenAM must
     be able to read from and write in this directory.</p><p>If you cannot change the permissions to the user's home directory,
     you can, as a workaround, unpack <code class="filename">OpenAM-12.0.0.war</code>, 
     set the <code class="literal">configuration.dir</code> property in the
     <code class="filename">WEB-INF/classes/bootstrap.properties</code> to a directory
     with appropriate permissions, and repack <code class="filename">openam.war</code>
     with the adjusted file before deploying that.</p><div class="screen"><pre>
$ <strong>cd ~/Downloads/openam/OpenAM-12.0.0.war</strong>
$ <strong>mkdir unpacked ; cd unpacked</strong>
$ <strong>jar xf ../OpenAM-12.0.0.war</strong>
$ <strong>vi WEB-INF/classes/bootstrap.properties</strong>
$ <strong>grep ^config WEB-INF/classes/bootstrap.properties</strong>
<em>configuration.dir=/my/readwrite/config/dir</em>
$ <strong>jar cf ../openam.war *</strong>
     </pre></div></td></tr><tr class="question"><td align="left" valign="top"><a name="deploy-failed-lack-of-memory"></a><a name="d16037e35088"></a><p><b>Q:</b></p></td><td align="left" valign="top"><p>Deployment failed due to lack of memory. What do I do?</p></td></tr><tr class="answer"><td align="left" valign="top"><p><b>A:</b></p></td><td align="left" valign="top"><p>OpenAM requires at least a maximum heap size of 1024 MB, with a 256
     MB maximum permanent generation heap size. For the Sun JVM, ensure the
     container starts with <code class="literal">-Xmx1024m -XX:MaxPermSize=256m</code>
     for these settings.</p><p>If you do not know the settings used when the web container was
     started, use the <span class="command"><strong>ps</strong></span> command to check. In the following
     example, the web container is <code class="literal">tomcat</code>.</p><div class="screen"><pre>
$ <strong>ps -ef | grep tomcat | grep Xm</strong>
<em>... -Xmx1024m -XX:MaxPermSize=256m ...</em>
     </pre></div><p>Make sure you have at least 2 GB of RAM on the system where you
     run OpenAM to avoid running out of memory.</p><p>If you make it through deployment and seem to be running out of
     memory later, you can confirm memory errors in OpenAM by searching the
     <code class="filename"><em class="replaceable"><code>config-dir</code></em>/openam/debug/*</code>
     files for <code class="literal">java.lang.OutOfMemoryError</code>.</p></td></tr><tr class="question"><td align="left" valign="top"><a name="deploy-failed-invalid-hostname"></a><a name="d16037e35126"></a><p><b>Q:</b></p></td><td align="left" valign="top"><p>Deployment failed due to invalid hostname configuration. What do
     I do?</p></td></tr><tr class="answer"><td align="left" valign="top"><p><b>A:</b></p></td><td align="left" valign="top"><p>OpenAM requires that you use a fully qualified domain name (FQDN)
     that the host can resolve.</p><div class="screen"><pre>
$ <strong>ping openam-ter.example.com</strong>
<em>PING openam-ter (192.168.56.2) 56(84) bytes of data.
64 bytes from openam (192.168.56.2): icmp_seq=1 ttl=64 time=0.025 ms
64 bytes from openam (192.168.56.2): icmp_seq=2 ttl=64 time=0.032 ms
64 bytes from openam (192.168.56.2): icmp_seq=3 ttl=64 time=0.030 ms</em>
     </pre></div><p>For a test deployment (at home, on a laptop), you can use fake FQDNs
     in <code class="filename">/etc/hosts</code> (<code class="filename">%SystemRoot%\system32\drivers\etc\hosts</code> on Windows), depending
     on how your network is configured.</p><div class="screen"><pre>
$ <strong>cat /etc/hosts | grep openam</strong>
<em>192.168.56.2 openam openam.example.com
192.168.56.3 openam-bis openam-bis.example.com
192.168.56.5 openam-ter openam-ter.example.com</em>
     </pre></div></td></tr><tr class="question"><td align="left" valign="top"><a name="who-deleted-my-config"></a><a name="d16037e35157"></a><p><b>Q:</b></p></td><td align="left" valign="top"><p>I configured OpenAM, and now am seeing the configuration screen
     again. Who deleted my configuration?</p></td></tr><tr class="answer"><td align="left" valign="top"><p><b>A:</b></p></td><td align="left" valign="top"><p>OpenAM uses a file in <code class="filename">$HOME/.openamcfg/</code> to
     bootstrap and find its configuration. The file is named after the path
     to OpenAM and contains the path to the configuration. The following
     example shows what the file looks like for OpenAM deployed in Apache
     Tomcat under <code class="filename">/path/to/tomcat/webapps/openam</code>, and
     running as user <code class="literal">amuser</code> with <code class="literal">$HOME</code>
     <code class="filename">/home/amuser</code>.</p><div class="screen"><pre>
$ <strong>cat ~/.openamcfg/AMConfig_path_to_tomcat_webapps_openam_</strong>
<em>/home/amuser/openam</em>
     </pre></div><p>If OpenAM cannot find its configuration, then it displays the
     configuration screen.</p></td></tr><tr class="qandadiv"><td align="left" valign="top" colspan="2"><h3 class="title"><a name="troubleshooting-openam-upgrades"></a>24.2. OpenAM Upgrades</h3></td></tr><tr class="question"><td align="left" valign="top"><a name="general-tools-upgrade"></a><a name="d16037e35192"></a><p><b>Q:</b></p></td><td align="left" valign="top"><p>I have upgraded OpenAM, now my tools are not working properly. What
     happened?</p></td></tr><tr class="answer"><td align="left" valign="top"><p><b>A:</b></p></td><td align="left" valign="top"><p>Every OpenAM component must be upgraded, not just the main
     OpenAM <code class="filename">.war</code> file. If you did not upgrade the tools
     too, they may not work as intended.</p></td></tr><tr class="qandadiv"><td align="left" valign="top" colspan="2"><h3 class="title"><a name="troubleshooting-openam-administration"></a>24.3. OpenAM Administration</h3></td></tr><tr class="question"><td align="left" valign="top"><a name="cannot-use-ssoadm-jsp"></a><a name="d16037e35205"></a><p><b>Q:</b></p></td><td align="left" valign="top"><p>I cannot use the browser-based equivalent of
     <span class="command"><strong>ssoadm</strong></span>,
     <code class="literal">http://openam.example.com:8080/openam/ssoadm.jsp</code>. Why
     not?</p></td></tr><tr class="answer"><td align="left" valign="top"><p><b>A:</b></p></td><td align="left" valign="top"><p>For security reasons, <code class="literal">ssoadm.jsp</code> is not activated
     by default. To activate it, browse to Configuration &gt; Servers and Sites
     &gt; Servers &gt; <em class="replaceable"><code>ServerName</code></em> &gt; Advanced,
     and then add a property named <code class="literal">ssoadm.disabled</code> with
     value <code class="literal">false</code>.</p></td></tr><tr class="question"><td align="left" valign="top"><a name="ssoadm-slow-on-vm"></a><a name="d16037e35230"></a><p><b>Q:</b></p></td><td align="left" valign="top"><p>The <span class="command"><strong>ssoadm</strong></span> command is very, very slow on my
     virtual machine (VMWare, VirtualBox, etc.). How can I speed it up?</p></td></tr><tr class="answer"><td align="left" valign="top"><p><b>A:</b></p></td><td align="left" valign="top"><p>Virtual machine random devices do not always produce enough random
     data. The <span class="command"><strong>ssoadm</strong></span> command can hang while reading random
     data from the virtual machine's random device, with the result that you
     can wait a minute or more for a single command to finish.</p><p>To work around this limitation on virtual machines, make sure you
     install something that generates enough random data, such as a <a class="link" href="http://www.vanheusden.com/te/" target="_blank">timer entropy
     daemon</a>.</p></td></tr><tr class="question"><td align="left" valign="top"><a name="ssoadm-weblogic-1211-java6"></a><a name="d16037e35248"></a><p><b>Q:</b></p></td><td align="left" valign="top"><p>
      I have OpenAM deployed on WebLogic 12.1.1 and am running Java 6.
      What can I do to fix the exceptions and strange results that I am seeing
      when I use the <span class="command"><strong>ssoadm</strong></span> command?
     </p></td></tr><tr class="answer"><td align="left" valign="top"><p><b>A:</b></p></td><td align="left" valign="top"><p>
      Edit the start up script for WebLogic as described in
      the <em class="citetitle">Installation Guide</em> section,
      <a href="../install-guide/index.html#prepare-oracle-weblogic" class="link"><em class="citetitle">Preparing Oracle WebLogic</em></a>, and then restart WebLogic.
     </p></td></tr><tr class="question"><td align="left" valign="top"><a name="opendj-missing-schema"></a><a name="d16037e35265"></a><p><b>Q:</b></p></td><td align="left" valign="top"><p>I added OpenDJ as a data store, and now I cannot add a user. OpenAM
     gives me the following error.</p><div class="literallayout"><p>ERROR:&nbsp;LDAPv3Repo.create&nbsp;failed.&nbsp;errorCode=65&nbsp;Entry<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uid=test,ou=people,dc=example,dc=com&nbsp;violates&nbsp;the&nbsp;Directory&nbsp;Server<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;schema&nbsp;configuration&nbsp;because&nbsp;it&nbsp;includes&nbsp;attribute&nbsp;inetUserStatus&nbsp;which<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;not&nbsp;allowed&nbsp;by&nbsp;any&nbsp;of&nbsp;the&nbsp;objectclasses&nbsp;defined&nbsp;in&nbsp;that<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entry</p></div></td></tr><tr class="answer"><td align="left" valign="top"><p><b>A:</b></p></td><td align="left" valign="top"><p>When you set up a New Data Store to use OpenDJ as an identity
     repository under Access Control &gt; <em class="replaceable"><code>Realm Name</code></em>
     &gt; Data Stores &gt; New..., you need to check the Load schema when
     saved box if you want OpenAM to add the schema to OpenDJ. The box is
     not selected by default.</p><p>The full version of OpenAM includes directory server schema in the
     <code class="filename">~/Downloads/openam/ldif/</code> directory. To add the schema
     to OpenDJ afterwards, you can try the following command.</p><div class="screen"><pre>
$ <strong>/path/to/opendj/bin/ldapmodify \
 --port 1389 \
 --bindDN "cn=Directory Manager" \
 --bindPassword password \
 --filename ~/Downloads/openam/ldif/fam_sds_schema.ldif</strong>
<em>Processing MODIFY request for CN=schema
MODIFY operation successful for DN CN=schema</em>
     </pre></div></td></tr><tr class="question"><td align="left" valign="top"><a name="websphere-smtp-ssl"></a><a name="d16037e35290"></a><p><b>Q:</b></p></td><td align="left" valign="top"><p>
      I have OpenAM installed in WebSphere application server with IBM Java.
      I am doing REST-based user registration or forgotten password reset,
      or setting up the HOTP authentication module,
      sending mail to an SMTP server over SSL.
     </p><p>
      How come OpenAM cannot send mail over SSL?
     </p></td></tr><tr class="answer"><td align="left" valign="top"><p><b>A:</b></p></td><td align="left" valign="top"><p>
      If you see in the OpenAM Authentication debug log
      that the SSL handshake is failing when connecting to the mail server,
      then it is likely that the SSL certificate presented by the mail server
      is not trusted.
     </p><p>
      This is a WebSphere/IBM Java issue, rather than an OpenAM issue.
     </p><p>
      To work around the problem, follow these steps
      to make sure that WebSphere trusts the mail server SSL certificate.
     </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Log in as administrator to WebSphere console.</p></li><li class="listitem"><p>
        Browse to Security
        &gt; SSL certificate and key management
        &gt; Manage endpoint security configurations,
        and then click the link for the node where OpenAM runs.
       </p></li><li class="listitem"><p>
        In the menu on the right, click SSL configuration.
       </p></li><li class="listitem"><p>
        Click NodeDefaultSSLSettings.
       </p></li><li class="listitem"><p>
        In the menu on the right, click Key stores and certificates.
       </p></li><li class="listitem"><p>
        Click NodeDefaultTrustStore.
       </p></li><li class="listitem"><p>
        In the menu on the right, click Signer certificates.
       </p></li><li class="listitem"><p>
        Click Retrieve from port.
       </p></li><li class="listitem"><p>
        Set Host, Port, and Alias, and then click Retrieve signer information.
       </p><p>
        The Host is the host name of the SMTP server.
       </p><p>
        The Port is the port number of the SMTP server, such as 465.
       </p><p>
        The certificate Alias can be set to the user name used
        to authenticate to the mail server.
       </p><p>
        For example, if you are sending mail through Google mail as my.user,
        then set Host to <code class="literal">smtp.gmail.com</code>,
        set Port to <code class="literal">465</code>,
        and set Alias to <code class="literal">my.user</code>.
       </p></li><li class="listitem"><p>
        After the information is retrieved,
        click Apply, save your work, and then restart WebSphere.
       </p></li></ol></div><p>
      After WebSphere restarts, it should trust the mail server SSL certificate.
      OpenAM therefore should be able to connect to the mail server over SSL.
     </p><p>
      For more information, see the
      <a class="link" href="http://infolib.lotus.com/resources/portal/8.0.0/doc/en_us/PT800ACD001/index.html" target="_blank">WebSphere documentation</a>.
     </p></td></tr><tr class="question"><td align="left" valign="top"><a name="turn-off-oauth2-logging"></a><a name="d16037e35358"></a><p><b>Q:</b></p></td><td align="left" valign="top"><p>
      My container log file is filling up with messages from OpenAM's
      OAuth authorization service and OpenID Connect provider.
     </p><p>
      What can I do to prevent all these messages from being logged?
     </p></td></tr><tr class="answer"><td align="left" valign="top"><p><b>A:</b></p></td><td align="left" valign="top"><p>
      This behavior is governed by the log settings for RESTlet,
      which is used by OpenAM for OAuth 2.0 and OpenID Connect 1.0.
     </p><p>
      Use log configuration settings to turn off logging from RESTlet.
     </p><p>
      For example, if your container is Apache Tomcat, follow these steps.
     </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
        Stop Tomcat.
       </p><div class="screen"><pre>
$ <strong>/path/to/tomcat/bin/shutdown.sh</strong>
       </pre></div></li><li class="listitem"><p>
        Edit the Tomcat settings script,
        <code class="filename">catalina.sh</code> or <code class="filename">catalina.bat</code>,
        to use the logging configuration file.
       </p><p>
        For example, in <code class="filename">/path/to/tomcat/bin/catalina.sh</code>,
        uncomment the following line, and then save your work:
       </p><pre class="brush: ini;">
LOGGING_CONFIG= \
  "-Djava.util.logging.config.file=$CATALINA_BASE/conf/logging.properties"</pre></li><li class="listitem"><p>
        In <code class="filename">$CATALINA_BASE/conf/logging.properties</code>,
        add the following line, and then save your work:
       </p><pre class="brush: ini;">
org.restlet.level=OFF
       </pre></li><li class="listitem"><p>
        Start Tomcat.
       </p><div class="screen"><pre>
$ <strong>/path/to/tomcat/bin/startup.sh</strong>
       </pre></div></li></ol></div></td></tr><tr class="question"><td align="left" valign="top"><a name="openam-sfo-time-wait"></a><a name="d16037e35412"></a><p><b>Q:</b></p></td><td align="left" valign="top"><p>I have session failover configured for an OpenAM site. I see many
     connections in <code class="literal">TIME_WAIT</code> state, and the connections
     seem to be used only for communication between OpenAM servers in that
     site. What should I set to have fewer connections in
     <code class="literal">TIME_WAIT</code>?</p></td></tr><tr class="answer"><td align="left" valign="top"><p><b>A:</b></p></td><td align="left" valign="top"><p>When you have session failover configured for a site, OpenAM servers
     run health checks against other servers in the same site. By default, the
     health checks are run every second (1000 milliseconds) with a timeout of 1
     second (1000 milliseconds).</p><p>If there is network latency between servers in a site, for example
     if you are running your servers in virtual machines, the default settings
     might not be right for your deployment. In that case, consider changing the
     following advanced server properties.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>By lengthening
       <code class="literal">com.iplanet.am.session.failover.cluster.stateCheck.timeout</code>
       and
       <code class="literal">com.iplanet.am.session.failover.cluster.stateCheck.period</code>
       to something longer than the default, you can work around issues with
       network latency.</p></li><li class="listitem"><p>By setting <code class="literal">com.sun.identity.urlchecker.dorequest</code>
       to <code class="literal">true</code> or <code class="literal">false</code>, you can change
       whether OpenAM performs an HTTP GET request or only checks the Socket
       connection of <code class="literal">com.sun.identity.urlchecker.targeturl</code>
       as a health check.</p></li></ul></div><p>To set advanced properties, either use the OpenAM console page under
     Configuration &gt; Servers and Sites &gt; Default Server Settings &gt;
     Advanced, or set the properties using the
     <span class="command"><strong>ssoadm update-server-cfg</strong></span> command as in the following
     example, which updates the default server configuration:</p><div class="screen"><pre>
$ <strong>./ssoadm \
 update-server-cfg \
 --servername default \
 --adminid amadmin \
 --password-file /tmp/pwd.txt \
 --attributevalues com.iplanet.am.session.failover.cluster.stateCheck.timeout=2000</strong>
     </pre></div></td></tr><tr class="question"><td align="left" valign="top"><a name="change-app-password"></a><a name="d16037e35462"></a><p><b>Q:</b></p></td><td align="left" valign="top"><p>I want to change the password for the <code class="literal">UrlAccessAgent</code> that
     was assigned during the OpenAM Installation process.</p></td></tr><tr class="answer"><td align="left" valign="top"><p><b>A:</b></p></td><td align="left" valign="top"><p>To change the <code class="literal">UrlAccessAgent</code> password, you can use
     the <span class="command"><strong>ssoadm</strong></span> that is installed with the OpenAM Administration tools,
     as described in the <a href="../install-guide/index.html#chap-install-tools" class="link"><em class="citetitle">Installing OpenAM Tools</em>
     Chapter of the Installation Guide.</a>
     </p><p>You can then change the password for the <code class="literal">UrlAccessAgent</code> for
     the root realm (/) with the following commands:</p><div class="screen"><pre>
$ <strong>cd /path/to/SSOAdminTools/bin</strong>
$ <strong>./ssoadm \
 set-identity-attrs \
 --realm / \
 --idname amService-UrlAccessAgent \
 --idtype user \
 --adminid amadmin \
 --password-file /tmp/passwd \
 --attributevalues userpassword=changeit</strong>

<em>Attribute values of identity, amService-UrlAccessAgent of type, user
 in realm, / was modified.</em>
     </pre></div><p>The new password will take effect the next time you start OpenAM.</p></td></tr></tbody></table></div></div><div lang="en" class="glossary"><div class="titlepage"><div><div><h1 class="title"><a name="openam-glossary"></a>OpenAM Glossary</h1></div></div></div><dl><dt><span class="glossterm">Access control</span></dt><dd class="glossdef"><p>Control to grant or to deny access to a resource</p></dd><dt><span class="glossterm">Account lockout</span></dt><dd class="glossdef"><p>The act of making an account temporarily or permanently inactive
    after successive authentication failures</p></dd><dt><span class="glossterm">Actions</span></dt><dd class="glossdef"><p>
    Defined as part of policies,
    these verbs indicate what authorized subjects can do to resources.
   </p></dd><dt><span class="glossterm">Advice</span></dt><dd class="glossdef"><p>
    In the context of a policy decision denying access,
    a hint to the policy enforcement point about remedial action to take
    that could result in a decision allowing access.
   </p></dd><dt><span class="glossterm">Agent administrator</span></dt><dd class="glossdef"><p>User having privileges only to read and write policy agent profile
   configuration information, typically created to delegate policy agent
   profile creation to the user installing a policy agent</p></dd><dt><span class="glossterm">Agent authenticator</span></dt><dd class="glossdef"><p>Entity with read-only access to multiple agent profiles defined in the
    same realm; allows an agent to read web service profiles</p></dd><dt><span class="glossterm">Application</span></dt><dd class="glossdef"><p>
    In general terms, a service exposing protected resources.
   </p><p>
    In the context of OpenAM policies,
    the application is a template that constrains the policies
    that govern access to protected resources.
    An application can have zero or more policies.
   </p></dd><dt><span class="glossterm">Application type</span></dt><dd class="glossdef"><p>
    Application types act as templates for creating policy applications.
   </p><p>
    Application types define a preset list of actions and functional logic,
    such as policy lookup and resource comparator logic.
   </p><p>
    Application types also define the internal normalization,
    indexing logic, and comparator logic for applications.
   </p></dd><dt><span class="glossterm">Attribute-based access control (ABAC)</span></dt><dd class="glossdef"><p>Access control that is based on attributes of a user, such as how old
    a user is or whether she is a paying customer</p></dd><dt><span class="glossterm">Authentication</span></dt><dd class="glossdef"><p>The act of confirming the identity of a principal</p></dd><dt><span class="glossterm">Authentication chaining</span></dt><dd class="glossdef"><p>A series of authentication modules configured together which a
   principal must negotiate as configured in order to authenticate
   successfully</p></dd><dt><span class="glossterm">Authentication level</span></dt><dd class="glossdef"><p>Positive integer associated with an authentication module, usually
    used to require success with more stringent authentication measures when
    requesting resources requiring special protection</p></dd><dt><span class="glossterm">Authentication module</span></dt><dd class="glossdef"><p>OpenAM authentication unit that handles one way of obtaining and
    verifying credentials</p></dd><dt><span class="glossterm">Authorization</span></dt><dd class="glossdef"><p>The act of determining whether to grant or to deny a principal access
   to a resource</p></dd><dt><span class="glossterm">Authorization Server</span></dt><dd class="glossdef"><p>In OAuth 2.0, issues access tokens to the client after authenticating
   a resource owner and confirming that the owner authorizes the client to
   access the protected resource. OpenAM can play this role in the OAuth 2.0
   authorization framework.</p></dd><dt><span class="glossterm">Auto-federation</span></dt><dd class="glossdef"><p>Arrangement to federate a principal's identity automatically based
   on a common attribute value shared across the principal's profiles at
   different providers</p></dd><dt><span class="glossterm">Bulk federation</span></dt><dd class="glossdef"><p>Batch job permanently federating user profiles between a service
   provider and an identity provider based on a list of matched user
   identifiers that exist on both providers</p></dd><dt><span class="glossterm">Circle of trust</span></dt><dd class="glossdef"><p>Group of providers, including at least one identity provider, who
   have agreed to trust each other to participate in a SAML 2.0 provider
   federation</p></dd><dt><span class="glossterm">Client</span></dt><dd class="glossdef"><p>In OAuth 2.0, requests protected web resources on behalf of the
   resource owner given the owner's authorization. OpenAM can play this role
   in the OAuth 2.0 authorization framework.</p></dd><dt><span class="glossterm">Conditions</span></dt><dd class="glossdef"><p>
    Defined as part of policies,
    these determine the circumstances under which which a policy applies.
   </p><p>
    Environmental conditions reflect circumstances like
    the client IP address, time of day, how the subject authenticated,
    or the authentication level achieved
   </p><p>
    Subject conditions reflect characteristics of the subject like
    whether the subject authenticated, the identity of the subject,
    or claims in the subject's JWT
   </p></dd><dt><span class="glossterm">Configuration datastore</span></dt><dd class="glossdef"><p>LDAP directory service holding OpenAM configuration data</p></dd><dt><span class="glossterm">Cross-domain single sign on (CDSSO)</span></dt><dd class="glossdef"><p>OpenAM capability allowing single sign on across different DNS
   domains</p></dd><dt><span class="glossterm">Delegation</span></dt><dd class="glossdef"><p>
    Granting users administrative privileges with OpenAM
   </p></dd><dt><span class="glossterm">Entitlement</span></dt><dd class="glossdef"><p>
    Decision that defines which resource names can and cannot be accessed
    for a given subject in the context of a particular application,
    which actions are allowed and which are denied,
    and any related advice and attributes
   </p></dd><dt><span class="glossterm">Extended metadata</span></dt><dd class="glossdef"><p>Federation configuration information specific to OpenAM</p></dd><dt><span class="glossterm">Extensible Access Control Markup Language (XACML)</span></dt><dd class="glossdef"><p>Standard, XML-based access control policy language, including a
   processing model for making authorization decisions based on policies</p></dd><dt><span class="glossterm">Federation</span></dt><dd class="glossdef"><p>Standardized means for aggregating identities, sharing authentication
   and authorization data information between trusted providers, and allowing
   principals to access services across different providers without
   authenticating repeatedly</p></dd><dt><span class="glossterm">Fedlet</span></dt><dd class="glossdef"><p>Service provider application capable of participating in a circle of
   trust and allowing federation without installing all of OpenAM on the
   service provider side; OpenAM lets you create both .NET and Java
   Fedlets.</p></dd><dt><span class="glossterm">Hot swappable</span></dt><dd class="glossdef"><p>Refers to configuration properties for which changes can take effect
   without restarting the container where OpenAM runs</p></dd><dt><span class="glossterm">Identity</span></dt><dd class="glossdef"><p>Set of data that uniquely describes a person or a thing such as a
   device or an application</p></dd><dt><span class="glossterm">Identity federation</span></dt><dd class="glossdef"><p>Linking of a principal's identity across multiple providers</p></dd><dt><span class="glossterm">Identity provider (IdP)</span></dt><dd class="glossdef"><p>Entity that produces assertions about a principal (such as how and
   when a principal authenticated, or that the principal's profile has a
   specified attribute value)</p></dd><dt><span class="glossterm">Identity repository</span></dt><dd class="glossdef"><p>Data store holding user profiles and group information; different
   identity repositories can be defined for different realms.</p></dd><dt><span class="glossterm">Java EE policy agent</span></dt><dd class="glossdef"><p>Java web application installed in a web container that acts as a
   policy agent, filtering requests to other applications in the container
   with policies based on application resource URLs</p></dd><dt><span class="glossterm">Metadata</span></dt><dd class="glossdef"><p>Federation configuration information for a provider</p></dd><dt><span class="glossterm">Policy</span></dt><dd class="glossdef"><p>
    Set of rules that define who is granted access to a protected resource
    when, how, and under what conditions
   </p></dd><dt><span class="glossterm">Policy Agent</span></dt><dd class="glossdef"><p>Agent that intercepts requests for resources, directs principals to
    OpenAM for authentication, and enforces policy decisions from OpenAM</p></dd><dt><span class="glossterm">Policy Administration Point (PAP)</span></dt><dd class="glossdef"><p>Entity that manages and stores policy definitions</p></dd><dt><span class="glossterm">Policy Decision Point (PDP)</span></dt><dd class="glossdef"><p>Entity that evaluates access rights and then issues authorization
   decisions</p></dd><dt><span class="glossterm">Policy Enforcement Point (PEP)</span></dt><dd class="glossdef"><p>Entity that intercepts a request for a resource and then enforces
   policy decisions from a PDP</p></dd><dt><span class="glossterm">Policy Information Point (PIP)</span></dt><dd class="glossdef"><p>Entity that provides extra information such as user profile attributes
   that a PDP needs in order to make a decision</p></dd><dt><a name="def-principal"></a><span class="glossterm">Principal</span></dt><dd class="glossdef"><p>
    Represents an entity that has been authenticated
    (such as a user, a device, or an application),
    and thus is distinguished from other entities
   </p><p>
    When a <a class="xref" href="#def-subject" title="Subject">Subject</a> successfully authenticates,
    OpenAM associates the Subject with the Principal.
   </p></dd><dt><span class="glossterm">Privilege</span></dt><dd class="glossdef"><p>
    In the context of delegated administration,
    a set of administrative tasks that can be performed by specified subjects
    in a given realm
   </p></dd><dt><span class="glossterm">Provider federation</span></dt><dd class="glossdef"><p>Agreement among providers to participate in a circle of trust</p></dd><dt><span class="glossterm">Realm</span></dt><dd class="glossdef"><p>
    OpenAM unit for organizing configuration and identity information
   </p><p>
    Realms can be used for example when different parts of an organization
    have different applications and user data stores,
    and when different organizations use the same OpenAM deployment.
   </p><p>
    Administrators can delegate realm administration.
    The administrator assigns administrative privileges to users,
    allowing them to perform administrative tasks within the realm.
   </p></dd><dt><span class="glossterm">Referral</span></dt><dd class="glossdef"><p>
    Allows the policies for an application to be managed in the current realm,
    and also in sibling and child realms
   </p><p>
    During policy evaluation, OpenAM uses referrals
    to locate the application's policies in other realms
    in order to find all policies that apply for a given request.
   </p></dd><dt><span class="glossterm">Resource</span></dt><dd class="glossdef"><p>
    Something a user can access over the network such as a web page
   </p><p>
    Defined as part of policies,
    these can include wildcards in order to match multiple actual resources.
   </p></dd><dt><span class="glossterm">Resource owner</span></dt><dd class="glossdef"><p>In OAuth 2.0, entity who can authorize access to protected web
   resources, such as an end user</p></dd><dt><span class="glossterm">Resource server</span></dt><dd class="glossdef"><p>In OAuth 2.0, server hosting protected web resources, capable of
    handling access tokens to respond to requests for such resources</p></dd><dt><span class="glossterm">Response attributes</span></dt><dd class="glossdef"><p>
    Defined as part of policies, these allow OpenAM
    to return additional information in the form of "attributes"
    with the response to a policy decision
   </p></dd><dt><span class="glossterm">Role based access control (RBAC)</span></dt><dd class="glossdef"><p>Access control that is based on whether a user has been granted a set
   of permissions (a role)</p></dd><dt><span class="glossterm">Security Assertion Markup Language (SAML)</span></dt><dd class="glossdef"><p>Standard, XML-based language for exchanging authentication and
   authorization data between identity providers and service providers</p></dd><dt><span class="glossterm">Service provider (SP)</span></dt><dd class="glossdef"><p>Entity that consumes assertions about a principal (and provides a
   service that the principal is trying to access)</p></dd><dt><span class="glossterm">Session</span></dt><dd class="glossdef"><p>In OpenAM a user session is the interval that starts with the user
   authenticating through OpenAM and ends when the user logs out, or when her
   session is terminated. OpenAM manages user sessions across one or more
   applications by issuing a session token used to identify the session and by
   tracking the session state in order to handle session events like logout and
   timeout, to permit session constraints, and to notify applications involved
   in SSO when a session ends.</p></dd><dt><span class="glossterm">Session failover (SFO)</span></dt><dd class="glossdef"><p>Capability to allow another OpenAM server to manage a session when
   the OpenAM server that initially authenticated the principal goes
   offline</p></dd><dt><span class="glossterm">Session token</span></dt><dd class="glossdef"><p>Unique identifier issued by OpenAM after successful authentication,
   used to track a principal's session</p></dd><dt><span class="glossterm">Single log out (SLO)</span></dt><dd class="glossdef"><p>Capability allowing a principal to end a session once, thereby ending
   her session across multiple applications</p></dd><dt><span class="glossterm">Single sign on (SSO)</span></dt><dd class="glossdef"><p>Capability allowing a principal to authenticate once and gain access
   to multiple applications without authenticating again</p></dd><dt><span class="glossterm">Site</span></dt><dd class="glossdef"><p>
    Group of OpenAM servers configured the same way,
    accessed through a load balancer layer
   </p><p>
    The load balancer handles failover to provide service-level availability.
    Use sticky load balancing based on <code class="literal">amlbcookie</code> values
    to minimize cross-talk in the site.
   </p><p>
    The load balancer can also be used to protect OpenAM services.
   </p></dd><dt><span class="glossterm">Standard metadata</span></dt><dd class="glossdef"><p>Standard federation configuration information that you can share with
   other access management software</p></dd><dt><a name="def-subject"></a><span class="glossterm">Subject</span></dt><dd class="glossdef"><p>
    Entity that requests access to a resource
   </p><p>
    When a Subject successfully authenticates,
    OpenAM associates the Subject with the <a class="xref" href="#def-principal" title="Principal">Principal</a>
    that distinguishes it from other subjects.
    A Subject can be associated with multiple Principals.
   </p></dd><dt><span class="glossterm">User data store</span></dt><dd class="glossdef"><p>Data storage service holding principals' profiles; underlying storage
   can be an LDAP directory service, a relational database, or a custom
   <code class="literal">IdRepo</code> implementation</p></dd><dt><span class="glossterm">Web policy agent</span></dt><dd class="glossdef"><p>Native library installed in a web server that acts as a policy agent
   with policies based on web page URLs</p></dd></dl></div><div lang="en" class="appendix"><div class="titlepage"><div><div><h1 class="title"><a name="appendix-interface-stability"></a>Appendix&nbsp;A.&nbsp;Release Levels &amp; Interface Stability</h1></div></div></div><div class="toc"><div class="toc-title">Table of Contents</div><dl class="toc"><dt><span class="section"><a href="#release-levels">A.1. ForgeRock Product Release Levels</a></span></dt><dt><span class="section"><a href="#interface-stability">A.2. ForgeRock Product Interface Stability</a></span></dt></dl></div><p>This appendix includes ForgeRock definitions for product release levels
 and interface stability.</p><div lang="en" class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="release-levels"></a>A.1.&nbsp;ForgeRock Product Release Levels</h2></div></div></div><p>
  ForgeRock defines Major, Minor, and Maintenance product release levels.

  The release level is reflected in the version number.

  The release level tells you what sort of compatibility changes to expect.
 </p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Major (version: x.0.0)</span></dt><dd><p>
     Major releases bring big new features.

     Major releases can include changes even to Stable interfaces.

     Major releases can remove previously Deprecated functionality,
     and in rare cases remove Evolving functionality
     that has not been explicitly Deprecated.

     Major releases also include the changes present
     in previous Minor and Maintenance releases.
    </p></dd><dt><span class="term">Minor (version: x.y.0)</span></dt><dd><p>
     Minor releases might include new features,
     backwards-compatible changes to Stable interfaces in the same Major release,
     and incompatible changes to Evolving interfaces.

     Minor releases can remove previously Deprecated functionality.

     Minor releases also include the changes present in Maintenance releases.
    </p></dd><dt><span class="term">Maintenance (version: x.y.z)</span></dt><dd><p>
     Maintenance releases can include bug fixes.

     Maintenance releases are intended
     to be fully compatible with previous versions from the same Minor release.
    </p></dd></dl></div></div><div lang="en" class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="interface-stability"></a>A.2.&nbsp;ForgeRock Product Interface Stability</h2></div></div></div><p>
  ForgeRock products support many protocols, APIs, GUIs,
  and command-line interfaces.

  Some of these interfaces are standard and very stable.

  Others offer new functionality that is continuing to evolve.
 </p><p>
  We realize that you invest in these interfaces,
  and therefore must know when and how ForgeRock expects them to change.

  For that reason, ForgeRock defines interface stability labels
  and uses these definitions in ForgeRock products.
 </p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Stable</span></dt><dd><p>
     This documented interface is expected to undergo only
     backwards-compatible changes between major releases.

     Changes are announced at least one minor release before they take effect.
    </p></dd><dt><span class="term">Evolving</span></dt><dd><p>
     This documented interface is continuing to evolve
     and so is expected to change,
     potentially in backwards-incompatible ways even in a minor release.

     Changes are documented at the time of product release.
    </p><p>
     While new protocols and APIs are still in the process of standardization,
     they are Evolving.

     This applies for example to recent Internet-Draft implementations,
     and also to newly developed functionality.
    </p></dd><dt><span class="term">Deprecated</span></dt><dd><p>
     This interface is deprecated
     and likely to be removed in a future release.

     For previously stable interfaces,
     the change was likely announced in a previous release.

     Deprecated interfaces will be removed from ForgeRock products.
    </p></dd><dt><span class="term">Removed</span></dt><dd><p>
     This interface was deprecated in a previous release
     and has now been removed from the product.
    </p></dd><dt><span class="term">Internal/Undocumented</span></dt><dd><p>
     Internal and undocumented interfaces can change without notice.

     If you depend on one of these interfaces,
     contact ForgeRock support
     or email <a class="link" href="mailto:info@forgerock.com" target="_top">info@forgerock.com</a>
     to discuss your needs.
    </p></dd></dl></div></div></div><div class="index"><div class="titlepage"><div><div><h1 class="title"><a name="d16037e35993"></a>Index</h1></div></div></div><div class="index"><div class="indexdiv"><h3>A</h3><dl><dt>Account lockout</dt><dd><dl><dt>configuring, <a class="indexterm" href="#configure-account-lockout">Configuring Account Lockout</a></dt></dl></dd><dt>Active Directory authentication, <a class="indexterm" href="#ad-module-conf-hints">Hints for the Active Directory Authentication Module</a></dt><dt>Adaptive risk authentication, <a class="indexterm" href="#adaptive-auth-module-conf-hints">Hints for the Adaptive Risk Authentication Module</a></dt><dt>Admin Console</dt><dd><dl><dt>overview, <a class="indexterm" href="#openam-console-overview">OpenAM Web-Based Console</a></dt></dl></dd><dt>Administration tools, <a class="indexterm" href="#chap-admin-tools">Administration Interfaces &amp; Tools</a></dt><dt>Anonymous authentication, <a class="indexterm" href="#anon-module-conf-hints">Hints for the Anonymous Authentication Module</a></dt><dt>Application</dt><dd><dl><dt>Configuring, <a class="indexterm" href="#configure-apps-with-console">Configuring Applications by Using the OpenAM Console</a></dt></dl></dd><dt>Authentication</dt><dd><dl><dt>about, <a class="indexterm" href="#what-is-authn">About Authentication in OpenAM</a></dt><dt>Active Directory, <a class="indexterm" href="#ad-module-conf-hints">Hints for the Active Directory Authentication Module</a></dt><dt>Active Directory module, <a class="indexterm" href="#ad-module-conf-hints">Hints for the Active Directory Authentication Module</a>-<a class="indexterm" href="#ad-module-conf-hints">Hints for the Active Directory Authentication Module</a></dt><dt>Adaptive risk module, <a class="indexterm" href="#adaptive-auth-module-conf-hints">Hints for the Adaptive Risk Authentication Module</a>-<a class="indexterm" href="#adaptive-auth-module-conf-hints">Hints for the Adaptive Risk Authentication Module</a></dt><dt>Anonymous module, <a class="indexterm" href="#anon-module-conf-hints">Hints for the Anonymous Authentication Module</a>-<a class="indexterm" href="#anon-module-conf-hints">Hints for the Anonymous Authentication Module</a></dt><dt>Chains, <a class="indexterm" href="#what-is-authn">About Authentication in OpenAM</a></dt><dt>chains, <a class="indexterm" href="#configure-authn-chains">Configuring Authentication Chains</a></dt><dt>Core</dt><dd><dl><dt>account lockout, <a class="indexterm" href="#auth-core-account-lockout">Core - Account Lockout</a></dt><dt>general, <a class="indexterm" href="#auth-core-general">Core - General</a></dt><dt>global attributes, <a class="indexterm" href="#auth-core-global">Core - Global Attributes</a></dt><dt>persistent cookie (legacy), <a class="indexterm" href="#auth-core-persistent-cookie">Core - Persistent Cookie (Legacy)</a></dt><dt>post authentication processing, <a class="indexterm" href="#auth-core-post-auth">Core - Post Authentication Processing</a></dt><dt>realm attributes, <a class="indexterm" href="#auth-core-realm-attributes">Core - Realm Attributes</a></dt><dt>security, <a class="indexterm" href="#auth-core-security">Core - Security</a></dt></dl></dd><dt>Core module, <a class="indexterm" href="#core-module-conf-hints">Hints for the Core Authentication Module</a></dt><dt>Data Store, <a class="indexterm" href="#datastore-module-conf-hints">Hints for the Data Store Authentication Module</a></dt><dt>Data store module, <a class="indexterm" href="#datastore-module-conf-hints">Hints for the Data Store Authentication Module</a></dt><dt>Device ID (Match) module, <a class="indexterm" href="#device-id-match-hints">Hints for the Device ID (Match) Authentication Module</a>-<a class="indexterm" href="#device-id-match-hints">Hints for the Device ID (Match) Authentication Module</a></dt><dt>Device ID (Save) module, <a class="indexterm" href="#device-id-save-hints">Hints for the Device ID (Save) Module</a></dt><dt>Federation module, <a class="indexterm" href="#federation-module-conf-hints">Hints for the Federation Authentication Module</a></dt><dt>HMAC One-Time Password (HOTP) module, <a class="indexterm" href="#hotp-module-conf-hints">Hints for the HOTP Authentication Module</a>-<a class="indexterm" href="#hotp-module-conf-hints">Hints for the HOTP Authentication Module</a></dt><dt>HTTP Basic module, <a class="indexterm" href="#http-module-conf-hints">Hints for the HTTP Basic Authentication Module</a></dt><dt>JDBC module, <a class="indexterm" href="#jdbc-module-conf-hints">Hints for the JDBC Authentication Module</a></dt><dt>LDAP module, <a class="indexterm" href="#ldap-module-conf-hints">Hints for the LDAP Authentication Module</a>-<a class="indexterm" href="#ldap-module-conf-hints">Hints for the LDAP Authentication Module</a></dt><dt>Levels, <a class="indexterm" href="#what-is-authn">About Authentication in OpenAM</a></dt><dt>Modules, <a class="indexterm" href="#what-is-authn">About Authentication in OpenAM</a></dt><dt>modules</dt><dd><dl><dt>configuring, <a class="indexterm" href="#configure-authn-modules">Configuring Authentication Modules</a></dt></dl></dd><dt>MSISDN module, <a class="indexterm" href="#msisdn-module-conf-hints">Hints for the MSISDN Authentication Module</a>-<a class="indexterm" href="#msisdn-module-conf-hints">Hints for the MSISDN Authentication Module</a></dt><dt>OAuth 2.0, <a class="indexterm" href="#oauth2-module-conf-hints">Hints for the OAuth 2.0/OpenID Connect Authentication Module</a></dt><dt>OAuth 2.0/OpenID Connect 1.0 module, <a class="indexterm" href="#oauth2-module-conf-hints">Hints for the OAuth 2.0/OpenID Connect Authentication Module</a>-<a class="indexterm" href="#oauth2-module-conf-hints">Hints for the OAuth 2.0/OpenID Connect Authentication Module</a></dt><dt>Open Authentication (OATH) module, <a class="indexterm" href="#OATH-module-conf-hints">Hints for the OATH Module</a></dt><dt>OpenID Connect 1.0, <a class="indexterm" href="#oidc-module-conf-hints">Hints for the OpenID Connect id_token bearer Module</a></dt><dt>OpenID Connect id_token Bearer module, <a class="indexterm" href="#oidc-module-conf-hints">Hints for the OpenID Connect id_token bearer Module</a></dt><dt>RADIUS module, <a class="indexterm" href="#radius-module-conf-hints">Hints for the RADIUS Authentication Module</a></dt><dt>Scripted Authentication module, <a class="indexterm" href="#scripted-module-conf-hints">Hints for Scripted Authentication Modules</a></dt><dt>Secure Attribute Exchange (SAE) module, <a class="indexterm" href="#sae-module-conf-hints">Hints for the SAE Authentication Module</a></dt><dt>SecurID, <a class="indexterm" href="#securid-module-conf-hints">Hints For the SecurID Authentication Module</a></dt><dt>social</dt><dd><dl><dt>configuring, <a class="indexterm" href="#configure-social-authn">Configuring Social Authentication</a></dt></dl></dd><dt>Web Service Security (WSSAuth) module, <a class="indexterm" href="#wss-module-conf-hints">Hints for the WSSAuth Authentication Module</a></dt><dt>Windows Desktop SSO module, <a class="indexterm" href="#desktop-module-conf-hints">Hints for the Windows Desktop SSO Authentication Module</a></dt><dt>Windows NT module, <a class="indexterm" href="#winnt-module-conf-hints">Hints for the Windows NT Authentication Module</a></dt><dt>X509 certificate-based module, <a class="indexterm" href="#cert-module-conf-hints">Hints for the Certificate Authentication Module</a>-<a class="indexterm" href="#cert-module-conf-hints">Hints for the Certificate Authentication Module</a></dt></dl></dd><dt>Authentication levels</dt><dd><dl><dt>and session upgrade, <a class="indexterm" href="#session-upgrade">Authentication Levels &amp; Session Upgrade</a></dt></dl></dd><dt>Authorization, <a class="indexterm" href="#what-is-authz">About Authorization in OpenAM</a></dt><dd><dl><dt>Configuring, <a class="indexterm" href="#configure-policies-with-console">Configuring Policies by Using the OpenAM Console</a>, <a class="indexterm" href="#chap-openid-connect">Managing OpenID Connect 1.0 Authorization</a></dt><dt>OAuth 2.0, <a class="indexterm" href="#chap-oauth2">Managing OAuth 2.0 Authorization</a></dt></dl></dd></dl></div><div class="indexdiv"><h3>B</h3><dl><dt>Backup, <a class="indexterm" href="#chap-backup-restore">Backing Up and Restoring OpenAM Configurations</a></dt></dl></div><div class="indexdiv"><h3>C</h3><dl><dt>Caching, <a class="indexterm" href="#caching">Caching in OpenAM</a></dt><dt>Certificates, <a class="indexterm" href="#chap-certs-keystores">Managing Certificates</a></dt><dt>command-line tools</dt><dd><dl><dt>overview, <a class="indexterm" href="#openam-cli-overview">OpenAM Command-Line Tools</a></dt></dl></dd><dt>Core authentication</dt><dd><dl><dt>account lockout, <a class="indexterm" href="#auth-core-account-lockout">Core - Account Lockout</a></dt><dt>general, <a class="indexterm" href="#auth-core-general">Core - General</a></dt><dt>global attributes, <a class="indexterm" href="#auth-core-global">Core - Global Attributes</a></dt><dt>persistent cookie (legacy), <a class="indexterm" href="#auth-core-persistent-cookie">Core - Persistent Cookie (Legacy)</a></dt><dt>post authentication processing, <a class="indexterm" href="#auth-core-post-auth">Core - Post Authentication Processing</a></dt><dt>realm attributes, <a class="indexterm" href="#auth-core-realm-attributes">Core - Realm Attributes</a></dt><dt>security, <a class="indexterm" href="#auth-core-security">Core - Security</a></dt></dl></dd><dt>Cross-domain single sign on (CDSSO), <a class="indexterm" href="#chap-cdsso">Configuring Cross-Domain Single Sign On</a></dt></dl></div><div class="indexdiv"><h3>D</h3><dl><dt>Dashboard service, <a class="indexterm" href="#chap-dashboard">Configuring the Dashboard Service</a>, <a class="indexterm" href="#dashboard-users">Adding Applications to a User's Dashboard</a></dt><dt>Data store authentication, <a class="indexterm" href="#datastore-module-conf-hints">Hints for the Data Store Authentication Module</a></dt><dt>Data stores</dt><dd><dl><dt>Active Directory, <a class="indexterm" href="#sec-data-stores-active-directory">Hints for Configuring Active Directory Data Stores</a></dt><dt>Active Directory Application Mode (ADAM), <a class="indexterm" href="#sec-data-stores-adam">Hints for Configuring Active Directory Application Mode (ADAM) Data Stores</a></dt><dt>Database Repository (Early Access), <a class="indexterm" href="#sec-data-stores-db">Hints for Configuring Database Repository (Early Access) Data Stores</a></dt><dt>Generic LDAPv3, <a class="indexterm" href="#sec-data-stores-generic-ldapv3">Hints for Configuring Generic LDAPv3 Data Stores</a></dt><dt>OpenDJ, <a class="indexterm" href="#sec-data-stores-opendj">Hints for Configuring OpenDJ Data Stores</a></dt><dt>Oracle DSEE, <a class="indexterm" href="#sec-data-stores-dsee">Hints for Configuring Sun/Oracle DSEE Data Stores</a></dt><dt>Tivoli Directory Server, <a class="indexterm" href="#sec-data-stores-tivoli">Hints for Configuring Tivoli Directory Server Data Stores</a></dt></dl></dd><dt>Debug logging</dt><dd><dl><dt>Level, <a class="indexterm" href="#log-debug-levels">Setting Debug Logging Levels</a></dt><dt>Rotation, <a class="indexterm" href="#log-rotate-debug">Rotating Debug Logs</a></dt><dt>Service selection, <a class="indexterm" href="#log-debug-selective-capture">Debug Logging by Service</a></dt><dt>Single file, <a class="indexterm" href="#log-debug-single-file">Debug Logging to a Single File</a></dt></dl></dd><dt>Delegating administration, <a class="indexterm" href="#manage-realms">Managing Realms</a></dt><dt>Device ID (Match) authentication, <a class="indexterm" href="#device-id-match-hints">Hints for the Device ID (Match) Authentication Module</a></dt><dt>Device ID (Save) authentication, <a class="indexterm" href="#device-id-save-hints">Hints for the Device ID (Save) Module</a></dt></dl></div><div class="indexdiv"><h3>E</h3><dl><dt>Enabling ssoadm.jsp, <a class="indexterm" href="#openam-ssoadm-jsp-overview">OpenAM ssoadm.jsp</a></dt><dt>Exhaustion actions, <a class="indexterm" href="#configure-session-quotas">Configuring Session Quotas</a></dt></dl></div><div class="indexdiv"><h3>F</h3><dl><dt>Federation, <a class="indexterm" href="#about-federation">About SAML 2.0 SSO &amp; Federation</a></dt><dd><dl><dt>Changing signing key, <a class="indexterm" href="#chap-certs-keystores">Managing Certificates</a></dt><dt>Configuring, <a class="indexterm" href="#set-up-federation">Setting Up SAML 2.0 SSO</a>, <a class="indexterm" href="#configure-idp">Configuring Identity Providers</a>, <a class="indexterm" href="#configure-sp">Configuring Service Providers</a>, <a class="indexterm" href="#configure-cot">Configuring Circles of Trust</a>, <a class="indexterm" href="#google-apps-as-sp">Configuring Google Apps as a Remote Service Provider</a>, <a class="indexterm" href="#salesforce-as-sp">Configuring Salesforce CRM as a Remote Service Provider</a>, <a class="indexterm" href="#saml2-ecp-config">Configuring OpenAM For the ECP Profile</a></dt><dt>Linking accounts, <a class="indexterm" href="#federation-linking-accounts">Managing Federated Accounts</a></dt><dt>SAML 1.x, <a class="indexterm" href="#chap-saml-1">Managing SAML 1.x Single Sign-On</a></dt><dt>SAML 2.0 Single Logout (SLO), <a class="indexterm" href="#using-saml2-sso-slo">Using SAML 2.0 Single Sign-On &amp; Single Logout</a></dt><dt>SAML 2.0 Single Sign-On (SSO), <a class="indexterm" href="#using-saml2-sso-slo">Using SAML 2.0 Single Sign-On &amp; Single Logout</a></dt></dl></dd><dt>Federation authentication, <a class="indexterm" href="#federation-module-conf-hints">Hints for the Federation Authentication Module</a></dt></dl></div><div class="indexdiv"><h3>G</h3><dl><dt>Google Apps, <a class="indexterm" href="#google-apps-as-sp">Configuring Google Apps as a Remote Service Provider</a></dt></dl></div><div class="indexdiv"><h3>H</h3><dl><dt>HMAC One-Time Password (HOTP) authentication, <a class="indexterm" href="#hotp-module-conf-hints">Hints for the HOTP Authentication Module</a></dt></dl></div><div class="indexdiv"><h3>J</h3><dl><dt>JDBC authentication, <a class="indexterm" href="#jdbc-module-conf-hints">Hints for the JDBC Authentication Module</a></dt></dl></div><div class="indexdiv"><h3>K</h3><dl><dt>Kerberos, <a class="indexterm" href="#desktop-module-conf-hints">Hints for the Windows Desktop SSO Authentication Module</a></dt></dl></div><div class="indexdiv"><h3>L</h3><dl><dt>LDAP authentication, <a class="indexterm" href="#ldap-module-conf-hints">Hints for the LDAP Authentication Module</a></dt><dt>Logging</dt><dd><dl><dt>Audit, <a class="indexterm" href="#chap-audit-logging">Configuring Audit Logging</a></dt><dt>Debug, <a class="indexterm" href="#debug-logging">Debug Logging</a></dt></dl></dd></dl></div><div class="indexdiv"><h3>M</h3><dl><dt>Monitoring, <a class="indexterm" href="#monitoring-interfaces">Monitoring Interfaces</a></dt><dd><dl><dt>CTS, <a class="indexterm" href="#cts-monitoring">Monitoring CTS Tokens</a></dt><dt>Health check, <a class="indexterm" href="#is-openam-alive">Is OpenAM Running?</a></dt><dt>JMX, <a class="indexterm" href="#monitoring-jmx">JMX Monitoring</a></dt><dt>Policy evaluation, <a class="indexterm" href="#snmp-policy-evaluation">SNMP Monitoring For Policy Evaluation</a></dt><dt>Sessions, <a class="indexterm" href="#snmp-sessions">SNMP Monitoring For Sessions</a></dt><dt>SNMP, <a class="indexterm" href="#monitoring-snmp">SNMP Monitoring</a></dt></dl></dd><dt>MSISDN authentication, <a class="indexterm" href="#msisdn-module-conf-hints">Hints for the MSISDN Authentication Module</a></dt></dl></div><div class="indexdiv"><h3>O</h3><dl><dt>OAuth 2.0, <a class="indexterm" href="#oauth2-module-conf-hints">Hints for the OAuth 2.0/OpenID Connect Authentication Module</a>, <a class="indexterm" href="#chap-oauth2">Managing OAuth 2.0 Authorization</a></dt><dd><dl><dt>about, <a class="indexterm" href="#about-oauth2-support">About OAuth 2.0 Support in OpenAM</a></dt><dt>authorization service</dt><dd><dl><dt>configuring, <a class="indexterm" href="#configure-oauth2-authz">Configuring the OAuth 2.0 Authorization Service</a></dt><dt>registering clients, <a class="indexterm" href="#register-oauth2-client">Registering OAuth 2.0 Clients with the Authorization Service</a></dt></dl></dd><dt>client agent profile</dt><dd><dl><dt>configuring, <a class="indexterm" href="#register-oauth2-client">Registering OAuth 2.0 Clients with the Authorization Service</a></dt><dt>creating, <a class="indexterm" href="#register-oauth2-client">Registering OAuth 2.0 Clients with the Authorization Service</a></dt></dl></dd><dt>client credentials grant, <a class="indexterm" href="#oauth2-client-cred">OAuth 2.0 Client Credentials Grant</a></dt><dt>endpoints, <a class="indexterm" href="#oauth2-endpoints">OpenAM OAuth 2.0 Endpoints</a></dt><dt>implicit grant, <a class="indexterm" href="#oauth2-implicit">OAuth 2.0 Implicit Grant</a></dt><dt>JWT bearer profile, <a class="indexterm" href="#oauth2-jwt-bearer">JWT Bearer Profile</a></dt><dt>OpenAM as authorization server</dt><dd><dl><dt>configuring, <a class="indexterm" href="#oauth2-sp-and-authz">Configuring OpenAM as a SAML Service Provider &amp; OAuth2 Authorization Server</a></dt></dl></dd><dt>OpenAM as authorization server &amp; client</dt><dd><dl><dt>configuring, <a class="indexterm" href="#oauth2-client-plus-authz">Configuring OpenAM as Authorization Server &amp; Client</a></dt></dl></dd><dt>OpenAM as OAuth 2.0 client, <a class="indexterm" href="#openam-oauth2-client">OpenAM as OAuth 2.0 Client &amp; Resource Server Solution</a></dt><dt>SAML 2.0 bearer assertion profiles, <a class="indexterm" href="#oauth2-saml2-bearer">SAML 2.0 Bearer Assertion Profiles</a></dt><dt>tokens</dt><dd><dl><dt>managing, <a class="indexterm" href="#oauth2-manage-tokens">Managing OAuth 2.0 Tokens</a></dt></dl></dd><dt>user consent, <a class="indexterm" href="#oauth2-user-consent">User Consent Management</a></dt><dt>using own client &amp; resource server, <a class="indexterm" href="#oauth2-byo-client">Using Your Own Client &amp; Resource Server</a></dt></dl></dd><dt>OAuth 2.0 clients</dt><dd><dl><dt>configuring, <a class="indexterm" href="#configure-oauth2-client">Configuring OAuth 2.0 &amp; OpenID Connect 1.0 Clients</a></dt></dl></dd><dt>OAuth 2.0/OpenID Connection 1.0, <a class="indexterm" href="#oauth2-module-conf-hints">Hints for the OAuth 2.0/OpenID Connect Authentication Module</a></dt><dt>OAuth2 2.0</dt><dd><dl><dt>resource server solution, <a class="indexterm" href="#openam-oauth2-client">OpenAM as OAuth 2.0 Client &amp; Resource Server Solution</a></dt><dt>security considerations, <a class="indexterm" href="#oauth2-security-considerations">Security Considerations</a></dt></dl></dd><dt>Open Authentication (OATH) authentication, <a class="indexterm" href="#OATH-module-conf-hints">Hints for the OATH Module</a></dt><dt>Open Identity Gateway, <a class="indexterm" href="#gateway-or-policy-agent">Open Identity Gateway or Policy Agent?</a></dt><dt>OpenAM</dt><dd><dl><dt>as an OAuth 2.0 authorization server, <a class="indexterm" href="#openam-oauth2-authz-server">OpenAM as OAuth 2.0 Authorization Server</a></dt><dt>authenticating to, <a class="indexterm" href="#authn-from-browser">Authenticating To OpenAM</a></dt></dl></dd><dt>OpenID Connect 1.0, <a class="indexterm" href="#oidc-module-conf-hints">Hints for the OpenID Connect id_token bearer Module</a>, <a class="indexterm" href="#chap-openid-connect">Managing OpenID Connect 1.0 Authorization</a></dt><dd><dl><dt>configuring, <a class="indexterm" href="#configure-oauth2-client">Configuring OAuth 2.0 &amp; OpenID Connect 1.0 Clients</a></dt></dl></dd><dt>OpenID Connect id_token Bearer module, <a class="indexterm" href="#oidc-module-conf-hints">Hints for the OpenID Connect id_token bearer Module</a></dt></dl></div><div class="indexdiv"><h3>P</h3><dl><dt>Password reset, <a class="indexterm" href="#chap-pwd-reset">Configuring User Self-Service Features</a></dt><dt>Performance, <a class="indexterm" href="#chap-tuning">Tuning OpenAM</a></dt><dt>Persistent Cookie module, <a class="indexterm" href="#persistent-cookie">Hints for the Persistent Cookie Module</a></dt><dt>Policy, <a class="indexterm" href="#what-is-authz-policies">OpenAM Policies and Applications</a></dt><dd><dl><dt>Configuring, <a class="indexterm" href="#configure-policies-with-console">Configuring Policies by Using the OpenAM Console</a></dt><dt>Delegating management, <a class="indexterm" href="#delegate-policy">Delegating Policy Management</a></dt><dt>Import, Export, <a class="indexterm" href="#script-policy">Importing and Exporting Policies</a></dt></dl></dd><dt>policy agent profiles</dt><dd><dl><dt>agent administrators</dt><dd><dl><dt>creating, <a class="indexterm" href="#delegate-agent-profile-creation">Delegating Agent Profile Creation</a></dt></dl></dd><dt>creating, <a class="indexterm" href="#create-agent-profiles">Creating Agent Profiles</a></dt><dt>delegating creation of, <a class="indexterm" href="#delegate-agent-profile-creation">Delegating Agent Profile Creation</a></dt><dt>kinds of, <a class="indexterm" href="#kinds-of-agent-profiles">Kinds of Agent Profiles</a></dt><dt>web policy agents</dt><dd><dl><dt>creating, <a class="indexterm" href="#configure-web-policy-agent">Configuring Web Policy Agents</a></dt></dl></dd></dl></dd><dt>Policy agents</dt><dd><dl><dt>Configuring, <a class="indexterm" href="#configure-j2ee-policy-agent">Configuring Java EE Policy Agents</a>, <a class="indexterm" href="#configure-22-policy-agent">Configuring Version 2.2 Policy Agents</a>, <a class="indexterm" href="#configure-agent-auth">Configuring Agent Authenticators</a></dt><dt>configuring, <a class="indexterm" href="#configure-sts-policy-agent">Configuring Security Token Service Client Policy Agents</a></dt><dt>Group inheritance, <a class="indexterm" href="#create-agent-profiles">Creating Agent Profiles</a></dt><dt>OAuth 2.0 clients</dt><dd><dl><dt>configuring, <a class="indexterm" href="#configure-oauth2-client">Configuring OAuth 2.0 &amp; OpenID Connect 1.0 Clients</a></dt></dl></dd><dt>profiles, <a class="indexterm" href="#chap-agents">Configuring Policy Agent Profiles</a></dt><dt>Profiles, <a class="indexterm" href="#kinds-of-agent-profiles">Kinds of Agent Profiles</a></dt><dt>security token service client, <a class="indexterm" href="#configure-sts-policy-agent">Configuring Security Token Service Client Policy Agents</a></dt><dt>web service client</dt><dd><dl><dt>configuring, <a class="indexterm" href="#configure-wsc-policy-agent">Configuring Web Service Client Policy Agents</a></dt></dl></dd><dt>web service provider</dt><dd><dl><dt>configuring, <a class="indexterm" href="#configure-wsp-policy-agent">Configuring Web Service Provider Policy Agents</a></dt></dl></dd></dl></dd><dt>Post authentication plugins, <a class="indexterm" href="#authn-post-auth-plugins">Post Authentication Plugins</a></dt></dl></div><div class="indexdiv"><h3>R</h3><dl><dt>RADIUS module, <a class="indexterm" href="#radius-module-conf-hints">Hints for the RADIUS Authentication Module</a></dt><dt>Realms, <a class="indexterm" href="#chap-realms">Configuring Realms</a></dt><dd><dl><dt>Creating, <a class="indexterm" href="#manage-realms">Managing Realms</a></dt></dl></dd><dt>Referral</dt><dd><dl><dt>Configuring, <a class="indexterm" href="#configure-referrals-with-console">Configuring Referrals by Using the OpenAM Console</a></dt><dt>Enabling, <a class="indexterm" href="#configure-referrals-with-console">Configuring Referrals by Using the OpenAM Console</a></dt></dl></dd><dt>REST API, <a class="indexterm" href="#chap-rest">Configuring REST APIs</a></dt><dt>Restore, <a class="indexterm" href="#chap-backup-restore">Backing Up and Restoring OpenAM Configurations</a></dt><dt>Restoring, <a class="indexterm" href="#chap-backup-restore">Backing Up and Restoring OpenAM Configurations</a></dt></dl></div><div class="indexdiv"><h3>S</h3><dl><dt>Salesforce CRM, <a class="indexterm" href="#salesforce-as-sp">Configuring Salesforce CRM as a Remote Service Provider</a></dt><dt>SAML 1.x, <a class="indexterm" href="#chap-saml-1">Managing SAML 1.x Single Sign-On</a></dt><dt>SAML 2.0</dt><dd><dl><dt>OpenAM as server provider</dt><dd><dl><dt>configuring, <a class="indexterm" href="#oauth2-sp-and-authz">Configuring OpenAM as a SAML Service Provider &amp; OAuth2 Authorization Server</a></dt><dt>getting access token, <a class="indexterm" href="#oauth2-sp-and-authz">Configuring OpenAM as a SAML Service Provider &amp; OAuth2 Authorization Server</a></dt></dl></dd></dl></dd><dt>Scripted authentication module, <a class="indexterm" href="#scripted-module-conf-hints">Hints for Scripted Authentication Modules</a></dt><dt>Secure Attribute Exchange (SAE) module, <a class="indexterm" href="#sae-module-conf-hints">Hints for the SAE Authentication Module</a></dt><dt>Securing OpenAM, <a class="indexterm" href="#chap-securing">Securing OpenAM</a></dt><dt>Session quotas</dt><dd><dl><dt>configuring, <a class="indexterm" href="#configure-session-quotas">Configuring Session Quotas</a></dt></dl></dd><dt>Sessions, <a class="indexterm" href="#session-mgmt">Session Management</a></dt><dt>Silent installation, <a class="indexterm" href="#openam-cli-overview">OpenAM Command-Line Tools</a></dt><dt>Single Sign-On (SSO), <a class="indexterm" href="#chap-sso">Configuring Single Sign-On within One Domain</a></dt><dt>Social Authentication</dt><dd><dl><dt>configuring, <a class="indexterm" href="#configure-social-authn">Configuring Social Authentication</a></dt><dt>custon providers</dt><dd><dl><dt>configuring, <a class="indexterm" href="#social-authn-wizard-custom">Configuring Custom Social Authentication Providers</a></dt></dl></dd><dt>implementations service</dt><dd><dl><dt>configuring, <a class="indexterm" href="#social-authn-implementations-service">Configuring the Social Authentication Implementations service</a></dt></dl></dd><dt>pre-populating providers, <a class="indexterm" href="#social-authn-wizard-pre-populated">Configuring Pre-Populated Social Authentication Providers</a></dt><dd><dl><dt>configuring, <a class="indexterm" href="#social-authn-wizard-pre-populated">Configuring Pre-Populated Social Authentication Providers</a></dt></dl></dd></dl></dd><dt>SSL, <a class="indexterm" href="#chap-certs-keystores">Managing Certificates</a></dt><dt>ssoadm.jsp</dt><dd><dl><dt>enabling, <a class="indexterm" href="#openam-ssoadm-jsp-overview">OpenAM ssoadm.jsp</a></dt></dl></dd></dl></div><div class="indexdiv"><h3>T</h3><dl><dt>Troubleshooting, <a class="indexterm" href="#chap-troubleshooting">Troubleshooting</a></dt></dl></div><div class="indexdiv"><h3>V</h3><dl><dt>Valid goto URL resources</dt><dd><dl><dt>configuring, <a class="indexterm" href="#configure-valid-goto-url-resources">Configuring Valid goto URL Resources</a></dt></dl></dd></dl></div><div class="indexdiv"><h3>W</h3><dl><dt>web policy agents</dt><dd><dl><dt>advanced properties</dt><dd><dl><dt>configuring, <a class="indexterm" href="#configure-web-pa-advanced-props">Configuring Web Policy Agent Advanced Properties</a></dt></dl></dd><dt>application properties</dt><dd><dl><dt>configuring, <a class="indexterm" href="#configure-web-pa-application-props">Configuring Web Policy Agent Application Properties</a></dt></dl></dd><dt>general properties, <a class="indexterm" href="#configure-web-pa-global-props">Configuring Web Policy Agent Global Properties</a></dt><dt>global properties</dt><dd><dl><dt>configuring, <a class="indexterm" href="#configure-web-pa-global-props">Configuring Web Policy Agent Global Properties</a></dt></dl></dd><dt>miscellaneous properties</dt><dd><dl><dt>configuring, <a class="indexterm" href="#configure-web-pa-misc-props">Configuring Web Policy Agent Miscellaneous Properties</a></dt></dl></dd><dt>OpenAM services properties</dt><dd><dl><dt>configuring, <a class="indexterm" href="#configure-web-pa-services-props">Configuring Web Policy Agent OpenAM Services Properties</a></dt></dl></dd><dt>SSO properties</dt><dd><dl><dt>configuring, <a class="indexterm" href="#configure-web-pa-sso-props">Configuring Web Policy Agent SSO Properties</a></dt></dl></dd></dl></dd><dt>Web Service Security (WSSAuth) module, <a class="indexterm" href="#wss-module-conf-hints">Hints for the WSSAuth Authentication Module</a></dt><dt>Windows Desktop SSO module, <a class="indexterm" href="#desktop-module-conf-hints">Hints for the Windows Desktop SSO Authentication Module</a></dt><dt>WIndows NT module, <a class="indexterm" href="#winnt-module-conf-hints">Hints for the Windows NT Authentication Module</a></dt></dl></div><div class="indexdiv"><h3>X</h3><dl><dt>X509 Certificate-based authentication, <a class="indexterm" href="#cert-module-conf-hints">Hints for the Certificate Authentication Module</a></dt></dl></div><div class="indexdiv"><h3>Z</h3><dl><dt>Zero page login, <a class="indexterm" href="#auth-core-security">Core - Security</a></dt></dl></div></div></div></div><p>&nbsp;</p><div id="footer"><p>Something wrong on this page? <a href="https://bugster.forgerock.org/jira/secure/CreateIssueDetails!init.jspa?pid=10000&components=10007&issuetype=1">Log a documentation bug.</a></p></div>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-23412190-14']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</body></html>