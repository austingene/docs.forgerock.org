<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head>

      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   <title>Chapter&nbsp;3.&nbsp;Using RESTful Web Services</title><link rel="stylesheet" type="text/css" href="coredoc.css"><link rel="stylesheet" type="text/css" href="css/coredoc.css"><link rel="stylesheet" type="text/css" href="sh/shCore.css"><link rel="stylesheet" type="text/css" href="sh/shCoreEclipse.css"><link rel="stylesheet" type="text/css" href="sh/shThemeEclipse.css"><script src="http://code.jquery.com/jquery-1.11.0.min.js" type="text/javascript"></script><script src="uses-jquery.js" type="text/javascript"></script><script src="sh/shCore.js" type="text/javascript"></script><script src="sh/shBrushAci.js" type="text/javascript"></script><script src="sh/shBrushBash.js" type="text/javascript"></script><script src="sh/shBrushCsv.js" type="text/javascript"></script><script src="sh/shBrushHttp.js" type="text/javascript"></script><script src="sh/shBrushJava.js" type="text/javascript"></script><script src="sh/shBrushJScript.js" type="text/javascript"></script><script src="sh/shBrushLDIF.js" type="text/javascript"></script><script src="sh/shBrushPlain.js" type="text/javascript"></script><script src="sh/shBrushProperties.js" type="text/javascript"></script><script src="sh/shBrushXml.js" type="text/javascript"></script><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><link rel="home" href="index.html" title="OpenAM Developer's Guide"><link rel="up" href="index.html" title="OpenAM Developer's Guide"><link rel="prev" href="chap-client-dev.html" title="Chapter&nbsp;2.&nbsp;Developing Client Applications"><link rel="next" href="chap-jdk.html" title="Chapter&nbsp;4.&nbsp;Using the OpenAM Java SDK"><link rel="copyright" href="legalnotice.html" title="Legal Notice"><script type="text/javascript">SyntaxHighlighter.all();</script>
<link rel="shortcut icon" href="http://forgerock.org/favicon.ico">
</head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter&nbsp;3.&nbsp;Using RESTful Web Services</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="chap-client-dev.html">Prev</a>&nbsp;</td><th width="60%" align="center">&nbsp;</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="chap-jdk.html">Next</a></td></tr></table><hr></div><div lang="en" class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="chap-rest"></a>Chapter&nbsp;3.&nbsp;Using RESTful Web Services</h1></div></div></div><div class="toc"><div class="toc-title">Table of Contents</div><dl class="toc"><dt><span class="section"><a href="chap-rest.html#about-openam-rest-api">3.1. About the RESTful API</a></span></dt><dt><span class="section"><a href="chap-rest.html#c66-encoding">3.2. Token Encoding</a></span></dt><dt><span class="section"><a href="chap-rest.html#rest-api-auth">3.3. Authentication &amp; Logout</a></span></dt><dt><span class="section"><a href="chap-rest.html#rest-api-cookie-info">3.4. Cookie Information</a></span></dt><dt><span class="section"><a href="chap-rest.html#rest-api-tokens">3.5. Token Validation, Attribute Retrieval</a></span></dt><dt><span class="section"><a href="chap-rest.html#rest-api-authz">3.6. Authorization</a></span></dt><dt><span class="section"><a href="chap-rest.html#rest-api-oauth2">3.7. OAuth 2.0 Authorization</a></span></dt><dt><span class="section"><a href="chap-rest.html#rest-api-openid-connect">3.8. OpenID Connect 1.0</a></span></dt><dt><span class="section"><a href="chap-rest.html#rest-api-self-registration">3.9. User Self-Registration</a></span></dt><dt><span class="section"><a href="chap-rest.html#rest-api-password-reset">3.10. Resetting Forgotten Passwords</a></span></dt><dt><span class="section"><a href="chap-rest.html#rest-api-logging">3.11. Logging</a></span></dt><dt><span class="section"><a href="chap-rest.html#rest-api-crud-identity">3.12. Identity Management</a></span></dt><dt><span class="section"><a href="chap-rest.html#rest-api-crud-realm">3.13. Realm Management</a></span></dt><dt><span class="section"><a href="chap-rest.html#rest-dashboard">3.14. Displaying Dashboard Applications</a></span></dt><dt><span class="section"><a href="chap-rest.html#rest-api-status-codes">3.15. REST Status Codes</a></span></dt></dl></div><a class="indexterm" name="d0e359"></a><p>This chapter shows how to use the OpenAM RESTful interfaces for direct
 integration between web client applications and OpenAM.</p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="about-openam-rest-api"></a>3.1.&nbsp;About the RESTful API</h2></div></div></div><p>Interface Stability: <a href="../../admin-guide/index/appendix-interface-stability.html#interface-stability" class="link">Evolving</a></p><p>OpenAM offers a RESTful API for these access and identity management
  operations:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="link" href="chap-rest.html#rest-api-auth" title="3.3.&nbsp;Authentication &amp; Logout">Authentication</a> (login)</p></li><li class="listitem"><p><a class="link" href="chap-rest.html#rest-api-auth" title="3.3.&nbsp;Authentication &amp; Logout">Logout</a></p></li><li class="listitem"><p><a class="link" href="chap-rest.html#rest-api-cookie-info" title="3.4.&nbsp;Cookie Information">Cookie information</a></p></li><li class="listitem"><p><a class="link" href="chap-rest.html#rest-api-tokens" title="3.5.&nbsp;Token Validation, Attribute Retrieval">Token attribute retrieval</a></p></li><li class="listitem"><p><a class="link" href="chap-rest.html#rest-api-tokens" title="3.5.&nbsp;Token Validation, Attribute Retrieval">Token validation</a></p></li><li class="listitem"><p><a class="link" href="chap-rest.html#rest-api-authz" title="3.6.&nbsp;Authorization">Authorization</a></p></li><li class="listitem"><p><a class="link" href="chap-rest.html#rest-api-oauth2" title="3.7.&nbsp;OAuth 2.0 Authorization">OAuth 2.0 Authorization</a></p></li><li class="listitem"><p><a class="link" href="chap-rest.html#rest-api-openid-connect" title="3.8.&nbsp;OpenID Connect 1.0">OpenID Connect 1.0</a></p></li><li class="listitem"><p><a class="link" href="chap-rest.html#rest-api-self-registration" title="3.9.&nbsp;User Self-Registration">User self-registration</a></p></li><li class="listitem"><p><a class="link" href="chap-rest.html#rest-api-password-reset" title="3.10.&nbsp;Resetting Forgotten Passwords">Resetting forgotten passwords</a></p></li><li class="listitem"><p><a class="link" href="chap-rest.html#rest-api-logging" title="3.11.&nbsp;Logging">Logging</a></p></li><li class="listitem"><p><a class="link" href="chap-rest.html#rest-api-crud-identity" title="3.12.&nbsp;Identity Management">Identity management</a> (creating,
    reading, updating, deleting identities)</p></li><li class="listitem"><p><a class="link" href="chap-rest.html#rest-api-crud-realm" title="3.13.&nbsp;Realm Management">Realm management</a> (creating,
    reading, updating, deleting realms)</p></li><li class="listitem"><p><a class="link" href="chap-rest.html#rest-dashboard" title="3.14.&nbsp;Displaying Dashboard Applications">Displaying Dashboard Applications</a></p></li></ul></div><p>This chapter also includes a section on <a class="xref" href="chap-rest.html#rest-api-status-codes" title="3.15.&nbsp;REST Status Codes">Section&nbsp;3.15, &#8220;REST Status Codes&#8221;</a>.</p><p>In this chapter, long URLs are wrapped to fit the printed page, as some
  of the output is formatted for easier reading.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="c66-encoding"></a>3.2.&nbsp;Token Encoding</h2></div></div></div><p>Valid tokens in OpenAM requires configuration either in percent encoding or in <span class="emphasis"><em>C66Encode</em></span>
  format. C66Encode format is encouraged. It is the default token format for OpenAM, and is used in this chapter.
  The following is an example token that has not been encoded:</p><pre class="literallayout">AQIC5wM2LY4SfczntBbXvEAOuECbqMY3J4NW3byH6xwgkGE=@AAJTSQACMDE=#</pre><p>This token includes reserved characters such as <code class="literal">+</code>, <code class="literal">/</code>,
  and <code class="literal">=</code> (The <code class="literal">@</code>, <code class="literal">#</code>, and <code class="literal">*</code> are not
  reserved characters per se, but substitutions are still required). To c66encode this token,
  you would substitute certain characters for others, as follows:</p><pre class="brush: plain;">+ is replaced with -
/ is replaced with _
= is replaced with .
@ is replaced with *
# is repalced with *
* (first instance) is replaced with @
* (subsequent instances) is replaced with #</pre><p>In this case, the translated token would appear as shown here:</p><pre class="literallayout">AQIC5wM2LY4SfczntBbXvEAOuECbqMY3J4NW3byH6xwgkGE.*AAJTSQACMDE.*</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="rest-api-auth"></a>3.3.&nbsp;Authentication &amp; Logout</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="chap-rest.html#rest-api-auth-json">3.3.1. Authentication &amp; Logout</a></span></dt><dt><span class="section"><a href="chap-rest.html#rest-api-auth-legacy">3.3.2. Authentication &amp; Logout (Legacy API)</a></span></dt></dl></div><a class="indexterm" name="d0e478"></a><a class="indexterm" name="d0e483"></a><p>OpenAM provides REST APIs for authentication and for logout.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Under <code class="literal">/json/authenticate</code> and
    <code class="literal">/json/sessions</code>, you find the newer JSON-based APIs.</p><p>See <a class="xref" href="chap-rest.html#rest-api-auth-json" title="3.3.1.&nbsp;Authentication &amp; Logout">Section&nbsp;3.3.1, &#8220;Authentication &amp; Logout&#8221;</a> below.</p></li><li class="listitem"><p>Under <code class="literal">/identity/authenticate</code> and
    <code class="literal">/identity/logout</code>, you find the backwards-compatible,
    legacy API.</p><p>See <a class="xref" href="chap-rest.html#rest-api-auth-legacy" title="3.3.2.&nbsp;Authentication &amp; Logout (Legacy API)">Section&nbsp;3.3.2, &#8220;Authentication &amp; Logout (Legacy API)&#8221;</a> below.</p></li></ul></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="rest-api-auth-json"></a>3.3.1.&nbsp;Authentication &amp; Logout</h3></div></div></div><p>The simplest user name/password authentication returns a
   <code class="literal">tokenId</code> that applications can present as a cookie
   value for other operations that require authentication. In this case use
   HTTP POST to prevent the web container from logging the credentials.
   Pass the user name in an <code class="literal">X-OpenAM-Username</code> header, and
   the password in an <code class="literal">X-OpenAM-Password</code> header.</p><div class="screen"><pre>$ curl --request POST
 --header "X-OpenAM-Username: demo" --header "X-OpenAM-Password: changeit"
 --header "Content-Type: application/json" --data "{}"
 https://openam.example.com:8443/openam/json/authenticate

{ "tokenId": "AQIC5w...NTcy*", "successUrl": "/openam/console" }</pre></div><p>This "zero page login" mechanism works only for name/password
   authentication. If you include a POST body with the request, it must
   be an empty JSON string as shown in the example. Alternatively, you can
   leave the POST body empty. Otherwise, OpenAM interprets the body as a
   continuation of an existing authentication attempt, one that uses a
   supported callback mechanism.</p><p>The authentication service at <code class="literal">/json/authenticate</code>
   supports callback mechanisms that make it possible to perform other types of
   authentication in addition to simple user name/password login.</p><p>Callbacks that are not completed based on the content of the client
   HTTP request are returned in JSON as a response to the request. Each
   callback has an array of output suitable for displaying to the end user,
   and input which is what the client must complete and send back to
   OpenAM. The default is still user name/password authentication.</p><div class="screen"><pre>$ curl --request POST --header "Content-Type: application/json"
 https://openam.example.com:8443/openam/json/authenticate

{
    "authId": "...jwt-value...",
    "template": "",
    "stage": "DataStore1",
    "callbacks": [
        {
            "type": "NameCallback",
            "output": [
                {
                    "name": "prompt",
                    "value": " User Name: "
                }
            ],
            "input": [
                {
                    "name": "IDToken1",
                    "value": ""
                }
            ]
        },
        {
            "type": "PasswordCallback",
            "output": [
                {
                    "name": "prompt",
                    "value": " Password: "
                }
            ],
            "input": [
                {
                    "name": "IDToken2",
                    "value": ""
                }
            ]
        }
    ]
}</pre></div><p>The "authId" value is a JSON Web Token (JWT) that uniquely identifies
   the authentication context to OpenAM, and so must also be sent back with the
   requests.</p><p>To respond to the callback, send back the JSON object with the missing
   values filled, as in this case where the user name is <code class="literal">demo</code>
   and the password is <code class="literal">changeit</code>.</p><div class="informalexample"><div class="screen"><pre>$ curl --request POST --header "Content-Type: application/json"
 --data '{ "authId": "...jwt-value...", "template": "", "stage": "DataStore1",
   "callbacks": [ { "type": "NameCallback", "output": [ { "name": "prompt",
   "value": " User Name: " } ], "input": [ { "name": "IDToken1", "value": "demo" } ] },
   { "type": "PasswordCallback", "output": [ { "name": "prompt", "value": " Password: " } ],
   "input": [ { "name": "IDToken2", "value": "changeit" } ] } ] }'
 https://openam.example.com:8443/openam/json/authenticate

{ "tokenId": "AQIC5wM2...U3MTE4NA..*", "successUrl": "/openam/console" }</pre></div></div><p>The response is a token ID holding the SSO Token value.</p><p>Alternatively, you can authenticate without requesting a session
   using the <code class="literal">noSession</code> query string parameter.</p><div class="informalexample"><div class="screen"><pre>$ curl --request POST --header "Content-Type: application/json"
 --data '{ "authId": "...jwt-value...", "template": "", "stage": "DataStore1",
   "callbacks": [ { "type": "NameCallback", "output": [ { "name": "prompt",
   "value": " User Name: " } ], "input": [ { "name": "IDToken1", "value": "demo" } ] },
   { "type": "PasswordCallback", "output": [ { "name": "prompt", "value": " Password: " } ],
   "input": [ { "name": "IDToken2", "value": "changeit" } ] } ] }'
 https://openam.example.com:8443/openam/json/authenticate?noSession=true

{ "message": "Authentication Successful", "successUrl": "/openam/console" }</pre></div></div><p>OpenAM can be configured to return a failure URL value when
   authentication fails. No failure URL is configured by default. The Default
   Failure Login URL can be configured for the <a href="../../admin-guide/index/chap-auth-services.html#core-module-conf-hints" class="link">Core</a> authentication
   module. Alternatively, failure URLs can be configured per authentication
   chain, which your client can specify using the <code class="literal">service</code>
   parameter described below. On failure OpenAM then returns HTTP status
   code 401 Unauthorized, and the JSON in the reply indicates the failure
   URL.</p><div class="screen"><pre>$ curl --request POST --header "Content-Type: application/json"
 --header "X-OpenAM-Username: demo" --header "X-OpenAM-Password: badpassword"
 https://openam.example.com:8443/openam/json/authenticate

{ "errorMessage": "Invalid Password!!",
  "failureUrl": "http://www.example.com/401.html" }</pre></div><p>You can set the realm by using the realm query string parameter as
   in <code class="literal">?realm=myRealm</code>.</p><div class="variablelist"><p>You can use the <code class="literal">authIndexType</code> and
    <code class="literal">authIndexValue</code> query string parameters as a pair
    to provide additional information about how you are authenticating.
    The <code class="literal">authIndexType</code> can be one of the following
    types.</p><dl class="variablelist"><dt><span class="term">composite</span></dt><dd><p>Set the value to a composite advice string.</p></dd><dt><span class="term">level</span></dt><dd><p>Set the value to the authentication level.</p></dd><dt><span class="term">module</span></dt><dd><p>Set the value to the name of an authentication module.</p></dd><dt><span class="term">resource</span></dt><dd><p>Set the value to a URL protected by an OpenAM policy.</p></dd><dt><span class="term">role</span></dt><dd><p>Set the value to an OpenAM role.</p></dd><dt><span class="term">service</span></dt><dd><p>Set the value to the name of an authentication chain.</p></dd><dt><span class="term">user</span></dt><dd><p>Set the value to an OpenAM user ID.</p></dd></dl></div><div class="itemizedlist"><p>OpenAM uses the following callback types depending on the
    authentication module in use.</p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>ChoiceCallback</p></li><li class="listitem"><p>ConfirmationCallback</p></li><li class="listitem"><p>HttpCallback</p></li><li class="listitem"><p>LanguageCallback</p></li><li class="listitem"><p>NameCallback</p></li><li class="listitem"><p>PasswordCallback</p></li><li class="listitem"><p>RedirectCallback</p></li><li class="listitem"><p>TextInputCallback</p></li><li class="listitem"><p>TextOutputCallback</p></li><li class="listitem"><p>X509CertificateCallback</p></li></ul></div><p>Authenticated users can log out with the token cookie value and an HTTP
   POST to <code class="literal">/json/sessions/?_action=logout</code>.</p><div class="screen"><pre>$ curl
 --request POST
 --header "iplanetDirectoryPro: AQIC5wM2...U3MTE4NA..*"
 "https://openam.example.com:8443/openam/json/sessions/?_action=logout"

{"result":"Successfully logged out"}</pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="rest-api-auth-legacy"></a>3.3.2.&nbsp;Authentication &amp; Logout (Legacy API)</h3></div></div></div><p>Interface Stability: <a href="../../admin-guide/index/appendix-interface-stability.html#interface-stability" class="link">Deprecated</a></p><p>Simple authentication with a user name and password returns a
    token.</p><div class="screen"><pre>$ curl --request POST --data "username=bjensen&amp;password=hifalutin"
 https://openam.example.com:8443/openam/identity/authenticate

token.id=AQIC5wM2LY4SfcxvdvHOXjtC_eWSs2RB54tgvgK8SuYi7aQ.*AAJTSQACMDE.*</pre></div><p>If you must specify parameters as when authenticating to
    <code class="literal">/UI/Login</code>, you provide a percent encoded string of the
    parameters as the value of the <code class="literal">uri</code> parameter. The
    <code class="literal">/UI/Login</code> parameter deals with the <code class="literal">realm</code>,
    <code class="literal">module</code>, and <code class="literal">service</code> parameters. Setting the
    <code class="literal">client</code> parameter sets the user's IP address as part of the
    token following successful authentication. The default for the <code class="literal">client</code>
    parameter is the IP of the machine making the REST request.</p><div class="screen"><pre>$ curl --request POST --data "username=bjensen
 &amp;password=hifalutin
 &amp;uri=realm%3D%2F%26module%3DDataStore
 &amp;client=192.168.1.1"
 https://openam.example.com:8443/openam/identity/authenticate

token.id=AQIC5wM2LY4SfcxvdvHOXjtC_eWSs2RB54tgvgK8SuYi7aQ.*AAJTSQACMDE.*</pre></div><p>You log out using the token to end the user session.</p><div class="screen"><pre>$ curl --request POST --data "subjectid=AQIC5w...*AAJTSQACMDE.*"
https://openam.example.com:8443/openam/identity/logout</pre></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="rest-api-cookie-info"></a>3.4.&nbsp;Cookie Information</h2></div></div></div><p>You can retrieve the cookie domains that OpenAM supports by HTTP GET on
  <code class="literal">/json/serverinfo/cookieDomains</code>.</p><div class="screen"><pre>$ curl https://openam.example.com:8443/openam/json/serverinfo/cookieDomains
{"domains":[".example.com"]}</pre></div><p>You can retrieve the name of the cookie used for storing the session
  token. By default it is <code class="literal">iPlanetDirectoryPro</code>.</p><div class="screen"><pre>$ curl https://openam.example.com:8443/openam/identity/getCookieNameForToken
string=iPlanetDirectoryPro</pre></div><p>You can also retrieve the name of the cookie used for storing the session
  token and the names of the cookies to forward with requests.</p><div class="screen"><pre>$ curl https://openam.example.com:8443/openam/identity/getCookieNamesToForward
string=iPlanetDirectoryPro
string=amlbcookie</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="rest-api-tokens"></a>3.5.&nbsp;Token Validation, Attribute Retrieval</h2></div></div></div><p>You check whether a token is valid as follows.</p><div class="screen"><pre>$ curl --request POST --data "tokenid=AQIC5w...*AAJTSQACMDE.*" 
  https://openam.example.com:8443/openam/identity/isTokenValid
boolean=true</pre></div><p>An invalid token returns <code class="literal">boolean=false</code>.</p><div class="screen"><pre>$ curl --request POST --data "tokenid=INVALID" 
  https://openam.example.com:8443/openam/identity/isTokenValid
boolean=false</pre></div><p>With a valid token, you can retrieve attributes about the subject.
  OpenAM returns a series of <em class="replaceable"><code>name</code></em>,
  <em class="replaceable"><code>value</code></em> pairs.</p><p>The newer API for retrieving user information is demonstrated in
  <a class="xref" href="chap-rest.html#rest-api-read-identity" title="3.12.2.&nbsp;Reading Identities">Section&nbsp;3.12.2, &#8220;Reading Identities&#8221;</a>. What follows describes the
  legacy API.</p><a class="indexterm" name="d0e769"></a><div class="screen"><pre>$ curl --request POST --data "subjectid=AQIC5w...*AAJTSQACMDE.*" 
  https://openam.example.com:8443/openam/identity/attributes
userdetails.token.id=
 AQIC5wM2LY4SfcxuxIP0VnP2lVjs7ypEM6VDx6srk56CN1Q.*AAJTSQACMDE.*
userdetails.attribute.name=uid
userdetails.attribute.value=bjensen
userdetails.attribute.name=mail
userdetails.attribute.value=bjensen@example.com
userdetails.attribute.name=sn
userdetails.attribute.value=Jensen
userdetails.attribute.name=userpassword
userdetails.attribute.value={SSHA}rhusOfYpkapDWEHcfT2Y7y83LMuC++F4Abqvig==
userdetails.attribute.name=cn
userdetails.attribute.value=Babs Jensen
userdetails.attribute.value=Barbara Jensen
userdetails.attribute.name=givenname
userdetails.attribute.value=Barbara
userdetails.attribute.name=dn
userdetails.attribute.value=uid=bjensen,ou=people,dc=example,dc=com
userdetails.attribute.name=telephonenumber
userdetails.attribute.value=+1 408 555 1862
userdetails.attribute.name=objectclass
userdetails.attribute.value=organizationalPerson
userdetails.attribute.value=person
userdetails.attribute.value=posixAccount
userdetails.attribute.value=inetOrgPerson
userdetails.attribute.value=krbprincipalaux
userdetails.attribute.value=krbTicketPolicyAux
userdetails.attribute.value=top</pre></div><p>You can specify attributes to limit what you retrieve.</p><div class="screen"><pre>$ curl "https://openam.example.com:8443/openam/identity/attributes?
 subjectid=AQIC5wM2LY4SfcxuxIP0VnP2lVjs7ypEM6VDx6srk56CN1Q.*AAJTSQACMDE.*
 &amp;attributenames=mail
 &amp;attributenames=uid"
userdetails.token.id=
 AQIC5wM2LY4SfcxuxIP0VnP2lVjs7ypEM6VDx6srk56CN1Q.*AAJTSQACMDE.*
userdetails.attribute.name=uid
userdetails.attribute.value=bjensen
userdetails.attribute.name=mail
userdetails.attribute.value=bjensen@example.com</pre></div><p>When retrieving attributes, you can refresh the session thus setting
  the idle time to 0, by adding the boolean parameter
  <code class="literal">refresh=true</code> to the query string.</p><div class="screen"><pre>$ curl "https://openam.example.com:8443/openam/identity/attributes?
 subjectid=AQIC5wM2LY4SfcxuxIP0VnP2lVjs7ypEM6VDx6srk56CN1Q.*AAJTSQACMDE.*
 &amp;attributenames=cn
 &amp;refresh=true"
userdetails.token.id=
 AQIC5wM2LY4SfcxuxIP0VnP2lVjs7ypEM6VDx6srk56CN1Q.*AAJTSQACMDE.*
userdetails.attribute.name=cn
userdetails.attribute.value=Babs Jensen
userdetails.attribute.value=Barbara Jensen</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="rest-api-authz"></a>3.6.&nbsp;Authorization</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="chap-rest.html#rest-api-policy-decisions">3.6.1. Requesting Policy Decisions</a></span></dt><dt><span class="section"><a href="chap-rest.html#rest-api-policy-management">3.6.2. Managing Policies</a></span></dt></dl></div><a class="indexterm" name="d0e790"></a><p>You can call on OpenAM to decide whether to authorize access to a
  protected resource based on a valid token. Of course, you must percent
  encode the resource URI.</p><div class="screen"><pre>$ curl "https://openam.example.com:8443/openam/identity/authorize?
 uri=http%3A%2F%2Fwww.example.com%3A8080%2Fexamples%2Findex.html
 &amp;subjectid=AQIC5wM2LY4SfcxuxIP0VnP2lVjs7ypEM6VDx6srk56CN1Q.*AAJTSQACMDE.*"
boolean=true</pre></div><p>To indicate access denied, OpenAM returns
  <code class="literal">boolean=false</code>.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="rest-api-policy-decisions"></a>3.6.1.&nbsp;Requesting Policy Decisions</h3></div></div></div><p>OpenAM provides additional REST APIs for requesting policy
   decisions.</p><div class="itemizedlist"><p>The policy decision interfaces use the following path suffixes and
    query string parameters.</p><p>Path suffixes for policy decision requests include the following.</p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">ws/1/entitlement/decision</code>: request a decision
     pertaining to a single resource</p></li><li class="listitem"><p><code class="literal">ws/1/entitlement/decisions</code>: request decisions
     pertaining to multiple resources</p></li><li class="listitem"><p><code class="literal">ws/1/entitlement/entitlement</code>: request decisions
     for a specified resource URL and all resources underneath</p></li></ul></div><div class="itemizedlist"><p>Query string parameters for policy decision requests include the
    following.</p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">subject=<em class="replaceable"><code>encoded-token</code></em></code>,
     where the token is encoded using the method implemented in <a class="link" href="http://sources.forgerock.org/browse/~raw,r=6/openam/trunk/opensso/www/public/use/docs/fampdf/Encoder.java" target="_blank"><code class="filename">Encoder.java</code></a>.</p><p>In the examples for this section, the token ID obtained during
     authentication for <code class="literal">amadmin</code> is abbreviated as
     <code class="literal">AQIC5...DU3*</code> and the encoded token ID for the subject
     is <code class="literal">MJ3QFTr4ZV2QrtlJvXlg0Q2dMRM=</code>.</p></li><li class="listitem"><p><code class="literal">action=get</code>, or <code class="literal">action=post</code>,
     which identifies the user agent action when requesting a decision.</p></li><li class="listitem"><p><code class="literal">application=iPlanetAMWebAgentService</code></p></li><li class="listitem"><p><code class="literal">resource=<em class="replaceable"><code>resource-url</code></em></code>,
     or multiple <code class="literal">resources=<em class="replaceable"><code>resource-url</code></em></code>
     parameters for multiple decisions.</p></li><li class="listitem"><p><code class="literal">env=<em class="replaceable"><code>requestDnsName%3Dfqdn</code></em></code>,
     <code class="literal">env=<em class="replaceable"><code>requestIP%3Ddotted-quads</code></em></code>,
     <code class="literal">env=<em class="replaceable"><code>requestTime%3Dseconds-since-epoch</code></em></code>,
     and <code class="literal">env=<em class="replaceable"><code>requestDnsName%3Dtime-zone</code></em></code>
     where <em class="replaceable"><code>time-zone</code></em> is from Java
     <code class="literal">TimeZone.getTimeZone().getID()</code>. The
     <code class="literal">env</code> parameters thus express conditions.</p></li></ul></div><p>Authentication for these interfaces uses cookies, so if your
   application is not running in a browser, first authenticate as described in
   <a class="xref" href="chap-rest.html#rest-api-auth" title="3.3.&nbsp;Authentication &amp; Logout">Section&nbsp;3.3, &#8220;Authentication &amp; Logout&#8221;</a>.</p><p>To request a decision for a single resource, use an HTTP GET on
   <code class="literal">/ws/1/entitlement/decision</code> as in the following example.</p><div class="screen"><pre>$ curl
 --request GET
 --cookie "iPlanetDirectoryPro=AQIC5...DU3*"
 "https://openam.example.com:8443/openam/ws/1/entitlement/decision
 ?subject=MJ3QFTr4ZV2QrtlJvXlg0Q2dMRM=&amp;action=GET
 &amp;application=iPlanetAMWebAgentService
 &amp;resource=http%3A%2F%2Fwww.example.com%2Findex.html"
allow</pre></div><p>If access is denied, the result is <code class="literal">deny</code>.</p><p>To request decisions for multiple resources, use an HTTP GET on
   <code class="literal">/ws/1/entitlement/decisions</code> as in the following example.</p><div class="screen"><pre>$ curl
 --request GET
 --cookie "iPlanetDirectoryPro=AQIC5...DU3*"
 "https://openam.example.com:8443/openam/ws/1/entitlement/decisions
 ?subject=MJ3QFTr4ZV2QrtlJvXlg0Q2dMRM=&amp;action=GET
 &amp;application=iPlanetAMWebAgentService
 &amp;resources=http%3A%2F%2Fwww.example.com%2Findex.html
 &amp;resources=http%3A%2F%2Fwww.example.com%2Ffavicon.ico"
{
    "statusCode": 200,
    "body": {
        "results": [
            {
                "actionsValues": {
                    "POST": true,
                    "GET": true
                },
                "attributes": {},
                "advices": {},
                "resourceName": "http://www.example.com:80/index.html"
            },
            {
                "actionsValues": {
                    "POST": true,
                    "GET": true
                },
                "attributes": {},
                "advices": {},
                "resourceName": "http://www.example.com:80/favicon.ico"
            }
        ]
    },
    "statusMessage": "OK"
}</pre></div><p>To request decisions for all resource underneath a given resource, use
   an HTTP GET on <code class="literal">/ws/1/entitlement/entitlement</code> as in the
   following example.</p><div class="screen"><pre>$ curl
 --request GET
 --cookie "iPlanetDirectoryPro=AQIC5...DU3*"
 "https://openam.example.com:8443/openam/ws/1/entitlement/entitlement
 ?subject=MJ3QFTr4ZV2QrtlJvXlg0Q2dMRM=
 &amp;application=iPlanetAMWebAgentService
 &amp;resource=http%3A%2F%2Fwww.example.com%2F*"
{
    "statusCode": 200,
    "body": {
        "actionsValues": {
            "POST": true,
            "GET": true
        },
        "attributes": {},
        "advices": {},
        "resourceName": "http://www.example.com:80/*"
    },
    "statusMessage": "OK"
}</pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="rest-api-policy-management"></a>3.6.2.&nbsp;Managing Policies</h3></div></div></div><p>OpenAM exposes a REST API through the
   <code class="literal">/ws/1/entitlement/privilege</code> endpoint under the
   deployment URI. The API lets you create, read, update, delete, and query
   policies.</p><p>Authentication for these interfaces uses cookies, so if your
   application is not running in a browser, first authenticate as described in
   <a class="xref" href="chap-rest.html#rest-api-auth" title="3.3.&nbsp;Authentication &amp; Logout">Section&nbsp;3.3, &#8220;Authentication &amp; Logout&#8221;</a>.</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="rest-api-policy-management-create"></a>3.6.2.1.&nbsp;Creating Policies</h4></div></div></div><p>You create a policy by using an HTTP POST of the JSON representation
    to the endpoint. You must URL encode the JSON before passing it to
    OpenAM.</p><div class="screen"><pre>$ cat entitlement.json
{
    "name": "Example HTTP",
    "eSubject": {
        "state": {
            "className": "com.sun.identity.policy.plugins.AuthenticatedUsers",
            "exclusive": false,
            "name": "All Authenticated Users",
            "values": []
        },
        "className": "com.sun.identity.entitlement.opensso.PolicySubject"
    },
    "entitlement": {
        "actionsValues": {
            "POST": true,
            "GET": true
        },
        "applicationName": "iPlanetAMWebAgentService",
        "name": "authorize",
        "resourceNames": [
            "http://www.example.com:80/*"
        ]
    }
}$ curl
 --request POST
 --cookie "iPlanetDirectoryPro=AQIC5...DU3*"
 --data-urlencode "privilege.json@entitlement.json"
 https://openam.example.com:8443/openam/ws/1/entitlement/privilege
{"statusCode":201,"body":"Created","statusMessage":"Created"}

$ cat entitlement2.json
{
    "name": "Example HTTPS",
    "eSubject": {
        "state": {
            "className": "com.sun.identity.policy.plugins.AuthenticatedUsers",
            "exclusive": false,
            "name": "All Authenticated Users",
            "values": []
        },
        "className": "com.sun.identity.entitlement.opensso.PolicySubject"
    },
    "entitlement": {
        "actionsValues": {
            "POST": false,
            "GET": true
        },
        "applicationName": "iPlanetAMWebAgentService",
        "name": "authorize",
        "resourceNames": [
            "https://www.example.com:443/*?*"
        ]
    }
}$ curl
 --request POST
 --cookie "iPlanetDirectoryPro=AQIC5...DU3*"
 --data-urlencode "privilege.json@entitlement2.json"
 https://openam.example.com:8443/openam/ws/1/entitlement/privilege
{"statusCode":201,"body":"Created","statusMessage":"Created"}</pre></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="rest-api-policy-management-read"></a>3.6.2.2.&nbsp;Reading Policies</h4></div></div></div><p>To read a policy, use an HTTP GET on the endpoint followed by
    the URL-encoded name of the policy.</p><p>Notice that the "state" is returned as a long string, and so is not
    shown here in full.</p><div class="screen"><pre>$ curl
 --request GET
 --cookie "iPlanetDirectoryPro=AQIC5...DU3*"
 https://openam.example.com:8443/openam/ws/1/entitlement/privilege/Example%20HTTP
{
    "statusCode": 200,
    "body": {
        "results": {
            "name": "Example HTTP",
            "eSubject": {
                "state": "{\n  \"className\": \"com.sun.identity.policy...}",
                "className": "com.sun.identity.entitlement.opensso.PolicySubject"
            },
            "entitlement": {
                "actionsValues": {
                    "POST": true,
                    "GET": true
                },
                "applicationName": "iPlanetAMWebAgentService",
                "name": "authorize",
                "resourceNames": [
                    "http://www.example.com:80/*"
                ]
            }
        }
    },
    "statusMessage": "OK"
}

$ curl
 --request GET
 --cookie "iPlanetDirectoryPro=AQIC5...DU3*"
 https://openam.example.com:8443/openam/ws/1/entitlement/privilege/Example%20HTTPS
{
    "statusCode": 200,
    "body": {
        "results": {
            "name": "Example HTTPS",
            "eSubject": {
                "state": "{\n  \"className\": \"com.sun.identity.policy...}",
                "className": "com.sun.identity.entitlement.opensso.PolicySubject"
            },
            "entitlement": {
                "actionsValues": {
                    "POST": false,
                    "GET": true
                },
                "applicationName": "iPlanetAMWebAgentService",
                "name": "authorize",
                "resourceNames": [
                    "https://www.example.com:443/*?*"
                ]
            }
        }
    },
    "statusMessage": "OK"
}</pre></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="rest-api-policy-management-update"></a>3.6.2.3.&nbsp;Updating Policies</h4></div></div></div><p>To update a policy, use an HTTP PUT on the endpoint followed by the
    URL-encoded name of the policy.</p><div class="screen"><pre>$ cat update.json {
    "name": "Example HTTP",
    "eSubject": {
        "state": {
            "className": "com.sun.identity.policy.plugins.AuthenticatedUsers",
            "exclusive": false,
            "name": "All Authenticated Users",
            "values": []
        },
        "className": "com.sun.identity.entitlement.opensso.PolicySubject"
    },
    "entitlement": {
        "actionsValues": {
            "POST": false,
            "GET": true
        },
        "applicationName": "iPlanetAMWebAgentService",
        "name": "authorize",
        "resourceNames": [
            "http://www.example.com:80/*?*"
        ]
    }
}$ curl
 --request PUT
 --cookie "iPlanetDirectoryPro=AQIC5...DU3*"
 --data-urlencode "privilege.json@update.json"
 https://openam.example.com:8443/openam/ws/1/entitlement/privilege/Example%20HTTP
{"statusCode":200,"body":"OK","statusMessage":"OK"}</pre></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="rest-api-policy-management-delete"></a>3.6.2.4.&nbsp;Deleting Policies</h4></div></div></div><p>To delete a policy, use an HTTP DELETE on the endpoint followed by
    the URL-encoded name of the policy.</p><div class="screen"><pre>$ curl
 --request DELETE
 --cookie "iPlanetDirectoryPro=AQIC5...DU3*"
 https://openam.example.com:8443/openam/ws/1/entitlement/privilege/Example%20HTTPS
{"statusCode":200,"body":"OK","statusMessage":"OK"}</pre></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="rest-api-policy-management-query"></a>3.6.2.5.&nbsp;Querying Policies</h4></div></div></div><p>To get the names of policies, use an HTTP GET on the endpoint.</p><div class="screen"><pre>$ curl
 --request GET
 --cookie "iPlanetDirectoryPro=AQIC5...DU3*"
 https://openam.example.com:8443/openam/ws/1/entitlement/privilege
{
    "statusCode": 200,
    "body": {
        "results": [
            "Example HTTPS",
            "Example HTTP"
        ]
    },
    "statusMessage": "OK"
}</pre></div><p>You can pass a filter query parameter to get only policies
    that match the filter. Make sure you URL encode the filter value.</p><div class="screen"><pre>$ curl
 --request GET
 --cookie "iPlanetDirectoryPro=AQIC5...DU3*"
 "https://openam.example.com:8443/openam/ws/1/entitlement/privilege
 ?subject=MJ3QFTr4ZV2QrtlJvXlg0Q2dMRM=&amp;filter=name%3D*HTTP"
{
    "statusCode": 200,
    "body": {
        "results": [
            "Example HTTP"
        ]
    },
    "statusMessage": "OK"
}
</pre></div></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="rest-api-oauth2"></a>3.7.&nbsp;OAuth 2.0 Authorization</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="chap-rest.html#rest-api-oauth2-client-endpoints">3.7.1. OAuth 2.0 Client &amp; Resource Server Endpoints</a></span></dt><dt><span class="section"><a href="chap-rest.html#rest-api-oauth2-token-admin-endpoint">3.7.2. OAuth 2.0 Token Administration Endpoint</a></span></dt><dt><span class="section"><a href="chap-rest.html#rest-api-oauth2-client-admin-endpoint">3.7.3. OAuth 2.0 Client Administration Endpoint</a></span></dt></dl></div><a class="indexterm" name="d0e997"></a><div class="itemizedlist"><p>OpenAM exposes the following REST endpoints for different OAuth 2.0
   purposes.</p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Endpoints for <a class="link" href="chap-rest.html#rest-api-oauth2-client-endpoints" title="3.7.1.&nbsp;OAuth 2.0 Client &amp; Resource Server Endpoints">OAuth
    2.0 clients and resource servers</a>, mostly defined in RFC 6749,
    <a class="link" href="http://tools.ietf.org/html/rfc6749" target="_blank"><em class="citetitle">The OAuth 2.0 Authorization Framework</em></a>, with
    an additional <code class="literal">tokeninfo</code> endpoint useful to resource
    servers.</p></li><li class="listitem"><p>An endpoint for <a class="link" href="chap-rest.html#rest-api-oauth2-token-admin-endpoint" title="3.7.2.&nbsp;OAuth 2.0 Token Administration Endpoint">OAuth 2.0 token administration</a>. This is specific to OpenAM.</p></li><li class="listitem"><p>An endpoint for <a class="link" href="chap-rest.html#rest-api-oauth2-client-admin-endpoint" title="3.7.3.&nbsp;OAuth 2.0 Client Administration Endpoint">OAuth 2.0 client administration</a>. This is specific to OpenAM.</p></li></ul></div><p>When accessing the APIs, browser-based REST clients can rely on OpenAM
  to handle the session as usual. First authenticate with OpenAM. Then perform
  the operations in the browser session.</p><p>Clients not running in a browser can authenticate as described in
  <a class="xref" href="chap-rest.html#rest-api-auth" title="3.3.&nbsp;Authentication &amp; Logout">Section&nbsp;3.3, &#8220;Authentication &amp; Logout&#8221;</a>, whereby OpenAM returns a
  <code class="literal">token.id</code> value. Clients pass the
  <code class="literal">token.id</code> value in a header named after the
  authentication cookie, by default <code class="literal">iplanetDirectoryPro</code>.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="rest-api-oauth2-client-endpoints"></a>3.7.1.&nbsp;OAuth 2.0 Client &amp; Resource Server Endpoints</h3></div></div></div><p>As described in the <em class="citetitle">Administration Guide</em> chapter
   on <a href="../../admin-guide/index/chap-oauth2.html" class="link"><em class="citetitle">Managing OAuth
   2.0 Authorization</em></a>, OpenAM exposes REST endpoints for
   making calls to OpenAM acting as an authorization server.</p><div lang="en" class="variablelist"><p>In addition to the standard authorization and token endpoints
 described in RFC 6749, OpenAM also exposes a token information endpoint
 for resource servers to get information about access tokens so they can
 determine how to respond to requests for protected resources. OpenAM as
 authorization server exposes the following endpoints for clients and
 resource servers.</p><dl class="variablelist"><dt><span class="term"><code class="literal">/oauth2/authorize</code></span></dt><dd><p>Authorization endpoint defined in RFC 6749, used to obtain an
   authorization grant from the resource owner</p><p>Example: <code class="literal">https://openam.example.com:8443/openam/oauth2/authorize</code></p></dd><dt><span class="term"><code class="literal">/oauth2/access_token</code></span></dt><dd><p>Token endpoint defined in RFC 6749, used to obtain an access token
   from the authorization server</p><p>Example: <code class="literal">https://openam.example.com:8443/openam/oauth2/access_token</code></p></dd><dt><span class="term"><code class="literal">/oauth2/tokeninfo</code></span></dt><dd><p>Endpoint not defined in RFC 6749, used to validate tokens, and to
   retrieve information such as scopes</p><p>Given an access token, a resource server can perform an HTTP GET on
   <code class="literal">/oauth2/tokeninfo?access_token=<em class="replaceable"><code>token-id</code></em></code>
   to retrieve a JSON object indicating <code class="literal">token_type</code>,
   <code class="literal">expires_in</code>, <code class="literal">scope</code>, and the
   <code class="literal">access_token</code> ID.</p><p>Example: <code class="literal">https://openam.example.com:8443/openam/oauth2/tokeninfo</code></p></dd></dl></div><p>The <code class="literal">/oauth2/authorize</code>, and
   <code class="literal">/oauth2/access_token</code> endpoints function as described
   in RFC 6749.</p><p>The <code class="literal">/oauth2/authorize</code> endpoint is protected by the
   policy created during OAuth 2.0 authorization server configuration, which
   grants all authenticated users access.</p><p>The <code class="literal">/oauth2/tokeninfo</code> endpoint takes an HTTP GET
   on <code class="literal">/oauth2/tokeninfo?access_token=<em class="replaceable"><code>token-id</code></em></code>, and returns information about the
   token.</p><p>Resource servers &#8212; or any party having the token ID &#8212; can
   get token information through this endpoint without authenticating. This
   means any application or user can validate the token without having to be
   registered with OpenAM.</p><p>The following example shows OpenAM issuing an access token, and
   then returning token information.</p><div class="screen"><pre>$ curl
 --request POST
 --user "myClientID:password"
 --data "grant_type=password&amp;username=demo&amp;password=changeit&amp;scope=cn%20mail"
 https://openam.example.com:8443/openam/oauth2/access_token
{
    "expires_in": 599,
    "token_type": "Bearer",
    "refresh_token": "f6dcf133-f00b-4943-a8d4-ee939fc1bf29",
    "access_token": "f9063e26-3a29-41ec-86de-1d0d68aa85e9"
}
$ curl https://openam.example.com:8443/openam/oauth2/tokeninfo
 ?access_token=f9063e26-3a29-41ec-86de-1d0d68aa85e9
{
    "mail": "demo@example.com",
    "scope": [
        "mail",
        "cn"
    ],
    "cn": "demo",
    "realm": "/",
    "token_type": "Bearer",
    "expires_in": 577,
    "access_token": "f9063e26-3a29-41ec-86de-1d0d68aa85e9"
}</pre></div><p>The resource server making decisions about whether the token is valid
   can thus use the <code class="literal">/oauth2/tokeninfo</code> endpoint to retrieve
   expiration information about the token. Depending on the scopes
   implementation, the JSON response about the token can also contain scope
   information. As described in the <em class="citetitle">Administration Guide</em>,
   the default scopes implementation in OpenAM considers scopes to be names of
   attributes in the resource owner's user profile. Notice that the JSON
   response contains the values for those attributes from the user's profile,
   as in the preceding example, with scopes set to <code class="literal">mail</code> and
   <code class="literal">cn</code>.</p><p>Both the <code class="literal">/oauth2/authorize</code> and
   <code class="literal">/oauth2/access_token</code> endpoints can take additional
   parameters. In particular you must specify the realm using the
   <code class="literal">realm=<em class="replaceable"><code>realm-name</code></em></code> parameter if
   the OpenAM OAuth 2.0 provider is configured for a subrealm rather than /
   (Top-Level Realm). For example, if the OAuth 2.0 provider is configured
   for the <code class="literal">/customers</code> realm, then use
   <code class="literal">/oauth2/authorize?realm=/customers</code> and
   <code class="literal">/oauth2/access_token?realm=/customers</code>.</p><p>The <code class="literal">/oauth2/authorize</code> endpoint can also take
   <code class="literal">module</code> and <code class="literal">service</code> parameters. Use
   either as described in <a href="../../admin-guide/index/chap-auth-services.html#authn-from-browser" class="link"><em class="citetitle">Authenticating
   To OpenAM</em></a>, where <code class="literal">module</code> specifies the
   authentication module instance to use or <code class="literal">service</code>
   specifies the authentication chain to use when authenticating the resource
   owner.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="rest-api-oauth2-token-admin-endpoint"></a>3.7.2.&nbsp;OAuth 2.0 Token Administration Endpoint</h3></div></div></div><p>The OpenAM-specific OAuth 2.0 token administration endpoint lets
   administrators read, list, and delete OAuth 2.0 tokens. OAuth 2.0 clients
   can also manage their own tokens.</p><p>OpenAM exposes the token administration endpoint at
   <code class="literal">/frrest/oauth2/token</code>, such as
   <code class="literal">https://openam.example.com:8443/openam/frrest/oauth2/token</code>.</p><div class="note"><h3 class="title">Note</h3><p>This endpoint location is likely to change in the future.</p></div><p>To get a token, perform an HTTP GET on
   <code class="literal">/frrest/oauth2/token/<em class="replaceable"><code>token-id</code></em></code>,
   as in the following example.</p><div class="screen"><pre>$ curl
 --request POST
 --user "myClientID:password"
 --data "grant_type=password&amp;username=demo&amp;password=changeit&amp;scope=cn%20mail"
 https://openam.example.com:8443/openam/oauth2/access_token
{
    "expires_in": 599,
    "token_type": "Bearer",
    "refresh_token": "f838e7d4-7e84-4743-af7c-9a9c42c2969e",
    "access_token": "9c6a48fc-44b1-4a0c-b4f0-672fba468b0f"
}
$ curl
 --header "iplanetDirectoryPro: AQIC5wM2LY4Sfcxs...EwNDU2NjE0*"
 https://openam.example.com:8443/openam/frrest/oauth2/token/9c6a48fc...fba468b0f
{
    "scope": [
        "mail",
        "cn"
    ],
    "type": [
        "access_token"
    ],
    "username": [
        "demo"
    ],
    "realm": [
        "/"
    ],
    "id": [
        "9c6a48fc-44b1-4a0c-b4f0-672fba468b0f"
    ],
    "parent": [
        "f838e7d4-7e84-4743-af7c-9a9c42c2969e"
    ],
    "expiry_time": [
        "1355741494888"
    ],
    "client_id": [
        "myClientID"
    ]
}</pre></div><p>To list tokens, perform an HTTP GET on
   <code class="literal">/frrest/oauth2/token/?_query_id=<em class="replaceable"><code>conditions</code></em></code>,
   where <em class="replaceable"><code>conditions</code></em> is a comma-separated list of
   <code class="literal"><em class="replaceable"><code>field</code></em>=<em class="replaceable"><code>value</code></em></code>
   conditions. The <em class="replaceable"><code>field</code></em>s are taken from the fields
   returned in the token object through this endpoint.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">"expiry_time"</code></span></dt><dd><p>Token expiration time in milliseconds since 00:00:00 UTC, January 1,
      1970.</p></dd><dt><span class="term"><code class="literal">"type"</code></span></dt><dd><p>Either <code class="literal">"access_token"</code> or
      <code class="literal">"refresh_token"</code>.</p></dd><dt><span class="term"><code class="literal">"username"</code></span></dt><dd><p>OAuth 2.0 client to whom the token was issued.</p></dd><dt><span class="term"><code class="literal">"realm"</code></span></dt><dd><p>The realm for which the token was issued.</p></dd><dt><span class="term"><code class="literal">"id"</code></span></dt><dd><p>Unique ID of the token.</p></dd></dl></div><p>The following example shows a search for current access tokens that
   were issued to <code class="literal">myClientID</code>.</p><div class="screen"><pre>$ curl
 --header "iplanetDirectoryPro: AQIC5wM2LY4Sfcxs...EwNDU2NjE0*"
 https://openam.example.com:8443/openam/frrest/oauth2/token/?_queryID
 =username%3DmyClientID%2Ctype%3Daccess_token
{
    "result": [
        {
            "scope": [
                "mail",
                "cn"
            ],
            "id": [
                "1b836369-4fcf-4fb2-b819-ee4b1314d4f1"
            ],
            "type": [
                "access_token"
            ],
            "username": [
                "myClientID"
            ],
            "realm": [
                "/"
            ],
            "expiry_time": [
                "1355741986154"
            ]
        },
        {
            "scope": [
                "mail",
                "cn"
            ],
            "type": [
                "access_token"
            ],
            "username": [
                "myClientID"
            ],
            "realm": [
                "/"
            ],
            "id": [
                "5f1763fc-37ae-4698-9e84-d301d49e1f7e"
            ],
            "expiry_time": [
                "1355741982091"
            ]
        }
    ],
    "pagedResultsCookie": null,
    "remainingPagedResults": -1
}</pre></div><p>To delete a token, perform an HTTP DELETE on
   <code class="literal">/frrest/oauth2/token/<em class="replaceable"><code>token-id</code></em></code>,
   as in the following example.</p><div class="screen"><pre>$ curl
 --request POST
 --data "grant_type=client_credentials&amp;username=demo&amp;password=changeit
 &amp;client_id=myClientID&amp;client_secret=password&amp;scope=cn%20mail"
 https://openam.example.com:8443/openam/oauth2/access_token
{
    "expires_in": 599,
    "token_type": "Bearer",
    "access_token": "867aaab2-61d7-4b78-9b80-4f9098034540"
}
$ curl
 --request DELETE
 --header "iplanetDirectoryPro: AQIC5wM2LY4Sfcxs...EwNDU2NjE0*"
 https://openam.example.com:8443/openam/frrest/oauth2/token/867aaab2..098034540
{
    "success": "true"
}</pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="rest-api-oauth2-client-admin-endpoint"></a>3.7.3.&nbsp;OAuth 2.0 Client Administration Endpoint</h3></div></div></div><p>The OAuth 2.0 administration endpoint lets OpenAM administrators and
   agent administrators create (that is, register) and delete OAuth 2.0
   clients.</p><p>OpenAM exposes this endpoint at <code class="literal">/frrest/oauth2/client</code>,
   such as
   <code class="literal">https://openam.example.com:8443/openam/frrest/oauth2/client</code>.</p><div class="note"><h3 class="title">Note</h3><p>This endpoint location is likely to change in the future.</p></div><p>To create an OAuth 2.0 client, perform an HTTP POST to
   <code class="literal">/frrest/oauth2/client/?_action=create</code>
   with a JSON object fully specifying the client, as in the following
   example.</p><div class="screen"><pre>$ curl --request POST --header "iplanetDirectoryPro: AQIC5wM...3MTYxOA..*"
 --header "Content-Type: application/json"
 --data '{"client_id":["testClient"],
          "realm":["/"]
          "userpassword":["secret12"],
          "com.forgerock.openam.oauth2provider.clientType":["Confidential"],
          "com.forgerock.openam.oauth2provider.redirectionURIs":
            ["www.client.com","www.example.com"],
          "com.forgerock.openam.oauth2provider.scopes":["cn","sn"],
          "com.forgerock.openam.oauth2provider.defaultScopes":["cn"],
          "com.forgerock.openam.oauth2provider.name":["My Test Client"],
          "com.forgerock.openam.oauth2provider.description":["OAuth 2.0 Client"]
         }'
 https://openam.example.com:8443/openam/frrest/oauth2/client/?_action=create
 {"success":"true"}</pre></div><div class="variablelist"><p>When creating an OAuth 2.0 client, use the following fields in your
    JSON object.</p><dl class="variablelist"><dt><span class="term"><code class="literal">"client_id"</code></span></dt><dd><p>(Required) This field takes an array containing the client
      identifier as defined in RFC 6749.</p></dd><dt><span class="term"><code class="literal">"realm"</code></span></dt><dd><p>(Required) This field takes an array containing the OpenAM realm
      in which to create the client as defined in RFC 6749.</p></dd><dt><span class="term"><code class="literal">"userpassword"</code></span></dt><dd><p>(Required) This field takes an array containing the client
      secret as defined in RFC 6749.</p></dd><dt><span class="term"><code class="literal">"com.forgerock.openam.oauth2provider.clientType"</code></span></dt><dd><p>(Required) This field takes an array containing the client
      type, either <code class="literal">"Confidential"</code> or
      <code class="literal">"Public"</code> as defined in RFC 6749.</p></dd><dt><span class="term"><code class="literal">"com.forgerock.openam.oauth2provider.redirectionURIs"</code></span></dt><dd><p>(Optional for confidential clients) This field takes an array of
      client redirection endpoints as defined in RFC 6749.</p></dd><dt><span class="term"><code class="literal">"com.forgerock.openam.oauth2provider.scopes"</code></span></dt><dd><p>(Optional) This field takes an array of scopes as defined in RFC
      6749. The default scopes implementation takes scopes to be names of
      attributes in the resource owner profile.</p><p>Specify localized scopes in <code class="literal"><em class="replaceable"><code>scope</code></em>|<em class="replaceable"><code>locale</code></em>|<em class="replaceable"><code>localized description</code></em></code> format.</p></dd><dt><span class="term"><code class="literal">"com.forgerock.openam.oauth2provider.defaultScopes"</code></span></dt><dd><p>(Optional) This field takes an array of default scopes set
      automatically when tokens are issued.</p></dd><dt><span class="term"><code class="literal">"com.forgerock.openam.oauth2provider.name"</code></span></dt><dd><p>(Optional) This field takes an array containing the client name to
      display to the resource owner when the resource owner must authorize
      client access to protected resources.</p><p>Specify localized names in <code class="literal"><em class="replaceable"><code>locale</code></em>|<em class="replaceable"><code>localized name</code></em></code>
      format.</p></dd><dt><span class="term"><code class="literal">"com.forgerock.openam.oauth2provider.description"</code></span></dt><dd><p>(Optional) This field takes an array containing the description to
      display to the resource owner when the resource owner must authorize
      client access to protected resources.</p><p>Specify localized descriptions in <code class="literal"><em class="replaceable"><code>locale</code></em>|<em class="replaceable"><code>localized description</code></em></code>
      format.</p></dd></dl></div><p>To delete an OAuth 2.0 client, perform an HTTP DELETE on
   <code class="literal">/frrest/oauth2/client/<em class="replaceable"><code>client-id</code></em></code>,
   as in the following example.</p><div class="screen"><pre>$ curl --request DELETE
 --header "iplanetDirectoryPro: AQIC5wM...3MTYxOA..*"
 https://openam.example.com:8443/openam/frrest/oauth2/client/testClient
{"success":"true"}</pre></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="rest-api-openid-connect"></a>3.8.&nbsp;OpenID Connect 1.0</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="chap-rest.html#rest-api-openid-connect-discovery">3.8.1. Discovering OpenID Connect 1.0 Configuration</a></span></dt><dt><span class="section"><a href="chap-rest.html#rest-api-openid-connect-dynamic-registration">3.8.2. Registering OpenID Connect 1.0 Clients</a></span></dt><dt><span class="section"><a href="chap-rest.html#rest-api-openid-connect-authorization">3.8.3. Performing OpenID Connect 1.0 Client Authorization</a></span></dt><dt><span class="section"><a href="chap-rest.html#rest-api-openid-connect-session">3.8.4. Managing OpenID Connect 1.0 Sessions</a></span></dt></dl></div><a class="indexterm" name="d0e1440"></a><p>OpenID Connect 1.0 extends OAuth 2.0 so the client can verify claims
  about the identity of the end user, get profile information about the end
  user, and log the user out at the end of the OpenAM session.</p><div class="itemizedlist"><p>OpenAM exposes the following REST endpoints for <a class="link" href="http://openid.net/connect/" target="_blank">OpenID Connect 1.0</a>
   purposes.</p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Endpoints for <a class="link" href="chap-rest.html#rest-api-openid-connect-discovery" title="3.8.1.&nbsp;Discovering OpenID Connect 1.0 Configuration">discovering information</a>.</p></li><li class="listitem"><p>An endpoint for <a class="link" href="chap-rest.html#rest-api-openid-connect-dynamic-registration" title="3.8.2.&nbsp;Registering OpenID Connect 1.0 Clients">registering client applications</a>.</p></li><li class="listitem"><p>Endpoints for <a class="link" href="chap-rest.html#rest-api-openid-connect-authorization" title="3.8.3.&nbsp;Performing OpenID Connect 1.0 Client Authorization">client authorization</a>.</p></li><li class="listitem"><p>Endpoints for <a class="link" href="chap-rest.html#rest-api-openid-connect-session" title="3.8.4.&nbsp;Managing OpenID Connect 1.0 Sessions">session management</a>.</p></li></ul></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="rest-api-openid-connect-discovery"></a>3.8.1.&nbsp;Discovering OpenID Connect 1.0 Configuration</h3></div></div></div><p>OpenAM exposes endpoints for discovering information about the provider
   configuration, and about the provider for a given end user.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">/.well-known/openid-configuration</code> allows clients
     to retrieve OpenID Provider configuration by HTTP GET as specified by
     OpenID Connect Discovery 1.0.</p></li><li class="listitem"><p><code class="literal">/.well-known/webfinger</code> allows clients to retrieve
     the provider URL for an end user by HTTP GET as specified by OpenID Connect
     Discovery 1.0.</p></li></ul></div><p>For examples, see <a href="../../admin-guide/index/chap-openid-connect.html#configure-openid-connect-discovery" class="link"><em class="citetitle">Configuring
   OpenAM For OpenID Connect Discovery</em></a>.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="rest-api-openid-connect-dynamic-registration"></a>3.8.2.&nbsp;Registering OpenID Connect 1.0 Clients</h3></div></div></div><p>OpenAM allows both static and dynamic registration of OpenID Connect
   client applications. For dynamic registration according to the OpenID Connect
   Dynamic Client Registration 1.0 specification, the endpoint is
   <code class="literal">/oauth2/connect/register</code>. See <a href="../../admin-guide/index/chap-openid-connect.html#register-openid-connect-client-dynamic" class="link"><em class="citetitle">To Register a
   Client Dynamically</em></a> for details.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="rest-api-openid-connect-authorization"></a>3.8.3.&nbsp;Performing OpenID Connect 1.0 Client Authorization</h3></div></div></div><p>Registered clients can request authorization through OpenAM.</p><p>OpenID Connect 1.0 supports both a Basic Client Profile using the
   OAuth 2.0 authorization code grant, and an Implicit Client Profile using the
   OAuth 2.0 implicit grant. These client profiles rely on the OAuth 2.0
   endpoints for authorization. Those endpoints are described in
   <a class="xref" href="chap-rest.html#rest-api-oauth2-client-endpoints" title="3.7.1.&nbsp;OAuth 2.0 Client &amp; Resource Server Endpoints">Section&nbsp;3.7.1, &#8220;OAuth 2.0 Client &amp; Resource Server Endpoints&#8221;</a>.</p><p>In addition, authorized clients can access end user information through
   the OpenID Connect 1.0 specific endpoint
   <code class="literal">/oauth2/userinfo</code>.</p><p>For examples, see <a href="../../admin-guide/index/chap-openid-connect.html#openid-connect-examples" class="link"><em class="citetitle">Client
   Examples</em></a>.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="rest-api-openid-connect-session"></a>3.8.4.&nbsp;Managing OpenID Connect 1.0 Sessions</h3></div></div></div><p>Registered clients can use OpenID Connect Session Management 1.0 to
   handle end user logout actions.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">/oauth2/connect/checkSession</code> allows clients
     to retrieve session status notifications.</p></li><li class="listitem"><p><code class="literal">/oauth2/connect/endSession</code> allows clients to
     terminate end user sessions.</p></li></ul></div><p>For an example, see <a href="../../admin-guide/index/chap-openid-connect.html#manage-sessions-openid-connect" class="link"><em class="citetitle">Managing User
   Sessions</em></a>.</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="rest-api-self-registration"></a>3.9.&nbsp;User Self-Registration</h2></div></div></div><a class="indexterm" name="d0e1556"></a><p>The OpenAM REST API for users provides an action for
  self-registration.</p><p>The feature works by sending an email to the user in response to RESTful
  HTTP POST requesting registration with an email address. When the user clicks
  the link received by mail, an application intercepts the HTTP GET,
  transforms the query string values into an HTTP POST to confirm the operation.
  OpenAM responds to the application with a JSON object that the application
  can further use to request creation of the user account to complete the
  transaction.</p><div class="orderedlist"><p>An example follows, showing the steps in more detail.</p><ol class="orderedlist" type="1"><li class="listitem"><p>Configure the Email Service and REST Security.</p><p>In particular, you must configure the Email Service to send mail
    to users who self-register, and you must enable self-registration in the
    REST Security service.</p><p>You can configure these globally in OpenAM Console at Configuration &gt;
    Global &gt; Email Service for notifications and Configuration &gt; Global &gt;
    REST Security to allow self-registration.</p><p>Alternatively, you can configure them for an individual realm under
    Access Control &gt; <em class="replaceable"><code>Realm Name</code></em> &gt; Services.</p></li><li class="listitem"><p>Perform an HTTP POST on <code class="literal">/json/users?_action=register</code>
    with the new user's mail.</p><p>Notice that authentication is not required.</p><div class="screen"><pre>$ curl
 --request POST --header "Content-Type: application/json"
 --data '{"email":"newuser@example.com"}'
 https://openam.example.com:8443/openam/json/users?_action=register
{}</pre></div><p>On success, the response is an empty JSON object <code class="literal">{}</code>
    as shown in the example.</p></li><li class="listitem"><p>The user receives an email message that includes a URL as in the
    following example.</p><pre class="literallayout">https://openam.example.com:8443/openam/json/confirmation/register?confirmationId=P23PK5kyAgNdqeNJpAvq1ebcpcg=&amp;email=newuser@example.com&amp;tokenId=+8rWf5O8KG0rfz3Pa+WwDLkH9Ac=</pre></li><li class="listitem"><p>Intercept the HTTP GET request to this URL when the user clicks the
    link.</p><p>Your application must use the confirmation link to construct an HTTP
    POST to <code class="literal">/json/users?_action=confirm</code> from the query string
    parameters as shown in the following example.</p><div class="screen"><pre>$ curl --request POST --header "Content-Type: application/json"
 --data '{"email":"newuser@example.com",
     "tokenId":"+8rWf5O8KG0rfz3Pa+WwDLkH9Ac=",
     "confirmationId":"P23PK5kyAgNdqeNJpAvq1ebcpcg="}'
 https://openam.example.com:8443/openam/json/users?_action=confirm
{
    "email": "newuser@example.com",
    "tokenId": "+8rWf5O8KG0rfz3Pa+WwDLkH9Ac=",
    "confirmationId": "P23PK5kyAgNdqeNJpAvq1ebcpcg="
}</pre></div><p>The response is a further confirmation that the account can be
    created.</p></li><li class="listitem"><p>Using the confirmation, your application must make an authenticated
    HTTP POST to <code class="literal">/json/users?_action=anonymousCreate</code> to
    create the user as shown in the following example.</p><div class="screen"><pre>$ curl --request POST --header "iPlanetDirectoryPro: AQIC5wM...3MTYxOA..*"
 --header "Content-Type: application/json"
 --data '{"email":"newuser@example.com",
     "tokenId":"+8rWf5O8KG0rfz3Pa+WwDLkH9Ac=",
     "confirmationId":"P23PK5kyAgNdqeNJpAvq1ebcpcg=",
     "name":"newuser","userpassword":"password"}'
 https://openam.example.com:8443/openam/json/users?_action=anonymousCreate
{
    "username": "mark",
    "realm": "/",
    "uid": [
        "newuser"
    ],
    "mail": [
        "newuser@example.com"
    ],
    "sn": [
        "newuser"
    ],
    "userPassword": [
        "{SSHA}dAiONYMxqFiNilXeLXUQoDpHlePYtiJcjYw8Dw=="
    ],
    "cn": [
        "newuser"
    ],
    "inetUserStatus": [
        "Active"
    ],
    "dn": [
        "uid=newuser,ou=people,dc=openam,dc=forgerock,dc=org"
    ],
    "objectClass": [
        "devicePrintProfilesContainer",
        "person",
        "sunIdentityServerLibertyPPService",
        "inetorgperson",
        "sunFederationManagerDataStore",
        "iPlanetPreferences",
        "iplanet-am-auth-configuration-service",
        "organizationalperson",
        "sunFMSAML2NameIdentifier",
        "inetuser",
        "forgerock-am-dashboard-service",
        "iplanet-am-managed-person",
        "iplanet-am-user-service",
        "sunAMAuthAccountLockout",
        "top"
    ],
    "universalid": [
        "id=newuser,ou=user,dc=openam,dc=forgerock,dc=org"
    ]
}</pre></div></li></ol></div><p>At this point the user is registered, active, and can authenticate
  with OpenAM.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="rest-api-password-reset"></a>3.10.&nbsp;Resetting Forgotten Passwords</h2></div></div></div><a class="indexterm" name="d0e1623"></a><p>The OpenAM REST API for users provides an action for handling forgotten
  passwords as long as the user has a valid email address in their profile.</p><p>The option is disabled by default. You can enable it in the OpenAM Console
  globally via Configuration &gt; Global &gt; REST Security.</p><p>Alternatively, you can enable it for an individual realm under
  Access Control &gt; <em class="replaceable"><code>Realm Name</code></em> &gt; Services &gt; Add &gt;
  REST Security.</p><div class="orderedlist"><p>An example follows, showing the steps in more detail.</p><ol class="orderedlist" type="1"><li class="listitem"><p>Configure the Email Service.</p><p>In particular, you must configure the Email Service to send mail
    allowing the user to reset the forgotten password.</p><p>You can configure the service globally in the OpenAM Console via
    Configuration &gt; Global &gt; Email Service.</p><p>Alternatively, you can configure it for an individual realm under
    Access Control &gt; <em class="replaceable"><code>Realm Name</code></em> &gt; Services.</p></li><li class="listitem"><p>Perform an HTTP POST on <code class="literal">/json/users?_action=forgotPassword</code>
    with the user's ID.</p><p>Notice that authentication is not required.</p><div class="screen"><pre>curl --request POST --header "Content-Type: application/json"
 --data '{"username":"demo"}'
 https://openam.example.com:8443/openam/json/users?_action=forgotPassword
{}</pre></div><p>On success, the response is an empty JSON object <code class="literal">{}</code>
    as shown in the example.</p></li><li class="listitem"><p>OpenAM looks up the email address in the user profile, and sends an
    email message that includes a URL as in the following example.</p><pre class="literallayout">https://openam.example.com:8443/openam/json/confirmation/forgotPassword?confirmationId=jrUZ3E7CK4UQJM5jnDHGNKH1UaQ=&amp;tokenId=M8cVqWqbKtCtpd/UqEAr0x25fxA=&amp;username=demo</pre></li><li class="listitem"><p>Intercept the HTTP GET request to this URL when the user clicks the
    link.</p><p>Your application must use the confirmation link to construct an HTTP
    POST to <code class="literal">/json/users?_action=forgotPasswordReset</code> from the
    query string parameters as shown in the following example.</p><p>Your POST includes the new password as the value of the "userpassword"
    field in the JSON payload.</p><div class="screen"><pre>$ curl --request POST --header "Content-Type: application/json"
 --data '{"username":"demo",
     "userpassword":"password",
     "tokenId":"M8cVqWqbKtCtpd/UqEAr0x25fxA=",
     "confirmationId":"jrUZ3E7CK4UQJM5jnDHGNKH1UaQ="}'
 https://openam.example.com:8443/openam/json/users?_action=forgotPasswordReset
{
    "name": "demo",
    "realm": "/",
    "uid": [
        "demo"
    ],
    "mail": [
        "demo@example.com"
    ],
    "sn": [
        "demo"
    ],
    "userPassword": [
        "{SSHA}zgeBu4yOAy1i9QAgnldMCzW8LWX36ViVj9leig=="
    ],
    "cn": [
        "demo"
    ],
    "inetUserStatus": [
        "Active"
    ],
    "objectClass": [
        "devicePrintProfilesContainer",
        "person",
        "sunIdentityServerLibertyPPService",
        "inetorgperson",
        "sunFederationManagerDataStore",
        "iPlanetPreferences",
        "iplanet-am-auth-configuration-service",
        "organizationalperson",
        "sunFMSAML2NameIdentifier",
        "inetuser",
        "forgerock-am-dashboard-service",
        "iplanet-am-managed-person",
        "iplanet-am-user-service",
        "sunAMAuthAccountLockout",
        "top"
    ],
    "universalid": [
        "id=demo,ou=user,dc=openam,dc=forgerock,dc=org"
    ]
}</pre></div><p>On success, the response is the JSON representation of the user
    profile with the new password hashed according to the password storage
    scheme for the identity repository.</p></li></ol></div><p>At this point the user can authenticate with the new password.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="rest-api-logging"></a>3.11.&nbsp;Logging</h2></div></div></div><p>You can send OpenAM messages to log, specifying the message content
  and the log file in which to write your message.</p><div class="screen"><pre>$ curl "https://openam.example.com:8443/openam/identity/log?
 appid=AQIC5wM2LY4SfcwyCZkk-1JXzx6q1EzgagabHfBjMidb5jI.*AAJTSQACMDE.*
 &amp;subjectid=AQIC5wM2LY4SfcxuxIP0VnP2lVjs7ypEM6VDx6srk56CN1Q.*AAJTSQACMDE.*
 &amp;logname=rest.access
 &amp;message=Hello%20World"</pre></div><p>Logging takes a valid <code class="literal">appid</code> token for the subject
  with access to log the message, and also a <code class="literal">subjectid</code> token
  for the user whom the message concerns. If the tokens are valid and the
  access rights correct, your message ends up in the log specified.</p><div class="screen"><pre>$ cat openam/openam/log/rest.access 
#Version: 1.0
#Fields: time   Data    LoginID ContextID   IPAddr  LogLevel    Domain 
 LoggedBy    MessageID   ModuleName  NameID  HostName    
"2011-09-14 16:38:17"   /home/mark/openam/openam/log/
   "cn=dsameuser,ou=DSAME Users,o=openam"  aa307b2dcb721d4201
   "Not Available" INFO    o=openam    "cn=dsameuser,ou=DSAME Users,o=openam"
   LOG-1   rest.access "Not Available"192.168.56.2 
"2011-09-14 16:38:17"   "Hello World"   id=bjensen,ou=user,o=openam
   8a4025a2b3af291d01  "Not Available" INFO    o=openam
   id=amadmin,ou=user,o=openam "Not Available" rest.access "Not Available"
   192.168.56.2</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="rest-api-crud-identity"></a>3.12.&nbsp;Identity Management</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="chap-rest.html#rest-api-create-identity">3.12.1. Creating Identities</a></span></dt><dt><span class="section"><a href="chap-rest.html#rest-api-read-identity">3.12.2. Reading Identities</a></span></dt><dt><span class="section"><a href="chap-rest.html#rest-api-update-identity">3.12.3. Updating Identities</a></span></dt><dt><span class="section"><a href="chap-rest.html#rest-api-delete-identity">3.12.4. Deleting Identities</a></span></dt><dt><span class="section"><a href="chap-rest.html#rest-api-query-identity">3.12.5. Listing Identities</a></span></dt><dt><span class="section"><a href="chap-rest.html#rest-api-create-legacy">3.12.6. Creating Identities (Legacy API)</a></span></dt><dt><span class="section"><a href="chap-rest.html#rest-api-read-legacy">3.12.7. Reading &amp; Searching for Identities (Legacy API)</a></span></dt><dt><span class="section"><a href="chap-rest.html#rest-api-update-legacy">3.12.8. Updating Identities (Legacy API)</a></span></dt><dt><span class="section"><a href="chap-rest.html#rest-api-delete-legacy">3.12.9. Deleting Identities (Legacy API)</a></span></dt></dl></div><a class="indexterm" name="d0e1707"></a><p>This section shows how to create, read, update, delete, and list
  identities using the RESTful APIs.</p><div class="important"><h3 class="title">Important</h3><p>OpenAM is not primarily an identity data store, nor is it provisioning
   software. For storing identity data, consider <a class="link" href="http://forgerock.com/what-we-offer/open-identity-stack/opendj/" target="_blank">OpenDJ</a>.
   For provisioning, consider <a class="link" href="http://forgerock.com/what-we-offer/open-identity-stack/openidm/" target="_blank">OpenIDM</a>.
   Both of these products provide REST APIs as well.</p></div><div class="itemizedlist"><p>OpenAM has two REST APIs for managing identities.</p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Under the <code class="literal">/json/agents</code>,
    <code class="literal">/json/groups</code>, and <code class="literal">/json/users</code>,
    you find the newer JSON-based APIs. The newer APIs follow the ForgeRock
    common REST pattern creating, reading, updating, deleting, and querying
    resources.</p><p>Examples in this section do not repeat the authentication shown
    in <a class="xref" href="chap-rest.html#rest-api-auth" title="3.3.&nbsp;Authentication &amp; Logout">Section&nbsp;3.3, &#8220;Authentication &amp; Logout&#8221;</a>. For browser-based clients, you
    can rely on OpenAM cookies rather than construct the header in your
    application. Managing agent profiles, groups, realms, and users with
    these APIs of course require authorization. The examples shown in this
    section were performed with the token ID gained after authenticating
    as OpenAM administrator.</p><p>Although the examples here show user management, you can use
    <code class="literal">/json/agents</code>, <code class="literal">/json/groups</code>,
    <code class="literal">/json/realms</code> in similar fashion. See
    <a class="xref" href="chap-rest.html#rest-api-crud-realm" title="3.13.&nbsp;Realm Management">Section&nbsp;3.13, &#8220;Realm Management&#8221;</a> for examples related to realms.</p><div class="itemizedlist"><p>The following sections cover this JSON-based API.</p><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><a class="xref" href="chap-rest.html#rest-api-create-identity" title="3.12.1.&nbsp;Creating Identities">Section&nbsp;3.12.1, &#8220;Creating Identities&#8221;</a></p></li><li class="listitem"><p><a class="xref" href="chap-rest.html#rest-api-read-identity" title="3.12.2.&nbsp;Reading Identities">Section&nbsp;3.12.2, &#8220;Reading Identities&#8221;</a></p></li><li class="listitem"><p><a class="xref" href="chap-rest.html#rest-api-update-identity" title="3.12.3.&nbsp;Updating Identities">Section&nbsp;3.12.3, &#8220;Updating Identities&#8221;</a></p></li><li class="listitem"><p><a class="xref" href="chap-rest.html#rest-api-delete-identity" title="3.12.4.&nbsp;Deleting Identities">Section&nbsp;3.12.4, &#8220;Deleting Identities&#8221;</a></p></li><li class="listitem"><p><a class="xref" href="chap-rest.html#rest-api-query-identity" title="3.12.5.&nbsp;Listing Identities">Section&nbsp;3.12.5, &#8220;Listing Identities&#8221;</a></p></li></ul></div></li><li class="listitem"><p>Under the <code class="literal">/identity</code> endpoint, you find the
    backwards-compatible, legacy API.</p><div class="itemizedlist"><p>The following sections cover this backwards-compatible API.</p><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><a class="xref" href="chap-rest.html#rest-api-create-legacy" title="3.12.6.&nbsp;Creating Identities (Legacy API)">Section&nbsp;3.12.6, &#8220;Creating Identities (Legacy API)&#8221;</a></p></li><li class="listitem"><p><a class="xref" href="chap-rest.html#rest-api-read-legacy" title="3.12.7.&nbsp;Reading &amp; Searching for Identities (Legacy API)">Section&nbsp;3.12.7, &#8220;Reading &amp; Searching for Identities (Legacy API)&#8221;</a></p></li><li class="listitem"><p><a class="xref" href="chap-rest.html#rest-api-update-legacy" title="3.12.8.&nbsp;Updating Identities (Legacy API)">Section&nbsp;3.12.8, &#8220;Updating Identities (Legacy API)&#8221;</a></p></li><li class="listitem"><p><a class="xref" href="chap-rest.html#rest-api-delete-legacy" title="3.12.9.&nbsp;Deleting Identities (Legacy API)">Section&nbsp;3.12.9, &#8220;Deleting Identities (Legacy API)&#8221;</a></p></li></ul></div></li></ul></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="rest-api-create-identity"></a>3.12.1.&nbsp;Creating Identities</h3></div></div></div><p>OpenAM lets administrators create a user profile by making 
   an HTTP POST of the JSON representation of the profile to
   <code class="literal">/json/<em class="replaceable"><code>subrealm</code></em>/users/?_action=create</code>.
   To add a user to the Top Level Realm, you do not need to specify the realm.</p><p>The following example shows an administrator creating a new user. The
   only required fields are <code class="literal">username</code> and
   <code class="literal">userpassword</code>. If no other name is provided, the entry
   you make for <code class="literal">username</code> defaults to both the user id and the
   user's last name.</p><div class="screen"><pre>$ curl --request POST --header "iplanetDirectoryPro: AQIC5w...2NzEz*"
 --header "Content-Type: application/json"
 --data '{ "username": "bjensen", "userpassword": "secret12",
           "mail": "bjensen@example.com" }'
 https://openam.example.com:8443/openam/json/users/?_action=create
{
    "username": "bjensen",
    "realm": "/",
    "uid": [
        "bjensen"
    ],
    "mail": [
        "bjensen@example.com"
    ],
    "sn": [
        "bjensen"
    ],
    "userpassword": [
        "{SSHA}0pXpKLPRKCGY7g3YqZygJmKMW6IC2BLJimmlwg=="
    ],
    "cn": [
        "bjensen"
    ],
    "inetuserstatus": [
        "Active"
    ],
    "dn": [
        "uid=bjensen,ou=people,dc=openam,dc=forgerock,dc=org"
    ],
    "objectclass": [
        "person",
        "sunIdentityServerLibertyPPService",
        "sunFederationManagerDataStore",
        "inetorgperson",
        "iPlanetPreferences",
        "iplanet-am-auth-configuration-service",
        "organizationalperson",
        "sunFMSAML2NameIdentifier",
        "inetuser",
        "iplanet-am-managed-person",
        "sunAMAuthAccountLockout",
        "iplanet-am-user-service",
        "top"
    ],
    "universalid": [
        "id=bjensen,ou=user,dc=openam,dc=forgerock,dc=org"
    ]
}</pre></div><p>Alternatively, administrators can create user profiles with specific
    user IDs by doing an HTTP PUT of the JSON representation of the changes to
    <code class="literal">/json/users/<em class="replaceable"><code>user-id</code></em></code>, as
    shown in the following example.</p><div class="screen"><pre>$ curl --request PUT --header "iplanetDirectoryPro: AQIC5w...2NzEz*"
 --header "Content-Type: application/json" --header "If-None-Match: *"
 --data '{ "username": "janedoe" userpassword": "secret12", "mail": "janedoe@example.com" }'
 https://openam.example.com:8443/openam/json/users/janedoe
{
    "username": "janedoe",
    "realm": "/",
    "uid": [
        "janedoe"
    ],
    "mail": [
        "janedoe@example.com"
    ],
    "sn": [
        "janedoe"
    ],
    "userpassword": [
        "{SSHA}e4DJoxvYVW/nsp62XJf29ZADE16YQgrxK+XuKA=="
    ],
    "cn": [
        "janedoe"
    ],
    "inetuserstatus": [
        "Active"
    ],
    "dn": [
        "uid=janedoe,ou=people,dc=openam,dc=forgerock,dc=org"
    ],
    "objectclass": [
        "devicePrintProfilesContainer",
        "person",
        "sunIdentityServerLibertyPPService",
        "inetorgperson",
        "sunFederationManagerDataStore",
        "iPlanetPreferences",
        "iplanet-am-auth-configuration-service",
        "organizationalperson",
        "sunFMSAML2NameIdentifier",
        "inetuser",
        "forgerock-am-dashboard-service",
        "iplanet-am-managed-person",
        "iplanet-am-user-service",
        "sunAMAuthAccountLockout",
        "top"
    ],
    "universalid": [
        "id=janedoe,ou=user,dc=openam,dc=forgerock,dc=org"
    ]
}</pre></div><p>As shown in the examples, OpenAM returns the JSON representation of
   the profile on successful creation. On failure, OpenAM returns a JSON
   representation of the error including the
   <a class="link" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html" target="_blank">HTTP status code</a>.</p><p>The same HTTP POST and PUT mechanisms also work for other objects
   such as policy agent profiles and groups.</p><div class="screen"><pre>$ curl --request POST --header "iPlanetDirectoryPro: AQIC5w...2NzEz*"
 --header "Content-Type: application/json"
 --data '{"name":"myWebAgent","realm":"/",
  "com.sun.identity.agents.config.fqdn.default":["www.example.com"],
  "sunidentityserverdevicekeyvalue":["agentRootURL=http://www.example.com:80/"],
  "com.sun.identity.agents.config.remote.logfile":["amAgent_www_example_com_80.log"],
  "com.sun.identity.agents.config.repository.location":["centralized"],
  "agenttype":["WebAgent"],
  "com.sun.identity.agents.config.cdsso.cdcservlet.url":
  ["[0]=https://openam.example.com:8443/openam/cdcservlet"],
  "com.sun.identity.client.notification.url":
  ["http://www.example.com:80/UpdateAgentCacheServlet?shortcircuit=false"],
  "com.sun.identity.agents.config.agenturi.prefix":
  ["http://www.example.com:80/amagent"],
  "userpassword":["password"],
  "com.sun.identity.agents.config.login.url":
  ["[0]=https://openam.example.com:8443/openam/UI/Login"],
  "com.sun.identity.agents.config.logout.url":
  ["[0]=https://openam.example.com:8443/openam/UI/Logout"],
  "sunidentityserverdevicestatus":["Active"]}'
 https://openam.example.com:8443/openam/json/agents/?_action=create
{
    "name": "myWebAgent",
    "realm": "/",
    "com.sun.identity.agents.config.cdsso.enable": [
        "false"
    ],
    "com.sun.identity.agents.config.cdsso.cookie.domain": [
        "[0]="
    ],
    "com.sun.identity.agents.config.get.client.host.name": [
        "false"
    ],
    "com.sun.identity.agents.config.profile.attribute.fetch.mode": [
        "NONE"
    ],
    "com.sun.identity.agents.config.notenforced.ip": [
        "[0]="
    ],
    "com.sun.identity.agents.config.fqdn.check.enable": [
        "true"
    ],
    "com.sun.identity.agents.config.cleanup.interval": [
        "30"
    ],
    "com.sun.identity.agents.config.notenforced.url.attributes.enable": [
        "false"
    ],
    "com.sun.identity.agents.config.ignore.preferred.naming.url": [
        "true"
    ],
    "com.sun.identity.agents.config.client.ip.header": [],
    "com.sun.identity.agents.config.session.attribute.mapping": [
        "[]="
    ],
    "com.sun.identity.agents.config.audit.accesstype": [
        "LOG_NONE"
    ],
    "com.sun.identity.agents.config.proxy.override.host.port": [
        "false"
    ],
    "com.sun.identity.agents.config.load.balancer.enable": [
        "false"
    ],
    "com.sun.identity.agents.config.encode.url.special.chars.enable": [
        "false"
    ],
    "com.sun.identity.agents.config.convert.mbyte.enable": [
        "false"
    ],
    "com.sun.identity.agents.config.domino.check.name.database": [
        "false"
    ],
    "com.sun.identity.agents.config.iis.owa.enable": [
        "false"
    ],
    "com.sun.identity.agents.config.override.port": [
        "false"
    ],
    "com.sun.identity.agents.config.policy.clock.skew": [
        "0"
    ],
    "com.sun.identity.agents.config.sso.only": [
        "false"
    ],
    "com.sun.identity.agents.config.iis.owa.enable.session.timeout.url": [],
    "com.sun.identity.agents.config.domino.ltpa.config.name": [
        "LtpaToken"
    ],
    "com.sun.identity.agents.config.cookie.reset": [
        "[0]="
    ],
    "com.sun.identity.agents.config.fqdn.default": [
        "www.example.com"
    ],
    "sunIdentityServerDeviceKeyValue": [
        "agentRootURL=http://www.example.com:80/"
    ],
    "com.sun.identity.agents.config.domino.ltpa.cookie.name": [
        "LtpaToken"
    ],
    "com.sun.identity.agents.config.iis.password.header": [
        "false"
    ],
    "com.sun.identity.agents.config.response.attribute.mapping": [
        "[]="
    ],
    "com.sun.identity.agents.config.userid.param.type": [
        "session"
    ],
    "com.sun.identity.agents.config.url.comparison.case.ignore": [
        "true"
    ],
    "com.sun.identity.agents.config.profile.attribute.cookie.maxage": [
        "300"
    ],
    "com.sun.identity.agents.config.remote.logfile": [
        "amAgent_www_example_com_80.log"
    ],
    "com.sun.identity.agents.config.domino.ltpa.enable": [
        "false"
    ],
    "com.sun.identity.agents.config.notenforced.url": [
        "[0]="
    ],
    "com.sun.identity.agents.config.notification.enable": [
        "true"
    ],
    "com.sun.identity.agents.config.profile.attribute.cookie.prefix": [
        "HTTP_"
    ],
    "com.sun.identity.agents.config.logout.cookie.reset": [
        "[0]="
    ],
    "com.sun.identity.agents.config.polling.interval": [
        "60"
    ],
    "com.sun.identity.agents.config.attribute.multi.value.separator": [
        "|"
    ],
    "com.sun.identity.agents.config.debug.file.rotate": [
        "true"
    ],
    "com.sun.identity.agents.config.debug.level": [
        "Error"
    ],
    "com.sun.identity.agents.config.local.log.rotate": [
        "false"
    ],
    "com.sun.identity.agents.config.repository.location": [
        "centralized"
    ],
    "com.sun.identity.agents.config.client.ip.validation.enable": [
        "false"
    ],
    "com.sun.identity.agents.config.override.protocol": [
        "false"
    ],
    "AgentType": [
        "WebAgent"
    ],
    "com.sun.identity.agents.config.logout.redirect.url": [],
    "com.sun.identity.agents.config.ignore.path.info": [
        "false"
    ],
    "com.sun.identity.agents.config.override.notification.url": [
        "false"
    ],
    "com.sun.identity.agents.config.session.attribute.fetch.mode": [
        "NONE"
    ],
    "com.sun.identity.agents.config.policy.cache.polling.interval": [
        "3"
    ],
    "com.sun.identity.agents.config.cdsso.cdcservlet.url": [
        "[0]=https://openam.example.com:8443/openam/cdcservlet"
    ],
    "com.sun.identity.agents.config.cookie.name": [
        "iPlanetDirectoryPro"
    ],
    "com.sun.identity.agents.config.profile.attribute.mapping": [
        "[]="
    ],
    "com.sun.identity.agents.config.iis.filter.priority": [
        "HIGH"
    ],
    "com.sun.identity.agents.config.iis.auth.type": [],
    "com.sun.identity.client.notification.url": [
        "http://www.example.com:80/UpdateAgentCacheServlet?shortcircuit=false"
    ],
    "com.sun.identity.agents.config.cookie.secure": [
        "false"
    ],
    "com.sun.identity.agents.config.ignore.path.info.for.not.enforced.list": [
        "true"
    ],
    "com.sun.identity.agents.config.remote.log.interval": [
        "5"
    ],
    "com.sun.identity.agents.config.notenforced.url.invert": [
        "false"
    ],
    "universalid": [
        "id=myWebAgent,ou=agent,dc=openam,dc=forgerock,dc=org"
    ],
    "com.sun.identity.agents.config.replaypasswd.key": [],
    "com.sun.identity.agents.config.iis.owa.enable.change.protocol": [
        "false"
    ],
    "com.sun.identity.agents.config.userid.param": [
        "UserToken"
    ],
    "userpassword": [
        "{SHA-1}W6ph5Mm5Pz8GgiULbPgzG37mj9g="
    ],
    "com.sun.identity.agents.config.response.attribute.fetch.mode": [
        "NONE"
    ],
    "com.sun.identity.agents.config.freeformproperties": [
        "sunidentityserverdevicestatus=Active",
        "sunidentityserverdevicekeyvalue=agentRootURL=http://www.example.com:80/",
        "realm=/",
        "name=myWebAgent"
    ],
    "com.sun.identity.agents.config.postdata.preserve.enable": [
        "false"
    ],
    "com.sun.identity.agents.config.log.disposition": [
        "REMOTE"
    ],
    "com.sun.identity.agents.config.agenturi.prefix": [
        "http://www.example.com:80/amagent"
    ],
    "com.sun.identity.agents.config.override.host": [
        "false"
    ],
    "com.sun.identity.agents.config.cookie.reset.enable": [
        "false"
    ],
    "com.sun.identity.agents.config.local.log.size": [
        "52428800"
    ],
    "com.sun.identity.agents.config.access.denied.url": [],
    "com.sun.identity.agents.config.debug.file.size": [
        "10000000"
    ],
    "com.sun.identity.agents.config.change.notification.enable": [
        "true"
    ],
    "com.sun.identity.agents.config.anonymous.user.enable": [
        "false"
    ],
    "com.sun.identity.agents.config.domino.ltpa.org.name": [],
    "com.sun.identity.agents.config.agent.logout.url": [
        "[0]="
    ],
    "com.sun.identity.agents.config.poll.primary.server": [
        "5"
    ],
    "com.sun.identity.agents.config.fqdn.mapping": [
        "[]="
    ],
    "com.sun.identity.agents.config.auth.connection.timeout": [
        "2"
    ],
    "com.sun.identity.agents.config.client.hostname.header": [],
    "com.sun.identity.agents.config.iis.logonuser": [
        "false"
    ],
    "com.sun.identity.agents.config.ignore.server.check": [
        "false"
    ],
    "com.sun.identity.agents.config.fetch.from.root.resource": [
        "false"
    ],
    "com.sun.identity.agents.config.login.url": [
        "[0]=https://openam.example.com:8443/openam/UI/Login"
    ],
    "com.sun.identity.agents.config.redirect.param": [
        "goto"
    ],
    "com.sun.identity.agents.config.logout.url": [
        "[0]=https://openam.example.com:8443/openam/UI/Logout"
    ],
    "sunIdentityServerDeviceStatus": [
        "Active"
    ],
    "com.sun.identity.agents.config.sso.cache.polling.interval": [
        "3"
    ],
    "com.sun.identity.agents.config.anonymous.user.id": [
        "anonymous"
    ],
    "com.sun.identity.agents.config.encode.cookie.special.chars.enable": [
        "false"
    ],
    "com.sun.identity.agents.config.locale": [
        "en_US"
    ],
    "com.sun.identity.agents.config.postcache.entry.lifetime": [
        "10"
    ]
}</pre></div><div class="screen"><pre>$ curl --request POST --header "iPlanetDirectoryPro: AQIC5w...2NzEz*"
 --header "Content-Type: application/json"
 --data '{"name":"newGroup","realm":"/",
    "uniquemember":["uid=demo,ou=people,dc=openam,dc=forgerock,dc=org"]}'
 "https://openam.example.com:8443/openam/json/groups?_action=create"
{
    "name": "newGroup",
    "realm": "/",
    "uniqueMember": [
        "uid=demo,ou=people,dc=openam,dc=forgerock,dc=org"
    ],
    "cn": [
        "newGroup"
    ],
    "objectclass": [
        "groupofuniquenames",
        "top"
    ],
    "universalid": [
        "id=newGroup,ou=group,dc=openam,dc=forgerock,dc=org"
    ]
}

$ curl --request PUT --header "If-None-Match: *"
 --header "iPlanetDirectoryPro: AQIC5w...2NzEz*"
 --header "Content-Type: application/json"
 --data '{"name":"anotherGroup","realm":"/",
    "uniquemember":["uid=demo,ou=people,dc=openam,dc=forgerock,dc=org"]}'
 https://openam.example.com:8443/openam/json/groups/anotherGroup
{
    "name": "anotherGroup",
    "realm": "/",
    "uniqueMember": [
        "uid=demo,ou=people,dc=openam,dc=forgerock,dc=org"
    ],
    "cn": [
        "anotherGroup"
    ],
    "objectclass": [
        "groupofuniquenames",
        "top"
    ],
    "universalid": [
        "id=anotherGroup,ou=group,dc=openam,dc=forgerock,dc=org"
    ]
}</pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="rest-api-read-identity"></a>3.12.2.&nbsp;Reading Identities</h3></div></div></div><p>OpenAM lets users and administrators read profiles by requesting an HTTP
   GET on <code class="literal">/json/<em class="replaceable"><code>subrealm</code></em>/users/<em class="replaceable"><code>user-id</code></em></code>.
   This allows users and administrators to verify user data, status, and directory.
   If users or administrators see missing or incorrect information, they can write 
   down the correct information and add it using <a class="xref" href="chap-rest.html#rest-api-update-identity" title="3.12.3.&nbsp;Updating Identities">Section&nbsp;3.12.3, &#8220;Updating Identities&#8221;</a>.
   To read a profile on the Top Level Realm, you do not need to specify the realm.</p><p>Users can review the data associated with their accounts and administrators 
   can read other user's profiles. The following example shows an administrator 
   accessing user data. Users can view their information by changing
   <code class="literal">username=amadmin</code> to <code class="literal"><em class="replaceable"><code>user-id</code></em></code>.</p><div class="screen"><pre>$ curl --header "iplanetDirectoryPro: AQIC5w...2NzEz*"
 https://openam.example.com:8443/openam/json/users/demo
{
    "username": "demo",
    "realm": "/",
    "uid": [
        "demo"
    ],
    "sn": [
        "demo"
    ],
    "userpassword": [
        "{SSHA}S14oR2gusLWtiDkAS4twj63slXNNaMKpwrOWdw=="
    ],
    "cn": [
        "demo"
    ],
    "inetuserstatus": [
        "Active"
    ],
    "dn": [
        "uid=demo,ou=people,dc=openam,dc=forgerock,dc=org"
    ],
    "objectclass": [
        "person",
        "sunIdentityServerLibertyPPService",
        "sunFederationManagerDataStore",
        "inetorgperson",
        "iPlanetPreferences",
        "iplanet-am-auth-configuration-service",
        "organizationalperson",
        "sunFMSAML2NameIdentifier",
        "inetuser",
        "iplanet-am-managed-person",
        "sunAMAuthAccountLockout",
        "iplanet-am-user-service",
        "top"
    ],
    "universalid": [
        "id=demo,ou=user,dc=openam,dc=forgerock,dc=org"
    ]
}</pre></div><p>Use the <code class="literal">_fields</code> query string parameter to restrict
   the list of attributes returned. This parameter takes a comma-separated list
   of JSON object fields to include in the result.</p><div class="screen"><pre>$ curl --header "iPlanetDirectoryPro: AQIC5w...2NzEz*"
 https://openam.example.com:8443/openam/json/users/demo?_fields=name,uid
{"name":"demo","uid":["demo"]}</pre></div><p>As shown in the examples, OpenAM returns the JSON representation of the
   profile on success. On failure, OpenAM returns a JSON representation of the
   error including the
   <a class="link" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html" target="_blank">HTTP status code</a>.</p><p>Using HTTP GET to read also works for other objects such as agent
   profiles and groups.</p><div class="screen"><pre>$ curl --header "iplanetDirectoryPro: AQIC5w...2NzEz*"
 https://openam.example.com:8443/openam/json/agents/myClientID
{
    "name": "myClientID",
    "realm": "/",
    "com.forgerock.openam.oauth2provider.accessToken": [],
    "com.forgerock.openam.oauth2provider.clientSessionURI": [],
    "com.forgerock.openam.oauth2provider.subjectType": [
        "Pairwise"
    ],
    "com.forgerock.openam.oauth2provider.defaultScopes": [
        "[1]=profile",
        "[0]=openid"
    ],
    "com.forgerock.openam.oauth2provider.clientType": [
        "Confidential"
    ],
    "universalid": [
        "id=myClientID,ou=agent,dc=openam,dc=forgerock,dc=org"
    ],
    "userpassword": [
        "{SHA-1}W6ph5Mm5Pz8GgiULbPgzG37mj9g="
    ],
    "com.forgerock.openam.oauth2provider.name": [
        "[0]="
    ],
    "com.forgerock.openam.oauth2provider.redirectionURIs": [
        "[1]=https://openam.example.com:8443/openid/cb-implicit.html",
        "[0]=https://openam.example.com:8443/openid/cb-basic.html"
    ],
    "com.forgerock.openam.oauth2provider.scopes": [
        "[1]=profile",
        "[0]=openid"
    ],
    "com.forgerock.openam.oauth2provider.idTokenSignedResponseAlg": [
        "HmacSHA256"
    ],
    "com.forgerock.openam.oauth2provider.postLogoutRedirectURI": [],
    "sunIdentityServerDeviceStatus": [
        "Active"
    ],
    "AgentType": [
        "OAuth2Client"
    ],
    "com.forgerock.openam.oauth2provider.description": [
        "[0]="
    ]
}</pre></div><p>The <code class="literal">_prettyPrint</code> query string parameter can make
   the resulting JSON easier to read when you are viewing the resulting JSON
   directly.</p><div class="screen"><pre>$ curl --header "iPlanetDirectoryPro: AQIC5w...2NzEz*"
 "https://openam.example.com:8443/openam/json/groups/myGroup?_prettyPrint=true"
{
  "name" : "myGroup",
  "realm" : "/",
  "uniquemember" : [ "uid=demo,ou=people,dc=openam,dc=forgerock,dc=org" ],
  "cn" : [ "myGroup" ],
  "objectclass" : [ "groupofuniquenames", "top" ],
  "universalid" : [ "id=myGroup,ou=group,dc=openam,dc=forgerock,dc=org" ]
}</pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="rest-api-update-identity"></a>3.12.3.&nbsp;Updating Identities</h3></div></div></div><p>OpenAM lets users update their own profiles, and lets administrators
   update other users' profiles. To update an identity do an HTTP PUT of the JSON 
   representation of the changes to <code class="literal">/json/<em class="replaceable"><code>subrealm</code></em>/users/<em class="replaceable"><code>user-id</code></em></code>.
   To update a profile on the Top Level Realm, you do not need to specify the realm.</p><p>The following example shows how users can update their own
    profiles.</p><div class="screen"><pre>$ curl --request PUT --header "iplanetDirectoryPro: AQIC5...Y3MTAx*"
 --header "Content-Type: application/json"
 --data '{ "mail": "demo@example.com" }'
 https://openam.example.com:8443/openam/json/users/demo
{
    "username": "demo",
    "realm": "/",
    "uid": [
        "demo"
    ],
    "mail": [
        "demo@example.com"
    ],
    "sn": [
        "demo"
    ],
    "userpassword": [
        "{SSHA}S14oR2gusLWtiDkAS4twj63slXNNaMKpwrOWdw=="
    ],
    "cn": [
        "demo"
    ],
    "inetuserstatus": [
        "Active"
    ],
    "dn": [
        "uid=demo,ou=people,dc=openam,dc=forgerock,dc=org"
    ],
    "objectclass": [
        "person",
        "sunIdentityServerLibertyPPService",
        "sunFederationManagerDataStore",
        "inetorgperson",
        "iPlanetPreferences",
        "iplanet-am-auth-configuration-service",
        "organizationalperson",
        "sunFMSAML2NameIdentifier",
        "inetuser",
        "iplanet-am-managed-person",
        "sunAMAuthAccountLockout",
        "iplanet-am-user-service",
        "top"
    ],
    "universalid": [
        "id=demo,ou=user,dc=openam,dc=forgerock,dc=org"
    ]
}</pre></div><p>As shown in the example, OpenAM returns the JSON representation of the
   profile on success. On failure, OpenAM returns a JSON representation of the
   error including the
   <a class="link" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html" target="_blank">HTTP status code</a>.</p><p>You can use HTTP PUT to update other objects as well, such as policy
   agent profiles groups.</p><div class="screen"><pre>$ curl --request PUT --header "iPlanetDirectoryPro: AQIC5...Y3MTAx*"
 --header "Content-Type: application/json"
 --data '{"name":"masterClient","realm":"/","accesstoken":[],
    "clientsessionuri":[],"subjecttype":["Pairwise"],
    "defaultscopes":["[0]=openid"],"clienttype":["Confidential"],
    "universalid":["id=masterClient,ou=agent,dc=openam,dc=forgerock,dc=org"],
    "userpassword":"changeit","name":["[0]="],"redirectionuris":["[0]="],
    "idtokensignedresponsealg":["HmacSHA512"],"scopes":["[0]=openid"],
    "postlogoutredirecturi":[],"sunidentityserverdevicestatus":["Active"],
    "agenttype":["OAuth2Client"],"description":["[0]="]}'
 https://openam.example.com:8443/openam/json/agents/masterClient
{
    "name": "masterClient",
    "realm": "/",
    "com.forgerock.openam.oauth2provider.accesstoken": [],
    "com.forgerock.openam.oauth2provider.clientsessionuri": [],
    "com.forgerock.openam.oauth2provider.subjecttype": [
        "Pairwise"
    ],
    "com.forgerock.openam.oauth2provider.defaultscopes": [
        "[0]="
    ],
    "com.forgerock.openam.oauth2provider.clienttype": [
        "Confidential"
    ],
    "universalid": [
        "id=masterClient,ou=agent,dc=openam,dc=forgerock,dc=org"
    ],
    "userpassword": [
        "{SHA-1}W6ph5Mm5Pz8GgiULbPgzG37mj9g="
    ],
    "com.forgerock.openam.oauth2provider.name": [
        "[0]="
    ],
    "com.forgerock.openam.oauth2provider.redirectionuris": [
        "[0]="
    ],
    "com.forgerock.openam.oauth2provider.idtokensignedresponsealg": [
        "HmacSHA256"
    ],
    "com.forgerock.openam.oauth2provider.scopes": [
        "[0]="
    ],
    "com.forgerock.openam.oauth2provider.postlogoutredirecturi": [],
    "sunidentityserverdevicestatus": [
        "Active"
    ],
    "agenttype": [
        "OAuth2Client"
    ],
    "com.forgerock.openam.oauth2provider.description": [
        "[0]="
    ]
}</pre></div><p>Notice in the following example that updates <code class="literal">myGroup</code>
   the object class value is not included in the JSON sent to OpenAM.</p><div class="screen"><pre>$ curl --request PUT --header "iPlanetDirectoryPro: AQIC5...Y3MTAx*"
 --header "Content-Type: application/json"
 --data '{"name":"myGroup","realm":"/",
    "uniquemember":["uid=demo,ou=people,dc=openam,dc=forgerock,dc=org"],
    "cn":["myGroup"],"description":["Updated the group"]}'
    https://openam.example.com:8443/openam/json/groups/myGroup
{
    "name": "myGroup",
    "realm": "/",
    "uniqueMember": [
        "uid=demo,ou=people,dc=openam,dc=forgerock,dc=org"
    ],
    "cn": [
        "myGroup"
    ],
    "dn": [
        "cn=myGroup,ou=groups,dc=openam,dc=forgerock,dc=org"
    ],
    "objectclass": [
        "groupofuniquenames",
        "top"
    ],
    "universalid": [
        "id=myGroup,ou=group,dc=openam,dc=forgerock,dc=org"
    ]
}
</pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="rest-api-delete-identity"></a>3.12.4.&nbsp;Deleting Identities</h3></div></div></div><p>OpenAM lets administrators delete a user profile by making an HTTP DELETE 
   call to <code class="literal">/json/<em class="replaceable"><code>subrealm</code></em>/users/<em class="replaceable"><code>user-id</code></em></code>.
   To delete a user from the Top Level Realm, you do not need to specify the realm.</p><p>The following example removes a user from the top level
   realm. Only administrators should delete users. The user id is the only
   field required to delete a user.</p><div class="screen"><pre>$ curl --request DELETE --header "iplanetDirectoryPro: AQIC5w...2NzEz*"
 https://openam.example.com:8443/openam/json/users/bjensen
{"success":"true"}</pre></div><p>On success, OpenAM returns a JSON object indicating success. On
   failure, OpenAM returns a JSON representation of the error including the
   <a class="link" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html" target="_blank">HTTP status code</a>.</p><p>You can use this same logic for other resources such as performing an
   HTTP DELETE of an agent profile or of a group.</p><div class="screen"><pre>$ curl --request DELETE --header "iplanetDirectoryPro: AQIC5w...2NzEz*"
 https://openam.example.com:8443/openam/json/agents/myOAuth2ClientAgent
{"success":"true"}</pre></div><div class="screen"><pre>$ curl --request DELETE --header "iPlanetDirectoryPro: AQIC5w...2NzEz*"
 https://openam.example.com:8443/openam/json/groups/myGroup
{"success":"true"}</pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="rest-api-query-identity"></a>3.12.5.&nbsp;Listing Identities</h3></div></div></div><p>OpenAM lets administrators list identities by making an HTTP GET
   call to <code class="literal">/json/<em class="replaceable"><code>subrealm</code></em>/users/?_queryId=*</code>. To query the Top Level Realm, you do not need
   to specify the realm.</p><div class="screen"><pre>$ curl --header "iPlanetDirectoryPro: AQIC5w...2NzEz*"
 "https://openam.example.com:8443/openam/json/users?_queryID=*"
{
  "result" : [ "amAdmin", "demo", "anonymous" ],
  "resultCount" : 3,
  "pagedResultsCookie" : null,
  "remainingPagedResults" : -1
}</pre></div><p>This also works for other types of objects, such as agent profiles and
   groups.</p><div class="screen"><pre>$ curl --header "iPlanetDirectoryPro: AQIC5w...2NzEz*"
 "https://openam.example.com:8443/openam/json/agents?_queryID=*"
{
  "result" : [ "wsp", "wsc", "agentAuth", "SecurityTokenService" ],
  "resultCount" : 4,
  "pagedResultsCookie" : null,
  "remainingPagedResults" : -1
}</pre></div><div class="screen"><pre>$ curl --header "iPlanetDirectoryPro: AQIC5w...2NzEz*"
 "https://openam.example.com:8443/openam/json/groups?_queryID=*"
{
  "result" : [ "myOtherGroup", "myGroup" ],
  "resultCount" : 2,
  "pagedResultsCookie" : null,
  "remainingPagedResults" : -1
}</pre></div><p>As the result lists include all objects, this capability to list
   identity names is mainly useful in testing.</p><p>As shown in the examples, OpenAM returns the JSON representation of
   the resource list if successful. On failure, OpenAM returns a JSON
   representation of the error including the
   <a class="link" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html" target="_blank">HTTP status code</a>.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="rest-api-create-legacy"></a>3.12.6.&nbsp;Creating Identities (Legacy API)</h3></div></div></div><p>Interface Stability: <a href="../../admin-guide/index/appendix-interface-stability.html#interface-stability" class="link">Deprecated</a></p><p>OpenAM lets you create user profiles, and also create web and J2EE
   policy agent profiles. When you create an entry, you must provide the
   following parameters.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">admin</span></dt><dd><p>Valid token for the user with permissions to add the identity</p></dd><dt><span class="term">identity_name</span></dt><dd><p>A unique name for the identity to create</p></dd><dt><span class="term">identity_attribute_names</span></dt><dd><p>LDAP attribute names for attributes to create</p></dd><dt><span class="term">identity_attribute_values_<em class="replaceable"><code>name</code></em></span></dt><dd><p>LDAP attribute values for the identity to create. For example,
      <code class="literal">identity_attribute_names=sn&amp;identity_attribute_values_sn=Jensen</code>.</p></dd><dt><span class="term">identity_realm</span></dt><dd><p>The realm in which to create the identity</p></dd><dt><span class="term">identity_type</span></dt><dd><p>Either <code class="literal">user</code> or <code class="literal">AgentOnly</code></p></dd></dl></div><div class="screen"><pre>$ curl "https://openam.example.com:8443/openam/identity/create?
 admin=AQIC5wM2LY4SfcxSYA8eG-vrNHb_W7nG8XkfAGyRyuaebDY.*AAJTSQACMDE.*
 &amp;identity_name=testuser
 &amp;identity_attribute_names=cn
 &amp;identity_attribute_values_cn=Test%20User
 &amp;identity_attribute_names=sn
 &amp;identity_attribute_values_sn=User
 &amp;identity_attribute_names=userpassword
 &amp;identity_attribute_values_userpassword=secret12
 &amp;identity_realm=%2F
 &amp;identity_type=user"</pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="rest-api-read-legacy"></a>3.12.7.&nbsp;Reading &amp; Searching for Identities (Legacy API)</h3></div></div></div><p>Interface Stability: <a href="../../admin-guide/index/appendix-interface-stability.html#interface-stability" class="link">Deprecated</a></p><p>Reading is similar to attribute retrieval, as described in
   <a class="xref" href="chap-rest.html#rest-api-tokens" title="3.5.&nbsp;Token Validation, Attribute Retrieval">Section&nbsp;3.5, &#8220;Token Validation, Attribute Retrieval&#8221;</a>, but obtained using the token of
   a user with permissions to perform the search, as shown in the following
   example.</p><div class="screen"><pre>$ curl "https://openam.example.com:8443/openam/identity/read?
 admin=AQIC5wM2LY4SfcxSYA8eG-vrNHb_W7nG8XkfAGyRyuaebDY.*AAJTSQACMDE.*
 &amp;name=testuser
 &amp;attributes_names=realm
 &amp;attributes_values_realm=%2F"
identitydetails.name=testuser
identitydetails.type=user
identitydetails.realm=o=openam
identitydetails.attribute=
identitydetails.attribute.name=uid
identitydetails.attribute.value=testuser
identitydetails.attribute=
identitydetails.attribute.name=sn
identitydetails.attribute.value=User
identitydetails.attribute=
identitydetails.attribute.name=userpassword
identitydetails.attribute.value={SSHA}AzpT+N1sjrQhL1wfX2ETWh/Aqbd+lH9LOlhDqg==
identitydetails.attribute=
identitydetails.attribute.name=cn
identitydetails.attribute.value=Test User
identitydetails.attribute=
identitydetails.attribute.name=inetuserstatus
identitydetails.attribute.value=Active
identitydetails.attribute=
identitydetails.attribute.name=dn
identitydetails.attribute.value=uid=testuser,ou=people,dc=example,dc=com
identitydetails.attribute=
identitydetails.attribute.name=objectclass
identitydetails.attribute.value=person
identitydetails.attribute.value=sunIdentityServerLibertyPPService
identitydetails.attribute.value=inetorgperson
identitydetails.attribute.value=sunFederationManagerDataStore
identitydetails.attribute.value=iPlanetPreferences
identitydetails.attribute.value=iplanet-am-auth-configuration-service
identitydetails.attribute.value=organizationalperson
identitydetails.attribute.value=sunFMSAML2NameIdentifier
identitydetails.attribute.value=inetuser
identitydetails.attribute.value=iplanet-am-managed-person
identitydetails.attribute.value=iplanet-am-user-service
identitydetails.attribute.value=sunAMAuthAccountLockout
identitydetails.attribute.value=top
identitydetails.attribute=
identitydetails.attribute.name=universalid
identitydetails.attribute.value=id=testuser,ou=user,o=openam</pre></div><p>You can search for user IDs by providing the following
   parameters.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">admin</span></dt><dd><p>Valid token for the user with access to perform the search</p></dd><dt><span class="term">attributes_names</span></dt><dd><p>LDAP attribute names for attributes to search</p></dd><dt><span class="term">attributes_values_<em class="replaceable"><code>name</code></em></span></dt><dd><p>LDAP attribute values for the identity to search. For example,
      <code class="literal">attribute_names=sn&amp;attribute_values_sn=Jensen</code>.</p></dd><dt><span class="term">filter</span></dt><dd><p>Additional LDAP filter component to limit the search results
      returned</p></dd></dl></div><div class="screen"><pre>$ curl "https://openam.example.com:8443/openam/identity/search?
 admin=AQIC5wM2LY4SfcxSYA8eG-vrNHb_W7nG8XkfAGyRyuaebDY.*AAJTSQACMDE.*
 &amp;attributes_names=sn
 &amp;attributes_values_sn=Jensen
 &amp;attributes_names=mail
 &amp;attributes_values_mail=bjensen*
 &amp;attributes_names=realm
 &amp;attributes_values_realm=%2F"
string=bjensen</pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="rest-api-update-legacy"></a>3.12.8.&nbsp;Updating Identities (Legacy API)</h3></div></div></div><p>Interface Stability: <a href="../../admin-guide/index/appendix-interface-stability.html#interface-stability" class="link">Deprecated</a></p><p>You can update an identity with the same parameters used to create
   identities, provided the token corresponds to a user with access to
   update the identity.</p><div class="screen"><pre>$ curl "https://openam.example.com:8443/openam/identity/update?
 admin=AQIC5wM2LY4SfcxSYA8eG-vrNHb_W7nG8XkfAGyRyuaebDY.*AAJTSQACMDE.*
 &amp;identity_name=testuser
 &amp;identity_attribute_names=mail
 &amp;identity_attribute_values_mail=testuser%40example.com
 &amp;identity_realm=%2F
 &amp;identity_type=user"</pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="rest-api-delete-legacy"></a>3.12.9.&nbsp;Deleting Identities (Legacy API)</h3></div></div></div><p>Interface Stability: <a href="../../admin-guide/index/appendix-interface-stability.html#interface-stability" class="link">Deprecated</a></p><p>You can also delete an identity.</p><div class="screen"><pre>$ curl "https://openam.example.com:8443/openam/identity/delete?
 admin=AQIC5wM2LY4SfcxSYA8eG-vrNHb_W7nG8XkfAGyRyuaebDY.*AAJTSQACMDE.*
 &amp;identity_name=testuser
 &amp;identity_realm=%2F
 &amp;identity_type=user"</pre></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="rest-api-crud-realm"></a>3.13.&nbsp;Realm Management</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="chap-rest.html#rest-api-parameters-realm">3.13.1. Default Parameters for Realms</a></span></dt><dt><span class="section"><a href="chap-rest.html#rest-api-create-realm">3.13.2. Creating Realms</a></span></dt><dt><span class="section"><a href="chap-rest.html#rest-api-read-realm">3.13.3. Reading Realms</a></span></dt><dt><span class="section"><a href="chap-rest.html#rest-api-update-realm">3.13.4. Updating Realms</a></span></dt><dt><span class="section"><a href="chap-rest.html#rest-api-delete-realm">3.13.5. Deleting Realms</a></span></dt></dl></div><a class="indexterm" name="d0e2104"></a><p>This section shows how to create, read, update, and delete realms 
  using the RESTful APIs.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Under the <code class="literal">/json/realms</code> endpoint, you find the 
    newer JSON-based API.</p><div class="itemizedlist"><p>The following sections cover this JSON-based API.</p><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><a class="xref" href="chap-rest.html#rest-api-parameters-realm" title="3.13.1.&nbsp;Default Parameters for Realms">Section&nbsp;3.13.1, &#8220;Default Parameters for Realms&#8221;</a></p></li><li class="listitem"><p><a class="xref" href="chap-rest.html#rest-api-create-realm" title="3.13.2.&nbsp;Creating Realms">Section&nbsp;3.13.2, &#8220;Creating Realms&#8221;</a></p></li><li class="listitem"><p><a class="xref" href="chap-rest.html#rest-api-read-realm" title="3.13.3.&nbsp;Reading Realms">Section&nbsp;3.13.3, &#8220;Reading Realms&#8221;</a></p></li><li class="listitem"><p><a class="xref" href="chap-rest.html#rest-api-update-realm" title="3.13.4.&nbsp;Updating Realms">Section&nbsp;3.13.4, &#8220;Updating Realms&#8221;</a></p></li><li class="listitem"><p><a class="xref" href="chap-rest.html#rest-api-delete-realm" title="3.13.5.&nbsp;Deleting Realms">Section&nbsp;3.13.5, &#8220;Deleting Realms&#8221;</a></p></li></ul></div></li></ul></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="rest-api-parameters-realm"></a>3.13.1.&nbsp;Default Parameters for Realms</h3></div></div></div><p>Realms have a number of fields entered with the default loading.
    The following table provides information on what the default realm settings are,
    and these settings can be updated, added, or deleted when updating
    a realm.</p><div class="table"><a name="realm-parameter"></a><div class="table-title">Table&nbsp;3.1.&nbsp;Realm Parameters for JSON-based API</div><div class="table-contents"><table summary="Realm Parameters for JSON-based API" width="100%" border="0"><colgroup><col width="33%"><col width="33%"><col width="34%"></colgroup><thead><tr><th>Realm Parameter</th><th>Default</th><th>Purpose</th></tr></thead><tbody><tr><td>realm</td><td>None - the only required field to add a realm</td><td><p>The name of the realm</p>
         <p>Example: <code class="literal">testRealm</code></p></td></tr><tr><td>sunOrganizationStatus</td><td>None</td><td><p>The status of the realm</p>
         <p><code class="literal">Active</code> or <code class="literal">Inactive</code></p></td></tr><tr><td>sunOrganizationAliases</td><td>None</td><td><p>Any applicable aliases associated with the realm. Be aware that
        an alias can only be used once. Entering an alias used by another realm
        will remove the alias from that realm and you will lose configuration.</p>
         <p>Example: <code class="literal">opensso.example.com</code></p></td></tr><tr><td>serviceNames</td><td><code class="literal">sunAMAuthHOTPService</code>
        <code class="literal">iPlanetAMAuthConfiguration</code>        
        <code class="literal">sunAMAuthFederationService</code>
        <code class="literal">sunIdentityRepositoryService</code>
        <code class="literal">iPlanetAMPolicyConfigService</code>
        <code class="literal">iPlanetAMAuthService</code>
        <code class="literal">iPlanetAMAuthLDAPService</code>
        <code class="literal">sunAMAuthDataStoreService</code>
        <code class="literal">sunAMAuthSAEService</code>
        <code class="literal">sunAMDelegationService</code>
        <code class="literal">sunAMAuthWSSAuthModuleService</code>
        <code class="literal">iPlanetAMAuthOATHService</code>
        </td><td>Services needed for the realm, including authentication modules</td></tr></tbody></table></div></div><br class="table-break"></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="rest-api-create-realm"></a>3.13.2.&nbsp;Creating Realms</h3></div></div></div><p>OpenAM lets administrators create a realm by making 
   an HTTP POST of the JSON representation of the profile to
   <code class="literal">/json/realms/?_action=create</code>.</p><p>You can create realms using an HTTP POST of the JSON representation 
    of the profile to <code class="literal">/json/realms/?_action=create</code>, as shown in 
    the following example. The only required field is <code class="literal">realm</code>, 
    but the realm will not be active if the status is not set.</p><div class="screen"><pre>$ curl --request POST --header "iplanetDirectoryPro: AQIC5w...2NzEz*"
 --header "Content-Type: application/json"
 --data '{ "realm": "testRealm" }'
 https://openam.example.com:8443/openam/json/realms/?_action=create
{"realmCreated":"/testRealm"}</pre></div><p>You can also set the <code class="literal">sunOrganizationAliases</code> parameter,
    but it can only be assigned to one realm (usually the top level realm). Before
    setting this parameter, make sure it is not already assigned elsewhere. If you 
    replace remove it from another realm, you will lose your configuration.</p><p>Alternatively, administrators can create realms by the specific realm
    name using the HTTP PUT of the JSON representation of the changes to 
    <code class="literal">/json/realms/<em class="replaceable"><code>realm-id</code></em></code>, as
    shown in the following example.</p><div class="screen"><pre>$ curl --request PUT --header "iplanetDirectoryPro: AQIC5w...2NzEz*"
 --header "Content-Type: application/json"
 --data '{ "sunOrganizationStatus": "Active" }'
 https://openam.example.com:8443/openam/json/realms/testRealm
{</pre></div><p>As shown in the examples, OpenAM returns the JSON representation of
    the profile on successful creation. On failure, OpenAM returns a JSON
    representation of the error including the
    <a class="link" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html" target="_blank">HTTP status code</a>.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="rest-api-read-realm"></a>3.13.3.&nbsp;Reading Realms</h3></div></div></div><p>OpenAM lets administrators read realms by requesting an HTTP GET on 
   <code class="literal">/json/realms/<em class="replaceable"><code>realm-id</code></em></code>. This 
   allows administrators to review all active realm services for the realm, 
   like policy configuration and modules. If users or administrators see missing 
   information (such as Active status) or incorrect information, they can write 
   down the correct information and add it using <a class="xref" href="chap-rest.html#rest-api-update-realm" title="3.13.4.&nbsp;Updating Realms">Section&nbsp;3.13.4, &#8220;Updating Realms&#8221;</a></p><p>The following example shows an administrator receiving information about
    the <code class="literal">testRealm</code>.</p><div class="screen"><pre>$ curl --header "iplanetDirectoryPro: AQIC5w...2NzEz*"
 https://openam.example.com:8443/openam/json/realms/testRealm
{
    "serviceNames":[
                  "sunAMAuthHOTPService",
                  "iPlanetAMAuthConfiguration",
                  "sunAMAuthFederationService",
                  "sunIdentityRepositoryService",
                  "iPlanetAMPolicyConfigService",
                  "iPlanetAMAuthService",
                  "iPlanetAMAuthLDAPService",
                  "sunAMAuthDataStoreService",
                  "sunAMAuthSAEService",
                  "sunAMDelegationService",
                  "sunAMAuthWSSAuthModuleService",
                  "iPlanetAMAuthOATHService"
    ]
}</pre></div><p>As shown in the example, OpenAM returns the JSON representation of the
    profile on success. On failure, OpenAM returns a JSON representation of the
    error including the
    <a class="link" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html" target="_blank">HTTP status code</a>.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="rest-api-update-realm"></a>3.13.4.&nbsp;Updating Realms</h3></div></div></div><p>OpenAM lets administrators update realms. To update a realm, do an HTTP PUT 
   of the JSON representation of the changes to
   <code class="literal">/json/realms/<em class="replaceable"><code>realm-id</code></em></code>.</p><p>The following example shows how to update a realm.</p><div class="screen"><pre>$ curl --request PUT --header "iplanetDirectoryPro: AQIC5...Y3MTAx*"
 --header "Content-Type: application/json"
 --data '{ "sunOrganizationStatus": "Active" }'
 https://openam.example.com:8443/openam/json/realms/testRealm</pre></div><p>As shown in the example, OpenAM returns the JSON representation of the
    profile on success. On failure, OpenAM returns a JSON representation of the
    error including the
    <a class="link" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html" target="_blank">HTTP status code</a>.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="rest-api-delete-realm"></a>3.13.5.&nbsp;Deleting Realms</h3></div></div></div><p>OpenAM lets administrators delete a realm by making an HTTP DELETE call to
   <code class="literal">/json/realms/<em class="replaceable"><code>realm-id</code></em></code>.</p><p>The following example deletes a realm. The top level realm cannot
    be deleted. Only administrators should delete realms. The name of the realm
    is the only field required to delete the realm.</p><p>Make sure that you do not have any information you need within a realm 
    before deleting it. Once a realm is deleted, the only way to restore it is 
    to return to a backed up deployment of OpenAM.</p><div class="screen"><pre>$ curl --request DELETE --header "iplanetDirectoryPro: AQIC5w...2NzEz*"
 https://openam.example.com:8443/openam/json/realms/testRealm
 {"success":"true"}</pre></div><p>On success, OpenAM returns a JSON object indicating success. On
    failure, OpenAM returns a JSON representation of the error including the
    <a class="link" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html" target="_blank">HTTP status code</a>.</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="rest-dashboard"></a>3.14.&nbsp;Displaying Dashboard Applications</h2></div></div></div><a class="indexterm" name="d0e2340"></a><p>OpenAm lets administrators configure online applications to display
    applications on user Dashboards. You can used exposed REST API to display
    information about the online applications.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">/dashboard/assigned</code></span></dt><dd><p>This endpoint retrieves the list of applications assigned to the 
       authenticated user.</p><div class="screen"><pre>$ curl --header "iplanetDirectoryPro: AQIC5w...2NzEz*"
 https://openam.example.com:8443/openam/json/dashboard/assigned
{
  "google": {
      "dashboardIcon": [
          "Google.gif"
      ],
      "dashboardName": [
          "Google"
      ],
      "dashboardLogin": [
          "http://www.google.com"
      ],
      "ICFIdentifier": [
          ""
      ],
      "dashboardDisplayName": [
          "Google"
      ],
      "dashboardClassName": [
          "SAML2ApplicationClass"
      ]
   }
}</pre></div></dd><dt><span class="term"><code class="literal">/dashboard/available</code></span></dt><dd><p>This endpoint retrieves the list of applications available in the
       authenticated user's realm. The example is based on two of the default 
       Dashboard applications: Google and Salesforce.</p><div class="screen"><pre>$ curl --header "iplanetDirectoryPro: AQIC5w...2NzEz*"
 https://openam.example.com:8443/openam/json/dashboard/available
{
  "google": {
      "dashboardIcon": [
          "Google.gif"
      ],
      "dashboardName": [
          "Google"
      ],
      "dashboardLogin": [
          "http://www.google.com"
      ],
      "ICFIdentifier": [
          ""
      ],
      "dashboardDisplayName": [
          "Google"
      ],
      "dashboardClassName": [
          "SAML2ApplicationClass"
      ]
  }
  "salesforce": {
      "dashboardIcon": [
          "salesforce.gif"
      ],
      "dashboardName": [
          "Salesforce"
      ],
      "dashboardLogin": [
          "http://salesforce.com"
      ],
      "ICFIdentifier": [
          ""
      ],
      "dashboardDisplayName": [
          "Salesforce"
      ],
      "dashboardClassName": [
          "SAML2ApplicationClass"
      ]
  }
}</pre></div></dd><dt><span class="term"><code class="literal">/dashboard/defined</code></span></dt><dd><p>This endpoint retrieves the list of all applications available defined
       for the OpenAM Dashboard service. The example is based on the three default 
       Dashboard applications: Google, Salesforce, and Zendesk.</p><div class="screen"><pre>$ curl --header "iplanetDirectoryPro: AQIC5w...2NzEz*"
 https://openam.example.com:8443/openam/json/dashboard/defined
{
    "google": {
        "dashboardIcon": [
            "Google.gif"
        ],
        "dashboardName": [
            "Google"
        ],
        "dashboardLogin": [
            "http://www.google.com"
        ],
        "ICFIdentifier": [
            "idm magic 34"
        ],
        "dashboardDisplayName": [
            "Google"
        ],
        "dashboardClassName": [
            "SAML2ApplicationClass"
        ]
    },
    "salesforce": {
        "dashboardIcon": [
            "salesforce.gif"
        ],
        "dashboardName": [
            "SalesForce"
        ],
        "dashboardLogin": [
            "http://www.salesforce.com"
        ],
        "ICFIdentifier": [
            "idm magic 12"
        ],
        "dashboardDisplayName": [
            "Salesforce"
        ],
        "dashboardClassName": [
            "SAML2ApplicationClass"
        ]
    },
    "zendesk": {
        "dashboardIcon": [
            "ZenDesk.gif"
        ],
        "dashboardName": [
            "ZenDesk"
        ],
        "dashboardLogin": [
            "http://www.ZenDesk.com"
        ],
        "ICFIdentifier": [
            "idm magic 56"
        ],
        "dashboardDisplayName": [
            "ZenDesk"
        ],
        "dashboardClassName": [
            "SAML2ApplicationClass"
        ]
    }
}</pre></div></dd></dl></div><p>If your application runs in a user-agent such as a browser, you can
    rely on OpenAM to handle authentication.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="rest-api-status-codes"></a>3.15.&nbsp;REST Status Codes</h2></div></div></div><p>OpenAM REST APIs respond to successful requests with HTTP status codes
   in the 2xx range. OpenAM REST APIs respond to error conditions with HTTP
   status codes in the 4xx and 5xx range. Status codes used are described in the
   following list.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">200 OK</span></dt><dd><p>The request was successful and a resource returned, depending on the
      request. For example, a successful HTTP GET on
      <code class="literal">/users/myUser</code> returns a user profile and status code
      200, whereas a successful HTTP DELETE returns
      <code class="literal">{"success","true"}</code> and status code 200.</p></dd><dt><span class="term">201 Created</span></dt><dd><p>The request succeeded and the resource was created.</p></dd><dt><span class="term">400 Bad Request</span></dt><dd><p>The request was malformed as in the following example, which is
      sending bad data in the payload for the action.</p><div class="screen"><pre>$ curl --request POST --header "Content-Type: application/json"
 --data '{"bad":"data"}'
 https://openam.example.com:8443/openam/json/users?_action=forgotPassword

{"code":400,"reason":"Bad Request","message":"Username not provided"}</pre></div></dd><dt><span class="term">401 Unauthorized</span></dt><dd><p>The request requires user authentication as in the following
      example, which is missing an SSO Token value.</p><div class="screen"><pre>$ curl --request POST
 https://openam.example.com:8443/openam/json/sessions?_action=logout

{ "code": 401, "reason": "Unauthorized", "message": "Access denied" }</pre></div></dd><dt><span class="term">403 Forbidden</span></dt><dd><p>Access was forbidden during an operation on a resource as in the
      following example, which has a regular user trying to read the OpenAM
      administrator profile.</p><div class="screen"><pre>$ curl --request POST
 --header "X-OpenAM-Username: demo" --header "X-OpenAM-Password: changeit"
 https://openam.example.com:8443/openam/json/authenticate

{ "tokenId": "AQIC5w...YyMA..*" }

$ curl --header "iplanetDirectoryPro: AQIC5w...YyMA..*"
 https://openam.example.com:8443/openam/json/users/amadmin
{
    "code": 403,
    "reason": "Forbidden",
    "message": "Permission to perform the read operation denied to
                id=demo,ou=user,dc=openam,dc=forgerock,dc=org"
}</pre></div></dd><dt><span class="term">404 Not Found</span></dt><dd><p>The specified resource could not be found as in the following
      example, which is attempting to read a nonexistent user's profile.</p><div class="screen"><pre>$ curl --header "iplanetDirectoryPro: AQIC5w...NTcy*"
 https://openam.example.com:8443/openam/json/users/missing

  {"code":404,"reason":"Not Found","message":"Resource cannot be found."}</pre></div></dd><dt><span class="term">405 Method Not Allowed</span></dt><dd><p>The HTTP method is not allowed for the requested resource.</p></dd><dt><span class="term">409 Conflict</span></dt><dd><p>The request would have resulted in a conflict with the current
      state of the resource.</p></dd><dt><span class="term">415 Unsupported Media Type</span></dt><dd><p>The request is in a format not supported by the requested resource
      for the requested method as in the following example, which is attempting
      to pass basic authentication credentials as form-encoded data rather than
      query string parameters.</p><div class="screen"><pre>$ curl --request POST --data "username=demo&amp;password=changeit"
 https://openam.example.com:8443/openam/json/authenticate
...
HTTP Status 415
...
The server refused this request because the request entity is in a
 format not supported by the requested resource for the requested method
...</pre></div></dd><dt><span class="term">500 Internal Server Error</span></dt><dd><p>The server encountered an unexpected condition which prevented it
      from fulfilling the request.</p></dd><dt><span class="term">501 Not Implemented</span></dt><dd><p>The resource does not support the functionality required to fulfill
      the request as in the following example, which is attempting to delete
      an entry as a delete action instead of using an HTTP DELETE request.</p><div class="screen"><pre>curl --request POST --header "iplanetDirectoryPro: AQIC5w...NTcy*"
 https://openam.example.com:8443/openam/json/users/demo?_action=delete

{
    "code": 501,
    "reason": "Not Implemented",
    "message": "Actions are not supported for resource instances"
}</pre></div></dd><dt><span class="term">503 Service Unavailable</span></dt><dd><p>The requested resource was temporarily unavailable.</p></dd></dl></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="chap-client-dev.html">Prev</a>&nbsp;</td><td width="20%" align="center">&nbsp;</td><td width="40%" align="right">&nbsp;<a accesskey="n" href="chap-jdk.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter&nbsp;2.&nbsp;Developing Client Applications&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;Chapter&nbsp;4.&nbsp;Using the OpenAM Java SDK</td></tr></table></div><p>&nbsp;</p><div id="footer"><p>Something wrong on this page? <a href="https://bugster.forgerock.org/jira/secure/CreateIssueDetails!init.jspa?pid=10000&components=10007&issuetype=1">Log a documentation bug.</a></p></div>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-23412190-14']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</body></html>